<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="id-ID"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Panduan: Mencari ID Amazon Machine Image - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="walkthrough-custom-resources-lambda-lookup-amiids" /><meta name="default_state" content="walkthrough-custom-resources-lambda-lookup-amiids" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" /><meta name="description" content="Gunakan AWS Lambda dan sumber daya kustom untuk secara dinamis mencari ID AMI." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Panduan Pengguna" /><meta name="abstract" content="Membuat dan mengelola penyebaran AWS infrastruktur dapat diprediksi dan berulang kali menggunakan Panduan Pengguna AWS CloudFormation ini." /><meta name="guide-locale" content="id_id" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Panduan Pengguna" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Panduan Pengguna" /><meta id="panorama-serviceConsolePage" value="Panduan: Mencari ID Amazon Machine Image" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Panduan: Mencari ID Amazon Machine Image - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,penyediaan sumber daya,konfigurasi sumber daya,manajemen infrastruktur,CloudFormer,CloudFormation tumpukan,CloudFormation stackset,CloudFormation Template,ubah set" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Panduan Pengguna",
        "item" : "https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Bekerja dengan templat AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Sumber daya khusus",
        "item" : "https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/template-custom-resources.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Sumber daya kustom yang didukung AWS Lambda",
        "item" : "https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/template-custom-resources-lambda.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Panduan: Mencari ID Amazon Machine Image",
        "item" : "https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/template-custom-resources-lambda.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Dokumentasi</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Panduan Pengguna</a></div><div id="page-toc-src"><a href="#walkthrough-custom-resources-lambda-lookup-amiids-savesample">Langkah 1: Mengunduh dan menyimpan paket sampel di Amazon S3</a><a href="#walkthrough-custom-resources-lambda-lookup-amiids-createfunction-createstack">Langkah 2: Buat tumpukan</a><a href="#walkthrough-custom-resources-lambda-lookup-amiids-createfunction-cleanup">Langkah 3: Bersihkan Sumber Daya </a><a href="#w9aac23c26c16b7c29">Informasi terkait</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Terjemahan disediakan oleh mesin penerjemah. Jika konten terjemahan yang diberikan bertentangan dengan versi bahasa Inggris aslinya, utamakan versi bahasa Inggris.</p></awsui-alert><h1 class="topictitle" id="walkthrough-custom-resources-lambda-lookup-amiids">Panduan: Mencari ID Amazon Machine Image</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>AWS CloudFormationtemplate yang mendeklarasikan instans Amazon Elastic Compute Cloud (Amazon EC2) juga harus menentukan ID Amazon Machine Image (AMI), yang mencakup sistem operasi dan perangkat lunak lain serta informasi konfigurasi yang digunakan untuk meluncurkan instance. ID AMI yang benar tergantung pada jenis dan wilayah instans di mana Anda meluncurkan tumpukan. Dan ID dapat berubah secara teratur, seperti ketika AMI diperbarui dengan pembaruan perangkat lunak.</p><p>Biasanya, Anda mungkin memetakan ID AMI ke jenis dan Tipe instans dan wilayah tertentu. Untuk memperbarui ID, Anda akan mengubahnya secara manual di setiap templat Anda. Dengan menggunakan sumber daya khusus dan AWS Lambda (Lambda), Anda dapat membuat fungsi yang mendapatkan ID AMI terbaru untuk wilayah dan jenis instans yang Anda gunakan sehingga Anda tidak perlu mempertahankan pemetaan.</p><p>Panduan ini menunjukkan kepada Anda cara membuat sumber daya khusus dan mengaitkan fungsi Lambda dengannya untuk mencari ID AMI. Perhatikan bahwa panduan mengasumsikan bahwa Anda memahami cara menggunakan sumber daya khusus dan Lambda. Untuk informasi selengkapnya, lihat <a href="./template-custom-resources.html">Sumber daya khusus</a> atau <a href="https://docs.aws.amazon.com/lambda/latest/dg/">Panduan AWS Lambda Pengembang</a>.</p><p>Gambaran umum panduan</p><p>Untuk panduan ini, Anda akan membuat tumpukan dengan sumber daya khusus, fungsi Lambda, dan instans EC2. Panduan tersebut menyediakan kode sampel dan templat contoh yang akan Anda gunakan untuk membuat tumpukan.</p><p>Templat sampel menggunakan jenis sumber daya khusus untuk memanggil dan mengirim nilai masukan ke fungsi Lambda. Saat Anda menggunakan templat, AWS CloudFormation memanggil fungsi dan mengirimkan informasi ke sana, seperti jenis permintaan, data input, dan URL Simple Storage Service (Amazon S3) Amazon Simple Storage Service (Amazon S3) yang telah ditandatangani sebelumnya. Fungsi ini menggunakan informasi tersebut untuk mencari ID AMI, dan kemudian mengirimkan respons ke URL yang telah ditandatangani sebelumnya.</p><p>Setelah AWS CloudFormation mendapat respon di lokasi URL yang sudah ditandatangani, akan dilanjutkan dengan membuat tumpukan. Saat AWS CloudFormation membuat instance, ia menggunakan respons fungsi Lambda untuk menentukan ID AMI instance.</p><p>Daftar berikut merangkum proses. Anda memerlukan izin AWS Identity and Access Management (IAM) untuk menggunakan semua layanan terkait, seperti Lambda, Amazon EC2, dan. AWS CloudFormation</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>catatan</h6></div><div class="awsdocs-note-text"><p>AWS CloudFormationadalah layanan gratis; namun, Anda dikenakan biaya untuk AWS sumber daya, seperti fungsi Lambda dan instans EC2, yang Anda sertakan dalam tumpukan Anda dengan tarif saat ini untuk masing-masing. Untuk informasi lebih lanjut tentang AWS harga, lihat halaman detail untuk setiap produk di <a href="https://aws.amazon.com/" rel="noopener noreferrer" target="_blank"><span>http://aws.amazon.com</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></div></div><div class="orderedlist">
     
     
     
  <ol><li>
      <p><a href="#walkthrough-custom-resources-lambda-lookup-amiids-savesample">Simpan paket Lambda sampel di bucket Amazon Simple Storage Service (Amazon S3).</a></p>
      <p>Paket sampel berisi semua yang diperlukan untuk membuat fungsi Lambda. Anda harus menyimpan paket dalam bucket yang berada di wilayah yang sama di mana Anda akan membuat tumpukan.</p>
    </li><li>
      <p><a href="#walkthrough-custom-resources-lambda-lookup-amiids-createfunction-createstack">Gunakan template sampel untuk membuat tumpukan.</a></p>
      <p>Tumpukan menunjukkan bagaimana Anda mengaitkan fungsi Lambda dengan sumber daya khusus dan cara menggunakan hasil dari fungsi untuk menentukan ID AMI. Tumpukan juga membuat peran IAM (peran eksekusi), yang digunakan Lambda untuk melakukan panggilan ke Amazon EC2.</p>
    </li><li>
      <p><a href="#walkthrough-custom-resources-lambda-lookup-amiids-createfunction-cleanup">Hapus tumpukan.</a></p>
      <p>Hapus tumpukan untuk membersihkan semua sumber daya tumpukan yang Anda buat sehingga Anda tidak dikenakan biaya untuk sumber daya yang tidak diperlukan.</p>
    </li></ol></div><h2 id="walkthrough-custom-resources-lambda-lookup-amiids-savesample">Langkah 1: Mengunduh dan menyimpan paket sampel di Amazon S3</h2>
    
    <p>Saat membuat tumpukan dengan fungsi Lambda, Anda harus menentukan lokasi bucket Amazon S3 yang berisi kode sumber fungsi. Bucket harus berada di wilayah yang sama dengan tempat Anda membuat tumpukan.</p>
    <p>Panduan ini menyediakan paket sampel (<code>.zip</code>file) yang diperlukan untuk membuat fungsi Lambda. Paket Lambda berisi kode sumber untuk fungsi dan perpustakaan yang diperlukan. Untuk panduan ini, fungsi tidak memerlukan pustaka tambahan.</p>
    <p>Fungsi ini mengambil arsitektur dan wilayah instans sebagai input dari permintaan sumber daya AWS CloudFormation khusus dan mengembalikan ID AMI terbaru ke URL Amazon S3 yang telah ditandatangani sebelumnya.</p>
    <div class="procedure"><h6>Untuk mengunduh dan menyimpan paket di Amazon S3</h6><ol><li>
        <p>Unduh paket sampel dari Amazon S3. Ketika Anda menyimpan file, gunakan nama file yang sama sebagai contoh, <code>amilookup.zip</code> atau <code>amilookup-win.zip</code>.</p>
        <div class="variablelist">
           
           
        <dl>
            <dt><b><span class="term">Cari ID AMI Linux</span></b></dt>
            <dd>
              <p><a href="https://s3.amazonaws.com/cloudformation-examples/lambda/amilookup.zip" rel="noopener noreferrer" target="_blank"><span>https://s3.amazonaws.com/cloudformation-examples/lambda/amilookup.zip</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
            </dd>
          
            <dt><b><span class="term">Cari ID Windows AMI</span></b></dt>
            <dd>
              <p><a href="https://s3.amazonaws.com/cloudformation-examples/lambda/amilookup-win.zip" rel="noopener noreferrer" target="_blank"><span>https://s3.amazonaws.com/cloudformation-examples/lambda/amilookup-win.zip</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
            </dd>
          </dl></div>
      </li><li>
        <p><a href="https://console.aws.amazon.com/s3/home" rel="noopener noreferrer" target="_blank"><span>Buka konsol Amazon S3 di https://console.aws.amazon.com/s3/home.</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
      </li><li>
        <p>Pilih atau buat bucket yang terletak di wilayah yang sama di mana Anda akan membuat AWS CloudFormation tumpukan. Rekam nama bucket.</p>
        <p>Anda akan menyimpan paket sampel dalam bucket ini. Untuk informasi selengkapnya tentang membuat bucket, lihat <a href="https://docs.aws.amazon.com/AmazonS3/latest/user-guide/CreatingaBucket.html">Membuat bucket</a> di <em>Panduan Pengguna Layanan Penyimpanan Sederhana Amazon</em>.</p>
      </li><li>
        <p>Unggah paket sampel ke bucket yang Anda pilih atau buat.</p>
        <p>Untuk informasi selengkapnya tentang mengunggah objek, lihat <a href="https://docs.aws.amazon.com/AmazonS3/latest/user-guide/UploadingObjectsintoAmazonS3.html">Mengunggah objek</a> di <em>Panduan Pengguna Layanan Penyimpanan Sederhana Amazon</em>.</p>
      </li></ol></div>
    <p>Dengan paket di Amazon S3, Anda sekarang dapat menentukan lokasinya di deklarasi sumber daya Lambda dari template. AWS CloudFormation Langkah berikutnya menunjukkan bagaimana Anda mendeklarasikan fungsi dan menjalankannya dengan menggunakan sumber daya kustom. Anda juga akan melihat bagaimana menggunakan hasil fungsi untuk menentukan ID AMI dari Instans EC2.</p>
   
   <h2 id="walkthrough-custom-resources-lambda-lookup-amiids-createfunction-createstack">Langkah 2: Buat tumpukan</h2>
    
    <p>Untuk membuat contoh tumpukan Amazon EC2, Anda akan menggunakan templat sampel yang menyertakan fungsi Lambda, peran eksekusi IAM, sumber daya khusus yang memanggil fungsi, dan instance EC2 yang menggunakan hasil dari fungsi tersebut.</p>
    <p>Selama pembuatan tumpukan, sumber daya kustom memanggil fungsi Lambda dan menunggu hingga fungsi mengirimkan respons ke URL Amazon S3 yang telah ditandatangani sebelumnya. Dalam respon, fungsi mengembalikan ID AMI terbaru yang sesuai dengan Tipe instans EC2 dan wilayah di mana Anda menciptakan instans. Data dari respon fungsi disimpan sebagai atribut dari sumber daya kustom, yang digunakan untuk menentukan ID AMI Instans EC2.</p>
    <p>Cuplikan berikut menjelaskan bagian yang relevan dari template sampel untuk membantu Anda memahami cara mengaitkan fungsi Lambda dengan sumber daya khusus dan cara menggunakan respons fungsi.</p>
    <p>Untuk melihat seluruh templat sampel, lihat:</p>
    <div class="variablelist">
       
       
    <dl>
        <dt><b><span class="term">Templat Linux</span></b></dt>
        <dd>
          <p><a href="https://s3.amazonaws.com/cloudformation-examples/lambda/LambdaAMILookupSample.template" rel="noopener noreferrer" target="_blank"><span>https://s3.amazonaws.com/cloudformation-examples/lambda/LambdaAMI LookupSample .templat</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
        </dd>
      
        <dt><b><span class="term">Templat Windows</span></b></dt>
        <dd>
          <p><a href="https://s3.amazonaws.com/cloudformation-examples/lambda/LambdaAMILookupSample-win.template" rel="noopener noreferrer" target="_blank"><span>https://s3.amazonaws.com/cloudformation-examples/lambda/LambdaAMI LookupSample -win.template</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
        </dd>
      </dl></div>
    <p>Potongan Templat Tumpukan</p>
    <p>Untuk membuat fungsi Lambda, Anda mendeklarasikan <code class="code">AWS::Lambda::Function</code> resource, yang memerlukan kode sumber fungsi, nama handler, lingkungan runtime, dan peran eksekusi ARN.</p>
    <div class="example"><h6>contoh Sintaks JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"AMIInfoFunction": <span>{</span>
  "Type": "AWS::Lambda::Function",
  "Properties": <span>{</span>
    "Code": <span>{</span>
      "S3Bucket": <span>{</span> "Ref": "S3Bucket" },
      "S3Key": <span>{</span> "Ref": "S3Key" }
    },
    "Handler": <span>{</span> "Fn::Join" : [ "", [<span>{</span> "Ref": "ModuleName" },".handler"] ] },
    "Runtime": "nodejs18.x",
    "Timeout": "30",
    "Role": <span>{</span> "Fn::GetAtt" : ["LambdaExecutionRole", "Arn"] }
  }
}</code></pre></div></div>
    <div class="example"><h6>contoh Sintaks YAM</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AMIInfoFunction:
  Type: AWS::Lambda::Function
  Properties:
    Code:
      S3Bucket: !Ref S3Bucket
      S3Key: !Ref S3Key
    Handler: !Sub "$<span>{</span>ModuleName}.handler"
    Runtime: nodejs18.x
    Timeout: 30
    Role: !GetAtt LambdaExecutionRole.Arn</code></pre></div></div>
    <p><code class="code">Code</code>Properti menentukan lokasi Amazon S3 (nama bucket dan nama file) tempat Anda mengunggah paket sampel. Templat sampel menggunakan parameter input (<code class="code">"Ref":
        "S3Bucket"</code> dan <code class="code">"Ref": "S3Key"</code>) untuk mengatur bucket dan nama file agar Anda dapat menentukan nama ketika Anda membuat tumpukan. Demikian pula, nama handler, yang sesuai dengan nama file sumber ( JavaScript file) dalam <code>.zip</code> paket, juga menggunakan parameter input (<code class="code">"Ref":
        "ModuleName"</code>). Karena file sumber adalah  JavaScript  kode, runtime ditentukan sebagai<code class="code">nodejs18.x</code>.</p>
    <p>Untuk panduan ini, waktu eksekusi untuk fungsi melebihi nilai default <code class="code">3</code> detik, sehingga batas waktu diatur ke <code class="code">30</code> detik. Jika Anda tidak menentukan batas waktu yang cukup lama, Lambda dapat menyebabkan batas waktu sebelum fungsi dapat selesai, menyebabkan pembuatan tumpukan gagal.</p>
    <p>Peran eksekusi, yang dinyatakan di tempat lain dalam templat, ditentukan dengan menggunakan <code class="code">Fn::GetAtt</code> fungsi intrinsik dalam <code class="code">Role</code> properti. Peran eksekusi memberikan izin fungsi Lambda untuk mengirim log AWS ke dan memanggil API EC2. <code class="code">DescribeImages</code> Potongan berikut menunjukkan peran dan kebijakan yang memberikan izin yang sesuai:</p>
    <div class="example"><h6>contoh Sintaks JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"LambdaExecutionRole": <span>{</span>
  "Type": "AWS::IAM::Role",
  "Properties": <span>{</span>
    "AssumeRolePolicyDocument": <span>{</span>
      "Version": "2012-10-17",
      "Statement": [<span>{</span>
        "Effect": "Allow",
        "Principal": <span>{</span>"Service": ["lambda.amazonaws.com"]},
        "Action": ["sts:AssumeRole"]
      }]
    },
    "Path": "/",
    "Policies": [<span>{</span>
      "PolicyName": "root",
      "PolicyDocument": <span>{</span>
        "Version": "2012-10-17",
        "Statement": [<span>{</span>
          "Effect": "Allow",
          "Action": ["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],
          "Resource": "arn:aws:logs:*:*:*"
        },
        <span>{</span>
          "Effect": "Allow",
          "Action": ["ec2:DescribeImages"],
          "Resource": "*"
        }]
      }
    }]
  }
}</code></pre></div></div>
    <div class="example"><h6>contoh Sintaks YAM</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">LambdaExecutionRole:
  Type: AWS::IAM::Role
  Properties:
    AssumeRolePolicyDocument:
      Version: '2012-10-17'
      Statement:
      - Effect: Allow
        Principal:
          Service:
          - lambda.amazonaws.com
        Action:
        - sts:AssumeRole
    Path: "/"
    Policies:
    - PolicyName: root
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Action:
          - logs:CreateLogGroup
          - logs:CreateLogStream
          - logs:PutLogEvents
          Resource: arn:aws:logs:*:*:*
        - Effect: Allow
          Action:
          - ec2:DescribeImages
          Resource: "*"</code></pre></div></div>
    <p>Untuk template Linux dan Windows, sumber daya khusus memanggil fungsi Lambda yang terkait dengannya. Untuk mengaitkan fungsi dengan sumber daya khusus, Anda menentukan Nama Sumber Daya Amazon (ARN) fungsi untuk <code class="code">ServiceToken</code> properti, menggunakan fungsi <code class="code">Fn::GetAtt</code> intrinsik. AWS CloudFormationmengirimkan properti tambahan yang disertakan dalam deklarasi sumber daya kustom, seperti <code class="code">Region</code> dan<code class="code">Architecture</code>, ke fungsi Lambda sebagai input. Fungsi Lambda menentukan nama dan nilai yang benar untuk properti input ini.</p>
    <div class="example"><h6>contoh Sintaks JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"AMIInfo": <span>{</span>
  "Type": "Custom::AMIInfo",
  "Properties": <span>{</span>
    "ServiceToken": <span>{</span> "Fn::GetAtt" : ["AMIInfoFunction", "Arn"] },
    "Region": <span>{</span> "Ref": "AWS::Region" },
    "Architecture": <span>{</span> "Fn::FindInMap" : [ "AWSInstanceType2Arch", <span>{</span> "Ref" : "InstanceType" }, "Arch" ] }
  }
}</code></pre></div></div>
    <div class="example"><h6>contoh Sintaks YAM</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AMIInfo:
  Type: Custom::AMIInfo
  Properties:
    ServiceToken: !GetAtt AMIInfoFunction.Arn
    Region: !Ref "AWS::Region"
    Architecture:
      Fn::FindInMap:
      - AWSInstanceType2Arch
      - !Ref InstanceType
      - Arch</code></pre></div></div>
    <p>Untuk Windows, sumber daya khusus menyediakan versi Windows ke fungsi Lambda alih-alih arsitektur instans.</p>
    <div class="example"><h6>contoh Sintaks JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"AMIInfo": <span>{</span>
  "Type": "Custom::AMIInfo",
  "Properties": <span>{</span>
    "ServiceToken": <span>{</span> "Fn::GetAtt" : ["AMIInfoFunction", "Arn"] },
    "Region": <span>{</span> "Ref": "AWS::Region" },
    "OSName": <span>{</span> "Ref": "WindowsVersion" }
  }
}</code></pre></div></div>
    <div class="example"><h6>contoh Sintaks YAM</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AMIInfo:
  Type: Custom::AMIInfo
  Properties:
    ServiceToken: !GetAtt AMIInfoFunction.Arn
    Region: !Ref "AWS::Region"
    OSName: !Ref "WindowsVersion"</code></pre></div></div>
    <p>Saat AWS CloudFormation memanggil fungsi Lambda, fungsi tersebut memanggil API <code class="code">DescribeImages</code> EC2, menggunakan arsitektur region dan instance atau nama OS untuk memfilter daftar gambar. Kemudian fungsi menyortir daftar gambar berdasarkan tanggal dan mengembalikan ID dari AMI terbaru.</p>
    <p>Ketika mengembalikan ID AMI terbaru, fungsi mengirimkan ID ke URL yang telah ditandatangani di <code class="code">Data</code> properti <a href="./crpg-ref-responses.html">objek respons</a>. Data terstruktur sebagai pasangan nama-nilai, seperti yang ditunjukkan pada contoh berikut:</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Data": <span>{</span> 
  "Id": "ami-43795473"
}</code></pre>
    <p>Cuplikan berikut menunjukkan cara mendapatkan data dari fungsi Lambda. Ia menggunakan <code class="code">Fn::GetAtt</code> fungsi intrinsik, menyediakan nama sumber daya kustom dan nama atribut dari nilai yang ingin Anda dapatkan. Dalam panduan ini, nama sumber daya kustom adalah <code class="code">AMIInfo</code> dan nama atribut adalah <code class="code">Id</code>.</p>
    <div class="example"><h6>contoh Sintaks JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"SampleInstance": <span>{</span>  
  "Type": "AWS::EC2::Instance",
  "Properties": <span>{</span>
    "InstanceType"   : <span>{</span> "Ref" : "InstanceType" },
    "ImageId": <span>{</span> "Fn::GetAtt": [ "AMIInfo", "Id" ] }
  }
}</code></pre></div></div>
    <div class="example"><h6>contoh Sintaks YAM</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">SampleInstance:
  Type: AWS::EC2::Instance
  Properties:
    InstanceType: !Ref InstanceType
    ImageId: !GetAtt AMIInfo.Id</code></pre></div></div>
    <p>Sekarang Anda telah memahami apa yang dilakukan templat, gunakan templat sampel untuk membuat tumpukan.</p>
    <div class="procedure"><h6>Untuk membuat tumpukan</h6><ol><li>
        <p>Buka AWS CloudFormation konsol di <a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/cloudformation/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
      </li><li>
        <p>Pilih <b>Buat tumpukan</b>.</p>
      </li><li>
        <p>Di bagian <b>Template</b>, pilih <b>Tentukan URL template Amazon S3</b>, lalu salin dan tempel URL berikut di kotak teks:</p>
        <div class="variablelist">
           
           
        <dl>
            <dt><b><span class="term">Templat Linux</span></b></dt>
            <dd>
              <p><code class="code"><a href="https://s3.amazonaws.com/cloudformation-examples/lambda/LambdaAMILookupSample.template" rel="noopener noreferrer" target="_blank"><span>https://s3.amazonaws.com/cloudformation-examples/lambda/LambdaAMILookupSample.template</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></code></p>
            </dd>
          
            <dt><b><span class="term">Templat Windows</span></b></dt>
            <dd>
              <p><code class="code"><a href="https://s3.amazonaws.com/cloudformation-examples/lambda/LambdaAMILookupSample-win.template" rel="noopener noreferrer" target="_blank"><span>https://s3.amazonaws.com/cloudformation-examples/lambda/LambdaAMILookupSample-win.template</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></code></p>
            </dd>
          </dl></div>
      </li><li>
        <p>Pilih <b>Berikutnya</b>.</p>
      </li><li>
        <p>Di bidang <b>Nama tumpukan</b>, ketik <code class="userinput">SampleEC2Instance</code>.</p>
      </li><li>
        <p><b>Di bagian <b>Parameter</b>, tentukan nama bucket Amazon S3 yang Anda buat, lalu pilih Berikutnya.</b></p>
        <p>Nilai default untuk parameter lainnya adalah nama yang sama yang digunakan dalam paket <code>.zip</code> sampel.</p>
      </li><li>
        <p>Untuk panduan ini, Anda tidak perlu menambahkan tanda atau menentukan pengaturan lanjutan, jadi pilih <b>Selanjutnya</b>.</p>
      </li><li>
        <p>Pastikan bahwa nama tumpukan dan URL templat sudah benar, lalu pilih <b>Buat</b>.</p>
      </li></ol></div>
    <p>Mungkin butuh beberapa menit bagi AWS CloudFormation untuk membuat tumpukan Anda. Untuk memantau kemajuan, tampilkan peristiwa tumpukan. Untuk informasi selengkapnya, lihat <a href="./cfn-console-view-stack-data-resources.html">Melihat data AWS CloudFormation tumpukan dan sumber daya di AWS Management Console</a>.</p>
    <p>Jika pembuatan tumpukan berhasil, semua sumber daya dalam tumpukan, seperti fungsi Lambda, sumber daya khusus, dan instans EC2, dibuat. Anda berhasil menggunakan fungsi Lambda dan sumber daya khusus untuk menentukan ID AMI dari instans EC2. Anda tidak perlu membuat dan memelihara pemetaan ID AMI dalam templat ini.</p>
    <p>Untuk melihat ID AMI AWS CloudFormation digunakan untuk membuat Instans EC2, tampilkan tumpukan output.</p>
   <p><a href="https://console.aws.amazon.com/cloudwatch/home#logs:" rel="noopener noreferrer" target="_blank"><span>Jika fungsi Lambda menampilkan kesalahan, lihat log fungsi di konsol Amazon  CloudWatch  Logs.</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> Nama pengaliran log adalah ID fisik sumber daya kustom, yang dapat Anda temukan dengan melihat sumber daya tumpukan. Untuk informasi selengkapnya, lihat <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/Working-with-log-groups-and-streams.html#ViewingLogData">Melihat data log</a> di <em>Panduan  CloudWatch  Pengguna Amazon</em>.</p>
   
   <h2 id="walkthrough-custom-resources-lambda-lookup-amiids-createfunction-cleanup">Langkah 3: Bersihkan Sumber Daya </h2>
    
    <p>Untuk memastikan bahwa Anda tidak dikenakan biaya untuk layanan yang tidak diinginkan, hapus tumpukan.</p>
    <div class="procedure"><h6>Untuk menghapus tumpukan</h6><ol><li>
        <p>Dari AWS CloudFormation konsol, pilih tumpukan <b>SampleEC2Instance</b>.</p>
      </li><li>
        <p>Pilih <b>Tindakan</b>, dan kemudian <b>Hapus Tumpukan</b>.</p>
      </li><li>
        <p>Pada pesan konfirmasi, pilih <b>Ya, Hapus</b>.</p>
      </li></ol></div>
    <p>Semua sumber daya yang telah Anda buat sebelumnya akan dihapus.</p>
    <p>Sekarang setelah Anda memahami cara membuat dan menggunakan fungsi LambdaAWS CloudFormation, Anda dapat menggunakan contoh template dan kode dari panduan ini untuk membangun tumpukan dan fungsi lain.</p>
  <h2 id="w9aac23c26c16b7c29">Informasi terkait</h2>
    
    <div class="itemizedlist">
       
    <ul class="itemizedlist"><li class="listitem">
        <p><a href="./crpg-ref.html">AWS CloudFormationReferensi Sumber Daya Kustom</a></p>
      </li></ul></div>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Awas" /> <strong>Javascript dinonaktifkan atau tidak tersedia di browser Anda.</strong></p><p>Untuk menggunakan Dokumentasi AWS, Javascript harus diaktifkan. Lihat halaman Bantuan browser Anda untuk petunjuk.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Konvensi Dokumen</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./template-custom-resources-lambda.html">Sumber daya kustom yang didukung AWS Lambda</div><div id="next" class="next-link" accesskey="n" href="./cfn-lambda-function-code-cfnresponsemodule.html">Modul cfn-response</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Apakah halaman ini membantu Anda? - Ya</div><div class="content"><p>Terima kasih telah memberitahukan bahwa hasil pekerjaan kami sudah baik.</p><p>Jika Anda memiliki waktu luang, beri tahu kami aspek apa saja yang sudah bagus, agar kami dapat menerapkannya secara lebih luas.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Umpan Balik" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Apakah halaman ini membantu Anda? - Tidak</div><div class="content"><p>Terima kasih telah memberi tahu kami bahwa halaman ini perlu ditingkatkan. Maaf karena telah mengecewakan Anda.</p><p>Jika Anda memiliki waktu luang, beri tahu kami bagaimana dokumentasi ini dapat ditingkatkan.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Umpan Balik" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/walkthrough-custom-resources-lambda-lookup-amiids.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>