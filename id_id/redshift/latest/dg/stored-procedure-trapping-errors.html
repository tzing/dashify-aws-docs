<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="id-ID"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Kesalahan perangkap - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="stored-procedure-trapping-errors" /><meta name="default_state" content="stored-procedure-trapping-errors" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/stored-procedure-trapping-errors.html" /><meta name="description" content="Perangkap kesalahan dalam prosedur tersimpan di Amazon Redshift." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Panduan Pengembang Database" /><meta name="abstract" content="Buat dan kelola gudang data dengan Amazon Redshift, skala petabyte tingkat perusahaan, layanan pergudangan data yang dikelola sepenuhnya." /><meta name="guide-locale" content="id_id" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/stored-procedure-trapping-errors.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/stored-procedure-trapping-errors.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Panduan Pengembang Database" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Panduan Pengembang Database" /><meta id="panorama-serviceConsolePage" value="Kesalahan perangkap" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Kesalahan perangkap - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#stored-procedure-trapping-errors" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/id_id/redshift/latest/dg/stored-procedure-trapping-errors.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/id_id/redshift/latest/dg/stored-procedure-trapping-errors.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/id_id/redshift/latest/dg/stored-procedure-trapping-errors.html" /><meta name="keywords" content="Amazon Redshift,AWSPergeseran Merah,Redshift,Spektrum Pergeseran Merah,Klaster,gudang data,pengembang,data sampel,database,pengembang basis data,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Panduan Pengembang Database",
        "item" : "https://docs.aws.amazon.com/id_id/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Membuat prosedur tersimpan di Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/id_id/redshift/latest/dg/stored-procedure-overview.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Ikhtisar prosedur tersimpan di Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/id_id/redshift/latest/dg/stored-procedure-create.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Kesalahan perangkap",
        "item" : "https://docs.aws.amazon.com/id_id/redshift/latest/dg/stored-procedure-create.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#stored-procedure-trapping-errors" target="_blank" rel="noopener noreferrer" title="Buka PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Dokumentasi</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Panduan Pengembang Database</a></div><div id="page-toc-src"><a href="#stored-procedure-trapping-errors-examples">Contoh</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Terjemahan disediakan oleh mesin penerjemah. Jika konten terjemahan yang diberikan bertentangan dengan versi bahasa Inggris aslinya, utamakan versi bahasa Inggris.</p></awsui-alert><h1 class="topictitle" id="stored-procedure-trapping-errors">Kesalahan perangkap</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Ketika kueri atau perintah dalam prosedur tersimpan menyebabkan kesalahan, kueri berikutnya tidak berjalan dan transaksi dibatalkan. Tetapi Anda dapat menangani kesalahan menggunakan blok EXCEPTION.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>catatan</h6></div><div class="awsdocs-note-text"><p>Perilaku default adalah bahwa kesalahan akan menyebabkan kueri berikutnya tidak berjalan, bahkan ketika tidak ada kondisi penghasil kesalahan tambahan dalam prosedur yang disimpan.</p></div></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">[ &lt;&lt;label&gt;&gt; ]
[ DECLARE
  declarations ]
BEGIN
  statements
EXCEPTION
  WHEN OTHERS THEN
    statements
END;   
</code></pre><p>Ketika pengecualian terjadi, dan Anda menambahkan blok penanganan pengecualian, Anda dapat menulis pernyataan RAISE dan sebagian besar pernyataan PL/PGSQL lainnya. Misalnya, Anda dapat memunculkan pengecualian dengan pesan khusus atau menyisipkan catatan ke dalam tabel logging.</p><p>Saat memasuki blok penanganan pengecualian, transaksi saat ini dibatalkan dan transaksi baru dibuat untuk menjalankan pernyataan di blok. Jika pernyataan di blok berjalan tanpa kesalahan, transaksi dilakukan dan pengecualian dilemparkan kembali. Terakhir, prosedur yang disimpan keluar.</p><p>Satu-satunya kondisi yang didukung dalam blok pengecualian adalah OTHERS, yang cocok dengan setiap jenis kesalahan kecuali pembatalan kueri. Juga, jika terjadi kesalahan di blok penanganan pengecualian, itu dapat ditangkap oleh blok penanganan pengecualian luar.</p><p>Ketika kesalahan terjadi di dalam prosedur NONATOMIC, kesalahan tidak dilemparkan kembali jika ditangani oleh blok pengecualian. Lihat pernyataan PL/PGSQL <code class="code">RAISE</code> untuk melempar pengecualian yang ditangkap oleh blok penanganan pengecualian. Pernyataan ini hanya valid di blok penanganan pengecualian. Untuk informasi selengkapnya, lihat <a href="./c_PLpgSQL-statements.html#r_PLpgSQL-messages-errors">MENAIKKAN</a>.</p><p><b>Mengontrol apa yang terjadi setelah kesalahan dalam prosedur tersimpan, dengan pengendali CONTINUE</b></p><p> <code class="code">CONTINUE</code>Handler adalah jenis handler pengecualian yang mengontrol aliran eksekusi dalam prosedur tersimpan NONATOMIC. Dengan menggunakannya, Anda dapat menangkap dan menangani pengecualian tanpa mengakhiri blok pernyataan yang ada. Biasanya, ketika kesalahan terjadi dalam prosedur yang disimpan, aliran terganggu dan kesalahan dikembalikan ke pemanggil. Namun, dalam beberapa kasus penggunaan, kondisi kesalahan tidak cukup parah untuk menjamin gangguan aliran. Anda mungkin ingin menangani kesalahan dengan anggun, menggunakan logika penanganan kesalahan yang Anda pilih dalam transaksi terpisah, dan kemudian melanjutkan menjalankan pernyataan yang mengikuti kesalahan. Berikut ini menunjukkan sintaks. </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">[ DECLARE
  declarations ]
BEGIN
  statements
EXCEPTION
  [ CONTINUE_HANDLER | EXIT_HANDLER ] WHEN OTHERS THEN
    handler_statements
END;   
</code></pre><p>Ada beberapa tabel sistem yang tersedia untuk membantu Anda mengumpulkan informasi tentang berbagai jenis kesalahan. Lihat informasi selengkapnya di <a href="./r_STL_LOAD_ERRORS.html">STL_LOAD_ERRORS</a>, <a href="./r_STL_ERROR.html">STL_ERROR</a>, dan <a href="./r_SYS_STREAM_SCAN_ERRORS.html">SYS_STREAM_SCAN_ERRORS</a>. Ada juga tabel sistem tambahan yang dapat Anda gunakan untuk memecahkan masalah kesalahan. Informasi lebih lanjut tentang ini dapat ditemukan di<a href="./cm_chap_system-tables.html">Tabel sistem dan tampilan referensi</a>.</p>
        <h2 id="stored-procedure-trapping-errors-examples">Contoh</h2>
     <p>Contoh berikut menunjukkan cara menulis pernyataan di blok penanganan pengecualian. Prosedur tersimpan menggunakan perilaku manajemen transaksi default.</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE employee (firstname varchar, lastname varchar);
INSERT INTO employee VALUES ('Tomas','Smith');
CREATE TABLE employee_error_log (message varchar);

CREATE OR REPLACE PROCEDURE update_employee_sp() AS
$$
BEGIN
    UPDATE employee SET firstname = 'Adam' WHERE lastname = 'Smith';
    EXECUTE 'select invalid';
EXCEPTION WHEN OTHERS THEN
    RAISE INFO 'An exception occurred.';
    INSERT INTO employee_error_log VALUES ('Error message: ' || SQLERRM);
END;
$$ 
LANGUAGE plpgsql;

CALL update_employee_sp();

INFO:  An exception occurred.
ERROR:  column "invalid" does not exist
CONTEXT:  SQL statement "select invalid"
PL/pgSQL function "update_employee_sp" line 3 at execute statement</code></pre>
     <p>Dalam contoh ini, jika kita memanggil<code class="code">update_employee_sp</code>, pesan informasi <em>Pengecualian terjadi</em>. dinaikkan dan pesan kesalahan dimasukkan ke dalam <code class="code">employee_error_log</code> log tabel logging. Pengecualian asli dilemparkan lagi sebelum prosedur yang disimpan keluar. Kueri berikut menunjukkan catatan yang dihasilkan dari menjalankan contoh.</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT * from employee;

firstname | lastname 
-----------+----------
 Tomas     | Smith

SELECT * from employee_error_log;

          message                     
------------------------------------------------
 Error message: column "invalid" does not exist</code></pre>   
        <p>Untuk informasi selengkapnya tentang RAISE, termasuk bantuan pemformatan dan daftar level tambahan, lihat<a href="./c_PLpgSQL-statements.html">Didukung pernyataan PL/pgSQL</a>.</p>
     <p>Contoh berikut menunjukkan cara menulis pernyataan di blok penanganan pengecualian. Prosedur tersimpan menggunakan perilaku manajemen transaksi NONATOMIC. Dalam contoh ini, tidak ada kesalahan yang dilemparkan kembali ke pemanggil setelah panggilan prosedur selesai. Pernyataan UPDATE tidak dibatalkan karena kesalahan dalam pernyataan berikutnya. Pesan informasi dimunculkan dan pesan kesalahan dimasukkan dalam tabel logging.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">CREATE TABLE employee (firstname varchar, lastname varchar); 
INSERT INTO employee VALUES ('Tomas','Smith'); 
CREATE TABLE employee_error_log (message varchar);

-- Create the SP in NONATOMIC mode
CREATE OR REPLACE PROCEDURE update_employee_sp_2() NONATOMIC AS
$$
BEGIN
    UPDATE employee SET firstname = 'Adam' WHERE lastname = 'Smith';
    EXECUTE 'select invalid';
EXCEPTION WHEN OTHERS THEN
    RAISE INFO 'An exception occurred.';
    INSERT INTO employee_error_log VALUES ('Error message: ' || SQLERRM);
END;
$$ 
LANGUAGE plpgsql;

CALL update_employee_sp_2();
INFO:  An exception occurred.
CALL

SELECT * from employee;

 firstname | lastname 
-----------+----------
 Adam      | Smith
(1 row)

SELECT * from employee_error_log;

                    message                     
------------------------------------------------
 Error message: column "invalid" does not exist
(1 row)
</code></pre><p>Contoh ini menunjukkan cara membuat prosedur dengan dua sub blok. Ketika prosedur tersimpan dipanggil, kesalahan dari sub blok pertama ditangani oleh blok penanganan pengecualian. Setelah sub blok pertama selesai, prosedur terus mengeksekusi sub blok kedua. Anda dapat melihat dari hasil bahwa tidak ada kesalahan yang dilemparkan ketika panggilan prosedur selesai. Operasi UPDATE dan INSERT pada karyawan meja berkomitmen. Pesan kesalahan dari kedua blok pengecualian disisipkan dalam tabel logging.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">CREATE TABLE employee (firstname varchar, lastname varchar); 
INSERT INTO employee VALUES ('Tomas','Smith'); 
CREATE TABLE employee_error_log (message varchar);

CREATE OR REPLACE PROCEDURE update_employee_sp_3() NONATOMIC AS
$$
BEGIN
    BEGIN
        UPDATE employee SET firstname = 'Adam' WHERE lastname = 'Smith';
        EXECUTE 'select invalid1';
    EXCEPTION WHEN OTHERS THEN
        RAISE INFO 'An exception occurred in the first block.';
        INSERT INTO employee_error_log VALUES ('Error message: ' || SQLERRM);
    END;
    BEGIN
        INSERT INTO employee VALUES ('Edie','Robertson');
        EXECUTE 'select invalid2';
    EXCEPTION WHEN OTHERS THEN
        RAISE INFO 'An exception occurred in the second block.';
        INSERT INTO employee_error_log VALUES ('Error message: ' || SQLERRM);
    END;
END;
$$ 
LANGUAGE plpgsql;

CALL update_employee_sp_3();
INFO:  An exception occurred in the first block.
INFO:  An exception occurred in the second block.
CALL

SELECT * from employee;

 firstname | lastname  
-----------+-----------
 Adam      | Smith
 Edie      | Robertson
(2 rows)

SELECT * from employee_error_log;

                     message                     
-------------------------------------------------
 Error message: column "invalid1" does not exist
 Error message: column "invalid2" does not exist
(2 rows)
</code></pre><p>Contoh berikut menunjukkan cara menggunakan handler pengecualian CONTINUE. Sampel ini membuat dua tabel dan menggunakannya dalam prosedur tersimpan. Handler CONTINUE mengontrol aliran eksekusi dalam prosedur tersimpan dengan perilaku manajemen transaksi NONATOMIC.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE tbl_1 (a int);
CREATE TABLE tbl_error_logging(info varchar, err_state varchar, err_msg varchar);

CREATE OR REPLACE PROCEDURE sp_exc_handling_1() NONATOMIC AS
$$
BEGIN
    INSERT INTO tbl_1 VALUES (1);
    -- Expect an error for the insert statement following, because of the invalid value
    INSERT INTO tbl_1 VALUES ("val");
    INSERT INTO tbl_1 VALUES (2);
EXCEPTION CONTINUE_HANDLER WHEN OTHERS THEN
    INSERT INTO tbl_error_logging VALUES ('Encountered error', SQLSTATE, SQLERRM);
END;
$$ LANGUAGE plpgsql;</code></pre><p>Panggil prosedur yang disimpan:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CALL sp_exc_handling_1();</code></pre><p>Aliran berlangsung seperti ini:</p><div class="orderedlist">
         
         
     <ol><li><p>Terjadi kesalahan karena upaya dilakukan untuk menyisipkan tipe data yang tidak kompatibel dalam kolom. Kontrol lolos ke blok EXCEPTION. Ketika blok penanganan pengecualian dimasukkan, transaksi saat ini dibatalkan dan transaksi implisit baru dibuat untuk menjalankan pernyataan di dalamnya.</p></li><li><p>Jika pernyataan di CONTINUE_HANDLER berjalan tanpa kesalahan, kontrol akan diteruskan ke pernyataan segera setelah pernyataan yang menyebabkan pengecualian. (Jika pernyataan di CONTINUE_HANDLER memunculkan pengecualian baru, Anda dapat menanganinya dengan penangan pengecualian di dalam blok EXCEPTION.)</p></li></ol></div><p>Setelah Anda memanggil prosedur tersimpan sampel, tabel berisi catatan berikut:</p><div class="itemizedlist">
         
         
     <ul class="itemizedlist"><li class="listitem"><p>Jika Anda menjalankan<code class="code">SELECT * FROM tbl_1;</code>, ia mengembalikan dua catatan. Ini berisi nilai-nilai <code class="code">1</code> dan<code class="code">2</code>.</p></li><li class="listitem"><p>Jika Anda menjalankan<code class="code">SELECT * FROM tbl_error_logging;</code>, ia mengembalikan satu catatan dengan nilai-nilai ini: <em>Error yang ditemui</em>, <em>42703</em>, dan <em>kolom “val” tidak ada di</em> tbl_1.</p></li></ul></div><p>Contoh penanganan kesalahan tambahan berikut menggunakan handler EXIT dan handler CONTINUE. Ini menciptakan dua tabel: tabel data dan tabel logging. Ini juga menciptakan prosedur tersimpan yang menunjukkan penanganan kesalahan:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE tbl_1 (a int);
CREATE TABLE tbl_error_logging(info varchar, err_state varchar, err_msg varchar);

CREATE OR REPLACE PROCEDURE sp_exc_handling_2() NONATOMIC AS
$$
BEGIN
    INSERT INTO tbl_1 VALUES (1);
    BEGIN
        INSERT INTO tbl_1 VALUES (100);
        -- Expect an error for the insert statement following, because of the invalid value
        INSERT INTO tbl_1 VALUES ("val");
        INSERT INTO tbl_1 VALUES (101);
    EXCEPTION EXIT_HANDLER WHEN OTHERS THEN
        INSERT INTO tbl_error_logging VALUES ('Encountered error', SQLSTATE, SQLERRM);
    END;
    INSERT INTO tbl_1 VALUES (2);
    -- Expect an error for the insert statement following, because of the invalid value
    INSERT INTO tbl_1 VALUES ("val");
    INSERT INTO tbl_1 VALUES (3);
EXCEPTION CONTINUE_HANDLER WHEN OTHERS THEN
    INSERT INTO tbl_error_logging VALUES ('Encountered error', SQLSTATE, SQLERRM);
END;
$$ LANGUAGE plpgsql;</code></pre><p>Setelah Anda membuat prosedur yang disimpan, sebut saja dengan yang berikut:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CALL sp_exc_handling_2();</code></pre><p>Ketika kesalahan terjadi di blok pengecualian bagian dalam, yang dikurung oleh set bagian dalam BEGIN dan END, itu ditangani oleh pengendali EXIT. Setiap kesalahan yang terjadi di blok luar ditangani oleh handler CONTINUE. </p><p>Setelah Anda memanggil prosedur tersimpan sampel, tabel berisi catatan berikut:</p><div class="itemizedlist">
         
         
     <ul class="itemizedlist"><li class="listitem"><p>Jika Anda menjalankan<code class="code">SELECT * FROM tbl_1;</code>, ia mengembalikan empat catatan, dengan nilai 1, 2, 3, dan 100.</p></li><li class="listitem"><p>Jika Anda menjalankan<code class="code">SELECT * FROM tbl_error_logging;</code>, ia mengembalikan dua catatan. Mereka memiliki nilai-nilai ini: <em>Ditemui kesalahan</em>, <em>42703</em>, dan <em>kolom “val” tidak ada di</em> tbl_1.</p></li></ul></div><p>Jika tabel <b>tbl_error_logging</b> tidak ada, itu menimbulkan pengecualian.</p><p>Contoh berikut menunjukkan cara menggunakan handler pengecualian CONTINUE dengan loop FOR. Sampel ini membuat tiga tabel dan menggunakannya dalam loop FOR dalam prosedur tersimpan. Loop FOR adalah varian set hasil, artinya iterasi atas hasil kueri:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE tbl_1 (a int);
INSERT INTO tbl_1 VALUES (1), (2), (3);
CREATE TABLE tbl_2 (a int);
CREATE TABLE tbl_error_logging(info varchar, err_state varchar, err_msg varchar);

CREATE OR REPLACE PROCEDURE sp_exc_handling_loop() NONATOMIC AS
$$
DECLARE
 rec RECORD;
BEGIN
    FOR rec IN SELECT a FROM tbl_1
    LOOP
        IF rec.a = 2 THEN
            -- Expect an error for the insert statement following, because of the invalid value
            INSERT INTO tbl_2 VALUES("val");
        ELSE
            INSERT INTO tbl_2 VALUES (rec.a);
        END IF;
    END LOOP;
EXCEPTION CONTINUE_HANDLER WHEN OTHERS THEN
    INSERT INTO tbl_error_logging VALUES ('Encountered error', SQLSTATE, SQLERRM);
END;
$$ LANGUAGE plpgsql;</code></pre><p>Panggil prosedur yang disimpan:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CALL sp_exc_handling_loop();</code></pre><p>Setelah Anda memanggil prosedur tersimpan sampel, tabel berisi catatan berikut:</p><div class="itemizedlist">
         
         
     <ul class="itemizedlist"><li class="listitem"><p> Jika Anda menjalankan<code class="code">SELECT * FROM tbl_2;</code>, ia mengembalikan dua catatan. Ini berisi nilai 1 dan 3.</p></li><li class="listitem"><p>Jika Anda menjalankan<code class="code">SELECT * FROM tbl_error_logging;</code>, ia mengembalikan satu catatan dengan nilai-nilai ini: <em>Error yang ditemui</em>, <em>42703</em>, dan <em>kolom “val” tidak ada di</em> tbl_2.</p></li></ul></div><p>Catatan penggunaan mengenai handler CONTINUE:</p><div class="itemizedlist">
         
 
         
     <ul class="itemizedlist"><li class="listitem"><p>Kata kunci CONTINUE_HANDLER dan EXIT_HANDLER hanya dapat digunakan dalam prosedur tersimpan NONATOMIC.</p></li><li class="listitem"><p>Kata kunci CONTINUE_HANDLER dan EXIT_HANDLER bersifat opsional. EXIT_HANDLER adalah default.</p></li></ul></div><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Awas" /> <strong>Javascript dinonaktifkan atau tidak tersedia di browser Anda.</strong></p><p>Untuk menggunakan Dokumentasi AWS, Javascript harus diaktifkan. Lihat halaman Bantuan browser Anda untuk petunjuk.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Konvensi Dokumen</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./stored-procedure-transaction-management.html">Mengelola transaksi</div><div id="next" class="next-link" accesskey="n" href="./c_PLpgSQL-logging.html">Prosedur tersimpan pencatatan</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Apakah halaman ini membantu Anda? - Ya</div><div class="content"><p>Terima kasih telah memberitahukan bahwa hasil pekerjaan kami sudah baik.</p><p>Jika Anda memiliki waktu luang, beri tahu kami aspek apa saja yang sudah bagus, agar kami dapat menerapkannya secara lebih luas.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Umpan Balik" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/id_id/redshift/latest/dg/stored-procedure-trapping-errors.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Apakah halaman ini membantu Anda? - Tidak</div><div class="content"><p>Terima kasih telah memberi tahu kami bahwa halaman ini perlu ditingkatkan. Maaf karena telah mengecewakan Anda.</p><p>Jika Anda memiliki waktu luang, beri tahu kami bagaimana dokumentasi ini dapat ditingkatkan.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Umpan Balik" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/id_id/redshift/latest/dg/stored-procedure-trapping-errors.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>