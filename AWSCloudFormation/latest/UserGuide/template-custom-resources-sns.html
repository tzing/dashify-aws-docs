<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Amazon Simple Notification Service-backed custom resources - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="template-custom-resources-sns" /><meta name="default_state" content="template-custom-resources-sns" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" /><meta name="description" content="Learn about Amazon SNS-backed custom resources in AWS CloudFormation." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Amazon Simple Notification Service-backed custom resources" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Amazon Simple Notification Service-backed custom resources - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Working with AWS CloudFormation templates",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Custom resources",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Amazon Simple Notification Service-backed custom resources",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">User Guide</a></div><div id="page-toc-src"><a href="#walkthrough-custom-resources-sns-adding-nonaws-resource">Walkthrough: Using
         Amazon Simple Notification Service to create custom resources</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="template-custom-resources-sns">Amazon Simple Notification Service-backed custom resources</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>When you associate an Amazon SNS topic with a custom resource, you use Amazon SNS notifications to
      invoke custom provisioning logic. With custom resources and Amazon SNS, you can enable scenarios
      such as adding new resources to a stack and injecting dynamic data into a stack. For example,
      when you create a stack, AWS CloudFormation can send a <code class="code">create</code> request to a topic that's
      monitored by an application that's running on an Amazon Elastic Compute Cloud instance. The Amazon SNS notification
      triggers the application to carry out additional provisioning tasks, such as retrieve a pool
      of allow-listed Elastic IP addresses. After it's done, the application sends a response (and
      any output data) that notifies AWS CloudFormation to proceed with the stack operation.</p><h2 id="walkthrough-custom-resources-sns-adding-nonaws-resource">Walkthrough: Using
         Amazon Simple Notification Service to create custom resources</h2>
      
      
      <p>This walkthrough will step through the custom resource process, explaining the sequence
         of events and messages sent and received as a result of custom resource stack creation,
         updates, and deletion.</p>
      <h3 id="crpg-walkthrough-stack-creation">Step 1: Stack creation</h3>
         
         <div class="orderedlist">
             
             
             
             
         <ol style="list-style-type:arabic ! important;"><li>
               <p>The template developer creates an AWS CloudFormation stack that contains a custom resource; in
                  the template example below, we use the custom resource type name
                     <code class="code">Custom::SeleniumTester</code> for the custom resource
                     <code class="code">MySeleniumTest</code>.</p>
               <p>The custom resource type is declared with a <em>service token</em>,
                  optional <em>provider-specific properties</em>, and optional <a href="./intrinsic-function-reference-getatt.html">Fn::GetAtt</a>
                  attributes that are defined by the custom resource provider. These properties and attributes can
                  be used to pass information from the template developer to the custom resource provider and
                  vice-versa. Custom resource type names must be alphanumeric and can have a maximum
                  length of 60 characters.</p>
               <p>The following example shows a template that has both custom properties and
                  return attributes:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "AWSTemplateFormatVersion" : "2010-09-09",
   "Resources" : <span>{</span>
      "MySeleniumTest" : <span>{</span>
         "Type": "Custom::SeleniumTester",
         "Version" : "1.0",
         "Properties" : <span>{</span>
            "ServiceToken": "arn:aws:sns:us-west-2:123456789012:CRTest",
            "seleniumTester" : "SeleniumTest()",
            "endpoints" : [ "http://mysite.com", "http://myecommercesite.com/", "http://search.mysite.com" ],
            "frequencyOfTestsPerHour" : [ "3", "2", "4" ]
         }
      }
   },
   "Outputs" : <span>{</span>
      "topItem" : <span>{</span>
         "Value" : <span>{</span> "Fn::GetAtt" : ["MySeleniumTest", "resultsPage"] }
      },
      "numRespondents" : <span>{</span>
         "Value" : <span>{</span> "Fn::GetAtt" : ["MySeleniumTest", "lastUpdate"] }
      }
   }
}</code></pre>
               <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The names and values of the data accessed with
                           <code class="code"><code class="code">Fn::GetAtt</code></code> are returned by the
                     custom resource provider during the provider's response to AWS CloudFormation. If the custom resource provider is a
                     third-party, then the template developer must obtain the names of these return
                     values from the custom resource provider.</p></div></div>
            </li><li>
               <p>AWS CloudFormation sends an Amazon SNS notification to the resource provider with a
                     <code class="code">"RequestType" : "Create"</code> that contains information about the
                  stack, the custom resource properties from the stack template, and an S3 URL for
                  the response.</p>
               <p>The SNS topic that's used to send the notification is embedded in the template
                  in the <code class="code">ServiceToken</code> property. To avoid using a hardcoded value, a
                  template developer can use a template parameter so that the value is entered at the
                  time the stack is launched.</p>
               <p>The following example shows a custom resource <code class="code">Create</code> request which
                  includes a custom resource type name, <code class="code">Custom::SeleniumTester</code>, created
                  with a <code class="code">LogicalResourceId</code> of <code class="code">MySeleniumTester</code>:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "RequestType" : "Create",
   "ResponseURL" : "http://pre-signed-S3-url-for-response",
   "StackId" : "arn:aws:cloudformation:us-west-2:123456789012:stack/stack-name/guid",
   "RequestId" : "unique id for this create request",
   "ResourceType" : "Custom::SeleniumTester",
   "LogicalResourceId" : "MySeleniumTester",
   "ResourceProperties" : <span>{</span>
      "seleniumTester" : "SeleniumTest()",
      "endpoints" : [ "http://mysite.com", "http://myecommercesite.com/", "http://search.mysite.com" ],
      "frequencyOfTestsPerHour" : [ "3", "2", "4" ]
   }
}</code></pre>
            </li><li>
               <p>The custom resource provider processes the data sent by the template developer and determines
                  whether the <code class="code">Create</code> request was successful. The resource provider then
                  uses the S3 URL sent by AWS CloudFormation to send a response of either <code class="code">SUCCESS</code> or
                     <code class="code">FAILED</code>.</p>
               <p>Depending on the response type, different response fields will be expected by
                  AWS CloudFormation. Refer to the Responses section in the reference topic for the RequestType
                  that's being processed.</p>
               <p>In response to a create or update request, the custom resource provider can return data
                  elements in the <a href="./crpg-ref-responses.html#crpg-ref-responses-data">Data</a> field of the response. These are name
                  value pairs, and the <em>names</em> correspond to the
                        <code class="code"><code class="code">Fn::GetAtt</code></code> attributes used with the custom
                  resource in the stack template. The <em>values</em> are the data
                  that's returned when the template developer calls <code class="code"><code class="code">Fn::GetAtt</code></code>
                  on the resource with the attribute name.</p>
               <p>The following is an example of a custom resource response:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Status" : "SUCCESS",
   "PhysicalResourceId" : "Tester1",
   "StackId" : "arn:aws:cloudformation:us-west-2:123456789012:stack/stack-name/guid",
   "RequestId" : "unique id for this create request",
   "LogicalResourceId" : "MySeleniumTester",
   "Data" : <span>{</span>
      "resultsPage" : "http://www.myexampledomain/test-results/guid",
      "lastUpdate" : "2012-11-14T03:30Z",
   }
}           </code></pre>
               <p>The <code class="code">StackId</code>, <code class="code">RequestId</code>, and
   <code class="code">LogicalResourceId</code> fields must be copied verbatim from the request.</p>
            </li><li>
               <p> AWS CloudFormation declares the stack status as <code class="code">CREATE_COMPLETE</code> or
                     <code class="code">CREATE_FAILED</code>. If the stack was successfully created, the
                  template developer can use the output values of the created custom resource by
                  accessing them with <a href="./intrinsic-function-reference-getatt.html">Fn::GetAtt</a>.</p>
               <p>For example, the custom resource template used for illustration used
                        <code class="code"><code class="code">Fn::GetAtt</code></code> to copy resource outputs into
                  the stack outputs:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Outputs" : <span>{</span>
   "topItem" : <span>{</span>
      "Value" : <span>{</span> "Fn::GetAtt" : ["MySeleniumTest", "resultsPage"] }
   },
   "numRespondents" : <span>{</span>
      "Value" : <span>{</span> "Fn::GetAtt" : ["MySeleniumTest", "lastUpdate"] }
   }
}           </code></pre>
            </li></ol></div>
         <p>For detailed information about the request and response objects involved in
               <code class="code">Create</code> requests, see <a href="./crpg-ref-requesttypes-create.html">Create</a> in the <a href="./crpg-ref.html">Custom Resource
            Reference</a>.</p>
       
      <h3 id="crpg-walkthrough-stack-updates">Step 2: Stack updates</h3>
         
         <p>To update an existing stack, you must submit a template that specifies updates for
            the properties of resources in the stack, as shown in the example below. AWS CloudFormation updates
            only the resources that have changes specified in the template. For more information
            about updating stacks, see <a href="./using-cfn-updating-stacks.html">AWS CloudFormation stack updates</a>.</p>
         <p>You can update custom resources that require a replacement of the underlying physical
            resource. When you update a custom resource in an AWS CloudFormation template, AWS CloudFormation sends an update
            request to that custom resource. If a custom resource requires a replacement, the new
            custom resource must send a response with the new physical ID. When AWS CloudFormation receives the
            response, it compares the <code class="code">PhysicalResourceId</code> between the old and new custom
            resources. If they're different, AWS CloudFormation recognizes the update as a replacement and sends
            a delete request to the old resource, as shown in <a href="#crpg-walkthrough-stack-deletion">Step 3: Stack deletion</a>.</p>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If you didn't make changes to the custom resource, AWS CloudFormation won't send requests to it during a stack update.</p></div></div>
         <div class="orderedlist">
             
             
             
             
         <ol style="list-style-type:arabic ! important;"><li>
               <p>The template developer initiates an update to the stack that contains a custom
                  resource. During an update, the template developer can specify new Properties in the
                  stack template.</p>
               <p>The following is an example of an <code class="code">Update</code> to the stack template
                  using a custom resource type:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "AWSTemplateFormatVersion" : "2010-09-09",
   "Resources" : <span>{</span>
      "MySeleniumTest" : <span>{</span>
         "Type": "Custom::SeleniumTester",
         "Version" : "1.0",
         "Properties" : <span>{</span>
            "ServiceToken": "arn:aws:sns:us-west-2:123456789012:CRTest",
            "seleniumTester" : "SeleniumTest()",
            "endpoints" : [ "http://mysite.com", "http://myecommercesite.com/", "http://search.mysite.com",
               "http://mynewsite.com" ],
            "frequencyOfTestsPerHour" : [ "3", "2", "4", "3" ]
         }
      }
   },
   "Outputs" : <span>{</span>
      "topItem" : <span>{</span>
         "Value" : <span>{</span> "Fn::GetAtt" : ["MySeleniumTest", "resultsPage"] }
      },
      "numRespondents" : <span>{</span>
         "Value" : <span>{</span> "Fn::GetAtt" : ["MySeleniumTest", "lastUpdate"] }
      }
   }
}           </code></pre>
            </li><li>
               <p>AWS CloudFormation sends an Amazon SNS notification to the resource provider with a
                     <code class="code">"RequestType" : "Update"</code> that contains similar information to the
                     <code class="code">Create</code> call, except that the
                     <code class="code">OldResourceProperties</code> field contains the old resource
                  properties, and ResourceProperties contains the updated (if any) resource
                  properties.</p>
               <p>The following is an example of an <code class="code">Update</code> request:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "RequestType" : "Update",
   "ResponseURL" : "http://pre-signed-S3-url-for-response",
   "StackId" : "arn:aws:cloudformation:us-west-2:123456789012:stack/stack-name/guid",
   "RequestId" : "uniqueid for this update request",
   "LogicalResourceId" : "MySeleniumTester",
   "ResourceType" : "Custom::SeleniumTester",  
   "PhysicalResourceId" : "Tester1",
   "ResourceProperties" : <span>{</span>
      "seleniumTester" : "SeleniumTest()",
      "endpoints" : [ "http://mysite.com", "http://myecommercesite.com/", "http://search.mysite.com",
         "http://mynewsite.com" ],
      "frequencyOfTestsPerHour" : [ "3", "2", "4", "3" ]
   },
   "OldResourceProperties" : <span>{</span>
      "seleniumTester" : "SeleniumTest()",
      "endpoints" : [ "http://mysite.com", "http://myecommercesite.com/", "http://search.mysite.com" ],
      "frequencyOfTestsPerHour" : [ "3", "2", "4" ]
   }
}          </code></pre>
            </li><li>
               <p>The custom resource provider processes the data sent by AWS CloudFormation. The custom resource performs
                  the update and sends a response of either <code class="code">SUCCESS</code> or
                     <code class="code">FAILED</code> to the S3 URL. AWS CloudFormation then compares the
                     <code class="code">PhysicalResourceIDs</code> of old and new custom resources. If they're
                  different, AWS CloudFormation recognizes that the update requires a replacement and sends a
                  delete request to the old resource. The following example demonstrates the
                  custom resource provider response to an <code class="code">Update</code> request.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Status" : "SUCCESS",
   "StackId" : "arn:aws:cloudformation:us-west-2:123456789012:stack/stack-name/guid",
   "RequestId" : "uniqueid for this update request",
   "LogicalResourceId" : "MySeleniumTester",
   "PhysicalResourceId" : "Tester2"
}           </code></pre>
               <p>The <code class="code">StackId</code>, <code class="code">RequestId</code>, and
   <code class="code">LogicalResourceId</code> fields must be copied verbatim from the request.</p>
            </li><li>
               <p>AWS CloudFormation declares the stack status as <code class="code">UPDATE_COMPLETE</code> or
                     <code class="code">UPDATE_FAILED</code>. If the update fails, the stack rolls back. If the
                  stack was successfully updated, the template developer can access any new output values
                  of the created custom resource with
                  <code class="code"><code class="code">Fn::GetAtt</code></code>.</p>
            </li></ol></div>
         <p>For detailed information about the request and response objects involved in
               <code class="code">Update</code> requests, see <a href="./crpg-ref-requesttypes-update.html">Update</a> in the <a href="./crpg-ref.html">Custom Resource
            Reference</a>.</p>
       
      <h3 id="crpg-walkthrough-stack-deletion">Step 3: Stack deletion</h3>
         
         <div class="orderedlist">
             
             
             
             
         <ol style="list-style-type:arabic ! important;"><li>
               <p>The template developer deletes a stack that contains a custom resource. AWS CloudFormation gets
                  the current properties specified in the stack template along with the SNS topic,
                  and prepares to make a request to the custom resource provider.</p>
            </li><li>
               <p>AWS CloudFormation sends an Amazon SNS notification to the resource provider with a
                     <code class="code">"RequestType" : "Delete"</code> that contains current information about
                  the stack, the custom resource properties from the stack template, and an S3 URL
                  for the response.</p>
               <p>Whenever you delete a stack or make an update that removes or replaces the
                  custom resource, AWS CloudFormation compares the <code class="code">PhysicalResourceId</code> between the
                  old and new custom resources. If they're different, AWS CloudFormation recognizes the update as
                  a replacement and sends a delete request for the old resource
                     (<code class="code">OldPhysicalResource</code>), as shown in the following example of a
                     <code class="code">Delete</code> request.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "RequestType" : "Delete",
   "ResponseURL" : "http://pre-signed-S3-url-for-response",
   "StackId" : "arn:aws:cloudformation:us-west-2:123456789012:stack/stack-name/guid",
   "RequestId" : "unique id for this delete request",
   "ResourceType" : "Custom::SeleniumTester",
   "LogicalResourceId" : "MySeleniumTester",
   "PhysicalResourceId" : "Tester1",
   "ResourceProperties" : <span>{</span>
      "seleniumTester" : "SeleniumTest()",
      "endpoints" : [ "http://mysite.com", "http://myecommercesite.com/", "http://search.mysite.com",
         "http://mynewsite.com" ],
      "frequencyOfTestsPerHour" : [ "3", "2", "4", "3" ]
   }
}    
            </code></pre>
               <p><code class="code">DescribeStackResource</code>, <code class="code">DescribeStackResources</code>, and
                     <code class="code">ListStackResources</code> display the user-defined name if it has been
                  specified.</p>
            </li><li>
               <p>The custom resource provider processes the data sent by AWS CloudFormation and determines whether the
                     <code class="code">Delete</code> request was successful. The resource provider then uses the
                  S3 URL sent by AWS CloudFormation to send a response of either <code class="code">SUCCESS</code> or
                     <code class="code">FAILED</code>. To successfully delete a stack with a custom resource, the
                  custom resource provider must respond successfully to a delete request.</p>
               <p>The following is an example of a custom resource provider response to a <code class="code">Delete</code>
                  request:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Status" : "SUCCESS",
   "StackId" : "arn:aws:cloudformation:us-west-2:123456789012:stack/stack-name/guid",
   "RequestId" : "unique id for this delete request",
   "LogicalResourceId" : "MySeleniumTester",
   "PhysicalResourceId" : "Tester1"
}         </code></pre>
               <p>The <code class="code">StackId</code>, <code class="code">RequestId</code>, and
   <code class="code">LogicalResourceId</code> fields must be copied verbatim from the request.</p>
            </li><li>
               <p>AWS CloudFormation declares the stack status as <code class="code">DELETE_COMPLETE</code> or
                     <code class="code">DELETE_FAILED</code>.</p>
            </li></ol></div>
         <p>For detailed information about the request and response objects involved in
               <code class="code">Delete</code> requests, see <a href="./crpg-ref-requesttypes-delete.html">Delete</a> in the <a href="./crpg-ref.html">Custom resource reference</a>.</p>
       
      <h3 id="w9aac23c26c14b5c12">See also</h3>
         
         <div class="itemizedlist">
             
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p><a href="./crpg-ref.html">AWS CloudFormation Custom Resource Reference</a></p>
            </li><li class="listitem">
               <p><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudformation-customresource.html"><code class="code">AWS::CloudFormation::CustomResource</code></a></p>
            </li><li class="listitem">
               <p><a href="./intrinsic-function-reference-getatt.html">Fn::GetAtt</a></p>
            </li></ul></div>
       
   <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./template-custom-resources.html">Custom resources</div><div id="next" class="next-link" accesskey="n" href="./template-custom-resources-lambda.html">AWS Lambda-backed custom resources</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>