<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Troubleshooting AWS CloudFormation StackSets - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="stacksets-troubleshooting" /><meta name="default_state" content="stacksets-troubleshooting" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" /><meta name="description" content="This topic contains some common AWS CloudFormation StackSets issues, and suggested solutions for those issues." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Troubleshooting AWS CloudFormation StackSets" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Troubleshooting AWS CloudFormation StackSets - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Working with AWS CloudFormation StackSets",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/what-is-cfnstacksets.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Troubleshooting AWS CloudFormation StackSets",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/what-is-cfnstacksets.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">User Guide</a></div><div id="page-toc-src"><a href="#common-reasons-for-stack-operation-failure">Common reasons for stack
                operation failure</a><a href="#retrying-failed-stack-creation-or-update-operations">Retrying failed
                stack creation or update operations</a><a href="#stack-instance-delete-fails">Stack instance deletion fails</a><a href="#stack-import-fails">Stack import operation fails</a><a href="#stack-instance-failure-count-for-stackset-operations">Stack instance
                failure count for StackSets operations</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="stacksets-troubleshooting">Troubleshooting AWS CloudFormation StackSets</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>This topic contains some common AWS CloudFormation StackSets issues, and suggested solutions for those
        issues.</p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#common-reasons-for-stack-operation-failure">Common reasons for stack
                operation failure</a></li><li><a href="#retrying-failed-stack-creation-or-update-operations">Retrying failed
                stack creation or update operations</a></li><li><a href="#stack-instance-delete-fails">Stack instance deletion fails</a></li><li><a href="#stack-import-fails">Stack import operation fails</a></li><li><a href="#stack-instance-failure-count-for-stackset-operations">Stack instance
                failure count for StackSets operations</a></li></ul></div>
        <h2 id="common-reasons-for-stack-operation-failure">Common reasons for stack
                operation failure</h2>

        <p><b>Problem:</b> A stack operation failed, and the stack
            instance status is <code class="code">OUTDATED</code>.</p>
        <p><b>Cause:</b> There can be several common causes for stack
            operation failure.</p>
        <div class="itemizedlist">
             
             
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>Insufficient permissions in a target account for creating resources that are
                    specified in your template.</p>
            </li><li class="listitem">
                <p>The AWS CloudFormation template might have errors. Validate the template in AWS CloudFormation and fix
                    errors before trying to create your stack set.</p>
            </li><li class="listitem">
                <p>The template could be trying to create global resources that must be unique
                    but aren't, such as S3 buckets.</p>
            </li><li class="listitem">
                <p>A specified target account number doesn't exist. Check the target account
                    numbers that you specified on the <b>Set deployment options</b>
                    page of the wizard.</p>
            </li><li class="listitem">
                <p>The administrator account does not have a trust relationship with the target
                    account.</p>
            </li><li class="listitem">
                <p>The maximum number of a resource that is specified in your template already
                    exists in your target account. For example, you might have reached the limit of
                    allowed IAM roles in a target account, but the template creates more IAM
                    roles.</p>
            </li><li class="listitem">
                <p>You have reached the maximum number of stacks that are allowed in a stack set.
                    See <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cloudformation-limits.html">AWS CloudFormation
                        limits</a> for the maximum number of stacks per stack set.</p>
            </li></ul></div>
        <p><b>Solution:</b> For more information about the permissions
            required of target and administrator accounts before you can create stack sets, see
                <a href="./stacksets-prereqs-self-managed.html#stacksets-prereqs-accountsetup">Set up basic permissions for stack
                    set operations</a>.</p>
     
        <h2 id="retrying-failed-stack-creation-or-update-operations">Retrying failed
                stack creation or update operations</h2>

        <p><b>Problem:</b> A stack creation or update failed, and the
            stack instance status is <code class="code">OUTDATED</code>. To troubleshoot why a stack creation or
            update failed, open the AWS CloudFormation console, and view the events for the stack, which will
            have a status of <code class="code">DELETED</code> (for failed create operations) or
                <code class="code">FAILED</code> (for failed update operations). Browse the stack events, and
            find the <b>Status reason</b> column. The value of <b>Status
                reason</b> explains why the stack operation failed.</p>
        <p>After you have fixed the underlying cause of the stack creation failure, and you are
            ready to retry stack creation, perform the following steps.</p>
        <p><b>Solution:</b> Perform the following steps to retry your
            stack operation.</p>
        <div class="procedure"><ol><li>
                <p>In the console, select the stack set that contains the stack on which the
                    operation failed.</p>
            </li><li>
                <p>In the <b>Actions</b> menu, choose <b>Edit StackSet
                        details</b> to retry creating or updating stacks.</p>
            </li><li>
                <p>On the <b>Specify template</b> page, to use the same AWS CloudFormation
                    template, keep the default option, <b>Use current template</b>. If
                    your stack operation failed because the template required changes, and you want
                    to upload a revised template, choose <b>Upload a template to Amazon
                        S3</b> instead, and then choose <b>Browse</b> to select
                    your updated template. When you are finished uploading your revised template,
                    choose <b>Next</b>.</p>
            </li><li>
                <p>On the <b>Specify details</b> page, if you are not changing any
                    parameters that are specific to your template, choose
                    <b>Next</b>.</p>
            </li><li>
                <p>On the <b>Set deployment options</b> page, change defaults for
                        <b>Maximum concurrent accounts</b> and <b>Failure
                        tolerance</b>, if desired. For more information about these settings,
                    see <a href="./stacksets-concepts.html#stackset-ops-options">Stack set operation options</a>.</p>
            </li><li>
                <p>On the <b>Review</b> page, review your selections, and fill the
                    checkbox to acknowledge required IAM capabilities. Choose
                        <b>Submit</b>.</p>
            </li><li>
                <p>If your stack is not successfully updated, repeat this procedure, after you've
                    resolved any underlying issues that are preventing stack creation.</p>
            </li></ol></div>
     
        <h2 id="stack-instance-delete-fails">Stack instance deletion fails</h2>
        <p><b>Problem:</b> A stack deletion has failed.</p>
        <p><b>Cause:</b> Stack deletion will fail for any stacks on
            which termination protection has been enabled.</p>
        <p><b>Solution:</b> Determine if termination protection has
            been enabled for the stack. If it has, disable termination protection and then perform
            the stack instance deletion again.</p>
     
        <h2 id="stack-import-fails">Stack import operation fails</h2>
        <p><b>Problem:</b> A stack import operation fails to import
            existing stacks into new or existing stack sets. The stack instance is in an
                <code class="code">INOPERABLE</code> status.</p>
        <p><b>Solution:</b> Revert the stack import operation, by
            completing the following tasks.</p>
        <div class="orderedlist">
             
             
             
            <ol><li>
                <p>Use <b>Delete Stacks from StackSets</b> option and enable <b>RetainStacks</b> 
                    during configuration, then proceed to delete stack instances from your stack set. 
                    For more information, For more information, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stackinstances-delete.html">Delete
                        stack instances from your stack set</a>.</p>
            </li><li>
                <p>You will see the stack instance of the Stackset are updated to remove the
                        <code class="code">INOPERABLE</code> stack instance.</p>
            </li><li>
                <p>Fix the stack instances according to the import failure error and retry the stack import operation.</p>
            </li></ol></div>
     
        <h2 id="stack-instance-failure-count-for-stackset-operations">Stack instance
                failure count for StackSets operations</h2>
        <p>The stack instance failure count alerts you if stack instances fail to provision or
            update. These stack instances didn't deploy because of one or more of the following
            reasons:</p>
        <div class="itemizedlist">
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>Existing resource(s) with a similar configuration</p>
            </li><li class="listitem">
                <p>Missing dependencies, such as AWS Identity and Access Management (IAM) roles</p>
            </li><li class="listitem">
                <p>Other conflicting factors</p>
            </li></ul></div>
        <p>If you want to deploy with maximum concurrency, max concurrency count is one more than
            the failure tolerance count, at most. For example, if the failure tolerance count is 9,
            then max concurrency count can’t be more than 10. This will cause the operation to
            return <code class="code">SUCCEEDED</code> even if some stack instances fail to update. The new stack
            instance failure count enables you to determine if the operation only conditionally
            succeeded because the failure tolerance count is set to allow all failures.</p>
        <p>You can use the AWS Management Console, AWS SDK, or AWS CLI to get the failure count and filter
            stack instances to determine which instances need to be redeployed.</p>
         
            <h3 id="stack-instance-failure-count-for-stackset-operations-console-examples">Using the console</h3>
            <div class="procedure"><h6>To view the number of failed stack instances:</h6><ol><li>
                    <p>Open the <a href="https://console.aws.amazon.com/cloudformation" rel="noopener noreferrer" target="_blank"><span>AWS CloudFormation console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>
                        and choose <b>StackSets</b>.</p>
                </li><li>
                    <p>Choose your StackSet, and then choose the <b>Operations</b>
                        tab.</p>
                </li><li>
                    <p>Choose a status in the <b>Status</b> column to view the
                        status details. You will find the number of failed stack instances for a
                        particular operation in the status details.</p>
                </li></ol></div>
            <div class="procedure"><h6>To view the account, region, and status of stack instances for the
                    operation:</h6><ol><li>
                    <p>In the status details, choose the failed stack instances count.
                            <em>Example:</em>
                        <b>Stack instances: <code class="code">&lt;number of failed stack
                                instances&gt;</code></b>.</p>
                </li><li>
                    <p>Expand the side panel by choosing the panel header. The results in the
                        side panel are the statuses of the stack instances after the completion of
                        the selected operation.</p>
                </li></ol></div>
            <div class="procedure"><h6>To view the current stack instance details for an operation:</h6><ol><li>
                    <p>Choose the <b>Stack Instances</b> tab.</p>
                </li><li>
                    <p>Filter by <b>Last operation ID</b>. The results are the
                        current statuses and status reasons from the last operation to modify the
                        instance. You can use this filter in combination with <b>AWS
                            account</b>, <b>AWS region</b>, <b>Detailed
                            Status</b>, and <b>Drift status</b> to further
                        refine your search results.</p>
                </li></ol></div>
         
         
            <h3 id="stack-instance-failure-count-for-stackset-operations-cli-examples">Using the AWS CLI</h3>
            <p>To get the number of failed stack instances, call
                    <code class="code">describe-stack-set-operation</code> or
                    <code class="code">list-stack-set-operations</code> and see <code class="code">StatusDetails</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code>aws cloudformation describe-stack-set-operation --stack-set-name ss1 \
    --operation-id 5550e62f-c822-4331-88fa-21c1d7bafc60</code></pre>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "StackSetOperation": <span>{</span>
        "OperationId": "5550e62f-c822-4331-88fa-21c1d7bafc60",
        "StackSetId": "ss1:9101ca57-49fc-4a61-a5a6-4c97b8adb08f",
        "Action": "CREATE",
        "Status": "SUCCEEDED",
        "OperationPreferences": <span>{</span>
            "RegionOrder": [],
            "FailureToleranceCount": 10,
            "MaxConcurrentCount": 10
        },
        "AdministrationRoleARN": "arn:aws:iam::123456789012:role/AWSCloudFormationStackSetAdministrationRole",
        "ExecutionRoleName": "AWSCloudFormationStackSetExecutionRole",
        "CreationTimestamp": "2022-10-26T17:18:53.947000+00:00",
        "EndTimestamp": "2022-10-26T17:19:35.304000+00:00",
        "StatusDetails": <span>{</span>
            "FailedStackInstancesCount": 3
        }
    }
}</code></pre>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation list-stack-set-operations --stack-set-name ss1</code></pre>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Summaries": [
        <span>{</span>
            "OperationId": "5550e62f-c822-4331-88fa-21c1d7bafc60",
            "Action": "CREATE",
            "Status": "SUCCEEDED",
            "CreationTimestamp": "2022-10-26T17:18:53.947000+00:00",
            "EndTimestamp": "2022-10-26T17:19:35.304000+00:00",
            "StatusDetails": <span>{</span>
                "FailedStackInstancesCount": 3
            },
            "OperationPreferences": <span>{</span>
                "RegionOrder": [],
                "FailureToleranceCount": 10,
                "MaxConcurrentCount": 10
            }
        }
    ]
}</code></pre>
            <p>To get a historical overview for a particular operation, use
                    <code class="code">list-stack-set-operation-results</code> to view the status and status
                reason for each stack instance after the operation completed. See the following
                example to find the <code class="code">Status</code> and <code class="code">StatusReason</code>:</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation list-stack-set-operation-results --stack-set-name ss1 --operation-id 5550e62f-c822-4331-88fa-21c1d7bafc60 --filters Name=OPERATION_RESULT_STATUS,Values=FAILED</code></pre>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Summaries": [
        <span>{</span>
            "Account": "123456789012",
            "Region": "us-west-2",
            "Status": "FAILED",
            "StatusReason": "Account 123456789012 should have 'AWSCloudFormationStackSetExecutionRole' role with trust relationship to Role 'AWSCloudFormationStackSetAdministrationRole'.",
            "AccountGateResult": <span>{</span>
                "Status": "SKIPPED",
                "StatusReason": "Account 123456789012 should have 'AWSCloudFormationStackSetExecutionRole' role with trust relationship to Role 'AWSCloudFormationStackSetAdministrationRole'."
            },
            "OrganizationalUnitId": ""
        },
        <span>{</span>
            "Account": "123456789012",
            "Region": "us-west-1",
            "Status": "FAILED",
            "StatusReason": "Account 123456789012 should have 'AWSCloudFormationStackSetExecutionRole' role with trust relationship to Role 'AWSCloudFormationStackSetAdministrationRole'.",
            "AccountGateResult": <span>{</span>
                "Status": "SKIPPED",
                "StatusReason": "Account 123456789012 should have 'AWSCloudFormationStackSetExecutionRole' role with trust relationship to Role 'AWSCloudFormationStackSetAdministrationRole'."
            },
            "OrganizationalUnitId": ""
        },
        <span>{</span>
            "Account": "123456789012",
            "Region": "us-east-1",
            "Status": "FAILED",
            "StatusReason": "Account 123456789012 should have 'AWSCloudFormationStackSetExecutionRole' role with trust relationship to Role 'AWSCloudFormationStackSetAdministrationRole'.",
            "AccountGateResult": <span>{</span>
                "Status": "SKIPPED",
                "StatusReason": "Account 123456789012 should have 'AWSCloudFormationStackSetExecutionRole' role with trust relationship to Role 'AWSCloudFormationStackSetAdministrationRole'."
            },
            "OrganizationalUnitId": ""
        }
    ]
}</code></pre>
            <p>Use <code class="code">list-stack-instances</code> with the <code class="code">DETAILED_STATUS</code> and
                    <code class="code">LAST_OPERATION_ID</code> filters to get a list of stack instances that
                failed in the last operation that tried to deploy the stack instance.
                See the <code class="code">--filters</code> flag in the example with <code class="code">DETAILED_STATUS</code> and
                    <code class="code">LAST_OPERATION_ID</code>:</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation list-stack-instances --stack-set-name ss1 --filters Name=DETAILED_STATUS,Values=FAILED Name=LAST_OPERATION_ID,Values=5550e62f-c822-4331-88fa-21c1d7bafc60</code></pre>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Summaries": [
        <span>{</span>
            "StackSetId": "ss1:9101ca57-49fc-4a61-a5a6-4c97b8adb08f",
            "Region": "us-east-1",
            "Account": "123456789012",
            "Status": "OUTDATED",
            "StatusReason": "Account 123456789012 should have 'AWSCloudFormationStackSetExecutionRole' role with trust relationship to Role 'AWSCloudFormationStackSetAdministrationRole'.",
            "StackInstanceStatus": <span>{</span>
                "DetailedStatus": "FAILED"
            },
            "OrganizationalUnitId": "",
            "DriftStatus": "NOT_CHECKED",
            "LastOperationId": "5550e62f-c822-4331-88fa-21c1d7bafc60"
        },
        <span>{</span>
            "StackSetId": "ss1:9101ca57-49fc-4a61-a5a6-4c97b8adb08f",
            "Region": "us-west-1",
            "Account": "123456789012",
            "Status": "OUTDATED",
            "StatusReason": "Account 123456789012 should have 'AWSCloudFormationStackSetExecutionRole' role with trust relationship to Role 'AWSCloudFormationStackSetAdministrationRole'.",
            "StackInstanceStatus": <span>{</span>
                "DetailedStatus": "FAILED"
            },
            "OrganizationalUnitId": "",
            "DriftStatus": "NOT_CHECKED",
            "LastOperationId": "5550e62f-c822-4331-88fa-21c1d7bafc60"
        },
        <span>{</span>
            "StackSetId": "ss1:9101ca57-49fc-4a61-a5a6-4c97b8adb08f",
            "Region": "us-west-2",
            "Account": "123456789012",
            "Status": "OUTDATED",
            "StatusReason": "Account 123456789012 should have 'AWSCloudFormationStackSetExecutionRole' role with trust relationship to Role 'AWSCloudFormationStackSetAdministrationRole'.",
            "StackInstanceStatus": <span>{</span>
                "DetailedStatus": "FAILED"
            },
            "OrganizationalUnitId": "",
            "DriftStatus": "NOT_CHECKED",
            "LastOperationId": "5550e62f-c822-4331-88fa-21c1d7bafc60"
        }
    ]
}</code></pre>
            <p>To find the last operation ID to modify a stack instance, use <code class="code">list-stack-instances</code> or
     <code class="code">describe-stack-instance</code> to get the <code class="code">LastOperationId</code>:</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation describe-stack-instance --stack-set-name ss1 --stack-instance-account 123456789012 --stack-instance-region us-east-2</code></pre>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "StackInstance": <span>{</span>
        "StackSetId": "ss1:9101ca57-49fc-4a61-a5a6-4c97b8adb08f",
        "Region": "us-west-2",
        "Account": "123456789012",
        "ParameterOverrides": [],
        "Status": "OUTDATED",
        "StackInstanceStatus": <span>{</span>
            "DetailedStatus": "FAILED"
        },
        "StatusReason": "Account 123456789012 should have 'AWSCloudFormationStackSetExecutionRole' role with trust relationship to Role 'AWSCloudFormationStackSetAdministrationRole'.",
        "OrganizationalUnitId": "",
        "DriftStatus": "NOT_CHECKED",
        "LastOperationId": "5550e62f-c822-4331-88fa-21c1d7bafc60"
    }
}</code></pre>
         
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./stacksets-sampletemplates.html">Sample templates</div><div id="next" class="next-link" accesskey="n" href="./git-sync.html">Working with Git sync</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stacksets-troubleshooting.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>