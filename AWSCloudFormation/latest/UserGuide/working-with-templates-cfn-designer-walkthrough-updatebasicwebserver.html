<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Walkthrough: Use AWS CloudFormation Designer to modify a stack's template - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver" /><meta name="default_state" content="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" /><meta name="description" content="Use AWS CloudFormation Designer to update a basic web server." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Walkthrough: Use AWS CloudFormation Designer to modify a stack's template" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Walkthrough: Use AWS CloudFormation Designer to modify a stack's template - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Working with AWS CloudFormation templates",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Walkthroughs",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/CHAP_Using.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Walkthrough: Use AWS CloudFormation Designer to modify a stack's template",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/CHAP_Using.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">User Guide</a></div><div id="page-toc-src"><a href="#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-get-template">Step 1: Get a stack template</a><a href="#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-modify-template">Step 2: Modify a template</a><a href="#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-update-stack">Step 3: Update the stack</a><a href="#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-delete-stack">Step 4: Clean up resources</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver">Walkthrough: Use AWS CloudFormation Designer to modify a stack's template</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>You can use AWS CloudFormation Designer to modify a stack's template, and then submit it to AWS CloudFormation to update
    the stack. Typically, when you modify a stack, you need to get a copy of its template, modify
    the template in a text editor, and then use CloudFormation to update the stack. With AWS CloudFormation Designer, you
    can quickly get a copy of any running stack's template, modify it, and then update the stack
    without ever leaving the console.</p><p>In this walkthrough, we'll start with a <a href="./working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html">basic web
      server</a> stack, and then modify it so that the web server is scalable and durable.</p><p>In this walkthrough, we will complete the following steps:</p><div class="orderedlist">
     
     
     
     
  <ol><li>
      <p><a href="#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-get-template">Get a stack's template.</a></p>
      <p>We'll get a copy of a running stack's template; the same basic web
        server stack in the following walkthrough: <a href="./working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html">Walkthrough: Use AWS CloudFormation Designer to create a basic web server</a>.</p>
    </li><li>
      <p><a href="#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-modify-template">Modify the template.</a></p>
      <p>We'll use AWS CloudFormation Designer to modify the stack's template so that your website is scalable and
        durable by replacing the EC2 instance with an Auto Scaling group and an Elastic Load Balancing load balancer.</p>
    </li><li>
      <p><a href="#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-update-stack">Update the stack.</a></p>
      <p>After saving the modifications, we'll update the basic web server
        stack with the modified template.</p>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>CloudFormation is a free service; however, you are charged for the
          AWS resources you include in your stacks at the current rate for
          each. For more information about AWS pricing, see the detail page
          for each product on <a href="http://aws.amazon.com" rel="noopener noreferrer" target="_blank"><span>http://aws.amazon.com</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></div></div>
    </li><li>
      <p><a href="#working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-delete-stack">Delete the stack.</a></p>
      <p>We'll delete the stack to clean up all of the resources.</p>
    </li></ol></div><p>Prerequisites</p><p>This walkthrough assumes that you have a working knowledge of Amazon Virtual Private Cloud
    (Amazon VPC), Auto Scaling, Elastic Load Balancing, and CloudFormation. For context, each procedure provides some
    basic information about each resource.</p><p>Additionally, the walkthrough assumes that you completed the following
    walkthrough: <a href="./working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html">Walkthrough: Use AWS CloudFormation Designer to create a basic web server</a>. From that walkthrough, you should have a running stack named
      <code class="code">BasicWebServerStack</code>.</p><h2 id="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-get-template">Step 1: Get a stack template</h2>
    
    <p>In this step, we'll use AWS CloudFormation Designer to get and open a copy of a running
      stack's template.</p>
    <div class="procedure"><h6>To get a copy of a running stack's template</h6><ol><li>
        <p>Open the CloudFormation console at <a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/cloudformation/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
      </li><li>
        <p>From the list of stacks, select the
            <code class="code">BasicWebServerStack</code>.</p>
      </li><li>
        <p>Choose <b>Actions</b>, and then <b>View/Edit
            template in Designer</b>.</p>
      </li></ol></div>
    <p>CloudFormation gets a copy of the <code class="code">BasicWebServerStack</code> stack's
      template and displays it in AWS CloudFormation Designer, where you can view the template
      resources and their relationships. In the following step, we'll use
      AWS CloudFormation Designer to modify the template.</p>
  <h2 id="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-modify-template">Step 2: Modify a template</h2>
    
    <p>We'll modify the basic web server template by using AWS CloudFormation Designer's
      drag-and-drop interface and integrated JSON and YAML editor to replace the single
      Amazon EC2 instance with an Auto Scaling group and load balancer to make the web site
      scalable. If traffic to the web site suddenly increases, use Auto Scaling to
      quickly increase the number of web servers. The load balancer will equally
      distributes the traffic among the instances.</p>
    <div class="procedure"><h6>To modify a stack template</h6><ol><li>
        <p>Remove the <code class="code">WebServerInstance</code> resource.</p>
        <ol><li>
            <p>Right-click the <code class="code">WebServerInstance</code>
              resource.</p>
          </li><li>
            <p>From the resource menu, choose <b>Delete</b> (<span class="inlinemediaobject">
                 
                  <img src="/images/AWSCloudFormation/latest/UserGuide/images/designer-resourcemenu-delete.png" class="aws-docs-img-whiteBg aws-docs-img-xs-padding" />
                 
              </span>).</p>
          </li><li>
            <p>Choose <b>OK</b> to confirm.</p>
          </li></ol>
      </li><li>
        <p>From the <b>Resource types</b> pane, add the
          following resources into the <code class="code">PublicSubnet</code> resource:
            <b>AutoScalingGroup</b>,
            <b>LaunchConfiguration</b>, and
            <b>LoadBalancer</b>. Before adding resources, you
          might need to expand the subnet to include all the resources.</p>
        <p>The resources are organized by resource categories. The Auto Scaling group
          and launch configuration are in the <b>AutoScaling</b>
          category, and the load balancer is in the
            <b>ElasticLoadBalancing</b> category.</p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>These resources don't follow the container model, so AWS CloudFormation Designer doesn't
            automatically associate them with the subnet. We'll create connections later on in this
            step.</p></div></div>
      </li><li>
        <p>From the <b>Resource types</b> pane in the
            <b>EC2</b> category, add the
            <b>SecurityGroup</b> resource anywhere in the VPC
          except in the subnet.</p>
        <p>This security group will control the inbound and outbound traffic
          of the load balancer.</p>
      </li><li>
        <p>Rename the resources to make them easier to identify:</p>
        <div class="itemizedlist">
           
           
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p>Rename <b>AutoScalingGroup</b> to
                <code class="code">WebServerFleet</code></p>
          </li><li class="listitem">
            <p>Rename <b>LaunchConfiguration</b> to
                <code class="code">WebServerLaunchConfig</code></p>
          </li><li class="listitem">
            <p>Rename <b>LoadBalancer</b> to
                <code class="code">PublicElasticLoadBalancer</code></p>
          </li><li class="listitem">
            <p>Rename <b>SecurityGroup</b> to
                <code class="code">PublicLoadBalancerSecurityGroup</code></p>
          </li></ul></div>
      </li><li>
        <p>Create associations for the resources that you added.</p>
        <ol><li>
            <p>Associate the load balancer and Auto Scaling group resources with the
              public subnet:</p>
            <div class="itemizedlist">
               
               
            <ul class="itemizedlist"><li class="listitem">
                <p>From the <code class="code">PublicElasticLoadBalancer</code> resource,
                  drag the <code class="code">AWS::EC2::Subnet (Property: Subnets)</code>
                  connection to the <code class="code">PublicSubnet</code> resource.</p>
              </li><li class="listitem">
                <p>From the <code class="code">WebServerFleet</code> resource, drag the
                    <code class="code">AWS::EC2::Subnet (Property: VPCZoneIdentifier)</code>
                  connection to the <code class="code">PublicSubnet</code> resource.</p>
              </li></ul></div>
          </li><li>
            <p>Associate the load balancer with its security group:</p>
            <div class="itemizedlist">
               
            <ul class="itemizedlist"><li class="listitem">
                <p>From the <code class="code">PublicElasticLoadBalancer</code> resource,
                  drag the <code class="code">AWS::EC2::SecurityGroup (Property:
                    SecurityGroups)</code> connection to the
                    <code class="code">PublicLoadBalancerSecurityGroup</code>
                  resource.</p>
              </li></ul></div>
          </li><li>
            <p>Associate the Auto Scaling group with the load balancer and launch
              configuration:</p>
            <div class="itemizedlist">
               
               
            <ul class="itemizedlist"><li class="listitem">
                <p>From the <code class="code">WebServerFleet</code> resource, drag the
                    <code class="code">AWS::ElasticLoadBalancing::LoadBalancer (Property:
                    LoadBalancerNames)</code> connection to the
                    <code class="code">PublicElasticLoadBalancer</code> resource.</p>
              </li><li class="listitem">
                <p>From the <code class="code">WebServerFleet</code> resource, drag the
                    <code class="code">AWS::ElasticLoadBalancing::LaunchConfiguration
                    (Property: LaunchConfigurationName)</code> connection to the
                    <code class="code">WebServerLaunchConfig</code> resource.</p>
              </li></ul></div>
          </li><li>
            <p>Associate the launch configuration with the security
              group:</p>
            <div class="itemizedlist">
               
            <ul class="itemizedlist"><li class="listitem">
                <p>From the <code class="code">WebServerLaunchConfig</code> resource, drag
                  the <code class="code">AWS::EC2::SecurityGroup (Property:
                    SecurityGroups)</code> connection to the
                    <code class="code">WebServerSecurityGroup</code> resource.</p>
              </li></ul></div>
          </li><li>
            <p>Define a dependency for the Auto Scaling group to the public
              route:</p>
            <div class="itemizedlist">
               
            <ul class="itemizedlist"><li class="listitem">
                <p>From the <code class="code">WebServerFleet</code> resource, drag the
                    <code class="code">DependsOn</code> connection to the
                    <code class="code">PublicRoute</code> resource.</p>
              </li></ul></div>
            <p>This dependency means that CloudFormation won't create the
                <code class="code">WebServerFleet</code> resource until the public route is
              complete. Otherwise, if the public route isn't available when the
              web server instances are starting up, they won't be able to send
              signals (using the cfn-signal helper script) to notify CloudFormation when
              their configurations and application deployments are
              complete.</p>
          </li></ol>
      </li><li>
        <p>Specify the properties for the resources that you added.</p>
        <ol><li>
            <p>On the AWS CloudFormation Designer canvas, choose the
                <code class="code">PublicElasticLoadBalancer</code> resource.</p>
          </li><li>
            <p>In the integrated editor pane, choose the
                <b>Properties</b> tab, and then copy the following
              snippet and paste it between the <b>Properties</b>
              braces (<code class="code"><span>{</span>}</code>).</p>
            <p>AWS CloudFormation Designer automatically added the security group and subnet
              association, so you need to add only the <code class="code">Listeners</code>
              and <code class="code">HealthCheck</code> properties. The
                <code class="code">Listeners</code> property specifies where and what type of
              traffic to listen for, and the <code class="code">HealthCheck</code> property
              describes the settings for determining the health status of the
              load balancer.</p>
            <p>JSON</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><b>          "Listeners": [
          <span>{</span>
            "LoadBalancerPort": "80",
            "InstancePort": "80",
            "Protocol": "HTTP"
          }
        ],
        "HealthCheck": <span>{</span>
          "Target": "HTTP:80/",
          "HealthyThreshold": "3",
          "UnhealthyThreshold": "5",
          "Interval": "90",
          "Timeout": "60"
        },</b>
        "SecurityGroups": [
          <span>{</span>
            "Ref": "PublicLoadBalancerSecurityGroup"
          }
        ],
        "Subnets": [
          <span>{</span>
            "Ref": "PublicSubnet"
          }
        ]</code></pre>

            <p>YAML</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml "><b>      Listeners:
        - LoadBalancerPort: '80'
          InstancePort: '80'
          Protocol: HTTP
      HealthCheck:
        Target: 'HTTP:80/'
        HealthyThreshold: '3'
        UnhealthyThreshold: '5'
        Interval: '90'
        Timeout: '60'</b>
      SecurityGroups:
        - !Ref PublicLoadBalancerSecurityGroup
      Subnets:
        - !Ref PublicSubnet</code></pre>
          </li><li>
            <p>Repeat this process for the following resources:</p>
            <div class="variablelist">
               
               
               
               
            <dl>
                <dt><span class="term"><code class="code">WebServerFleet</code></span></dt>
                <dd>
                  <p>Add the <code class="code">MaxSize</code>, <code class="code">MinSize</code>, and
                      <code class="code">DesiredCapacity</code> properties. These properties
                    specify the maximum and minimum number of instances that you
                    can launch in the Auto Scaling group and the initial number of
                    instances to start with. The desired capacity value refers
                    to a new parameter, which we'll add later in this
                    procedure.</p>
                  <p>JSON</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><b>        "MinSize": "1",
        "MaxSize": "10",
        "DesiredCapacity": <span>{</span>
          "Ref": "WebServerCount"
        },</b>
        "VPCZoneIdentifier": [
          <span>{</span>
            "Ref": "PublicSubnet"
          }
        ],
        "LaunchConfigurationName": <span>{</span>
          "Ref": "WebServerLaunchConfig"
        },
        "LoadBalancerNames": [
          <span>{</span>
            "Ref": "PublicElasticLoadBalancer"
          }
        ]</code></pre>
                  <p>YAML</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml "><b>      MinSize: '1'
      MaxSize: '10'
      DesiredCapacity: !Ref WebServerCount</b>
      VPCZoneIdentifier:
        - !Ref PublicSubnet
      LaunchConfigurationName: !Ref WebServerLaunchConfig
      LoadBalancerNames:
        - !Ref PublicElasticLoadBalancer</code></pre>
                </dd>
               
                <dt><span class="term"><code class="code">PublicLoadBalancerSecurityGroup</code></span></dt>
                <dd>
                  <p>Add the following inbound and outbound rules that
                    determine the traffic that can reach and leave the load
                    balancer. The rules allows all HTTP traffic to reach and
                    leave the load balancer.</p>
                  <p>JSON</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><b>        "GroupDescription": "Public Elastic Load Balancing security group with HTTP access on port 80 from the Internet",
        "SecurityGroupIngress": [
          <span>{</span>
            "IpProtocol": "tcp",
            "FromPort": 80,
            "ToPort": 80,
            "CidrIp": "0.0.0.0/0"
          }
        ],
        "SecurityGroupEgress": [
          <span>{</span>
            "IpProtocol": "tcp",
            "FromPort": 80,
            "ToPort": 80,
            "CidrIp": "0.0.0.0/0"
          }
        ],</b>
        "VpcId": <span>{</span>
          "Ref": "VPC"
        }</code></pre>

                  <p>YAML</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml "><b>      GroupDescription: &gt;-
        Public Elastic Load Balancing security group with HTTP access on port 80
        from the Internet
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0</b>
      VpcId: !Ref VPC</code></pre>
                </dd>
               
                <dt><span class="term"><code class="code">WebServerSecurityGroup</code></span></dt>
                <dd>
                  <p>Modify the HTTP inbound rule to allow only traffic from
                    the load balancer.</p>
                  <p>JSON</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">        "GroupDescription": "Allow access from load balancer and SSH traffic",
        "SecurityGroupIngress": [
          <span>{</span>
            "IpProtocol": "tcp",
            "FromPort": 80,
            "ToPort": 80,
<b>            "SourceSecurityGroupId": <span>{</span>
              "Ref": "PublicLoadBalancerSecurityGroup"
            }</b>
          },
          <span>{</span>
            "IpProtocol": "tcp",
            "FromPort": 22,
            "ToPort": 22,
            "CidrIp": <span>{</span>
              "Ref": "SSHLocation"
            }
          }
        ],
        "VpcId": <span>{</span>
          "Ref": "VPC"
        }</code></pre>
                  <p>YAML</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">      VpcId: !Ref VPC
      GroupDescription: Allow access from load balancer and SSH traffic
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          <b>SourceSecurityGroupId: !Ref PublicLoadBalancerSecurityGroup</b>
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: !Ref SSHLocation</code></pre>
                </dd>
               
                <dt><span class="term"><code class="code">WebServerLaunchConfig</code></span></dt>
                <dd>
                  <p>The launch configuration has a number of different properties that you need
                    to specify, so we'll highlight just a few of them. The <code class="code">InstanceType</code>
                    and <code class="code">ImageId</code> properties use the parameter and mapping values that
                    were already specified in the template. You specify the instance type as a
                    parameter value when you create a stack. The <code class="code">ImageId</code> value is a
                    mapping that's based on your stack's region and the instance type that you
                    specified.</p>
                  <p>In the <code class="code">UserData</code> property, we specify configurations scripts
                    that run after the instance is up and running. The configuration information is
                    defined in the instance's metadata, which we'll add in the next step.</p>
                  <p>JSON</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><b>        "InstanceType": <span>{</span>
          "Ref": "InstanceType"
        },
        "ImageId": <span>{</span>
          "Fn::FindInMap": [
            "AWSRegionArch2AMI",
            <span>{</span>
              "Ref": "AWS::Region"
            },
            <span>{</span>
              "Fn::FindInMap": [
                "AWSInstanceType2Arch",
                <span>{</span>
                  "Ref": "InstanceType"
                },
                "Arch"
              ]
            }
          ]
        },
        "KeyName": <span>{</span>
          "Ref": "KeyName"
        },
        "AssociatePublicIpAddress": "true",
        "UserData": <span>{</span>
          "Fn::Base64": <span>{</span>
            "Fn::Join": [
              "",
              [
                "#!/bin/bash -xe\n",
                "yum install -y aws-cfn-bootstrap\n",
                "# Install the files and packages from the metadata\n",
                "/opt/aws/bin/cfn-init -v ",
                "         --stack ",
                <span>{</span>
                  "Ref": "AWS::StackName"
                },
                "         --resource WebServerLaunchConfig ",
                "         --configsets All ",
                "         --region ",
                <span>{</span>
                  "Ref": "AWS::Region"
                },
                "\n",
                "# Signal the status from cfn-init\n",
                "/opt/aws/bin/cfn-signal -e $? ",
                "         --stack ",
                <span>{</span>
                  "Ref": "AWS::StackName"
                },
                "         --resource WebServerFleet ",
                "         --region ",
                <span>{</span>
                  "Ref": "AWS::Region"
                },
                "\n"
              ]
            ]
          }
        },</b>
        "SecurityGroups": [
          <span>{</span>
            "Ref": "WebServerSecurityGroup"
          }
        ]</code></pre>
                  <p>YAML</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml "><b>      InstanceType: !Ref InstanceType
      ImageId: !FindInMap 
        - AWSRegionArch2AMI
        - !Ref 'AWS::Region'
        - !FindInMap 
          - AWSInstanceType2Arch
          - !Ref InstanceType
          - Arch
      KeyName: !Ref KeyName
      AssociatePublicIpAddress: 'true'
      UserData: !Base64 
        'Fn::Join':
          - ''
          - - |
              #!/bin/bash -xe
            - |
              yum install -y aws-cfn-bootstrap
            - |
              # Install the files and packages from the metadata
            - '/opt/aws/bin/cfn-init -v '
            - '         --stack '
            - !Ref 'AWS::StackName'
            - '         --resource WebServerLaunchConfig '
            - '         --configsets All '
            - '         --region '
            - !Ref 'AWS::Region'
            - |+

            - |
              # Signal the status from cfn-init
            - '/opt/aws/bin/cfn-signal -e $? '
            - '         --stack '
            - !Ref 'AWS::StackName'
            - '         --resource WebServerFleet '
            - '         --region '
            - !Ref 'AWS::Region'
            - |+</b>

      SecurityGroups:
        - !Ref WebServerSecurityGroup</code></pre>
                </dd>
              </dl></div>
          </li></ol>
      </li><li>
        <p>Add the launch configuration metadata to the
            <code class="code">WebServerLaunchConfig</code> resource, which instructs the
          cfn-init helper script to start the web server and create a basic web
          page.</p>
        <ol><li>
            <p>Choose the <code class="code">WebServerLaunchConfig</code> resource, and
              then choose the <b>Metadata</b> tab in the
              integrated editor.</p>
          </li><li>
            <p><em>If you are authoring your template in
                JSON</em>: Within the <code class="code">Metadata</code> braces
                (<code class="code"><span>{</span>}</code>), after the
                <code class="code">AWS::CloudFormation::Designer</code> closing brace, add a
              comma (<code class="code">,</code>).</p>
          </li><li>
            <p>Add the following snippet, which instructs the cfn-init helper
              script to start the web server and create a basic web page, after
              the <code class="code">AWS::CloudFormation::Designer</code> property.</p>
            <p>JSON</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">        "AWS::CloudFormation::Init" : <span>{</span>
          "configSets" : <span>{</span>
            "All" : [ "ConfigureSampleApp" ]
          },
          "ConfigureSampleApp" : <span>{</span>
            "packages" : <span>{</span>
              "yum" : <span>{</span>
                "httpd" : []
              }
            },
            "files" : <span>{</span>
              "/var/www/html/index.html" : <span>{</span>
                "content" : <span>{</span> "Fn::Join" : ["\n", [
                  "&lt;h1&gt;Congratulations, you have successfully launched the AWS CloudFormation sample.&lt;/h1&gt;"
                ]]},
                "mode"    : "000644",
                "owner"   : "root",
                "group"   : "root"
              }
            },
            "services" : <span>{</span>
              "sysvinit" : <span>{</span>
                "httpd"    : <span>{</span> "enabled" : "true", "ensureRunning" : "true" }
              }
            }
          }
        }</code></pre>
            <p>YAML</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">      'AWS::CloudFormation::Init':
        configSets:
          All:
            - ConfigureSampleApp
        ConfigureSampleApp:
          packages:
            yum:
              httpd: []
          files:
            /var/www/html/index.html:
              content: !Join 
                - |+

                - - &gt;-
                    &lt;h1&gt;Congratulations, you have successfully launched the AWS
                    CloudFormation sample.&lt;/h1&gt;
              mode: '000644'
              owner: root
              group: root
          services:
            sysvinit:
              httpd:
                enabled: 'true'
                ensureRunning: 'true'</code></pre>
          </li></ol>
      </li><li>
        <p>Add the <code class="code">WebServerCount</code> parameter. This parameter
          specifies how many instances to create when CloudFormation creates the Auto Scaling
          group.</p>
        <ol><li>
            <p>Select on an open area on the AWS CloudFormation Designer canvas.</p>
          </li><li>
            <p>In the integrated editor pane, choose the
                <b>Parameters</b> tab.</p>
          </li><li>
            <p>Add the following parameter in the
              integrated editor. If you're authoring the template in
              JSON, add a comma as needed.</p>
            <p>JSON</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">    "WebServerCount": <span>{</span>
      "Description": "Number of Amazon EC2 instances to launch for the WebServer server",
      "Type": "Number",
      "Default": "1"
    }</code></pre>
            <p>YAML</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">  WebServerCount:
    Description: Number of Amazon EC2 instances to launch for the WebServer server
    Type: Number
    Default: '1'</code></pre>
          </li></ol>
      </li><li>
        <p>Modify the template output to show the DNS name of the load
          balancer.</p>
        <ol><li>
            <p>In the integrated editor pane, choose the
                <b>Outputs</b> tab.</p>
          </li><li>
            <p>Modify the JSON to use the load balancer DNS name, as shown in
              the following snippet.</p>
            <p>JSON</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Outputs": <span>{</span>
    "URL": <span>{</span>
      "Value": <span>{</span>
<b>        "Fn::GetAtt": [
          "PublicElasticLoadBalancer",
          "DNSName"
        ]</b>
      },
      "Description": "Newly created application URL"
    }
  }
}</code></pre>
            <p>If you're authoring your template in YAML, use the following
              snippet.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Outputs:
  URL:
    Value: !GetAtt 
      - PublicElasticLoadBalancer
      - DNSName
    Description: Newly created application URL</code></pre>
          </li></ol>
      </li><li>
        <p>On the AWS CloudFormation Designer toolbar, choose <b>Validate
            template</b> (<span class="inlinemediaobject">
             
              <img src="/images/AWSCloudFormation/latest/UserGuide/images/designer-validate-icon.png" class="aws-docs-img-whiteBg aws-docs-img-xs-padding" />
             
          </span>) to check for syntax errors in your
          template.</p>
        <p>View and fix errors in the <b>Messages</b> pane, and
          then validate the template again. If you don't see errors, your
          template is syntactically valid.</p>
      </li><li>
        <p>From the AWS CloudFormation Designer toolbar, save the template locally by choosing
            <b>File</b> (<span class="inlinemediaobject">
             
              <img src="/images/AWSCloudFormation/latest/UserGuide/images/designer-file-menu.png" class="aws-docs-img-whiteBg aws-docs-img-xs-padding" />
             
          </span>) and then <b>Save</b>.</p>
      </li></ol></div>
    <p>You now have a modified CloudFormation template that you can use to update the
      basic web server stack. In the next step, we'll use this template to
      update the basic web server stack.</p>
   
   <h2 id="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-update-stack">Step 3: Update the stack</h2>
    <p>To implement your template changes, we need to update the basic web
      server stack. You can launch the CloudFormation Update Stack Wizard directly from
      AWS CloudFormation Designer.</p>
    <div class="procedure"><h6>To update the stack</h6><ol><li>
        <p>On the AWS CloudFormation Designer toolbar, choose <b>Create
            Stack</b> (<span class="inlinemediaobject">
             
              <img src="/images/AWSCloudFormation/latest/UserGuide/images/designer-create-stack-icon.png" class="aws-docs-img-whiteBg aws-docs-img-xs-padding" />
             
          </span>).</p>
        <p>AWS CloudFormation Designer saves the opened template in an S3 bucket and then
          launches the CloudFormation Update Stack Wizard. Because we modified the
            <code class="code">BasicWebServerStack</code> stack's template, CloudFormation launches
          the Update Stack Wizard for that stack.</p>
      </li><li>
        <p>CloudFormation automatically populates the template URL; choose
            <b>Next</b>.</p>
      </li><li>
        <p>In the <b>Stack</b> section, in the
            <b>Name</b> field, verify that the stack name is
            <code class="code">BasicWebServerStack</code>.</p>
      </li><li>
        <p>In the <b>Parameters</b> section, use the existing
          values; choose <b>Next</b>.</p>
      </li><li>
        <p>For this walkthrough, you don't need to add tags or specify
          advanced settings, so choose <b>Next</b>.</p>
      </li><li>
        <p>Ensure that the stack name is correct, and then choose
            <b>Update</b>.</p>
      </li></ol></div>
    <p>It can take several minutes for CloudFormation to update your stack. To
      monitor progress, view the stack events. For more information, see <a href="./cfn-console-view-stack-data-resources.html">Viewing AWS CloudFormation stack data and resources on the
   AWS Management Console</a>. After the stack
      is updated, view the stack outputs and go to the website URL to verify
      that the website is running. For more information, see <a href="./cfn-console-view-stack-data-resources.html">Viewing AWS CloudFormation stack data and resources on the
   AWS Management Console</a>. You
      successfully updated a template and a stack using AWS CloudFormation Designer.</p>
    <p>To ensure that you aren't charged for unwanted services, you can delete this stack.</p>
   
   <h2 id="working-with-templates-cfn-designer-walkthrough-updatebasicwebserver-delete-stack">Step 4: Clean up resources</h2>
    
    <p>To make sure you aren't charged for unwanted services, delete your stack and it's
      resources.</p>
    <div class="procedure"><h6>To delete the stack</h6><ol><li>
        <p>From the CloudFormation console, choose the
            <b>BasicWebServerStack</b> stack.</p>
      </li><li>
        <p>Choose <b>Delete Stack</b>.</p>
      </li><li>
        <p>In the confirmation message, choose <b>Yes,
            Delete</b>.</p>
      </li></ol></div>
    <p>It can take several minutes for CloudFormation to delete your stack. To monitor progress, view
      the stack events. After the stack is deleted, all the resources that you created are deleted.
      Now that you understand how to use AWS CloudFormation Designer, you can use it to build and modify your own
      templates.</p>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html">Walkthrough: Use AWS CloudFormation Designer to create a basic web server</div><div id="next" class="next-link" accesskey="n" href="./peer-with-vpc-in-another-account.html">Peer with a VPC in another account</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>