<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Stack failure options - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="stack-failure-options" /><meta name="default_state" content="stack-failure-options" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" /><meta name="description" content="Iteratively develop your applications when provisioning failures are encountered by starting from the point of failure without rolling back successfully provisioned resources." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Stack failure options" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Stack failure options - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Working with stacks",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacks.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Stack failure options",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacks.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">User Guide</a></div><div id="page-toc-src"><a href="#stack-failure-options-overview">Overview of stack failure options</a><a href="#stack-failure-options-conditions">Conditions to pause stack rollback</a><a href="#stack-failure-options-console">Preserve successfully provisioned resources (console)</a><a href="#stack-failure-options-cli">Preserve successfully provisioned resources
    (AWS CLI)</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="stack-failure-options">Stack failure options</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>You can iteratively develop your applications when provisioning failures are encountered by
  starting from the point of failure without rolling back successfully provisioned resources. By
  specifying stack failure options, you can troubleshoot resources in a <code class="code">CREATE_FAILED</code>
  or <code class="code">UPDATE_FAILED</code> status. You can provision failure options for all stack deployments
  and change set operations.</p><div class="itemizedlist">
   
   
  
 <ul class="itemizedlist"><li class="listitem">
   <p>Create operations set to <b>Preserve successfully provisioned resources</b> preserves the state of successful resources, while failed resources will stay in a failed
    state until the next update operation is performed.</p>
  </li><li class="listitem">
   <p>Update and change set operations set to <b>Preserve successfully provisioned
     resources</b> preserves the state of successful resources while rolling back failed
    resources to the last known stable state. Failed resources will be in an
     <code class="code">UPDATE_FAILED</code> state. Resources without a last known stable state will be deleted
    upon the next stack operation.</p>
  </li></ul></div><p>See the following sections for more details about pausing the rollback of
  failed resources:</p><div class="itemizedlist">
   
   
   
   
 <ul class="itemizedlist"><li class="listitem">
   <p><a href="#stack-failure-options-overview">Overview of stack failure options</a></p>
  </li><li class="listitem">
   <p><a href="#stack-failure-options-conditions">Conditions to pause stack rollback</a></p>
  </li><li class="listitem">
   <p><a href="#stack-failure-options-console">Preserve successfully provisioned resources
    (console)</a></p>
  </li><li class="listitem">
   <p><a href="#stack-failure-options-cli">Preserve successfully provisioned resources
    (AWS CLI)</a></p>
  </li></ul></div>
  <h2 id="stack-failure-options-overview">Overview of stack failure options</h2>
  <p>Before issuing an operation from the AWS CloudFormation console, API, or AWS Command Line Interface (AWS CLI), specify
   the behavior for provisioned resource failure. Then, proceed with the deployment process of your
   resources without any other modifications. In the event of an operational failure, CloudFormation
   stops at the first failure in each independent provisioning path. CloudFormation identifies
   dependencies between resources to parallelize independent provisioning actions. Then it proceeds
   to provision resources on each independent provisioning path until it encounters a failure. A
   failure in one path doesn’t affect other provisioning paths. CloudFormation will continue to
   provision the resources until completion or stop on a different failure.</p>
  <p>Remediate any issues to continue the deployment process. CloudFormation performs the necessary
   updates before retrying provisioning actions on resources that couldn’t be successfully
   provisioned earlier. You remediate issues by submitting a <b>Retry</b>,
    <b>Update</b>, or <b>Roll back</b> operations. For example, if
   you're provisioning an Amazon EC2 instance and the EC2 instance fails during a create operation, you
   might want to investigate the error, rather than rolling back the failed resource right away. You
   can review system status checks and instances status checks, and then select the
    <b>Retry</b> operation once the issues is resolved.</p>
  
  
  <p>When a stack operation fails, and you've specified <b>Preserve successfully
   provisioned resources</b> from the <b>Stack failure options</b> menu, you can select the following options.</p>
  <div class="itemizedlist">
    
    
    
  <ul class="itemizedlist"><li class="listitem">
    <p><b>Retry</b> – Retries provisioning operation on failed resources and
     continues provisioning the template until the successful completion of the stack operation or
     the next failure. Select this option if the resource failed to provision due to an issue that
     doesn't require template modifications, such as an AWS Identity and Access Management (IAM) permission.</p>
   </li><li class="listitem">
    <p><b>Update</b> – Resources that have been provisioned are updated on
     template updates. Resources that failed to create or update will be retried. Select this option
     if the resource failed to provision due to template errors, and you've modified the template.
     When you update a stack that's in a <code class="code">FAILED</code> state, you must select
      <b>Preserve successfully provisioned resources</b> for the <b>Stack
      failure options</b> to continue updating your stack.</p>
   </li><li class="listitem">
    <p><b>Roll back</b> – CloudFormation rolls back the stack to the last known
     stable state.</p>
   </li></ul></div>

 
  
  <h2 id="stack-failure-options-conditions">Conditions to pause stack rollback</h2>
  <p>To pause the rollback of failed resources in your stack, the following conditions must be
   met.</p>
  <div class="itemizedlist">
    
    
  <ul class="itemizedlist"><li class="listitem">
    <p>You must specify the <b>Preserve successfully provisioned resources</b>
     parameter during a stack operation. For more information about rollback behavior, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-console-add-tags.html#rollback">Setting AWS CloudFormation
      stack options</a>.</p>
   </li><li class="listitem">
    <p>A stack operation must have a stack status of <code class="code">CREATE_FAILED</code> or
      <code class="code">UPDATE_FAILED</code>. For information about stack status, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-describing-stacks.html#w2ab1c23c15c17c11">Stack status codes</a>.</p>
   </li></ul></div>
  <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Immutable update types aren't supported.</p></div></div>
  
  <h2 id="stack-failure-options-console">Preserve successfully provisioned resources
    (console)</h2>
  <awsdocs-tabs><dl style="display: none">
   <dt>Create stack</dt><dd tab-id="create-stack">
     <div class="procedure"><h6>To preserve successfully provisioned resources during a create stack operation</h6><ol><li><p>Sign in to the AWS Management Console and open the AWS CloudFormation console at
         <a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/cloudformation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
       <p>Choose <b>Create stack</b> and select <b>With new resources
         (standard)</b>.</p>
      </li><li>
       <p>On the <b>Specify template</b> page, choose a stack template by using one
        of the following options:</p>
       <div class="itemizedlist">
         
         
         
       <ul class="itemizedlist"><li class="listitem">
         <p><b>Template is ready</b></p>
        </li><li class="listitem">
         <p><b>Use a sample template</b></p>
        </li><li class="listitem">
         <p><b>Create template in Designer</b></p>
        </li></ul></div>
       <p>Accept your settings and select <b>Next</b>.</p>
      </li><li>
       <p>On the <b>Specify stack details</b> page, enter a stack name in the
         <b>Stack name</b> box.</p>
      </li><li>
       <p>In the <b>Parameters</b> section, specify parameters that are defined in
        your stack template.</p>
       <p>You can use or change any parameters with default values.</p>
      </li><li>
       <p>When you're satisfied with the parameter values, choose
        <b>Next</b>.</p>
      </li><li>
       <p>On the <b>Configure stack options</b> page, you can set additional
        options for your stack.</p>
      </li><li>
       <p>For <b>Stack failure options</b>, select <b>Preserve successfully
         provisioned resources</b>.</p>
      </li><li>
       <p>When you're satisfied with the stack options, choose <b>Next</b>.</p>
      </li><li>
       <p>Review your stack on the <b>Review</b> page and select <b>Create
         stack</b>.</p>
      </li></ol></div>
     <p><em>Results</em>: Resources that failed to create transition the stack status
      to <code class="code">CREATE_FAILED</code> to prevent the stack from rolling back when the stack operation
      encounters a failure. Resources that are successfully provisioned are in a
       <code class="code">CREATE_COMPLETE</code> state. You can monitor the stack in the <b>Stack
       events</b> tab.</p>
    </dd>
   <dt>Update stack</dt><dd tab-id="update-stack">
     <div class="procedure"><h6>To preserve successfully provisioned resources during an update stack operation</h6><ol><li><p>Sign in to the AWS Management Console and open the AWS CloudFormation console at
         <a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/cloudformation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
       <p>Select the stack you want to update and then choose <b>Update</b>.</p>
      </li><li>
       <p>On the <b>Update stack</b> page, choose a stack template by using one of
        the following options:</p>
       <div class="itemizedlist">
         
         
         
       <ul class="itemizedlist"><li class="listitem">
         <p><b>Use current template</b></p>
        </li><li class="listitem">
         <p><b>Replace current template</b></p>
        </li><li class="listitem">
         <p><b>Edit template in designer</b></p>
        </li></ul></div>
       <p>Accept your settings and select <b>Next</b>.</p>
      </li><li>
       <p>On the <b>Specify stack details</b> page, specify parameters that are
        defined in your stack template.</p>
       <p>You can use or change any parameters with default values.</p>
      </li><li>
       <p>When you're satisfied with the parameter values, choose
        <b>Next</b>.</p>
      </li><li>
       <p>On the <b>Configure stack options</b> page, you can set additional
        options for your stack.</p>
      </li><li>
       <p>For the <b>Behavior on provisioning failure</b>, select
        <b>Preserve successfully provisioned resources</b>.</p>
      </li><li>
       <p>When you're satisfied with the stack options, choose <b>Next</b>.</p>
      </li><li>
       <p>Review your stack on the <b>Review</b> page and select <b>Update
         stack</b>.</p>
      </li></ol></div>
     <p><em>Results</em>: Resources that failed to update transition the stack status
      to <code class="code">UPDATE_FAILED</code> and roll back to the last known stable state. Resources without
      a last known stable state will be deleted by CloudFormation upon the next stack operation.
      Resources that are successfully provisioned are in a <code class="code">CREATE_COMPLETE</code> or
       <code class="code">UPDATE_COMPLETE</code> state. You can monitor the stack in the <b>Stack
       events</b> tab.</p>
    </dd>
   <dt>Change set</dt><dd tab-id="change-set">
     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You can initiate a change set for a stack with a status of <code class="code">CREATE_FAILED</code> or
        <code class="code">UPDATE_FAILED</code>, but not for a status of
       <code class="code">UPDATE_ROLLBACK_FAILED</code>.</p></div></div>
     <div class="procedure"><h6>To Preserve successfully provisioned resources during a change set
       operation</h6><ol><li><p>Sign in to the AWS Management Console and open the AWS CloudFormation console at
         <a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/cloudformation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
       <p>Select the stack that contains the change set you want to initiate, and then choose the
         <b>Change sets</b> tab.</p>
      </li><li>
       <p>Select the change set and then choose <b>Execute</b>.</p>
      </li><li>
       <p>For <b>Execute change set</b>, select the <b>Preserve successfully
         provisioned resources</b> option.</p>
      </li><li>
       <p>Select <b>Execute change set</b>.</p>
      </li></ol></div>
     <p><em>Results</em>: Resources that failed to update transition the stack status
      to <code class="code">UPDATE_FAILED</code> and roll back to the last known stable state. Resources without
      a last known stable state will be deleted by CloudFormation upon the next stack operation. Resources that are
      successfully provisioned are in a <code class="code">CREATE_COMPLETE</code> or <code class="code">UPDATE_COMPLETE</code>
      state. You can monitor the stack in the <b>Stack events</b> tab.</p>
    </dd>
  </dl></awsdocs-tabs>
  
  <h2 id="stack-failure-options-cli">Preserve successfully provisioned resources
    (AWS CLI)</h2>
  <awsdocs-tabs><dl style="display: none">
   <dt>Create stack</dt><dd tab-id="create-stack">
     <div class="procedure"><h6>To preserve successfully provisioned resources during a stack create operation</h6><p>Specify the <code class="code">disable-rollback</code> option or <code class="code">on-failure DO_NOTHING</code>
       enumeration during a <a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/create-stack.html">create-stack</a>
       operation.</p><ol><li>
       <p>Provide a stack name and template to the <code class="code">create-stack</code> command with the
         <code class="code">disable-rollback</code> option.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation create-stack --stack-name <code class="code" copy="true">myteststack</code> --template-body <code class="replaceable">file://DOC-EXAMPLE-BUCKET.json</code> --disable-rollback</code></pre>
       <p>The command returns the following output.</p>
       <pre class="screen"><span>{</span>
    "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896"
}</pre>
      </li><li>
       <p>Describe the state of the stack using the <code class="code">describe-stacks</code> option.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation describe-stacks --stack-name <code class="replaceable">myteststack</code></code></pre>
       <p>The command returns the following output.</p>
       <pre class="screen"><span>{</span>
    "Stacks":  [
        <span>{</span>
            "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896",
            "Description": "AWS CloudFormation Sample Template",
            "Tags": [],
            "Outputs": [],
            "StackStatusReason": “The following resource(s) failed to create: [MyBucket]”,
            "CreationTime": "2013-08-23T01:02:15.422Z",
            "Capabilities": [],
            "StackName": "myteststack",
            "StackStatus": "CREATE_FAILED",
            "DisableRollback": true
        }
    ]
}</pre>
      </li></ol></div>
    </dd>
   <dt>Update stack</dt><dd tab-id="update-stack">
     <div class="procedure"><h6>To preserve successfully provisioned resources during a stack update operation.</h6><ol><li>
       <p>Provide an existing stack name and template to the <code class="code">update-stack</code> command
        with the <code class="code">disable-rollback</code> option.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation update-stack --stack-name <code class="replaceable">myteststack</code> --template-url <code class="replaceable">DOC-EXAMPLE-BUCKET.template</code> --disable-rollback</code></pre>
       <p>The command returns the following output.</p>
       <pre class="screen"><span>{</span>
    "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896"
}</pre>
      </li><li>
       <p>Describe the state of the stack using either the <code class="code">describe-stacks</code> or
         <code class="code">describe-stack-events</code> option.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation describe-stacks --stack-name <code class="replaceable">myteststack</code></code></pre>
       <p>The command returns the following output.</p>
       <pre class="screen"><span>{</span>
    "Stacks":  [
        <span>{</span>
            "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896",
            "Description": "AWS CloudFormation Sample Template",
            "Tags": [],
            "Outputs": [],
            "CreationTime": "2013-08-23T01:02:15.422Z",
            "Capabilities": [],
            "StackName": "myteststack",
            "StackStatus": "UPDATE_COMPLETE",
            "DisableRollback": true
        }
    ]
}</pre>
      </li></ol></div>
    </dd>
   <dt>Change set</dt><dd tab-id="change-set">
     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You can initiate a change set for a stack with a status of <code class="code">CREATE_FAILED</code> or
        <code class="code">UPDATE_FAILED</code>
       but not for a status of <code class="code">UPDATE_ROLLBACK_FAILED</code>.</p></div></div>
     <div class="procedure"><h6>To preserve successfully provisioned resources during a change set operation</h6><p>Specify the <code class="code">disable-rollback</code> option  during an <a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/execute-change-set.html">execute-change-set</a>
       operation.</p><ol><li>
       <p>Provide a stack name and template to the <code class="code">execute-change-set</code> command with
        the <code class="code">disable-rollback</code> option.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation execute-change-set --stack-name <code class="replaceable">myteststack</code> --change-set-name <code class="replaceable">my-change-set</code> --template-body file://template.yaml</code></pre>
       <p>The command returns the following output.</p>
       <pre class="screen"><span>{</span>
 "Id": "arn:aws:cloudformation:us-east-1:123456789012:changeSet/my-change-set/bc9555ba-a949-xmpl-bfb8-f41d04ec5784",
 "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896"
}</pre>
      </li><li>
       <p>Initiate the change set with <code class="code">disable-rollback</code> option.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation execute-change-set --stack-name <code class="replaceable">myteststack</code> --change-set-name <code class="replaceable">my-change-set</code> -–disable-rollback</code></pre>
      </li><li>
       <p>Determine the status of the stack using either the <code class="code">describe-stacks</code> or
         <code class="code">describe-stack-events</code> option.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "StackEvents": [
     <span>{</span>
        "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896",
        "EventId": "49c966a0-7b74-11ea-8071-024244bb0672",
        "StackName": "myteststack",
        "LogicalResourceId": " MyBucket",
        "PhysicalResourceId": "MyBucket",
        "ResourceType": "AWS::S3::Bucket",
        "Timestamp": "2020-04-10T21:43:17.015Z",
        "ResourceStatus": "UPDATE_FAILED"
        "ResourceStatusReason": "User XYZ is not allowed to perform S3::UpdateBucket on MyBucket"
     }
}</code></pre>
      </li><li>
       <p>Fix permissions errors and retry the operation.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation update-stack --stack-name <code class="replaceable">myteststack</code> --use-previous-template --disable-rollback</code></pre>
       <p>The command returns the following output.</p>
       <pre class="screen"><span>{</span>
    "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896"
}</pre>
      </li><li>
       <p>Describe the state of the stack using either the <code class="code">describe-stacks</code> or
         <code class="code">describe-stack-events</code> option.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation describe-stacks --stack-name <code class="replaceable">myteststack</code></code></pre>
       <p>The command returns the following output.</p>
       <pre class="screen"><span>{</span>
    "Stacks":  [
        <span>{</span>
            "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896",
            "Description": "AWS CloudFormation Sample Template",
            "Tags": [],
            "Outputs": [],
            "CreationTime": "2013-08-23T01:02:15.422Z",
            "Capabilities": [],
            "StackName": "myteststack",
            "StackStatus": "UPDATE_COMPLETE",
            "DisableRollback": true
        }
    ]
}</pre>
      </li></ol></div>
    </dd>
  </dl></awsdocs-tabs>
  
   
   <h3 id="roll-back-stack-cli">Roll back stack</h3>
   
   <div class="procedure"><h6>To roll back a stack from the CREATE_FAILED or UPDATE_FAILED stack status</h6><p>Specify the <code class="code">rollback-stack</code> operation to roll back a stack to its last
     stable state.</p><ul><li>
     <p>Initiate a rollback with the <code class="code">rollback-stack</code> operation and specify the
      stack name.</p>
     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation rollback-stack --stack-name <code class="replaceable">myteststack</code></code></pre>
     <p>The command returns the following output.</p>
     <pre class="screen"><span>{</span>
    "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896"
}</pre>
    </li></ul></div>
   <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The <code class="code">rollback-stack</code> operation will delete a stack if it doesn't contain a
     last known stable state.</p></div></div>
   
  
 <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./stack-resource-configuration-complete.html">Stack deployment</div><div id="next" class="next-link" accesskey="n" href="./refactor-stacks.html">Moving resources between stacks</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stack-failure-options.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/stack-failure-options.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>