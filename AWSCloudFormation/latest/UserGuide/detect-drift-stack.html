<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Detect drift on an entire CloudFormation stack - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="detect-drift-stack" /><meta name="default_state" content="detect-drift-stack" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" /><meta name="description" content="Performing a drift detection operation on a stack determines whether the stack has drifted from its expected template configuration, and returns detailed information about the drift status of each resource in the stack that supports drift detection." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Detect drift on an entire CloudFormation stack" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Detect drift on an entire CloudFormation stack - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Working with stacks",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacks.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Detecting unmanaged configuration changes to stacks and resources",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-stack-drift.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Detect drift on an entire CloudFormation stack",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-stack-drift.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">User Guide</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="detect-drift-stack">Detect drift on an entire CloudFormation stack</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Performing a drift detection operation on a stack determines whether the stack has
            drifted from its expected template configuration, and returns detailed information about
            the drift status of each resource in the stack that supports drift detection.</p><div class="procedure"><h6>To detect drift on an entire stack using the AWS Management Console</h6><ol><li><p>Open the AWS CloudFormation console at
         <a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/cloudformation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
                <p>From the list of stacks, select the stack on which you want to perform drift
                    detection. In the stack details pane, choose <b>Stack actions</b>,
                    and then choose <b>Detect drift</b>.</p>
                <div class="mediaobject">
                     
                        <img src="/images/AWSCloudFormation/latest/UserGuide/images/console-stacks-actions-detect-drift-1.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                        The Detect drift for current stack command selected on the Stack&#xA;                            actions menu for the selected stack.&#xA;                    " style="max-width:80%" />
                     
                     
                </div>
                <p>CloudFormation displays an information bar stating that drift detection has been
                    initiated for the selected stack.</p>

            </li><li>
                <p>Wait until CloudFormation completes the drift detection operation. When the drift
                    detection operation completes, CloudFormation updates <b>Drift
                        status</b> and <b>Last drift check time</b> for your
                    stack. These fields are listed in the <b>Overview</b> section of
                    the <b>Stack info</b> pane of the stack details page.</p>
                <p>The drift detection operation may take several minutes, depending on the
                    number of resources included in the stack. You can only run a single drift
                    detection operation on a given stack at the same time. CloudFormation continues the
                    drift detection operation even after you dismiss the information bar.</p>
            </li><li>
                <p>Review the drift detection results for the stack and its resources. With your
                    stack selected, from the <b>Stack actions</b> menu select
                        <b>View drift results</b>.</p>
                <p>CloudFormation lists the overall drift status of the stack, in addition to the
                    last time drift detection was initiated on the stack or any of its individual
                    resources. A stack is considered to have drifted if one or more of its resources
                    have drifted.</p>
                <div class="mediaobject">
                     
                        <img src="/images/AWSCloudFormation/latest/UserGuide/images/console-stacks-drifts-overview-1.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                        The Drifts page for the selected stack, showing overall stack drift&#xA;                            status, drift detection status, and the last time drift detection was&#xA;                            initiated on the stack or any of its individual resources.&#xA;                    " style="max-width:80%" />
                     
                     
                </div>

                <p>In the <b>Resource drift status</b> section, CloudFormation lists
                    each stack resource, its drift status, and the last time drift detection was
                    initiated on the resource. The logical ID and physical ID of each resource is
                    displayed to help you identify them. In addition, for resources with a status of
                        <b>MODIFIED</b>, CloudFormation displays resource drift
                    details.</p>
                <p>You can sort the resources based on their drift status using the
                        <b>Drift status</b> column.</p>
                <ol><li>
                        <p>To view the details on a modified resource.</p>
                        <ol><li>
                                <p>With the modified resource selected, select <b>View drift
          details</b>.</p>
                                <p>CloudFormation displays the drift detail page for that resource.
                                    This page lists the resource's expected and current property
                                    values, and any differences between the two.</p>
                                <p>To highlight a difference, in the
                                        <b>Differences</b> section select the property
                                    name.</p>
                                <div class="itemizedlist">
                                     
                                     
                                     
                                <ul class="itemizedlist"><li class="listitem">
                                        <p>Added properties are highlighted in green in the
                                                <b>Current</b> column of the
                                                <b>Details</b> section.</p>
                                    </li><li class="listitem">
                                        <p>Deleted properties are highlighted in red in the
                                                <b>Expected</b> column of the
                                                <b>Details</b> section.</p>
                                    </li><li class="listitem">
                                        <p>Properties whose value have been changed are
                                            highlighted in yellow in the both
                                                <b>Expected</b> and
                                                <b>Current</b> columns.</p>
                                    </li></ul></div>
                            </li></ol>
                    </li></ol>
                <div class="mediaobject">
                     
                        <img src="/images/AWSCloudFormation/latest/UserGuide/images/console-stacks-drifts-drift-details-differences-1.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                        The Resource drift status section of the Drift Details page, which&#xA;                            contains drift information for each resource in the stack that supports&#xA;                            drift detection. Details include drift status and expected and current&#xA;                            property values.&#xA;                    " style="max-width:100%" />
                     
                     
                </div>

            </li></ol></div><div class="procedure"><h6>To detect drift on an entire stack using the AWS CLI</h6><p>To detect drift on an entire stack using the AWS CLI, use the following <code class="code">aws
                    cloudformation</code> commands:</p><div class="itemizedlist">
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p><code class="code">detect-stack-drift</code> to initiate a drift detection operation on
                        a stack.</p>
                </li><li class="listitem">
                    <p><code class="code">describe-stack-drift-detection-status</code> to monitor the status
                        of the stack drift detection operation.</p>
                </li><li class="listitem">
                    <p><code class="code">describe-stack-resource-drifts</code> to review the details of the
                        stack drift detection operation.</p>
                </li></ul></div><ol><li>
                <p>Use the <code class="code">detect-stack-drift</code> to detect drift on an entire stack.
                    Specify the stack name or ARN. You can also specify the logical IDs of any
                    specific resources that you want to use as filters for this drift detection
                    operation.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">aws cloudformation detect-stack-drift --stack-name <code class="replaceable">my-stack-with-resource-drift</code></code>
<code class="computeroutput" copy="false"><span>{</span>
    "StackDriftDetectionId": "624af370-311a-11e8-b6b7-500cexample"
}</code></code></pre>
            </li><li>
                <p>Because stack drift detection operations can be long-running, use
                        <code class="code">describe-stack-drift-detection-status</code> to monitor the status of
                    drift operation. This command takes the stack drift detection ID returned by the
                        <code class="code">detect-stack-drift</code> command.</p>
                <p>In the example below, we've taken the stack drift detection ID returned by the
                        <code class="code">detect-stack-drift</code> example above and passed it as a parameter
                    to <code class="code">describe-stack-drift-detection-status</code>. The parameter returns
                    operation details that show that the drift detection operation has completed, a
                    single stack resource has drifted, and that the entire stack is considered to
                    have drifted as a result.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">aws cloudformation describe-stack-drift-detection-status --stack-drift-detection-id <code class="replaceable">624af370-311a-11e8-b6b7-500cexample</code></code>
<code class="computeroutput" copy="false"><span>{</span>
    "StackId": "arn:aws:cloudformation:us-east-1:099908667365:stack/my-stack-with-resource-drift/489e5570-df85-11e7-a7d9-50example", 
    "StackDriftDetectionId": "624af370-311a-11e8-b6b7-500cexample", 
    "StackDriftStatus": "DRIFTED", 
    "Timestamp": "2018-03-26T17:23:22.279Z", 
    "DetectionStatus": "DETECTION_COMPLETE", 
    "DriftedStackResourceCount": 1
}</code></code></pre>
            </li><li>
                <p>When the stack drift detection operation is complete, use the
                        <code class="code">describe-stack-resource-drifts</code> command to review the results,
                    including actual and expected property values for resources that have
                    drifted.</p>
                <p>The example below uses the <code class="code">stack-resource-drift-status-filters</code>
                    parameter to request stack drift information for those resources that have been
                    modified or deleted. The request returns information on the one resource that
                    has been modified, including details about two of its properties whose values
                    have been changed. No resources have been deleted.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">aws cloudformation describe-stack-resource-drifts --stack-name <code class="replaceable">my-stack-with-resource-drift</code> --stack-resource-drift-status-filters MODIFIED DELETED</code>
<code class="computeroutput" copy="false"><span>{</span>
    "StackResourceDrifts": [
        <span>{</span>
            "StackId": "arn:aws:cloudformation:us-east-1:099908667365:stack/my-stack-with-resource-drift/489e5570-df85-11e7-a7d9-50example", 
            "ActualProperties": "<span>{</span>\"ReceiveMessageWaitTimeSeconds\":0,\"DelaySeconds\":120,\"RedrivePolicy\":<span>{</span>\"deadLetterTargetArn\":\"arn:aws:sqs:us-east-1:099908667365:my-stack-with-resource-drift-DLQ-1BCY7HHD5QIM3\",\"maxReceiveCount\":12},\"MessageRetentionPeriod\":345600,\"MaximumMessageSize\":262144,\"VisibilityTimeout\":60,\"QueueName\":\"my-stack-with-resource-drift-Queue-494PBHCO76H4\"}", 
            "ResourceType": "AWS::SQS::Queue", 
            "Timestamp": "2018-03-26T17:23:34.489Z", 
            "PhysicalResourceId": "https://sqs.us-east-1.amazonaws.com/099908667365/my-stack-with-resource-drift-Queue-494PBHCO76H4", 
            "StackResourceDriftStatus": "MODIFIED", 
            "ExpectedProperties": "<span>{</span>\"ReceiveMessageWaitTimeSeconds\":0,\"DelaySeconds\":20,\"RedrivePolicy\":<span>{</span>\"deadLetterTargetArn\":\"arn:aws:sqs:us-east-1:099908667365:my-stack-with-resource-drift-DLQ-1BCY7HHD5QIM3\",\"maxReceiveCount\":10},\"MessageRetentionPeriod\":345600,\"MaximumMessageSize\":262144,\"VisibilityTimeout\":60,\"QueueName\":\"my-stack-with-resource-drift-Queue-494PBHCO76H4\"}", 
            "PropertyDifferences": [
                <span>{</span>
                    "PropertyPath": "/DelaySeconds", 
                    "ActualValue": "120", 
                    "ExpectedValue": "20", 
                    "DifferenceType": "NOT_EQUAL"
                }, 
                <span>{</span>
                    "PropertyPath": "/RedrivePolicy/maxReceiveCount", 
                    "ActualValue": "12", 
                    "ExpectedValue": "10", 
                    "DifferenceType": "NOT_EQUAL"
                }
            ], 
            "LogicalResourceId": "Queue"
        }
    ]
}</code></code></pre>
            </li></ol></div><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./using-cfn-stack-drift.html">Detecting unmanaged configuration changes to stacks and resources</div><div id="next" class="next-link" accesskey="n" href="./detect-drift-resource.html">Detect drift on individual stack
                resources</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/detect-drift-stack.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>