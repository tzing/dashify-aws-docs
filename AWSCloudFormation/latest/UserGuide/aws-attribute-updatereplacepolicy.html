<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>UpdateReplacePolicy attribute - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="aws-attribute-updatereplacepolicy" /><meta name="default_state" content="aws-attribute-updatereplacepolicy" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" /><meta name="description" content="Specify how to handle resource replacement during stack update operations in AWS CloudFormation by using the UpdateReplacePolicy attribute." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="UpdateReplacePolicy attribute" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>UpdateReplacePolicy attribute - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Template reference",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Resource attribute reference",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-product-attribute-reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "UpdateReplacePolicy attribute",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-product-attribute-reference.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">User Guide</a></div><div id="page-toc-src"><a href="#aws-attribute-updatereplacepolicy-example.json">JSON</a><a href="#aws-attribute-updatereplacepolicy-example.yaml">YAML</a><a href="#aws-attribute-updatereplacepolicy-options">UpdateReplacePolicy options</a></div><div id="page-filters" style="display:none"><filter label="All" id="All"></filter><filter label="JSON" id="JSON"></filter><filter label="YAML" id="YAML"></filter></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="aws-attribute-updatereplacepolicy"><code class="code">UpdateReplacePolicy</code>
            attribute</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Use the <code class="code">UpdateReplacePolicy</code> attribute to retain or, in some cases, backup the
        existing physical instance of a resource when it's replaced during a stack update
        operation.</p><p>When you initiate a stack update, AWS CloudFormation updates resources based on differences between
        what you submit and the stack's current template and parameters. If you update a resource
        property that requires that the resource be <a href="./using-cfn-updating-stacks-update-behaviors.html#update-replacement">replaced</a>, CloudFormation recreates the resource during the update. Recreating the
        resource generates a new physical ID. CloudFormation creates the replacement resource first, and
        then changes references from other dependent resources to point to the replacement resource.
        By default, CloudFormation then deletes the old resource. Using the
            <code class="code">UpdateReplacePolicy</code>, you can specify that CloudFormation retain or, in some
        cases, create a snapshot of the old resource.</p><p>For resources that support snapshots, such as <code class="code">AWS::EC2::Volume</code>, specify
            <code class="code">Snapshot</code> to have CloudFormation create a snapshot before deleting the old
        resource instance.</p><p>You can apply the <code class="code">UpdateReplacePolicy</code> attribute to any resource.
            <code class="code">UpdateReplacePolicy</code> is only executed if you update a resource property
        whose update behavior is specified as <a href="./using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a>, thereby causing CloudFormation to replace the
        old resource with a new one with a new physical ID. For example, if you update the
            <code class="code">Engine</code> property of an <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html">AWS::RDS::DBInstance</a> resource type, CloudFormation creates a new resource and
        replaces the current DB instance resource with the new one. The
            <code class="code">UpdateReplacePolicy</code> attribute would then dictate whether CloudFormation
        deleted, retained, or created a snapshot of the old DB instance. The update behavior for
        each property of a resource is specified in the reference topic for that resource in the
            <a href="./aws-template-resource-type-ref.html">AWS resource and property types reference</a>. For more information on resource
        update behavior, see <a href="./using-cfn-updating-stacks-update-behaviors.html">Update behaviors of stack
         resources</a>.</p><p>The <code class="code">UpdateReplacePolicy</code> attribute applies to <a href="./using-cfn-updating-stacks-direct.html">stack updates you perform directly</a>, in
        addition to stack updates performed using <a href="./using-cfn-updating-stacks-changesets.html">change sets</a>.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Resources that are retained continue to exist and continue to incur applicable charges
            until you delete those resources. Snapshots that are created with this policy continue
            to exist and continue to incur applicable charges until you delete those snapshots.
                <code class="code">UpdateReplacePolicy</code> retains the old physical resource or snapshot, but
            removes it from CloudFormation's scope.</p></div></div><p><code class="code">UpdateReplacePolicy</code> differs from the <a href="./aws-attribute-deletionpolicy.html">DeletionPolicy</a> attribute in that it only applies
        to resources replaced during stack updates. Use DeletionPolicy for resources deleted when a
        stack is deleted, or when the resource definition itself is deleted from the template as
        part of a stack update.</p><p>The following snippet contains an Amazon RDS database instance resource with a
            <code class="code">Retain</code> policy for replacement. When this resource is replaced with a new
        resource with a new physical ID, CloudFormation leaves the old database instance without
        deleting it.</p><div id="JSON" name="JSON" class="section langfilter">
        <h2 id="aws-attribute-updatereplacepolicy-example.json">JSON</h2>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Resources" : <span>{</span>
    "myDB" : <span>{</span>
      "Type" : "AWS::RDS::DBInstance",
      "DeletionPolicy" : "Retain",
      "UpdateReplacePolicy" : "Retain",
      "Properties" : <span>{</span>}
    }
  }
}</code></pre>
    </div><div id="YAML" name="YAML" class="section langfilter">
        <h2 id="aws-attribute-updatereplacepolicy-example.yaml">YAML</h2>

        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWSTemplateFormatVersion: 2010-09-09
Resources:
  myDB:
    Type: 'AWS::RDS::DBInstance'
    DeletionPolicy: Retain
    UpdateReplacePolicy: Retain
    Properties: <span>{</span>} </code></pre>
    </div>
        <h2 id="aws-attribute-updatereplacepolicy-options"><code class="code">UpdateReplacePolicy</code> options</h2>

        <div class="variablelist">
             
             
             
        <dl>
                <dt><span class="term">Delete</span></dt>
                <dd>
                    <p>CloudFormation deletes the resource and all its content if applicable during
                        resource replacement. You can add this policy to any resource type. By
                        default, if you don't specify an <code class="code">UpdateReplacePolicy</code>,
                        CloudFormation deletes your resources. However, be aware of the following
                        consideration:</p>
                    <p>For Amazon S3 buckets, you must delete all objects in the bucket for deletion
                        to succeed.</p>
                </dd>
             
                <dt><span class="term">Retain</span></dt>
                <dd>
                    <p>CloudFormation keeps the resource without deleting the resource or its
                        contents when the resource is replaced. You can add this policy to any
                        resource type. Resources that are retained continue to exist and continue to
                        incur applicable charges until you delete those resources.</p>
                    <p>If a resource is replaced, the <code class="code">UpdateReplacePolicy</code> retains
                        the old physical resource but removes it from CloudFormation's scope.</p>
                </dd>
             
                <dt><span class="term">Snapshot</span></dt>
                <dd>
                    <p>For resources that support snapshots, CloudFormation creates a snapshot for
                        the resource before deleting it. Snapshots that are created with this policy
                        continue to exist and continue to incur applicable charges until you delete
                        those snapshots.</p>
                    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If you specify the <code class="code">Snapshot</code> option in the
                                <code class="code">UpdateReplacePolicy</code> for a resource that doesn't support
                            snapshots, CloudFormation reverts to the default option, which is
                                <code class="code">Delete</code>.</p></div></div>
                    <p>Resources that support snapshots include:</p>
                    <div class="itemizedlist">
                         
                         
                         
                         
                         
                         
                         
                    <ul class="itemizedlist"><li class="listitem">
                            <p><code class="code"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-ebs-volume.html">AWS::EC2::Volume</a></code></p>
                        </li><li class="listitem">
                            <p><code class="code"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-elasticache-cache-cluster.html">AWS::ElastiCache::CacheCluster</a></code></p>
                        </li><li class="listitem">
                            <p><code class="code"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticache-replicationgroup.html">AWS::ElastiCache::ReplicationGroup</a></code></p>
                        </li><li class="listitem">
                            <p><code class="code"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-neptune-dbcluster.html">AWS::Neptune::DBCluster</a></code></p>
                        </li><li class="listitem">
                            <p><code class="code"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-rds-dbcluster.html">AWS::RDS::DBCluster</a></code></p>
                        </li><li class="listitem">
                            <p><code class="code"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html">AWS::RDS::DBInstance</a></code></p>
                        </li><li class="listitem">
                            <p><code class="code"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-redshift-cluster.html">AWS::Redshift::Cluster</a></code></p>
                        </li></ul></div>
                </dd>
            </dl></div>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./aws-attribute-updatepolicy.html">UpdatePolicy</div><div id="next" class="next-link" accesskey="n" href="./intrinsic-function-reference.html">Intrinsic functions</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-attribute-updatereplacepolicy.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>