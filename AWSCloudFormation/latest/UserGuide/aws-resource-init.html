<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS::CloudFormation::Init - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="aws-resource-init" /><meta name="default_state" content="aws-resource-init" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="description" content="Include metadata on an Amazon EC2 instance for the cfn-init helper script by using the AWS::CloudFormation::Init resource type." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="AWS::CloudFormation::Init" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS::CloudFormation::Init - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Working with AWS CloudFormation templates",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Template anatomy",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-anatomy.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Metadata",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/metadata-section-structure.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "AWS::CloudFormation::Init",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/metadata-section-structure.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">User Guide</a></div><div id="page-toc-src"><a href="#aws-resource-cloudformation-init-syntax">Syntax</a><a href="#aws-resource-init-configsets">Configsets</a><a href="#aws-resource-init-commands">Commands</a><a href="#aws-resource-init-files">Files</a><a href="#aws-resource-init-groups">Groups</a><a href="#aws-resource-init-packages">Packages</a><a href="#aws-resource-init-services">Services</a><a href="#aws-resource-init-sources">Sources</a><a href="#aws-resource-init-users">Users</a></div><div id="page-filters" style="display:none"><filter label="All" id="All"></filter><filter label="JSON" id="JSON"></filter><filter label="YAML" id="YAML"></filter></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="aws-resource-init"><code class="code">AWS::CloudFormation::Init</code></h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Use the <code class="code">AWS::CloudFormation::Init</code> type to include metadata on an Amazon EC2
      instance for the cfn-init helper script. If your template calls the cfn-init script, the
      script looks for resource metadata rooted in the <code class="code">AWS::CloudFormation::Init</code> metadata key. For
      more information about cfn-init, see <a href="./cfn-init.html">cfn-init</a>.</p><p>cfn-init supports all metadata types for Linux systems. It supports metadata types for
      Windows with conditions that are described in the sections that follow.</p><p>For an example of using <code class="code">AWS::CloudFormation::Init</code> and the cfn-init helper
      script, see <a href="./deploying.applications.html">Deploying applications on Amazon EC2 with AWS CloudFormation</a>.</p><p>For an example that shows how to use cfn-init to create a Windows stack, see <a href="./cfn-windows-stacks-bootstrapping.html">Bootstrapping AWS CloudFormation Windows stacks</a>.</p>
      <h2 id="aws-resource-cloudformation-init-syntax">Syntax</h2>

      <p>The configuration is separated into sections. The following template snippet shows how
         you can attach metadata for cfn-init to an EC2 instance resource within the
         template.</p>
      <p>The metadata is organized into config keys, which you can group into configsets. You can
         specify a configset when you call cfn-init in your template. If you don't specify a
         configset, cfn-init looks for a single config key named <em>config</em>.</p>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The cfn-init helper script processes these configuration sections in the following
            order: packages, groups, users, sources, files, commands, and then services. If you
            require a different order, separate your sections into different config keys, and then
            use a configset that specifies the order in which the config keys should be
            processed.</p></div></div>

      <div id="JSON" name="JSON" class="section langfilter">
         <h3 id="aws-resource-cloudformation-init-syntax.json">JSON</h3>

         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Resources": <span>{</span>
  "MyInstance": <span>{</span>
    "Type": "AWS::EC2::Instance",
    "Metadata" : <span>{</span>
      "AWS::CloudFormation::Init" : <span>{</span>
        "config" : <span>{</span>
          "packages" : <span>{</span>
            :
          },
          "groups" : <span>{</span>
            :
          },
          "users" : <span>{</span>
            :
          },
          "sources" : <span>{</span>
            :
          },
          "files" : <span>{</span>
            :
          },
          "commands" : <span>{</span>
            :
          },
          "services" : <span>{</span>
            :
          }
        }
      }
    },
    "Properties": <span>{</span>
      :
    }
  }
}</code></pre>
      </div>
      <div id="YAML" name="YAML" class="section langfilter">
         <h3 id="aws-resource-cloudformation-init-syntax.yaml">YAML</h3>

         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Resources: 
  MyInstance: 
    Type: AWS::EC2::Instance
    Metadata: 
      AWS::CloudFormation::Init: 
        config: 
          packages: 
            :
          groups: 
            :
          users: 
            :
          sources: 
            :
          files: 
            :
          commands: 
            :
          services: 
            :
    Properties: 
      :</code></pre>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>To specify the <code class="code">AWS::CloudFormation::Init</code> property for an Amazon EC2
               instances, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-init.html#cfn-init-Examples">Amazon
                  Linux example</a>.</p></div></div>
      </div>
    
      <h2 id="aws-resource-init-configsets">Configsets</h2>

      <p>If you want to create more than one config key and to have cfn-init process them in a
         specific order, create a configset that contains the config keys in the desired
         order.</p>
       
         <h3 id="w9aac23c15c15c23c13b5">Single configset</h3>

         <p>The following template snippet creates configsets named <code class="code">ascending</code> and
               <code class="code">descending</code> that each contain two config keys.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example1.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"AWS::CloudFormation::Init" : <span>{</span>
    "configSets" : <span>{</span>
        "ascending" : [ "config1" , "config2" ],
        "descending" : [ "config2" , "config1" ]
    },
    "config1" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$CFNTEST\" &gt; test.txt",
                "env" : <span>{</span> "CFNTEST" : "I come from config1." },
                "cwd" : "~"
            }
        }
    },
    "config2" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$CFNTEST\" &gt; test.txt",
                "env" : <span>{</span> "CFNTEST" : "I come from config2" },
                "cwd" : "~"
            }
        }
    }
}     </code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example1.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWS::CloudFormation::Init: 
  configSets: 
    ascending: 
      - "config1"
      - "config2"
    descending: 
      - "config2"
      - "config1"
  config1: 
    commands: 
      test: 
        command: "echo \"$CFNTEST\" &gt; test.txt"
        env: 
          CFNTEST: "I come from config1."
        cwd: "~"
  config2: 
    commands: 
      test: 
        command: "echo \"$CFNTEST\" &gt; test.txt"
        env: 
          CFNTEST: "I come from config2"
        cwd: "~"</code></pre>
         </div>
          
            <h4 id="w9aac23c15c15c23c13b5b9">Related cfn-init calls</h4>

            <p>The following example calls to cfn-init refer to the preceding example configsets.
               The example calls are abbreviated for clarity, see <a href="./cfn-init.html">cfn-init</a> for the complete syntax.</p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>If a call to cfn-init specifies the <code class="code">ascending</code> configset:</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c ascending</code></code></pre>
                  <p>The script processes <code class="code">config1</code> and then processes
                        <code class="code">config2</code> and the test.txt file would contain the text <code class="code">I
                        come from config2</code>.</p>
               </li><li class="listitem">
                  <p>If a call to cfn-init specifies the <code class="code">descending</code>
                     configset:</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c descending</code></code></pre>
                  <p>The script processes <code class="code">config2</code> and then processes
                        <code class="code">config1</code> and the test.txt file would contain the text <code class="code">I
                        come from config1</code>.</p>
               </li></ul></div>
          
       
       
         <h3 id="w9aac23c15c15c23c13b7">Multiple configsets</h3>

         <p>You can create multiple configsets, and call a series of them using your cfn-init
            script. Each configset can contain a list of config keys or references to other
            configsets. For example, the following template snippet creates three configsets. The
            first configset, <code class="code">test1</code>, contains one config key named <code class="code">1</code>. The
            second configset, <code class="code">test2</code>, contains a reference to the <code class="code">test1</code>
            configset and one config key named <code class="code">2</code>. The third configset, default,
            contains a reference to the configset <code class="code">test2</code>.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example2.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"AWS::CloudFormation::Init" : <span>{</span>
    "configSets" : <span>{</span>
        "test1" : [ "1" ],
        "test2" : [ <span>{</span> "ConfigSet" : "test1" }, "2" ],
        "default" : [ <span>{</span> "ConfigSet" : "test2" } ]
    },
    "1" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$MAGIC\" &gt; test.txt",
                "env" : <span>{</span> "MAGIC" : "I come from the environment!" },
                "cwd" : "~"
            }
        }
    },
    "2" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$MAGIC\" &gt;&gt; test.txt",
                "env" : <span>{</span> "MAGIC" : "I am test 2!" },
                "cwd" : "~"
            }
        }
    }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example2.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWS::CloudFormation::Init:
  1:
    commands:
      test:
        command: "echo \"$MAGIC\" &gt; test.txt"
        env:
          MAGIC: "I come from the environment!"
        cwd: "~"
  2:
    commands:
      test:
        command: "echo \"$MAGIC\" &gt;&gt; test.txt"
        env:
          MAGIC: "I am test 2!"
        cwd: "~"
  configSets: 
    test1:
      - "1"
    test2:
      -
        ConfigSet: "test1"
      - "2"
    default:
      -
        ConfigSet: "test2"</code></pre>
         </div>
          
            <h4 id="w9aac23c15c15c23c13b7b9">Related cfn-init calls</h4>

            <p>The following calls to cfn-init refer to the configSets declared in the preceding
               template snippet. The example calls are abbreviated for clarity, see <a href="./cfn-init.html">cfn-init</a> for the complete syntax.</p>
            <div class="itemizedlist">
                
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>If you specify <code class="code">test1</code> only:</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c test1</code></code></pre>
                  <p>cfn-init processes config key <code class="code">1</code> only.</p>
               </li><li class="listitem">
                  <p>If you specify <code class="code">test2</code> only:</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c test2</code></code></pre>
                  <p>cfn-init processes config key <code class="code">1</code> and then processes config key
                        <code class="code">2</code>.</p>
               </li><li class="listitem">
                  <p>If you specify the <code class="code">default</code> configset (or no configsets at
                     all):</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c default</code></code></pre>
                  <p>You'll get the same behavior that you would if you specify configset
                        <code class="code">test2</code>.</p>
               </li></ul></div>
          
       
    
      <h2 id="aws-resource-init-commands">Commands</h2>

      <p>You can use the commands key to run commands on the EC2 instance. The commands are
         processed in alphabetical order by name.</p>
      <div class="table-container"><div class="table-contents"><table id="w1355aac23c15c15c23c15b5"><thead>
               <tr>
                  <th>Key</th>
                  <th>Required</th>
                  <th>Description</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>command</p>
                  </td>
                  <td tabindex="-1">Required</td>
                  <td tabindex="-1">
                     <p>Either an array or a string specifying the command to run. If you use an
                        array, you don't need to escape space characters or enclose command
                        parameters in quotes. Don't use the array to specify multiple
                        commands.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>env</p>
                  </td>
                  <td tabindex="-1">Optional</td>
                  <td tabindex="-1">
                     <p>Sets environment variables for the command. This property overwrites,
                        rather than appends, the existing environment.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>cwd</p>
                  </td>
                  <td tabindex="-1">Optional</td>
                  <td tabindex="-1">
                     <p>The working directory.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>test</p>
                  </td>
                  <td tabindex="-1">Optional</td>
                  <td tabindex="-1">
                     <p>A test command that determines whether cfn-init runs commands that are
                        specified in the command key. If the test passes, cfn-init runs the
                        commands. The cfn-init script runs the test in a command interpreter, such
                        as Bash or <code>cmd.exe</code>. Whether a test passes depends on
                        the exit code that the interpreter returns.</p>
                     <p>For Linux, the test command must return an exit code of <code class="code">0</code>
                        for the test to pass. For Windows, the test command must return an
                        %ERRORLEVEL% of <code class="code">0</code>.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>ignoreErrors</p>
                  </td>
                  <td tabindex="-1">Optional</td>
                  <td tabindex="-1">
                     <p>A Boolean value that determines whether cfn-init continues to run if the
                        command contained in the command key fails (returns a non-zero value).
                        Set to <code class="code">true</code> if you want cfn-init to continue running even if
                        the command fails. Set to <code class="code">false</code> if you want cfn-init to stop
                        running if the command fails. The default value is
                        <code class="code">false</code>.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>waitAfterCompletion</p>
                  </td>
                  <td tabindex="-1">Optional</td>
                  <td tabindex="-1">
                     <p>For Windows systems only. Specifies how long to wait (in seconds) after a
                        command has finished in case the command causes a reboot. The default value
                        is 60 seconds and a value of "forever" directs cfn-init to exit and resume
                        only after the reboot is complete. Set this value to <code class="code">0</code> if you
                        don't want to wait for every command.</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="w9aac23c15c15c23c15b7">Example</h3>

         <p>The following example snippet calls the echo command if the <code class="code">~/test.txt</code>
            file doesn't exist.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-commands-example.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"commands" : <span>{</span>
    "test" : <span>{</span>
        "command" : "echo \"$MAGIC\" &gt; test.txt",
        "env" : <span>{</span> "MAGIC" : "I come from the environment!" },
        "cwd" : "~",
        "test" : "test ! -e ~/test.txt",
        "ignoreErrors" : "false"
    },
    "test2" : <span>{</span>
        "command" : "echo \"$MAGIC2\" &gt; test2.txt",
        "env" : <span>{</span> "MAGIC2" : "I come from the environment!" },
        "cwd" : "~",
        "test" : "test ! -e ~/test2.txt",
        "ignoreErrors" : "false"
    }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-commands-example.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">commands:
  test:
    command: "echo \"$MAGIC\" &gt; test.txt"
    env:
      MAGIC: "I come from the environment!"
    cwd: "~"
    test: "test ! -e ~/test.txt"
    ignoreErrors: "false"
  test2:
    command: "echo \"$MAGIC2\" &gt; test2.txt"
    env:
      MAGIC2: "I come from the environment!"
    cwd: "~"
    test: "test ! -e ~/test2.txt"
    ignoreErrors: "false"</code></pre>
         </div>
       
    
      <h2 id="aws-resource-init-files">Files</h2>

      <p>You can use the <code class="code">files</code> key to create files on the EC2 instance. The content
         can be either inline in the template or the content can be pulled from a URL. The files are
         written to disk in lexicographic order. The following table lists the supported
         keys.</p>
      <div class="table-container"><div class="table-contents"><table id="w1355aac23c15c15c23c17b5"><thead>
               <tr>
                  <th>Key</th>
                  <th>Description</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>content</p>
                  </td>
                  <td tabindex="-1">
                     <p>Either a string or a properly formatted JSON object. If you use a JSON object as your
        content, the JSON will be written to a file on disk. Any intrinsic functions such as <code class="code">Fn::GetAtt</code> or
         <code class="code">Ref</code> are evaluated before the JSON object is written to disk. When you create a symlink, specify
        the symlink target as the content.</p>
                     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If you create a symlink, the helper script modifies the permissions of
                           the target file. Currently, you can't create a symlink without modifying
                           the permissions of the target file.</p></div></div>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>source</p>
                  </td>
                  <td tabindex="-1">
                     <p>A URL to load the file from. This option can't be specified with the
                        content key.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>encoding</p>
                  </td>
                  <td tabindex="-1">
                     <p>The encoding format. Only used if the content is a string. Encoding isn't
                        applied if you are using a source.</p>
                     <p>Valid values: <code class="code">plain</code> | <code class="code">base64</code></p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>group</p>
                  </td>
                  <td tabindex="-1">
                     <p>The name of the owning group for this file. Not supported for Windows
                        systems.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>owner</p>
                  </td>
                  <td tabindex="-1">
                     <p>The name of the owning user for this file. Not supported for Windows
                        systems.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>mode</p>
                  </td>
                  <td tabindex="-1">
                     <p>A six-digit octal value representing the mode for this file. Not
                        supported for Windows systems. Use the first three digits for symlinks and
                        the last three digits for setting permissions. To create a symlink, specify
                              <code class="userinput">120<code class="replaceable">xxx</code></code>, where
                           <code class="code">xxx</code> defines the permissions of the target file. To specify
                        permissions for a file, use the last three digits, such as
                           <code class="userinput">000644</code>.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>authentication</p>
                  </td>
                  <td tabindex="-1">
                     <p>The name of an authentication method to use. This overrides any default
                        authentication. You can use this property to select an authentication method
                        you define with the <a href="./aws-resource-authentication.html">AWS::CloudFormation::Authentication</a> resource.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>context</p>
                  </td>
                  <td tabindex="-1">
                     <p>Specifies a context for files that are to be processed as <a href="http://mustache.github.io/mustache.5.html" rel="noopener noreferrer" target="_blank"><span>Mustache
                           templates</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. To use this key, you must have installed
                           <code class="code">aws-cfn-bootstrap</code> 1.3 –11 or later in addition to
                           <a href="https://github.com/defunkt/pystache" rel="noopener noreferrer" target="_blank"><span>pystache</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="w9aac23c15c15c23c17b7">Examples</h3>

         <p>The following example snippet creates a file named setup.mysql as part of a larger
            installation.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-setup-mysql.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"files" : <span>{</span>
  "/tmp/setup.mysql" : <span>{</span>
    "content" : <span>{</span> "Fn::Join" : ["", [
      "CREATE DATABASE ", <span>{</span> "Ref" : "DBName" }, ";\n",
      "CREATE USER '", <span>{</span> "Ref" : "DBUsername" }, "'@'localhost' IDENTIFIED BY '",
                       <span>{</span> "Ref" : "DBPassword" }, "';\n",
      "GRANT ALL ON ", <span>{</span> "Ref" : "DBName" }, ".* TO '", <span>{</span> "Ref" : "DBUsername" },
                       "'@'localhost';\n",
      "FLUSH PRIVILEGES;\n"
      ]]},
    "mode"  : "000644",
    "owner" : "root",
    "group" : "root"
  }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-setup-mysql.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">files: 
  /tmp/setup.mysql: 
    content: !Sub |
      CREATE DATABASE $<span>{</span>DBName};
      CREATE USER '$<span>{</span>DBUsername}'@'localhost' IDENTIFIED BY '$<span>{</span>DBPassword}';
      GRANT ALL ON $<span>{</span>DBName}.* TO '$<span>{</span>DBUsername}'@'localhost';
      FLUSH PRIVILEGES;
    mode: "000644"
    owner: "root"
    group: "root"</code></pre>
         </div>
         <p>The full template is available at: <a href="https://s3.amazonaws.com/cloudformation-templates-us-east-1/Drupal_Single_Instance.template" rel="noopener noreferrer" target="_blank"><span>https://s3.amazonaws.com/cloudformation-templates-us-east-1/Drupal_Single_Instance.template</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
         <p>The following example snippet creates a symlink <code class="code">/tmp/myfile2.txt</code> that
            points at an existing file <code class="code">/tmp/myfile1.txt</code>. The permissions of the target
            file <code class="code">/tmp/myfile1.txt</code> is defined by the mode value <code class="code">644</code>.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-symlink.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"files" : <span>{</span>
  "/tmp/myfile2.txt" : <span>{</span>
    "content" : "/tmp/myfile1.txt",
    "mode" : "120644"
  }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-symlink.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">files:
  /tmp/myfile2.txt:
    content: "/tmp/myfile1.txt"
    mode: "120644"</code></pre>
         </div>
         <p>Mustache templates are used primarily to create configuration files. For example, you
            can store a configuration file in an S3 bucket and interpolate Refs and GetAtts from the
            template, instead of using <a href="./intrinsic-function-reference-join.html">Fn::Join</a>. The following example snippet
            outputs "Content for test9" to <code>/tmp/test9.txt</code>.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-test9.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">
"files" : <span>{</span>
    "/tmp/test9.txt" : <span>{</span>
        "content" : "Content for <span>{</span><span>{</span>name}}",
        "context" : <span>{</span> "name" : "test9" }
    }
} </code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-test9.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">files:
  /tmp/test9.txt:
    content: "Content for <span>{</span><span>{</span>name}}"
    context:
      name: "test9"</code></pre>
         </div>
         <p>When working with Mustache templates, note the following:</p>
         <div class="itemizedlist">
             
             
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>The context key must be present for the files to be processed.</p>
            </li><li class="listitem">
               <p>The context key must be a key-value map, but it can be nested.</p>
            </li><li class="listitem">
               <p>You can process files with inline content by using the content key and remote
                  files by using the source key.</p>
            </li><li class="listitem">
               <p>Mustache support depends on the pystache version. Version 0.5.2 supports the
                     <a href="https://github.com/mustache/spec/tree/v1.1.2" rel="noopener noreferrer" target="_blank"><span>Mustache 1.1.2
                     specification</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
            </li></ul></div>
       
    
      <h2 id="aws-resource-init-groups">Groups</h2>

      <p>You can use the groups key to create Linux/UNIX groups and to assign group IDs. The
         groups key isn't supported for Windows systems.</p>
      <p>To create a group, add a new key-value pair that maps a new group name to an optional
         group ID. The groups key can contain one or more group names. The following table lists the
         available keys.</p>
      <div class="table-container"><div class="table-contents"><table id="w1355aac23c15c15c23c19b7"><thead>
               <tr>
                  <th>Key</th>
                  <th>Description</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>
                        <code class="code">gid</code></p>
                  </td>
                  <td tabindex="-1">
                     <p>A group ID number.</p>
                     <p>If a group ID is specified, and the group already exists by name, the
                        group creation will fail. If another group has the specified group ID, the
                        OS may reject the group creation.</p>
                     <p>Example: <code class="code"><span>{</span> "gid" : "23" }</code></p>
                  </td>
               </tr>
            </table></div></div>
      
       
         <h3 id="aws-resource-init-groups-snippet">Example snippet</h3>

         <p>The following snippet specifies a group named <code class="code">groupOne</code> without assigning
            a group ID and a group named <code class="code">groupTwo</code> that specified a group ID value of
               <code class="code">45</code>.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-groups-snippet.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"groups" : <span>{</span>
    "groupOne" : <span>{</span>},
    "groupTwo" : <span>{</span> "gid" : "45" }
}</code></pre>
         </div>
         
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-groups-snippet.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">groups:
  groupOne: <span>{</span>}
  groupTwo:
    gid: "45"</code></pre>
         </div>
       
    
      <h2 id="aws-resource-init-packages">Packages</h2>

      <p>You can use the packages key to download and install pre-packaged applications and
         components. On Windows systems, the packages key supports only the MSI installer.</p>
       
         <h3 id="aws-resource-init-packages-formats">Supported package formats</h3>

         <p>The cfn-init script currently supports the following package formats: apt, msi,
            python, rpm, rubygems, yum, and Zypper. Packages are processed in the following order:
            rpm, yum/apt/zypper, and then rubygems and python. There is no ordering between rubygems
            and python, and packages within each package manager aren't guaranteed to be installed
            in any order.</p>
       
       
         <h3 id="aws-resource-init-packages-versions">Specifying versions</h3>

         <p>Within each package manager, each package is specified as a package name and a list
            of versions. The version can be a string, a list of versions, or an empty string or
            list. An empty string or list indicates that you want the latest version. For rpm
            manager, the version is specified as a path to a file on disk or a URL.</p>
         <p>If you specify a version of a package, cfn-init will attempt to install that version
            even if a newer version of the package is already installed on the instance. Some
            package managers support multiple versions, but others may not. Verify the documentation
            for your package manager for more information. If you don't specify a version and a
            version of the package is already installed, the cfn-init script won't install a new
            version— it will assume that you want to keep and use the existing version.</p>
       
       
         <h3 id="aws-resource-init-packages-snippet">Example snippets</h3>

          
            <h4 id="w9aac23c15c15c23c21b9b3">RPM, yum, Rubygems, and Zypper</h4>

            <p>The following snippet specifies a version URL for rpm, requests the latest
               versions from yum and Zypper, and version 0.10.2 of chef from rubygems:</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-packages-example1.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"rpm" : <span>{</span>
  "epel" : "http://download.fedoraproject.org/pub/epel/5/i386/epel-release-5-4.noarch.rpm"
},
"yum" : <span>{</span>
  "httpd" : [],
  "php" : [],
  "wordpress" : []
},
"rubygems" : <span>{</span>
  "chef" : [ "0.10.2" ]
},
"zypper" : <span>{</span>
  "git" : []
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-packages-example1.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">rpm:
  epel: "http://download.fedoraproject.org/pub/epel/5/i386/epel-release-5-4.noarch.rpm"
yum:
  httpd: []
  php: []
  wordpress: []
rubygems:
  chef:
    - "0.10.2"
zypper:
  git: []</code></pre>
            </div>
          
          
            <h4 id="w9aac23c15c15c23c21b9b5">MSI package</h4>

            <p>The following snippet specifies a URL for an MSI package:</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-packages-example2.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"msi" : <span>{</span>
  "awscli" : "https://s3.amazonaws.com/aws-cli/AWSCLI64.msi"
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-packages-example2.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">msi:
  awscli: "https://s3.amazonaws.com/aws-cli/AWSCLI64.msi"</code></pre>
            </div>
          
       
    
      <h2 id="aws-resource-init-services">Services</h2>

      <p>You can use the services key to define which services should be enabled or disabled when
         the instance is launched. On Linux systems, this key is supported by using sysvinit or
         systemd. On Windows systems, it's supported by using the Windows service manager.</p>
      <p>The services key also allows you to specify dependencies on sources, packages, and files
         so that if a restart is needed due to files being installed, cfn-init will take care of the
         service restart. For example, if you download the Apache HTTP Server package, the package
         installation will automatically start the Apache HTTP Server during the stack creation
         process. However, if the Apache HTTP Server configuration is updated later in the stack
         creation process, the update won't take effect unless the Apache server is restarted. You
         can use the services key to ensure that the Apache HTTP service is restarted.</p>
      <p>The following table lists the supported keys.</p>
      <div class="table-container"><div class="table-contents"><table id="w1355aac23c15c15c23c23b9"><thead>
               <tr>
                  <th>Key</th>
                  <th>Description</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>ensureRunning</p>
                  </td>
                  <td tabindex="-1">
                     <p>Set to true to ensure that the service is running after cfn-init
                        finishes.</p>
                     <p>Set to false to ensure that the service isn't running after cfn-init
                        finishes.</p>
                     <p>Omit this key to make no changes to the service state.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>enabled</p>
                  </td>
                  <td tabindex="-1">
                     <p>Set to true to ensure that the service will be started automatically upon
                        boot.</p>
                     <p>Set to false to ensure that the service won't be started automatically
                        upon boot.</p>
                     <p>Omit this key to make no changes to this property.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>files</p>
                  </td>
                  <td tabindex="-1">
                     <p>A list of files. If cfn-init changes one directly through the files
                        block, this service will be restarted.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>sources</p>
                  </td>
                  <td tabindex="-1">
                     <p>A list of directories. If cfn-init expands an archive into one of these
                        directories, this service will be restarted.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>packages</p>
                  </td>
                  <td tabindex="-1">
                     <p>A map of package manager to list of package names. If cfn-init installs
                        or updates one of these packages, this service will be restarted.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>commands</p>
                  </td>
                  <td tabindex="-1">
                     <p>A list of command names. If cfn-init runs the specified command, this
                        service will be restarted.</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="w9aac23c15c15c23c23c11">Examples</h3>

          
            <h4 id="w9aac23c15c15c23c23c11b3">Linux</h4>

            <p>The following Linux snippet configures the services as follows:</p>
            <div class="itemizedlist">
                
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>The nginx service will be restarted if either
                        <code class="code">/etc/nginx/nginx.conf</code> or <code class="code">/var/www/html</code> are
                     modified by cfn-init.</p>
               </li><li class="listitem">
                  <p>The php-fastcgi service will be restarted if cfn-init installs or updates
                     php or spawn-fcgi using yum.</p>
               </li><li class="listitem">
                  <p>The sendmail service will be stopped and disabled using systemd.</p>
               </li></ul></div>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-services-example1.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"services" : <span>{</span>
  "sysvinit" : <span>{</span>
    "nginx" : <span>{</span>
      "enabled" : "true",
      "ensureRunning" : "true",
      "files" : ["/etc/nginx/nginx.conf"],
      "sources" : ["/var/www/html"]
    },
    "php-fastcgi" : <span>{</span>
      "enabled" : "true",
      "ensureRunning" : "true",
      "packages" : <span>{</span> "yum" : ["php", "spawn-fcgi"] }
    }
  },
  "systemd": <span>{</span>
    "sendmail" : <span>{</span>
      "enabled" : "false",
      "ensureRunning" : "false"
    }
  }
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-services-example1.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">services:
  sysvinit:
    nginx:
      enabled: "true"
      ensureRunning: "true"
      files:
        - "/etc/nginx/nginx.conf"
      sources:
        - "/var/www/html"
    php-fastcgi:
      enabled: "true"
      ensureRunning: "true"
      packages:
        yum:
          - "php"
          - "spawn-fcgi"
  systemd:
    sendmail:
      enabled: "false"
      ensureRunning: "false"</code></pre>
               <p>To use systemd with a service, the service must have a systemd unit file configured. The following
                unit file allows systemd to start and stop the <a href="./cfn-hup.html">cfn-hup</a> daemon in the multi-user
                service target:</p>
                  
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="conf ">[Unit]
Description=cfn-hup daemon
[Service]
ExecStart=/usr/bin/cfn-hup -v
PIDFile=/var/run/cfn-hup.pid
[Install]
WantedBy=multi-user.target</code></pre>
               <p>This configuration assumes that cfn-hup is installed under the
                     <em>/usr/bin</em> directory. However, the actual location where
                  cfn-hup is installed might vary on different platforms. You can override this
                  configuration by creating an override file in
                     <em>/etc/systemd/system/cfn-hup.service.d/override.conf</em> as
                  follows:</p>
                  
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="conf "># In this example, cfn-hup executable is available under /usr/local/bin
[Service]
ExecStart=
ExecStart=/usr/local/bin/cfn-hup -v</code></pre>
            </div>
          
          
            <h4 id="aws-resource-init-windows-example">Windows</h4>

            <p>The following Windows snippet starts the <a href="./cfn-hup.html">cfn-hup</a> service, sets it to automatic, and restarts the service
               if <code class="code">cfn-init</code> modifies the specified configuration files:</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-services-example2.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"services" : <span>{</span>
  "windows" : <span>{</span>
    "cfn-hup" : <span>{</span>
      "enabled" : "true",
      "ensureRunning" : "true",
      "files" : ["c:\\cfn\\cfn-hup.conf", "c:\\cfn\\hooks.d\\cfn-auto-reloader.conf"]
    }
  }
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-services-example2.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">services:
  windows:
    cfn-hup:
      enabled: "true"
      ensureRunning: "true"
      files:
        - "c:\\cfn\\cfn-hup.conf"
        - "c:\\cfn\\hooks.d\\cfn-auto-reloader.conf"</code></pre>
            </div>
          
       
    
      <h2 id="aws-resource-init-sources">Sources</h2>

      <p>You can use the sources key to download an archive file and unpack it in a target
         directory on the EC2 instance. This key is fully supported for both Linux and Windows
         systems.</p>
       
         <h6>Supported formats</h6>
         <p>Supported formats are:</p>
       
      <div class="itemizedlist">
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><code class="code">tar</code></p>
         </li><li class="listitem">
            <p><code class="code">tar+gzip</code></p>
         </li><li class="listitem">
            <p><code class="code">tar+bz2</code></p>
         </li><li class="listitem">
            <p><code class="code">zip</code></p>
         </li></ul></div>
     
         <h3 id="aws-resource-init-sources-examples">Examples</h3>
      
            <h4 id="aws-resource-init-sources-examples-github">GitHub</h4>
            <p>If you use GitHub as a source control system, you can use cfn-init and the sources
               package mechanism to pull a specific version of your application. GitHub allows you
               to create a .zip or a .tar from a specific version through a URL as follows:</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="text ">https://github.com/&lt;your directory&gt;/(zipball|tarball)/&lt;version&gt;</code></pre>
            <p>For example, the following snippet pulls down version <em>main</em> as
               a <code>.tar</code> file.</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-sources-example1.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"sources" : <span>{</span>
  "/etc/puppet" : "https://github.com/user1/cfn-demo/tarball/main"
  }</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-sources-example1.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">sources:
  /etc/puppet: "https://github.com/user1/cfn-demo/tarball/main"</code></pre>
            </div>
          
      
            <h4 id="aws-resource-init-sources-examples-s3">S3 Bucket</h4>
            <p>The following example downloads a tarball from an S3 bucket and unpacks it into
                  <code class="code">/etc/myapp</code>:</p>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You can use authentication credentials for a source. However, you can't put an
                  authentication key in the sources block. Instead, include a buckets key in your
                     <code class="code">S3AccessCreds</code> block. For more information on Amazon S3 authentication
                  credentials, see <a href="./aws-resource-authentication.html">AWS::CloudFormation::Authentication</a>.</p><p><span>For an example, see the <a href="https://s3.amazonaws.com/cloudformation-templates-us-east-1/S3Bucket_SourceAuth.template" rel="noopener noreferrer" target="_blank"><span>example template</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</span></p></div></div>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-sources-example2.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"sources" : <span>{</span>
  "/etc/myapp" : "https://s3.amazonaws.com/mybucket/myapp.tar.gz"
  }</code></pre>
               
               
               

            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-sources-example2.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">sources:
  /etc/myapp: "https://s3.amazonaws.com/mybucket/myapp.tar.gz"</code></pre>
               
               
               


            </div>
          
       
    
      <h2 id="aws-resource-init-users">Users</h2>

      <p>You can use the users key to create Linux/UNIX users on the EC2 instance. The users key
         isn't supported for Windows systems.</p>
      <p>The following table lists the supported keys.</p>
      <div class="table-container"><div class="table-contents"><table id="w1355aac23c15c15c23c27b7"><thead>
               <tr>
                  <th>Key</th>
                  <th>Description</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>uid</p>
                  </td>
                  <td tabindex="-1">
                     <p>A user ID. The creation process fails if the user name exists with a
                        different user ID. If the user ID is already assigned to an existing user
                        the operating system may reject the creation request.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>groups</p>
                  </td>
                  <td tabindex="-1">
                     <p>A list of group names. The user will be added to each group in the
                        list.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>homeDir</p>
                  </td>
                  <td tabindex="-1">
                     <p>The user's home directory.</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="aws-resource-init-users-example">Example</h3>

         <p>Users are created as non-interactive system users with a shell of
               <code class="code">/sbin/nologin</code>. This is by design and can't be modified.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-users-example.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"users" : <span>{</span>
    "myUser" : <span>{</span>
        "groups" : ["groupOne", "groupTwo"],
        "uid" : "50",
        "homeDir" : "/tmp"
    }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-users-example.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">users:
  myUser:
    groups:
      - "groupOne"
      - "groupTwo"
    uid: "50"
    homeDir: "/tmp"</code></pre>
         </div>
       
   <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./aws-resource-authentication.html">AWS::CloudFormation::Authentication</div><div id="next" class="next-link" accesskey="n" href="./aws-resource-cloudformation-interface.html">AWS::CloudFormation::Interface</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-init.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-init.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>