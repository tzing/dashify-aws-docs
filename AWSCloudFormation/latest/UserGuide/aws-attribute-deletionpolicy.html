<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>DeletionPolicy attribute - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="aws-attribute-deletionpolicy" /><meta name="default_state" content="aws-attribute-deletionpolicy" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" /><meta name="description" content="Specify how to handle resource deletion in AWS CloudFormation with the DeletionPolicy attribute." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="DeletionPolicy attribute" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>DeletionPolicy attribute - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Template reference",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Resource attribute reference",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-product-attribute-reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "DeletionPolicy attribute",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-product-attribute-reference.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">User Guide</a></div><div id="page-toc-src"><a href="#aws-attribute-deletionpolicy-example.json">JSON</a><a href="#aws-attribute-deletionpolicy-example.yaml">YAML</a><a href="#aws-attribute-deletionpolicy-options">DeletionPolicy
            options</a></div><div id="page-filters" style="display:none"><filter label="All" id="All"></filter><filter label="JSON" id="JSON"></filter><filter label="YAML" id="YAML"></filter></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="aws-attribute-deletionpolicy"><code class="code">DeletionPolicy</code> attribute</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>With the <code class="code">DeletionPolicy</code> attribute you can preserve, and in some cases, backup
      a resource when its stack is deleted. You specify a <code class="code">DeletionPolicy</code> attribute for
      each resource that you want to control. If a resource has no <code class="code">DeletionPolicy</code>
      attribute, AWS CloudFormation deletes the resource by default.</p><p>This capability also applies to stack update operations that lead to resources being
      deleted from stacks. For example, if you remove the resource from the stack template, and then
      update the stack with the template. This capability doesn't apply to resources whose physical
      instance is replaced during stack update operations. For example, if you edit a resource's
      properties such that CloudFormation replaces that resource during a stack update.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p><b>Exception</b>: The default policy is <code class="code">Snapshot</code>
         for <code class="code">AWS::RDS::DBCluster</code> resources and for <code class="code">AWS::RDS::DBInstance</code>
         resources that don't specify the <code class="code">DBClusterIdentifier</code> property.</p></div></div><p>To keep a resource when its stack is deleted, specify <code class="code">Retain</code> for that resource. You can use
         <code class="code">Retain</code> for any resource. For example, you can retain a nested stack, Amazon S3 bucket, or EC2 instance
      so that you can continue to use or modify those resources after you delete their stacks.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If you want to modify resources outside of CloudFormation, use a <code class="code">Retain</code> deletion policy and then
         delete the stack. Otherwise, your resources might get out of sync with your CloudFormation template and cause stack
         errors.</p></div></div><p>For resources that support snapshots, such as <code class="code">AWS::EC2::Volume</code>, specify
         <code class="code">Snapshot</code> to have CloudFormation create a snapshot before deleting the
      resource.</p><p>The following snippet contains an Amazon S3 bucket resource with a <code class="code">Retain</code> deletion
      policy. When this stack is deleted, CloudFormation leaves the bucket without deleting it.</p><div id="JSON" name="JSON" class="section langfilter">
      <h2 id="aws-attribute-deletionpolicy-example.json">JSON</h2>

      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Resources" : <span>{</span>
    "myS3Bucket" : <span>{</span>
      "Type" : "AWS::S3::Bucket",
      "DeletionPolicy" : "Retain"
    }
  }
}</code></pre>
   </div><div id="YAML" name="YAML" class="section langfilter">
      <h2 id="aws-attribute-deletionpolicy-example.yaml">YAML</h2>

      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myS3Bucket:
    Type: AWS::S3::Bucket
    DeletionPolicy: Retain</code></pre>
   </div>
      <h2 id="aws-attribute-deletionpolicy-options"><code class="code">DeletionPolicy</code>
            options</h2>

      <div class="variablelist">
          
          
          
          
      <dl>
            <dt><span class="term">Delete</span></dt>
            <dd>
               <p>CloudFormation deletes the resource and all its content if applicable during stack
                  deletion. You can add this deletion policy to any resource type. By default, if
                  you don't specify a <code class="code">DeletionPolicy</code>, CloudFormation deletes your
                  resources. However, be aware of the following considerations:</p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p>For <code class="code">AWS::RDS::DBCluster</code> resources, the default policy is
                           <code class="code">Snapshot</code>.</p>
                  </li><li class="listitem">
                     <p>For <code class="code">AWS::RDS::DBInstance</code> resources that don't specify the
                           <code class="code">DBClusterIdentifier</code> property, the default policy is
                           <code class="code">Snapshot</code>.</p>
                  </li><li class="listitem">
                     <p>For Amazon S3 buckets, you must delete all objects in the bucket for deletion
                        to succeed.</p>
                  </li></ul></div>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The default behavior of CloudFormation is to delete the secret with the ForceDeleteWithoutRecovery flag.</p></div></div>
            </dd>
          
            <dt><span class="term">Retain</span></dt>
            <dd>
               <p>CloudFormation keeps the resource without deleting the resource or its contents
                  when its stack is deleted. You can add this deletion policy to any resource type.
                  When CloudFormation completes the stack deletion, the stack will be in
                     <code class="code">Delete_Complete</code> state; however, resources that are retained
                  continue to exist and continue to incur applicable charges until you delete those
                  resources.</p>
               
               <p>For update operations, the following considerations apply:</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p>If a resource is deleted, the <code class="code">DeletionPolicy</code> retains the
                        physical resource but ensures that it's deleted from CloudFormation's
                        scope.</p>
                  </li><li class="listitem">
                     <p>If a resource is updated such that a new physical resource is created to
                        replace the old resource, then the old resource is completely deleted,
                        including from CloudFormation's scope.</p>
                  </li></ul></div>
            </dd>
          
            <dt><span class="term">RetainExceptOnCreate</span></dt>
            <dd>
               <p><code class="code">RetainExceptOnCreate</code> behaves like <code class="code">Retain</code> for stack operations, except for
      the stack operation that initially created the resource. If the stack operation that created the resource is
      rolled back, CloudFormation deletes the resource. For all other stack operations, such as stack deletion, CloudFormation
      retains the resource and its contents. The result is that new, empty, and unused resources are deleted, while
      in-use resources and their data are retained. Refer to the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_UpdateStack.html"><code class="code">UpdateStack</code></a> API
      documentation to use this deletion policy as an API parameter without updating your template.</p>
            </dd>
          
            <dt><span class="term">Snapshot</span></dt>
            <dd>
               <p>For resources that support snapshots, CloudFormation creates a snapshot for the
                  resource before deleting it. When CloudFormation completes the stack deletion, the
                  stack will be in the <code class="code">Delete_Complete</code> state; however, the snapshots
                  that are created with this policy continue to exist and continue to incur
                  applicable charges until you delete those snapshots.</p>
               <p>Resources that support snapshots include:</p>
               <div class="itemizedlist">
                   
                   
                   
                   
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html"><code class="code">AWS::DocDB::DBCluster</code></a></p>
                  </li><li class="listitem">
                     <p><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-volume.html"><code class="code">AWS::EC2::Volume</code></a></p>
                  </li><li class="listitem">
                     <p><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticache-cachecluster.html"><code class="code">AWS::ElastiCache::CacheCluster</code></a></p>
                  </li><li class="listitem">
                     <p><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticache-replicationgroup.html"><code class="code">AWS::ElastiCache::ReplicationGroup</code></a></p>
                  </li><li class="listitem">
                     <p><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-neptune-dbcluster.html"><code class="code">AWS::Neptune::DBCluster</code></a></p>
                  </li><li class="listitem">
                     <p><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-rds-dbcluster.html"><code class="code">AWS::RDS::DBCluster</code></a></p>
                  </li><li class="listitem">
                     <p><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-rds-dbinstance.html"><code class="code">AWS::RDS::DBInstance</code></a></p>
                  </li><li class="listitem">
                     <p><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-redshift-cluster.html"><code class="code">AWS::Redshift::Cluster</code></a></p>
                  </li></ul></div>
            </dd>
         </dl></div>
   <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./aws-attribute-creationpolicy.html">CreationPolicy</div><div id="next" class="next-link" accesskey="n" href="./aws-attribute-dependson.html">DependsOn</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>