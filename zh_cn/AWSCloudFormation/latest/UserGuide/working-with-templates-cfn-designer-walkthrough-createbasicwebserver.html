<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>演练：使用 AWS CloudFormation Designer 创建基本 Web 服务器 - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="working-with-templates-cfn-designer-walkthrough-createbasicwebserver" /><meta name="default_state" content="working-with-templates-cfn-designer-walkthrough-createbasicwebserver" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" /><meta name="description" content="使用 AWS CloudFormation Designer 创建基本 Web 服务器。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="用户指南" /><meta name="abstract" content="根据此用户指南，使用 AWS CloudFormation 以可预见方式反复创建和管理 AWS 基础设施部署。" /><meta name="guide-locale" content="zh_cn" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="用户指南" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="用户指南" /><meta id="panorama-serviceConsolePage" value="演练：使用 AWS CloudFormation Designer 创建基本 Web 服务器" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>演练：使用 AWS CloudFormation Designer 创建基本 Web 服务器 - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,资源预置,资源配置,基础设施管理,CloudFormer,CloudFormation 堆栈,CloudFormation 堆栈集,CloudFormation 模板,更改集" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "用户指南",
        "item" : "https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "使用 AWS CloudFormation 模板",
        "item" : "https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "演练",
        "item" : "https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/CHAP_Using.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "演练：使用 AWS CloudFormation Designer 创建基本 Web 服务器",
        "item" : "https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/CHAP_Using.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">文档</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">用户指南</a></div><div id="page-toc-src"><a href="#working-with-templates-cfn-designer-walkthrough-createbasicwebserver-addresources">步骤 1：添加并连接资源</a><a href="#working-with-templates-cfn-designer-walkthrough-createbasicwebserver-addother">步骤 2：添加参数、映射和输出</a><a href="#working-with-templates-cfn-designer-walkthrough-createbasicwebserver-resourceproperties">步骤 3：指定资源属性</a><a href="#working-with-templates-cfn-designer-walkthrough-createbasicwebserver-provision">步骤 4：配置资源</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="working-with-templates-cfn-designer-walkthrough-createbasicwebserver">演练：使用 AWS CloudFormation Designer 创建基本 Web 服务器</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>AWS CloudFormation Designer 能够以图形化的方式展示您的模板，帮助您了解模板中的资源及其之间的关系。通过使用集成的 JSON 和 YAML 编辑器，可以直接在 AWS CloudFormation 控制台中轻松修改模板。为说明如何使用这两个组件，我们将使用 AWS CloudFormation Designer 在 VPC 中构建一个基本 Web 服务器。然后，我们保存此模板并使用它创建 CloudFormation 堆栈。</p><p>在此演练中，您将完成以下步骤：</p><div class="orderedlist">
     
     
     
     
  <ol><li>
      <p><a href="#working-with-templates-cfn-designer-walkthrough-createbasicwebserver-addresources">添加并连接资源。</a></p>
      <p>当您首次打开 AWS CloudFormation Designer 时，将从空白模板开始工作。我们将使用 AWS CloudFormation Designer 开始填充此模板：将 VPC、EC2 实例等资源拖放到模板中。我们还将在它们之间创建链接。例如，我们将使用 AWS CloudFormation Designer 在互联网网关与 VPC 之间创建连接。</p>
    </li><li>
      <p><a href="#working-with-templates-cfn-designer-walkthrough-createbasicwebserver-addother">添加模板参数、映射和输出。</a></p>
      <p>我们将使用 AWS CloudFormation Designer 集成编辑器添加其他模板组件以使模板更有用。例如，我们将向模板添加参数，以便您可以在创建堆栈时指定输入值。这样，您就不必总是为了可能经常变化的属性值而编辑模板了。</p>
    </li><li>
      <p><a href="#working-with-templates-cfn-designer-walkthrough-createbasicwebserver-resourceproperties">指定资源属性。</a></p>
      <p>我们将再使用 集成编辑器 为资源指定配置设置。</p>
    </li><li>
      <p><a href="#working-with-templates-cfn-designer-walkthrough-createbasicwebserver-provision">预置资源</a></p>
      <p>创建堆栈前，您的任何模板资源都不会启动和运行。我们将使用您刚刚创建的模板启动一个 CloudFormation 堆栈，它将配置在模板中定义的所有资源。</p>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>CloudFormation 是一种免费服务；但是，您需要为您在堆栈使用的 AWS 资源付费，费用按每种资源的现价收取。有关 AWS 定价的详细信息，请参阅 <a href="https://aws.amazon.com/" rel="noopener noreferrer" target="_blank"><span>http://aws.amazon.com</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> 上每种产品的详细信息页。</p></div></div>
    </li></ol></div><p>先决条件</p><p>本演练假定您具有 Amazon Virtual Private Cloud (Amazon VPC)、Amazon Elastic Compute Cloud (Amazon EC2) 和 CloudFormation 方面的工作经验。为了解上下文，每个过程提供了有关每项资源的一些基本信息。</p><p>另外，在开始前，请确保您在要创建堆栈的区域中拥有一个 Amazon EC2 密钥对。有关更多信息，请参阅 <em>Amazon EC2 用户指南（适用于 Linux 实例）</em>中的 <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html">Amazon EC2 密钥对</a>。</p><h2 id="working-with-templates-cfn-designer-walkthrough-createbasicwebserver-addresources">步骤 1：添加并连接资源</h2>

    <p>我们将使用 AWS CloudFormation Designer 拖放界面添加 Amazon EC2 实例和网络资源，如 VPC、子网、路由表和互联网网关。添加所有资源后，我们将在它们之间创建连接。例如，我们会将 Internet 网关关联到某个 VPC。</p>
    <div class="procedure"><h6>向模板添加资源</h6><ol><li>
        <p>打开 AWS CloudFormation Designer（<a href="https://console.aws.amazon.com/cloudformation/designer" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/cloudformation/designer</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>）。</p>
      </li><li>
        <p>在页面下半部分的 集成编辑器 中，选择<b>编辑</b> (<span class="inlinemediaobject">
             
              <img src="images/designer-edit-icon.png" class="aws-docs-img-whiteBg aws-docs-img-xs-padding" />
             
          </span>)。</p>
      </li><li>
        <p>将模板名称更改为 <code class="code">BasicWebServerInVPC</code>，然后按 <b>Enter</b>。</p>
        <p>目前，我们拥有一个无效的空白模板。在后续步骤中，我们将添加资源使其有效。</p>
      </li><li>
        <p>在 <b>Resource types</b> 窗格中，从 <b>EC2</b> 类别拖动 <b>VPC</b> 资源类型并放到 <b>Canvas</b> 窗格上。</p>
        <p>资源按资源类别组织。我们添加的所有资源都处于 <b>EC2</b> 类别中。</p>
        <p>AWS CloudFormation Designer 会立即修改模板以包含 VPC 资源，其结果类似于下面的 JSON 代码段。</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">  "Resources": <span>{</span>
    "VPC431KO": <span>{</span>
      "Type": "AWS::EC2::VPC",
      "Properties": <span>{</span>},
      "Metadata": <span>{</span>
        "AWS::CloudFormation::Designer": <span>{</span>
          "id": "445730ea-0d11-45ba-b6ac-12345EXAMPLE"
        }
      }
    }
  }</code></pre>

        <p>YAML 代码段应该类似于下列内容。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Resources:
  VPC431KO:
    Type: 'AWS::EC2::VPC'
    Properties: <span>{</span>}
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 9430b008-7a03-41ed-b63e-12345EXAMPLE</code></pre>

        <p>注意，我们仍需指定 VPC 属性，如 VPC 的 CIDR 块。此操作稍后进行。对于将要添加的所有资源，都需要执行此操作。</p>
      </li><li>
        <p>重命名 VPC。</p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>重命名资源时，更改的是其逻辑 ID，即模板中引用的名称（不是 CloudFormation 创建此资源时分配的名称）。有关更多信息，请参阅<a href="./resources-section-structure.html">资源</a>。</p></div></div>
        <ol><li>
            <p>选择 VPC 资源。</p>
          </li><li>
            <p>在 集成编辑器 中，选择<b>编辑</b>图标 (<span class="inlinemediaobject">
                 
                  <img src="images/designer-edit-icon.png" class="aws-docs-img-whiteBg aws-docs-img-xs-padding" />
                 
              </span>)。</p>
          </li><li>
            <p>将名称更改为 <code class="code">VPC</code>，然后选择 <b>Enter</b>。</p>
          </li></ol>
        <p>接下来，我们将向此 VPC 添加资源。</p>
      </li><li>
        <p>拖动 VPC 资源的一角来放大它，使其大到足以容纳几项更多的资源。</p>
        <p>我们需要添加一个子网，因为您无法将托管此网站的 EC2 实例直接添加到 VPC 中；实例必须位于子网中。</p>
      </li><li>
        <p>在 VPC 中添加一个 <b>Subnet</b> 资源类型，并将之重命名为 <code class="code">PublicSubnet</code>。</p>
        <p>我们将使用此子网来分配 VPC 中的 IP 地址范围（您可以将之关联到其他 AWS 资源，如 Amazon EC2 实例）。</p>
        <p>在 VPC 中添加子网时，AWS CloudFormation Designer 会将子网自动关联到 VPC。此关联是一种容器模型，即容器内的资源自动关联到容器资源。</p>
      </li><li>
        <p>在 <code class="code">PublicSubnet</code> 资源内添加一个 <b>Instance</b> 资源类型，并将之重命名为 <code class="code">WebServerInstance</code>。</p>
        <p>此实例是一种虚拟计算环境，您将在其中托管一个基本网站。与子网和 VPC 的情形一样，在子网中添加此实例会使其自动关联到此子网。</p>
      </li><li>
        <p>在 VPC 中添加一个 <b>SecurityGroup</b> 资源类型，并将之重命名为 <code class="code">WebServerSecurityGroup</code>。</p>
        <p>安全组是一种虚拟防火墙，它负责控制 Web 服务器实例的入站和出站流量。VPC 中的实例也需要它。此外，我们还需要将 Web 服务器实例与此安全组关联 (在后面指定实例的属性时进行)。</p>
      </li><li>
        <p>在 VPC 外的任何地方添加一个 <b>InternetGateway</b> 资源类型，并将之重命名为 <code class="code">InternetGateway</code>。</p>
        <p>Internet 网关使 VPC 内的实例能够与 Internet 进行通信。如果没有 Internet 网关，任何人都无法访问您的网站。</p>
        <p>虽然您可以将 Internet 网关拖放到 VPC 内，但这不会创建与 VPC 的关联。Internet 网关不遵守容器模型；您必须拖动一个从 Internet 网关到 VPC 的连接，如下一步所述。</p>
      </li><li>
        <p>在 <code class="code">InternetGateway</code> 资源和 <code class="code">VPC</code> 资源之间创建连接。</p>
        <ol><li>
            <p>在 <code class="code">InternetGateway</code> 资源上，将鼠标悬停在 Internet 网关连接 (<code class="code">AWS::EC2::VPCGatewayAttachment</code>) 上。</p>
          </li><li>
            <p>拖动一个连接到 VPC。</p>
            <p>有效目标资源的边界会改变颜色。在本例中，VPC 是唯一有效的目标资源。此连接会创建一个将 Internet 网关与 VPC 关联的连接资源。</p>
          </li></ol>
      </li><li>
        <p>接下来，我们需要添加路由表和路由，以指定如何引导来自子网内部的网络流量。在 VPC 内添加一个 <b>RouteTable</b>，并将之重命名为 <code class="code">PublicRouteTable</code>。</p>
        <p>这会为 VPC 关联一个新的路由表。</p>
      </li><li>
        <p>要向路由表添加路由规则，请在 <code class="code">PublicRouteTable</code> 资源内添加一个 <b>Route</b> 资源类型，并将之重命名为 <code class="code">PublicRoute</code>。</p>
        <p>我们将使用此路由指定将流量定向到何处。</p>
      </li><li>
        <p>对于公有路由，我们需要使用 Internet 网关作为目标。使用 <code class="code">GatewayId</code> 创建从 <code class="code">PublicRoute</code> 资源到 Internet 网关的连接 (采用与在 Internet 网关与 VPC 之间创建连接相同的方式)。</p>
        <p>在将互联网网关与 VPC 关联之前，CloudFormation 无法将路由与互联网网关关联。这意味着我们需要创建对 Internet 网关-VPC 连接的显式依赖关系，如下一步所述。有关更多信息，请参阅<a href="./aws-attribute-dependson.html">DependsOn 属性</a>。</p>
      </li><li>
        <p>在 <code class="code">PublicRoute</code> 资源与 Internet 网关-VPC 连接之间创建显式的依赖关系。</p>
        <ol><li>
            <p>在 <code class="code">PublicRoute</code> 资源上，将鼠标指针悬停在 <b>DependsOn</b> 点上。</p>
          </li><li>
            <p>拖动一个连接到 Internet 网关-VPC 连接 (<code class="code">AWS::EC2::VPCGatewayAttachment</code>)。</p>
            <p>通过 <code class="code">DependsOn</code> 连接，AWS CloudFormation Designer 能够创建原始资源依赖于目标资源的依赖关系（<code class="code">DependsOn</code> 属性）。在本例中，AWS CloudFormation Designer 添加一个 <code class="code">DependsOn</code> 属性到 <code class="code">PublicRoute</code> 资源，并指定网关-VPC 连接为依赖关系。</p>
          </li></ol>
      </li><li>
        <p>再创建一个从 <code class="code">WebServerInstance</code> 资源到 <code class="code">PublicRoute</code> 资源的依赖关系。</p>
        <p><code class="code">WebServerInstance</code> 资源依靠公有路由将流量路由到 Internet。如果没有此公有路由，当实例配置和应用程序部署完成时，实例无法发送信号 (使用 cfn-signal 帮助程序脚本) 通知 CloudFormation。</p>
      </li><li>
        <p>拖动从 <code class="code">PublicRouteTable</code> 资源到 <code class="code">PublicSubnet</code> 资源的连接以关联路由表和子网。</p>
        <p>现在，公有子网将使用公有路由表来定向流量。</p>
      </li><li>
        <p>在 AWS CloudFormation Designer 工具栏中，使用 <b>File</b>（文件）菜单（文件图标）将模板保存在本地。</p>
        <p>AWS CloudFormation Designer 会将模板保存到您的硬盘上。稍后您可以使用此模板创建堆栈。我们建议您定期保存模板，以免丢失更改。</p>
      </li></ol></div>
    <p>在此步骤中，我们在模板中添加了七个资源，并将它们的逻辑 ID 重命名为易记名称。我们还为大多数资源建立了视觉连接，以创建关联和依赖关系。但在使用此模板创建堆栈前，我们还需要创建其他几个连接 (如将实例与安全组关联)，并为每个资源指定属性。在下一步中，我们将演练使用 AWS CloudFormation Designer 集成编辑器修改模板的其他组件，如输入参数。</p>
  <h2 id="working-with-templates-cfn-designer-walkthrough-createbasicwebserver-addother">步骤 2：添加参数、映射和输出</h2>
    
    <p>指定资源属性前，我们需要添加其他模板组件，以便在多个环境中复用此模板。在该步骤中，我们将使用 AWS CloudFormation Designer 集成编辑器添加参数、映射和输出。然后，我们就可以在指定资源属性时引用这些参数和映射了。此演练提供示例 JSON 和 YAML，您可以将它复制粘贴到 集成编辑器 中。</p>
    <div class="procedure"><h6>添加参数</h6><p>参数是您在创建堆栈时指定的输入值。它们可用于传入值，让您不必在模板中使用硬编码值。例如，您不必在模板中硬编码 Web 服务器的实例类型；您可以在创建堆栈时使用参数指定实例类型。利用这种方法，您可以使用同一个模板创建多个具有不同实例类型的 Web 服务器。有关更多信息，请参阅<a href="./parameters-section-structure.html">参数</a>。</p><ol><li>
        <p>单击 AWS CloudFormation Designer 画布上的空白区域。</p>
        <p>根据您的选择， 集成编辑器 会显示可以编辑的模板级或资源级组件。在模板级，您可以编辑模板的所有其他部分，如模板参数、映射、输出，但资源部分除外。在资源级，您可以编辑资源属性和属性。</p>
        <p>单击画布上的空白区域可编辑模板级组件。要编辑资源级组件，请选中某个资源。</p>
      </li><li>
        <p>在集成编辑器窗格中，在 <b>Components</b>（组件）视图中选择 <b>Parameters</b>（参数）选项卡。</p>
      </li><li>
        <p>复制下面代码段中的参数并将其粘贴到 集成编辑器 中。</p>
        <p>下面的 JSON 代码段添加了用于指定 Web 服务器实例类型的参数、用于对 Web 服务器进行 SSH 访问的 Amazon EC2 密钥对名称，以及可用于通过 SSH 访问 Web 服务器的 IP 地址范围。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Parameters": <span>{</span>
    "InstanceType" : <span>{</span>
      "Description" : "WebServer EC2 instance type",
      "Type" : "String",
      "Default" : "t2.small",
      "AllowedValues" : [ 
        "t1.micro", 
        "t2.nano", 
        "t2.micro", 
        "t2.small", 
        "t2.medium", 
        "t2.large", 
        "m1.small", 
        "m1.medium", 
        "m1.large", 
        "m1.xlarge", 
        "m2.xlarge", 
        "m2.2xlarge", 
        "m2.4xlarge", 
        "m3.medium", 
        "m3.large", 
        "m3.xlarge", 
        "m3.2xlarge", 
        "m4.large", 
        "m4.xlarge", 
        "m4.2xlarge", 
        "m4.4xlarge", 
        "m4.10xlarge", 
        "c1.medium", 
        "c1.xlarge", 
        "c3.large", 
        "c3.xlarge", 
        "c3.2xlarge", 
        "c3.4xlarge", 
        "c3.8xlarge", 
        "c4.large", 
        "c4.xlarge", 
        "c4.2xlarge", 
        "c4.4xlarge", 
        "c4.8xlarge", 
        "g2.2xlarge", 
        "g2.8xlarge", 
        "r3.large", 
        "r3.xlarge", 
        "r3.2xlarge", 
        "r3.4xlarge", 
        "r3.8xlarge", 
        "i2.xlarge", 
        "i2.2xlarge", 
        "i2.4xlarge", 
        "i2.8xlarge", 
        "d2.xlarge", 
        "d2.2xlarge", 
        "d2.4xlarge", 
        "d2.8xlarge", 
        "hi1.4xlarge", 
        "hs1.8xlarge", 
        "cr1.8xlarge", 
        "cc2.8xlarge", 
        "cg1.4xlarge"
      ],
      "ConstraintDescription" : "must be a valid EC2 instance type."
    },
    "KeyName": <span>{</span>
      "Description": "Name of an EC2 KeyPair to enable SSH access to the instance.",
      "Type": "AWS::EC2::KeyPair::KeyName",
      "ConstraintDescription": "must be the name of an existing EC2 KeyPair."
    },
    "SSHLocation": <span>{</span>
      "Description": " The IP address range that can be used to access the web server using SSH.",
      "Type": "String",
      "MinLength": "9",
      "MaxLength": "18",
      "Default": "0.0.0.0/0",
      "AllowedPattern": "(\\d<span>{</span>1,3})\\.(\\d<span>{</span>1,3})\\.(\\d<span>{</span>1,3})\\.(\\d<span>{</span>1,3})/(\\d<span>{</span>1,2})",
      "ConstraintDescription": "must be a valid IP CIDR range of the form x.x.x.x/x."
    }
  }
}</code></pre>

        <p>下面是 YAML 格式的相同代码段。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Parameters:
  InstanceType:
    Description: WebServer EC2 instance type
    Type: String
    Default: t2.small
    AllowedValues:
      - t1.micro
      - t2.nano
      - t2.micro
      - t2.small
      - t2.medium
      - t2.large
      - m1.small
      - m1.medium
      - m1.large
      - m1.xlarge
      - m2.xlarge
      - m2.2xlarge
      - m2.4xlarge
      - m3.medium
      - m3.large
      - m3.xlarge
      - m3.2xlarge
      - m4.large
      - m4.xlarge
      - m4.2xlarge
      - m4.4xlarge
      - m4.10xlarge
      - c1.medium
      - c1.xlarge
      - c3.large
      - c3.xlarge
      - c3.2xlarge
      - c3.4xlarge
      - c3.8xlarge
      - c4.large
      - c4.xlarge
      - c4.2xlarge
      - c4.4xlarge
      - c4.8xlarge
      - g2.2xlarge
      - g2.8xlarge
      - r3.large
      - r3.xlarge
      - r3.2xlarge
      - r3.4xlarge
      - r3.8xlarge
      - i2.xlarge
      - i2.2xlarge
      - i2.4xlarge
      - i2.8xlarge
      - d2.xlarge
      - d2.2xlarge
      - d2.4xlarge
      - d2.8xlarge
      - hi1.4xlarge
      - hs1.8xlarge
      - cr1.8xlarge
      - cc2.8xlarge
      - cg1.4xlarge
    ConstraintDescription: must be a valid EC2 instance type.
  KeyName:
    Description: Name of an EC2 KeyPair to enable SSH access to the instance.
    Type: 'AWS::EC2::KeyPair::KeyName'
    ConstraintDescription: must be the name of an existing EC2 KeyPair.
  SSHLocation:
    Description: ' The IP address range that can be used to access the web server using SSH.'
    Type: String
    MinLength: '9'
    MaxLength: '18'
    Default: 0.0.0.0/0
    AllowedPattern: '(\d<span>{</span>1,3})\.(\d<span>{</span>1,3})\.(\d<span>{</span>1,3})\.(\d<span>{</span>1,3})/(\d<span>{</span>1,2})'
    ConstraintDescription: must be a valid IP CIDR range of the form x.x.x.x/x.</code></pre>
      </li></ol></div>
    <div class="procedure"><h6>添加映射</h6><p>映射是与一组名称值对关联的一组键。它们可用于根据输入参数值指定值。在此演练中，我们将使用映射基于实例类型和创建堆栈的区域为 EC2 实例指定一个 AMI ID。有关更多信息，请参阅<a href="./mappings-section-structure.html">映像</a>。</p><ol><li>
        <p>在集成编辑器窗格中，选择<b>映射</b>选项卡。</p>
      </li><li>
        <p>将以下 JSON 映射复制粘贴到 集成编辑器 中。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>      
  "Mappings" : <span>{</span>
    "AWSInstanceType2Arch" : <span>{</span>
      "t1.micro"    : <span>{</span> "Arch" : "HVM64"  },
      "t2.nano"     : <span>{</span> "Arch" : "HVM64"  },
      "t2.micro"    : <span>{</span> "Arch" : "HVM64"  },
      "t2.small"    : <span>{</span> "Arch" : "HVM64"  },
      "t2.medium"   : <span>{</span> "Arch" : "HVM64"  },
      "t2.large"    : <span>{</span> "Arch" : "HVM64"  },
      "m1.small"    : <span>{</span> "Arch" : "HVM64"  },
      "m1.medium"   : <span>{</span> "Arch" : "HVM64"  },
      "m1.large"    : <span>{</span> "Arch" : "HVM64"  },
      "m1.xlarge"   : <span>{</span> "Arch" : "HVM64"  },
      "m2.xlarge"   : <span>{</span> "Arch" : "HVM64"  },
      "m2.2xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "m2.4xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "m3.medium"   : <span>{</span> "Arch" : "HVM64"  },
      "m3.large"    : <span>{</span> "Arch" : "HVM64"  },
      "m3.xlarge"   : <span>{</span> "Arch" : "HVM64"  },
      "m3.2xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "m4.large"    : <span>{</span> "Arch" : "HVM64"  },
      "m4.xlarge"   : <span>{</span> "Arch" : "HVM64"  },
      "m4.2xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "m4.4xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "m4.10xlarge" : <span>{</span> "Arch" : "HVM64"  },
      "c1.medium"   : <span>{</span> "Arch" : "HVM64"  },
      "c1.xlarge"   : <span>{</span> "Arch" : "HVM64"  },
      "c3.large"    : <span>{</span> "Arch" : "HVM64"  },
      "c3.xlarge"   : <span>{</span> "Arch" : "HVM64"  },
      "c3.2xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "c3.4xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "c3.8xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "c4.large"    : <span>{</span> "Arch" : "HVM64"  },
      "c4.xlarge"   : <span>{</span> "Arch" : "HVM64"  },
      "c4.2xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "c4.4xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "c4.8xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "g2.2xlarge"  : <span>{</span> "Arch" : "HVMG2"  },
      "g2.8xlarge"  : <span>{</span> "Arch" : "HVMG2"  },
      "r3.large"    : <span>{</span> "Arch" : "HVM64"  },
      "r3.xlarge"   : <span>{</span> "Arch" : "HVM64"  },
      "r3.2xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "r3.4xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "r3.8xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "i2.xlarge"   : <span>{</span> "Arch" : "HVM64"  },
      "i2.2xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "i2.4xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "i2.8xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "d2.xlarge"   : <span>{</span> "Arch" : "HVM64"  },
      "d2.2xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "d2.4xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "d2.8xlarge"  : <span>{</span> "Arch" : "HVM64"  },
      "hi1.4xlarge" : <span>{</span> "Arch" : "HVM64"  },
      "hs1.8xlarge" : <span>{</span> "Arch" : "HVM64"  },
      "cr1.8xlarge" : <span>{</span> "Arch" : "HVM64"  },
      "cc2.8xlarge" : <span>{</span> "Arch" : "HVM64"  }
    },
    "AWSRegionArch2AMI" : <span>{</span>
      "us-east-1"        : <span>{</span>"HVM64" : "ami-0ff8a91507f77f867", "HVMG2" : "ami-0a584ac55a7631c0c"},
      "us-west-2"        : <span>{</span>"HVM64" : "ami-a0cfeed8", "HVMG2" : "ami-0e09505bc235aa82d"},
      "us-west-1"        : <span>{</span>"HVM64" : "ami-0bdb828fd58c52235", "HVMG2" : "ami-066ee5fd4a9ef77f1"},
      "eu-west-1"        : <span>{</span>"HVM64" : "ami-047bb4163c506cd98", "HVMG2" : "ami-0a7c483d527806435"},
      "eu-west-2"        : <span>{</span>"HVM64" : "ami-f976839e", "HVMG2" : "NOT_SUPPORTED"},
      "eu-west-3"        : <span>{</span>"HVM64" : "ami-0ebc281c20e89ba4b", "HVMG2" : "NOT_SUPPORTED"},
      "eu-central-1"     : <span>{</span>"HVM64" : "ami-0233214e13e500f77", "HVMG2" : "ami-06223d46a6d0661c7"},
      "ap-northeast-1"   : <span>{</span>"HVM64" : "ami-06cd52961ce9f0d85", "HVMG2" : "ami-053cdd503598e4a9d"},
      "ap-northeast-2"   : <span>{</span>"HVM64" : "ami-0a10b2721688ce9d2", "HVMG2" : "NOT_SUPPORTED"},
      "ap-northeast-3"   : <span>{</span>"HVM64" : "ami-0d98120a9fb693f07", "HVMG2" : "NOT_SUPPORTED"},
      "ap-southeast-1"   : <span>{</span>"HVM64" : "ami-08569b978cc4dfa10", "HVMG2" : "ami-0be9df32ae9f92309"},
      "ap-southeast-2"   : <span>{</span>"HVM64" : "ami-09b42976632b27e9b", "HVMG2" : "ami-0a9ce9fecc3d1daf8"},
      "ap-south-1"       : <span>{</span>"HVM64" : "ami-0912f71e06545ad88", "HVMG2" : "ami-097b15e89dbdcfcf4"},
      "us-east-2"        : <span>{</span>"HVM64" : "ami-0b59bfac6be064b78", "HVMG2" : "NOT_SUPPORTED"},
      "ca-central-1"     : <span>{</span>"HVM64" : "ami-0b18956f", "HVMG2" : "NOT_SUPPORTED"},
      "sa-east-1"        : <span>{</span>"HVM64" : "ami-07b14488da8ea02a0", "HVMG2" : "NOT_SUPPORTED"},
      "cn-north-1"       : <span>{</span>"HVM64" : "ami-0a4eaf6c4454eda75", "HVMG2" : "NOT_SUPPORTED"},
      "cn-northwest-1"   : <span>{</span>"HVM64" : "ami-6b6a7d09", "HVMG2" : "NOT_SUPPORTED"}
    }
  }
}</code></pre>

        <p>下面是 YAML 格式的相同映射。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Mappings:
  AWSInstanceType2Arch:
    t1.micro:
      Arch: HVM64
    t2.nano:
      Arch: HVM64
    t2.micro:
      Arch: HVM64
    t2.small:
      Arch: HVM64
    t2.medium:
      Arch: HVM64
    t2.large:
      Arch: HVM64
    m1.small:
      Arch: HVM64
    m1.medium:
      Arch: HVM64
    m1.large:
      Arch: HVM64
    m1.xlarge:
      Arch: HVM64
    m2.xlarge:
      Arch: HVM64
    m2.2xlarge:
      Arch: HVM64
    m2.4xlarge:
      Arch: HVM64
    m3.medium:
      Arch: HVM64
    m3.large:
      Arch: HVM64
    m3.xlarge:
      Arch: HVM64
    m3.2xlarge:
      Arch: HVM64
    m4.large:
      Arch: HVM64
    m4.xlarge:
      Arch: HVM64
    m4.2xlarge:
      Arch: HVM64
    m4.4xlarge:
      Arch: HVM64
    m4.10xlarge:
      Arch: HVM64
    c1.medium:
      Arch: HVM64
    c1.xlarge:
      Arch: HVM64
    c3.large:
      Arch: HVM64
    c3.xlarge:
      Arch: HVM64
    c3.2xlarge:
      Arch: HVM64
    c3.4xlarge:
      Arch: HVM64
    c3.8xlarge:
      Arch: HVM64
    c4.large:
      Arch: HVM64
    c4.xlarge:
      Arch: HVM64
    c4.2xlarge:
      Arch: HVM64
    c4.4xlarge:
      Arch: HVM64
    c4.8xlarge:
      Arch: HVM64
    g2.2xlarge:
      Arch: HVMG2
    g2.8xlarge:
      Arch: HVMG2
    r3.large:
      Arch: HVM64
    r3.xlarge:
      Arch: HVM64
    r3.2xlarge:
      Arch: HVM64
    r3.4xlarge:
      Arch: HVM64
    r3.8xlarge:
      Arch: HVM64
    i2.xlarge:
      Arch: HVM64
    i2.2xlarge:
      Arch: HVM64
    i2.4xlarge:
      Arch: HVM64
    i2.8xlarge:
      Arch: HVM64
    d2.xlarge:
      Arch: HVM64
    d2.2xlarge:
      Arch: HVM64
    d2.4xlarge:
      Arch: HVM64
    d2.8xlarge:
      Arch: HVM64
    hi1.4xlarge:
      Arch: HVM64
    hs1.8xlarge:
      Arch: HVM64
    cr1.8xlarge:
      Arch: HVM64
    cc2.8xlarge:
      Arch: HVM64
  AWSRegionArch2AMI:
    us-east-1:
      HVM64: ami-0ff8a91507f77f867
      HVMG2: ami-0a584ac55a7631c0c
    us-west-2:
      HVM64: ami-a0cfeed8
      HVMG2: ami-0e09505bc235aa82d
    us-west-1:
      HVM64: ami-0bdb828fd58c52235
      HVMG2: ami-066ee5fd4a9ef77f1
    eu-west-1:
      HVM64: ami-047bb4163c506cd98
      HVMG2: ami-0a7c483d527806435
    eu-west-2:
      HVM64: ami-f976839e
      HVMG2: NOT_SUPPORTED
    eu-west-3:
      HVM64: ami-0ebc281c20e89ba4b
      HVMG2: NOT_SUPPORTED
    eu-central-1:
      HVM64: ami-0233214e13e500f77
      HVMG2: ami-06223d46a6d0661c7
    ap-northeast-1:
      HVM64: ami-06cd52961ce9f0d85
      HVMG2: ami-053cdd503598e4a9d
    ap-northeast-2:
      HVM64: ami-0a10b2721688ce9d2
      HVMG2: NOT_SUPPORTED
    ap-northeast-3:
      HVM64: ami-0d98120a9fb693f07
      HVMG2: NOT_SUPPORTED
    ap-southeast-1:
      HVM64: ami-08569b978cc4dfa10
      HVMG2: ami-0be9df32ae9f92309
    ap-southeast-2:
      HVM64: ami-09b42976632b27e9b
      HVMG2: ami-0a9ce9fecc3d1daf8
    ap-south-1:
      HVM64: ami-0912f71e06545ad88
      HVMG2: ami-097b15e89dbdcfcf4
    us-east-2:
      HVM64: ami-0b59bfac6be064b78
      HVMG2: NOT_SUPPORTED
    ca-central-1:
      HVM64: ami-0b18956f
      HVMG2: NOT_SUPPORTED
    sa-east-1:
      HVM64: ami-07b14488da8ea02a0
      HVMG2: NOT_SUPPORTED
    cn-north-1:
      HVM64: ami-0a4eaf6c4454eda75
      HVMG2: NOT_SUPPORTED
    cn-northwest-1:
      HVM64: ami-6b6a7d09
      HVMG2: NOT_SUPPORTED</code></pre>
      </li></ol></div>
    <div class="procedure"><h6>添加输出</h6><p>输出用于声明您需要开放给 <code class="code">describe
          stacks</code> API 调用或通过 CloudFormation 控制台堆栈的 <b>Outputs</b> 选项卡显示的值。在此演练中，我们将输出网站的 URL，以便您轻松查看创建后的网站。有关更多信息，请参阅<a href="./outputs-section-structure.html">输出</a>。</p><ol><li>
        <p>在集成编辑器窗格中，选择<b>输出</b>选项卡。</p>
      </li><li>
        <p>将以下 JSON 输出复制粘贴到 集成编辑器 中。</p>
        <p>此输出使用 <code class="code">Fn::GetAtt</code> 内部函数获取 Web 服务器实例的公有 IP。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Outputs": <span>{</span>
    "URL": <span>{</span>
      "Value": <span>{</span>
        "Fn::Join": [
          "",
          [
            "http://",
            <span>{</span>
              "Fn::GetAtt": [
                "WebServerInstance",
                "PublicIp"
              ]
            }
          ]
        ]
      },
      "Description": "Newly created application URL"
    }
  }
}</code></pre>

        <p>下面是 YAML 格式的相同输出。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Outputs:
  URL:
    Value: !Join 
      - ''
      - - 'http://'
        - !GetAtt 
          - WebServerInstance
          - PublicIp
    Description: Newly created application URL</code></pre>
      </li><li>
        <p>再次保存模板，以免丢失更改。您可以安全地将更改保存到在前一部分中创建的文件。</p>
      </li></ol></div>
    <p>现在，模板参数、映射和输出均已到位，我们可以指定资源属性了。</p>
  <h2 id="working-with-templates-cfn-designer-walkthrough-createbasicwebserver-resourceproperties">步骤 3：指定资源属性</h2>
    
    <p>很多资源都有必需的属性用于定义资源的配置或设置，例如：要为 Web 服务器使用何种实例类型。与上一步中的做法类似，我们将使用 AWS CloudFormation Designer 集成编辑器指定资源属性。我们提供了示例 JSON 和 YAML，您可以将它们复制粘贴到 集成编辑器 中。</p>
    <div class="procedure"><h6>指定资源属性</h6><ol><li>
        <p>在 AWS CloudFormation Designer 画布上，选择 <code class="code">VPC</code> 资源。</p>
        <p>集成编辑器 显示您可以编辑的资源级组件，如资源属性和属性。</p>
      </li><li>
        <p>在集成编辑器窗格中，选择<b>属性</b>选项卡。</p>
      </li><li>
        <p>复制以下 JSON 代码段，并将其粘贴到集成编辑器中的<b>属性</b>大括号 (<code class="code"><span>{</span>}</code>) 之间。</p>
        <p>此代码段指定 DNS 设置和 VPC 的 CIDR 块。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">        "EnableDnsSupport": "true",
        "EnableDnsHostnames": "true",
        "CidrBlock": "10.0.0.0/16"</code></pre>
        <p>对于 YAML，在 <code class="code">Properties:</code> 后键入新行，然后粘贴下面的代码段。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">      EnableDnsSupport: 'true'
      EnableDnsHostnames: 'true'
      CidrBlock: 10.0.0.0/16</code></pre>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>为提高效率，我们提供了可供您复制粘贴的 JSON 和 YAML 代码段。但请注意，此编辑器具有自动完成功能，可让您方便地手动指定每个属性。有关更多信息，请参阅<a href="./working-with-templates-cfn-designer-json-editor.html">集成的 JSON 和 YAML 编辑器</a>。</p></div></div>
      </li><li>
        <p>为以下资源重复这一过程：</p><div class="variablelist">
             
             
             
             
          <dl>
              <dt><span class="term"><code class="code">PublicSubnet</code></span></dt>
              <dd>
                <p>在 VPC ID 属性后面添加下面的 CIDR 块属性。AWS CloudFormation将子网拖放到 VPC 中的时候，Designer 会自动添加 VPC ID 属性。</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>您会看到 AWS CloudFormation Designer 为您自动创建了其他几个关联。您只需添加以粗体显示的新属性。</p></div></div>
                <p>JSON</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">        "VpcId": <span>{</span>
          "Ref": "VPC"
        },
        <b>"CidrBlock": "10.0.0.0/24"</b></code></pre>
                <p>YAML</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">      VpcId: !Ref VPC
      <b>CidrBlock: 10.0.0.0/24</b></code></pre>
              </dd>
             
              <dt><span class="term"><code class="code">PublicRoute</code></span></dt>
              <dd>
                <p>添加下面的目标 CIDR 块属性（该属性将所有流量定向到 Internet 网关）：</p>
                <p>JSON</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">        <b>"DestinationCidrBlock": "0.0.0.0/0",</b>
        "RouteTableId": <span>{</span>
          "Ref": "PublicRouteTable"
        },        
        "GatewayId": <span>{</span>
          "Ref": "InternetGateway"
        }</code></pre>
                <p>YAML</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">      <b>DestinationCidrBlock: 0.0.0.0/0</b>
      RouteTableId: !Ref PublicRouteTable
      GatewayId: !Ref InternetGateway</code></pre>
              </dd>
             
              <dt><span class="term"><code class="code">WebServerSecurityGroup</code></span></dt>
              <dd>
                <p>添加下面的入站规则，用以确定哪些流量可以到达 Web 服务器实例。这些规则允许所有的 HTTP 和特定的 SSH 流量 (在创建堆栈时通过参数值指定) 通过。</p>
                <p>JSON</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">        "VpcId": <span>{</span>
          "Ref": "VPC"
        }<b>,
        "GroupDescription" : "Allow access from HTTP and SSH traffic",
        "SecurityGroupIngress": [
          <span>{</span>
            "IpProtocol": "tcp",
            "FromPort": 80,
            "ToPort": 80,
            "CidrIp": "0.0.0.0/0"
          },
          <span>{</span>
            "IpProtocol": "tcp",
            "FromPort": 22,
            "ToPort": 22,
            "CidrIp": <span>{</span>
              "Ref": "SSHLocation"
            }
          }
        ]</b></code></pre>
                <p>YAML</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">      VpcId: !Ref VPC
      <b>GroupDescription: Allow access from HTTP and SSH traffic
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: !Ref SSHLocation</b></code></pre>
              </dd>
             
              <dt><span class="term"><code class="code">WebServerInstance</code></span></dt>
              <dd>
                <p>您需要为 Web 服务器实例指定一些属性，出于演示目的，我们只重点介绍部分属性。<code class="code">InstanceType</code> 和 <code class="code">ImageId</code> 属性使用我们在上一部分中指定的参数和映射值。创建堆栈时，需要以参数值的形式指定实例类型。<code class="code">ImageId</code> 值是基于堆栈区域和指定的实例类型的映射。</p>
                <p><code class="code">NetworkInterfaces</code> 属性指定 Web 服务器实例的网络设置。该属性让我们能够将安全组和子网关联到实例。虽然 AWS CloudFormation Designer 使用了 <code class="code">SubnetId</code> 属性来关联实例和子网，但我们需要使用 <code class="code">NetworkInterfaces</code> 属性，因为这是为 Web 服务器提供公有 IP 的唯一方式。指定 <code class="code">NetworkInterfaces</code> 属性时，必须在该属性中指定子网和安全组。</p>
                <p>在 <code class="code">UserData</code> 属性中，我们指定在实例启动并运行后运行的配置脚本。所有配置信息均在实例的元数据中定义 (我们将在下一步中添加)。</p>
                <p>使用下面的代码段替换所有属性：</p>
                <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>请不要将此代码段附加到现有属性。</p></div></div>
                <p>JSON</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><b>       "InstanceType": <span>{</span>
          "Ref": "InstanceType"
        },
        "ImageId": <span>{</span>
          "Fn::FindInMap": [
            "AWSRegionArch2AMI",
            <span>{</span>
              "Ref": "AWS::Region"
            },
            <span>{</span>
              "Fn::FindInMap": [
                "AWSInstanceType2Arch",
                <span>{</span>
                  "Ref": "InstanceType"
                },
                "Arch"
              ]
            }
          ]
        },
        "KeyName": <span>{</span>
          "Ref": "KeyName"
        },
        "NetworkInterfaces": [
          <span>{</span>
            "GroupSet": [
              <span>{</span>
                "Ref": "WebServerSecurityGroup"
              }
            ],
            "AssociatePublicIpAddress": "true",
            "DeviceIndex": "0",
            "DeleteOnTermination": "true",
            "SubnetId": <span>{</span>
              "Ref": "PublicSubnet"
            }
          }
        ],
        "UserData": <span>{</span>
          "Fn::Base64": <span>{</span>
            "Fn::Join": [
              "",
              [
                "#!/bin/bash -xe\n",
                "yum install -y aws-cfn-bootstrap\n",
                "# Install the files and packages from the metadata\n",
                "/opt/aws/bin/cfn-init -v ",
                "         --stack ",
                <span>{</span>
                  "Ref": "AWS::StackName"
                },
                "         --resource WebServerInstance ",
                "         --configsets All ",
                "         --region ",
                <span>{</span>
                  "Ref": "AWS::Region"
                },
                "\n",
                "# Signal the status from cfn-init\n",
                "/opt/aws/bin/cfn-signal -e $? ",
                "         --stack ",
                <span>{</span>
                  "Ref": "AWS::StackName"
                },
                "         --resource WebServerInstance ",
                "         --region ",
                <span>{</span>
                  "Ref": "AWS::Region"
                },
                "\n"
              ]
            ]
          }
        }</b></code></pre>
                <p>YAML</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml "><b>      InstanceType: !Ref InstanceType
      ImageId: !FindInMap 
        - AWSRegionArch2AMI
        - !Ref 'AWS::Region'
        - !FindInMap 
          - AWSInstanceType2Arch
          - !Ref InstanceType
          - Arch
      KeyName: !Ref KeyName
      NetworkInterfaces:
        - GroupSet:
            - !Ref WebServerSecurityGroup
          AssociatePublicIpAddress: 'true'
          DeviceIndex: '0'
          DeleteOnTermination: 'true'
          SubnetId: !Ref PublicSubnet
      UserData: !Base64 
        'Fn::Join':
          - ''
          - - |
              #!/bin/bash -xe
            - |
              yum install -y aws-cfn-bootstrap
            - |
              # Install the files and packages from the metadata
            - '/opt/aws/bin/cfn-init -v '
            - '         --stack '
            - !Ref 'AWS::StackName'
            - '         --resource WebServerInstance '
            - '         --configsets All '
            - '         --region '
            - !Ref 'AWS::Region'
            - |+

            - |
              # Signal the status from cfn-init
            - '/opt/aws/bin/cfn-signal -e $? '
            - '         --stack '
            - !Ref 'AWS::StackName'
            - '         --resource WebServerInstance '
            - '         --region '
            - !Ref 'AWS::Region'
            - |+</b></code></pre>
              </dd>
            </dl></div>
      </li><li>
        <p>将 Web 服务器配置元数据添加到 <code class="code">WebServerInstance</code> 资源。</p>
        <ol><li>
            <p>选择 <code class="code">WebServerInstance</code> 资源，然后在集成编辑器窗格中选择<b>元数据</b>选项卡。</p>
          </li><li>
            <p><em>如果以 JSON 格式编写模板</em>：在 <code class="code">Metadata</code> 括号 (<code class="code"><span>{</span>}</code>) 内、<code class="code">AWS::CloudFormation::Designer</code> 右括号后面添加一个逗号 (<code class="code">,</code>)。</p>
          </li><li>
            <p>在 <code class="code">AWS::CloudFormation::Designer</code> 属性后添加下面的代码段，指示 cfn-init 帮助程序脚本启动 Web 服务器并创建基本网页。</p>
            <p>JSON</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">        "AWS::CloudFormation::Init" : <span>{</span>
          "configSets" : <span>{</span>
            "All" : [ "ConfigureSampleApp" ]
          },
          "ConfigureSampleApp" : <span>{</span>
            "packages" : <span>{</span>
              "yum" : <span>{</span>
                "httpd" : []
              }
            },
            "files" : <span>{</span>
              "/var/www/html/index.html" : <span>{</span>
                "content" : <span>{</span> "Fn::Join" : ["\n", [
                  "&lt;h1&gt;Congratulations, you have successfully launched the AWS CloudFormation sample.&lt;/h1&gt;"
                ]]},
                "mode"    : "000644",
                "owner"   : "root",
                "group"   : "root"
              }
            },
            "services" : <span>{</span>
              "sysvinit" : <span>{</span>
                "httpd"    : <span>{</span> "enabled" : "true", "ensureRunning" : "true" }
              }
            }
          }
        }</code></pre>
            <p>YAML</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">      'AWS::CloudFormation::Init':
        configSets:
          All:
            - ConfigureSampleApp
        ConfigureSampleApp:
          packages:
            yum:
              httpd: []
          files:
            /var/www/html/index.html:
              content: !Join 
                - |+

                - - &gt;-
                    &lt;h1&gt;Congratulations, you have successfully launched the AWS
                    CloudFormation sample.&lt;/h1&gt;
              mode: '000644'
              owner: root
              group: root
          services:
            sysvinit:
              httpd:
                enabled: 'true'
                ensureRunning: 'true'</code></pre>
          </li></ol>
      </li><li>
        <p>在 AWS CloudFormation Designer 工具栏上，选择 <b>Validate template</b>（验证模板）（<span class="inlinemediaobject">
               
                <img src="images/designer-validate-icon.png" class="aws-docs-img-whiteBg aws-docs-img-xs-padding" />
               
            </span>）以检查模板中的语法错误。</p>
        <p>查看并修复 <b>Messages</b> 窗格中的错误，然后再次验证模板。如果未看到错误，则说明您的模板语法上是有效的。</p>
      </li><li>
        <p>保存完成的模板，以保存所有更改。</p>
      </li></ol></div>
    <p>现在，您已拥有可在 VPC 中创建基本 Web 服务器的完整 CloudFormation 模板。为创建模板，我们先通过 AWS CloudFormation Designer 画布窗格添加并连接了模板资源。然后，我们使用 集成编辑器 添加其他模板组件并指定资源属性。在下一步中，我们将使用此模板创建堆栈。</p>
  <h2 id="working-with-templates-cfn-designer-walkthrough-createbasicwebserver-provision">步骤 4：配置资源</h2>
    
    <p>要创建堆栈，您可以从 AWS CloudFormation Designer 中启动 CloudFormation <b>Create Stack Wizard</b>（创建堆栈向导）。我们将使用在上一步中创建的模板创建一个 CloudFormation 堆栈。在 CloudFormation 配置所有资源后，您将拥有一个启动并正常运行的基本网站。</p>
    <div class="procedure"><h6>要创建  堆栈，请执行以下操作：</h6><ol><li>
        <p>在 AWS CloudFormation Designer 工具栏上，选择 <b>Create Stack</b>（创建堆栈）（云图标）。</p>
        <p>AWS CloudFormation Designer 将在 S3 桶中打开模板，然后启动 CloudFormation <b>Create Stack Wizard</b>（创建堆栈向导）。CloudFormation 使用它在您每次上传模板时创建的同一 S3 桶。</p>
      </li><li>
        <p>CloudFormation 会自动填充模板 URL；选择 <b>Next</b>。</p>
      </li><li>
        <p>在 <b>Specify Details</b> 部分的 <b>Stack name</b> 字段中，输入堆栈名称。对于该示例，请使用 <code class="userinput">BasicWebServerStack</code>。</p>
      </li><li>
        <p>在 <b>Parameters</b> 部分的 <b>KeyName</b> 字段中，输入要创建堆栈的同一区域中的有效 Amazon EC2 密钥对名称。</p>
      </li><li>
        <p>保持其他默认参数值不变，然后选择 <b>Next</b>。</p>
      </li><li>
        <p>在本演练中，您无需添加标记或指定高级设置，因此请选择 <b>Next</b>。</p>
      </li><li>
        <p>确保堆栈名称和 Amazon EC2 密钥对名称正确，然后选择 <b>Create</b>。</p>
      </li></ol></div>
    <p>AWS CloudFormation 可能需要几分钟时间创建堆栈。要监控进度，可查看堆栈事件。有关查看堆栈事件的更多信息，请参阅 <a href="./cfn-console-view-stack-data-resources.html">在 AWS Management Console上查看 AWS CloudFormation 堆栈数据和资源</a>。堆栈创建后，查看堆栈输出并前往示例网站 URL，确认网站正在运行。有关更多信息，请参阅<a href="./cfn-console-view-stack-data-resources.html">在 AWS Management Console上查看 AWS CloudFormation 堆栈数据和资源</a>。</p>
    <p>现在，您已使用 AWS CloudFormation Designer 成功创建模板并启动了堆栈，您可以在下面的演练中使用此堆栈了：<a href="./working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html">演练：使用 AWS CloudFormation Designer 修改堆栈的模板</a>（修改模板以创建可扩展的 Web 服务器）。</p>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>Javascript 在您的浏览器中被禁用或不可用。</strong></p><p>要使用 Amazon Web Services 文档，必须启用 Javascript。请参阅浏览器的帮助页面以了解相关说明。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">文档惯例</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./CHAP_Using.html">演练</div><div id="next" class="next-link" accesskey="n" href="./working-with-templates-cfn-designer-walkthrough-updatebasicwebserver.html">使用 Designer 修改模板</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">此页面对您有帮助吗？- 是</div><div class="content"><p>感谢您对我们工作的肯定！</p><p>如果不耽误您的时间，请告诉我们做得好的地方，让我们做得更好。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="反馈" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">此页面对您有帮助吗？- 否</div><div class="content"><p>感谢您告诉我们本页内容还需要完善。很抱歉让您失望了。</p><p>如果不耽误您的时间，请告诉我们如何改进文档。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="反馈" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-walkthrough-createbasicwebserver.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>