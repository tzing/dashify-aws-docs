<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Options d'échec de pile - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="stack-failure-options" /><meta name="default_state" content="stack-failure-options" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" /><meta name="description" content="Développez de manière itérative vos applications lorsque des échecs d'allocation sont rencontrés en partant du point de défaillance sans annuler les ressources allouées avec succès." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Guide de l'utilisateur" /><meta name="abstract" content="Créez et gérez des déploiements AWS d'infrastructure de manière prévisible et répétée à l'aide de ce AWS CloudFormation guide de l'utilisateur." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Guide de l'utilisateur" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Guide de l'utilisateur" /><meta id="panorama-serviceConsolePage" value="Options d'échec de pile" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Options d'échec de pile - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,provisionnement des ressources,configuration des ressources,gestion de l'infrastructure,CloudFormer,CloudFormation pile,CloudFormation stackset,CloudFormation modèle,jeu de modifications" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide de l'utilisateur",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Utilisation des piles",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacks.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Options d'échec de pile",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacks.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Guide de l'utilisateur</a></div><div id="page-toc-src"><a href="#stack-failure-options-overview">Présentation des options d'échec de pile</a><a href="#stack-failure-options-conditions">Conditions pour suspendre la restauration de la pile</a><a href="#stack-failure-options-console">Préserver les ressources correctement allouées (console)</a><a href="#stack-failure-options-cli">Préserver les ressources correctement allouées (AWS CLI)</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="stack-failure-options">Options d'échec de pile</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Vous pouvez développer vos applications de manière itérative en cas d'échec d'allocation en partant du point de défaillance sans annuler les ressources allouées avec succès. En spécifiant les options d'échec de pile, vous pouvez dépanner les ressources dans un état <code class="code">CREATE_FAILED</code> ou <code class="code">UPDATE_FAILED</code>. Vous pouvez allouer des options d'échec pour tous les déploiements de pile et les opérations d'ensembles de modifications.</p><div class="itemizedlist">
   
   
  
 <ul class="itemizedlist"><li class="listitem">
   <p>Les opérations de création définies sur <b>Preserve successfully provisioned resources</b> (Préserver les ressources correctement allouées) préserve l'état des ressources réussies, tandis que les ressources en échec resteront à un état d'échec jusqu'à ce que la prochaine opération de mise à jour soit effectuée.</p>
  </li><li class="listitem">
   <p>Les opérations de mise à jour et d'ensemble de modifications définies sur <b>Preserve successfully provisioned resources</b> (Préserver les ressources correctement allouées) permet de conserver l'état des ressources réussies tout en rétablissant les ressources en échec au dernier état stable connu. Les ressources en échec se trouveront à l'état <code class="code">UPDATE_FAILED</code>. Les ressources sans dernier état stable connu seront supprimées lors de la prochaine opération de pile.</p>
  </li></ul></div><p>Pour plus de détails sur la suspension de la restauration des ressources en échec, veuillez consulter les sections suivantes :</p><div class="itemizedlist">
   
   
   
   
 <ul class="itemizedlist"><li class="listitem">
   <p><a href="#stack-failure-options-overview">Présentation des options d'échec de pile</a></p>
  </li><li class="listitem">
   <p><a href="#stack-failure-options-conditions">Conditions pour suspendre la restauration de la pile</a></p>
  </li><li class="listitem">
   <p><a href="#stack-failure-options-console">Préserver les ressources correctement allouées (console)</a></p>
  </li><li class="listitem">
   <p><a href="#stack-failure-options-cli">Préserver les ressources correctement allouées (AWS CLI)</a></p>
  </li></ul></div>
  <h2 id="stack-failure-options-overview">Présentation des options d'échec de pile</h2>
  <p>Avant de lancer une opération à partir de la console AWS CloudFormation, de l'API ou de l'AWS Command Line Interface (AWS CLI), spécifiez le comportement en cas de défaillance des ressources allouées. Passez ensuite au processus de déploiement de vos ressources sans aucune autre modification. En cas de défaillance opérationnelle, CloudFormation s'arrête au premier échec de chaque chemin d'allocation indépendant. CloudFormation identifie les dépendances entre les ressources afin de paralléliser les actions d'allocation indépendantes. Il procède ensuite à l'allocation des ressources sur chaque chemin d'allocation indépendant jusqu'à ce qu'il rencontre un échec. L'échec d'un chemin n'affecte pas les autres chemins d'allocation. CloudFormation continuera d'allouer les ressources jusqu'à la fin ou s'arrêtera en cas d'échec différent.</p>
  <p>Corrigez tous les problèmes afin de poursuivre le processus de déploiement. CloudFormation effectue les mises à jour nécessaires avant de relancer les actions d'allocation sur des ressources qui n'ont pas pu être correctement allouées auparavant. Vous résolvez les problèmes en soumettant les opérations <b>Retry</b> (Réessayer), <b>Update</b> (Mettre à jour) ou <b>Roll back</b> (Restaurer). Par exemple, si vous allouez une instance Amazon EC2 et que l'instance EC2 échoue lors d'une opération de création, vous pouvez rechercher l'erreur, plutôt que de restaurer immédiatement la ressource ayant échoué. Vous pouvez passer en revue les contrôles d'état du système et les contrôles d'état des instances, puis sélectionner l'opération <b>Retry</b> (Réessayer) une fois que les problèmes sont résolus.</p>
  
  
  <p>Lorsqu'une opération de pile échoue et que vous avez spécifié <b>Preserve successfully provisioned resources</b> (Préserver les ressources correctement allouées) à partir du menu <b>Stack failure options</b> (Options d'échec de pile), vous pouvez sélectionner les options suivantes.</p>
  <div class="itemizedlist">
    
    
    
  <ul class="itemizedlist"><li class="listitem">
    <p><b>Retry</b> (Réessayer) : relance l'opération d'allocation sur les ressources en échec et continue d'allouer le modèle jusqu'à la fin de l'opération de pile ou jusqu'à l'échec suivant. Sélectionnez cette option si la ressource n'a pas pu être allouée en raison d'un problème qui ne nécessite pas de modifications du modèle, tel qu'une autorisation AWS Identity and Access Management (IAM).</p>
   </li><li class="listitem">
    <p><b>Update</b> (Mettre à jour) : les ressources qui ont été allouées sont mises à jour lors des mises à jour des modèles. Les ressources qui n'ont pas pu être créées ou mises à jour seront relancées. Sélectionnez cette option si la ressource n'a pas pu être allouée en raison d'erreurs de modèle et si vous avez modifié le modèle. Lorsque vous mettez à jour une pile qui se trouve à l'état <code class="code">FAILED</code>, vous devez sélectionner <b>Preserve successfully provisioned resources</b> (Préserver les ressources correctement allouées) pour <b>Stack failure options</b> (Options d'échec de pile) afin de poursuivre la mise à jour de votre pile.</p>
   </li><li class="listitem">
    <p><b>Roll back</b> (Restaurer) : CloudFormation restaure la pile au dernier état stable connu.</p>
   </li></ul></div>

 
  
  <h2 id="stack-failure-options-conditions">Conditions pour suspendre la restauration de la pile</h2>
  <p>Pour suspendre la restauration des ressources en échec dans votre pile, les conditions suivantes doivent être remplies.</p>
  <div class="itemizedlist">
    
    
  <ul class="itemizedlist"><li class="listitem">
    <p>Vous devez spécifier le paramètre <b>Preserve successfully provisioned resources</b> (Préserver les ressources correctement allouées) pendant une opération de pile. Pour plus d'informations sur le comportement de restauration, veuillez consulter la rubrique <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-console-add-tags.html#rollback">Définition des options de pile AWS CloudFormation</a>.</p>
   </li><li class="listitem">
    <p>Une opération de pile doit avoir l'état de pile <code class="code">CREATE_FAILED</code> ou <code class="code">UPDATE_FAILED</code>. Pour plus d'informations sur les états de pile, veuillez consulter la rubrique <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-describing-stacks.html#w2ab1c23c15c17c11">Codes d'état de la pile</a>.</p>
   </li></ul></div>
  <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Les types de mise à jour immuables ne sont pas pris en charge.</p></div></div>
  
  <h2 id="stack-failure-options-console">Préserver les ressources correctement allouées (console)</h2>
  <awsdocs-tabs><dl style="display: none">
   <dt>Create stack</dt><dd tab-id="create-stack">
     <div class="procedure"><h6>Pour préserver les ressources correctement allouées lors d'une opération de création de pile</h6><ol><li><p>Connectez-vous à la AWS Management Console et ouvrez la console AWS CloudFormation à l'adresse <a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/cloudformation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
       <p>Choisissez <b>Create stack</b> (Créer une pile), puis sélectionnez <b>With new resources (standard)</b> (Avec de nouvelles ressources (standard)).</p>
      </li><li>
       <p>Sur la page <b>Specify template (Spécifier un modèle)</b>, choisissez un modèle de pile en utilisant l'une des options suivantes :</p>
       <div class="itemizedlist">
         
         
         
       <ul class="itemizedlist"><li class="listitem">
         <p><b>Template is ready (Le modèle est prêt)</b></p>
        </li><li class="listitem">
         <p><b>Use a sample template (Utiliser un exemple de modèle)</b></p>
        </li><li class="listitem">
         <p><b>Create template in Designer (Créer un modèle dans Designer)</b></p>
        </li></ul></div>
       <p>Acceptez vos paramètres et sélectionnez <b>Next</b> (Suivant).</p>
      </li><li>
       <p>Sur la page <b>Spécifier les détails de la pile</b>, saisissez un nom pour la pile dans la zone <b>Stack name</b> (Nom de la pile).</p>
      </li><li>
       <p>Dans la section <b>Paramètres</b>, spécifiez les paramètres définis dans votre modèle de pile.</p>
       <p>Vous pouvez utiliser ou modifier n'importe quel paramètre contenant des valeurs par défaut.</p>
      </li><li>
       <p>Lorsque vous êtes satisfait de vos paramètres, choisissez <b>Next</b> (Suivant).</p>
      </li><li>
       <p>Sur la page <b>Configurer les options de la pile</b>, vous pouvez définir des options supplémentaires pour votre pile.</p>
      </li><li>
       <p>Pour <b>Stack failure options</b> (Options d'échec de pile), sélectionnez <b>Preserve successfully provisioned resources</b> (Préserver les ressources correctement allouées).</p>
      </li><li>
       <p>Lorsque vous êtes satisfait de vos options de pile, choisissez <b>Next</b> (Suivant).</p>
      </li><li>
       <p>Passez en revue votre pile sur la page <b>Révision</b> et sélectionnez <b>Create stack</b> (Créer une pile).</p>
      </li></ol></div>
     <p><em>Résultats</em> : les ressources qui n'ont pas pu être créées font passer l'état de la pile à <code class="code">CREATE_FAILED</code> pour empêcher la restauration de la pile lorsque l'opération de pile échoue. Les ressources qui sont correctement allouées se trouvent à l'état <code class="code">CREATE_COMPLETE</code>. Vous pouvez surveiller la pile dans l'onglet <b>Stack events</b> (Événements de la pile).</p>
    </dd>
   <dt>Update stack</dt><dd tab-id="update-stack">
     <div class="procedure"><h6>Pour préserver les ressources correctement allouées lors d'une opération de mise à jour de pile</h6><ol><li><p>Connectez-vous à la AWS Management Console et ouvrez la console AWS CloudFormation à l'adresse <a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/cloudformation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
       <p>Sélectionnez la pile que vous souhaitez mettre à jour, puis cliquez sur <b>Update</b> (Mettre à jour).</p>
      </li><li>
       <p>Sur la page <b>Mettre à jour une pile</b>, choisissez un modèle de pile en utilisant l'une des options suivantes :</p>
       <div class="itemizedlist">
         
         
         
       <ul class="itemizedlist"><li class="listitem">
         <p><b>Use current template</b> (Utiliser le modèle actuel)</p>
        </li><li class="listitem">
         <p><b>Replace current template</b> (Remplacer le modèle actuel)</p>
        </li><li class="listitem">
         <p><b>Edit template in designer</b> (Modifier le modèle dans Designer)</p>
        </li></ul></div>
       <p>Acceptez vos paramètres et sélectionnez <b>Next</b> (Suivant).</p>
      </li><li>
       <p>Sur la page <b>Définir les détails de la pile</b>, spécifiez les paramètres définis dans votre modèle de pile.</p>
       <p>Vous pouvez utiliser ou modifier n'importe quel paramètre contenant des valeurs par défaut.</p>
      </li><li>
       <p>Lorsque vous êtes satisfait de vos paramètres, choisissez <b>Next</b> (Suivant).</p>
      </li><li>
       <p>Sur la page <b>Configurer les options de la pile</b>, vous pouvez définir des options supplémentaires pour votre pile.</p>
      </li><li>
       <p>Pour <b>Comportement en cas d'échec de l'allocation</b>, sélectionnez <b>Preserve successfully provisioned resources</b> (Préserver les ressources correctement allouées).</p>
      </li><li>
       <p>Lorsque vous êtes satisfait de vos options de pile, choisissez <b>Next</b> (Suivant).</p>
      </li><li>
       <p>Passez en revue votre pile sur la page <b>Révision</b> et sélectionnez <b>Update stack</b> (Mettre à jour une pile).</p>
      </li></ol></div>
     <p><em>Résultats</em> : les ressources qui n'ont pas pu être mises à jour passent l'état de la pile à <code class="code">UPDATE_FAILED</code> et reviennent au dernier état stable connu. Les ressources sans dernier état stable connu seront supprimées par CloudFormation lors de la prochaine opération de pile. Les ressources qui sont correctement allouées se trouvent à l'état <code class="code">CREATE_COMPLETE</code> ou <code class="code">UPDATE_COMPLETE</code>. Vous pouvez surveiller la pile dans l'onglet <b>Stack events</b> (Événements de la pile).</p>
    </dd>
   <dt>Change set</dt><dd tab-id="change-set">
     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Vous pouvez initier un jeu de modifications pour une pile dont l'état est <code class="code">CREATE_FAILED</code> ou <code class="code">UPDATE_FAILED</code>, mais pas pour un état <code class="code">UPDATE_ROLLBACK_FAILED</code>.</p></div></div>
     <div class="procedure"><h6>Pour préserver les ressources correctement allouées lors d'une opération de modification de pile</h6><ol><li><p>Connectez-vous à la AWS Management Console et ouvrez la console AWS CloudFormation à l'adresse <a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/cloudformation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
       <p>Sélectionnez la pile qui contient le jeu de modifications que vous souhaitez initier, puis choisissez l'onglet <b>Change sets</b> (Jeux de modifications).</p>
      </li><li>
       <p>Sélectionnez le jeu de modifications, puis cliquez sur <b>Execute</b> (Exécuter).</p>
      </li><li>
       <p>Pour <b>Execute change set</b> (Exécuter le jeu de modifications), sélectionnez l'option <b>Preserve successfully provisioned resources</b> (Préserver les ressources correctement allouées).</p>
      </li><li>
       <p>Sélectionnez <b>Execute change set</b> (Exécuter le jeu de modifications).</p>
      </li></ol></div>
     <p><em>Résultats</em> : les ressources qui n'ont pas pu être mises à jour passent l'état de la pile à <code class="code">UPDATE_FAILED</code> et reviennent au dernier état stable connu. Les ressources sans dernier état stable connu seront supprimées par CloudFormation lors de la prochaine opération de pile. Les ressources qui sont correctement allouées se trouvent à l'état <code class="code">CREATE_COMPLETE</code> ou <code class="code">UPDATE_COMPLETE</code>. Vous pouvez surveiller la pile dans l'onglet <b>Stack events</b> (Événements de la pile).</p>
    </dd>
  </dl></awsdocs-tabs>
  
  <h2 id="stack-failure-options-cli">Préserver les ressources correctement allouées (AWS CLI)</h2>
  <awsdocs-tabs><dl style="display: none">
   <dt>Create stack</dt><dd tab-id="create-stack">
     <div class="procedure"><h6>Pour préserver les ressources correctement allouées lors d'une opération de création de pile</h6><p>Spécifiez l'option <code class="code">disable-rollback</code> ou l'énumération <code class="code">on-failure DO_NOTHING</code> au cours d'une opération <a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/create-stack.html">create-stack</a>.</p><ol><li>
       <p>Fournissez un nom de pile et un modèle à la commande <code class="code">create-stack</code> avec l'option <code class="code">disable-rollback</code>.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation create-stack --stack-name <code class="code" copy="true">myteststack</code> --template-body <code class="replaceable">file://DOC-EXAMPLE-BUCKET.json</code> --disable-rollback</code></pre>
       <p>La commande renvoie le résultat suivant.</p>
       <pre class="screen"><span>{</span>
    "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896"
}</pre>
      </li><li>
       <p>Décrivez l'état de la pile à l'aide de l'option <code class="code">describe-stacks</code>.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation describe-stacks --stack-name <code class="replaceable">myteststack</code></code></pre>
       <p>La commande renvoie le résultat suivant.</p>
       <pre class="screen"><span>{</span>
    "Stacks":  [
        <span>{</span>
            "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896",
            "Description": "AWS CloudFormation Sample Template",
            "Tags": [],
            "Outputs": [],
            "StackStatusReason": “The following resource(s) failed to create: [MyBucket]”,
            "CreationTime": "2013-08-23T01:02:15.422Z",
            "Capabilities": [],
            "StackName": "myteststack",
            "StackStatus": "CREATE_FAILED",
            "DisableRollback": true
        }
    ]
}</pre>
      </li></ol></div>
    </dd>
   <dt>Update stack</dt><dd tab-id="update-stack">
     <div class="procedure"><h6>Pour préserver les ressources correctement allouées lors d'une opération de mise à jour de pile.</h6><ol><li>
       <p>Fournissez un nom de pile et un modèle existants à la commande <code class="code">update-stack</code> avec l'option <code class="code">disable-rollback</code>.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation update-stack --stack-name <code class="replaceable">myteststack</code> --template-url <code class="replaceable">DOC-EXAMPLE-BUCKET.template</code> --disable-rollback</code></pre>
       <p>La commande renvoie le résultat suivant.</p>
       <pre class="screen"><span>{</span>
    "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896"
}</pre>
      </li><li>
       <p>Décrivez l'état de la pile à l'aide de l'option <code class="code">describe-stacks</code> ou <code class="code">describe-stack-events</code>.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation describe-stacks --stack-name <code class="replaceable">myteststack</code></code></pre>
       <p>La commande renvoie le résultat suivant.</p>
       <pre class="screen"><span>{</span>
    "Stacks":  [
        <span>{</span>
            "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896",
            "Description": "AWS CloudFormation Sample Template",
            "Tags": [],
            "Outputs": [],
            "CreationTime": "2013-08-23T01:02:15.422Z",
            "Capabilities": [],
            "StackName": "myteststack",
            "StackStatus": "UPDATE_COMPLETE",
            "DisableRollback": true
        }
    ]
}</pre>
      </li></ol></div>
    </dd>
   <dt>Change set</dt><dd tab-id="change-set">
     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Vous pouvez initier un jeu de modifications pour une pile dont l'état est <code class="code">CREATE_FAILED</code> ou <code class="code">UPDATE_FAILED</code>, mais pas pour un état <code class="code">UPDATE_ROLLBACK_FAILED</code>.</p></div></div>
     <div class="procedure"><h6>Pour préserver les ressources correctement allouées lors d'une opération de modification de pile</h6><p>Spécifiez l'option <code class="code">disable-rollback</code> au cours d'une opération <a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/execute-change-set.html">execute-change-set</a>.</p><ol><li>
       <p>Fournissez un nom de pile et un modèle à la commande <code class="code">execute-change-set</code> avec l'option <code class="code">disable-rollback</code>.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation execute-change-set --stack-name <code class="replaceable">myteststack</code> --change-set-name <code class="replaceable">my-change-set</code> --template-body file://template.yaml</code></pre>
       <p>La commande renvoie le résultat suivant.</p>
       <pre class="screen"><span>{</span>
 "Id": "arn:aws:cloudformation:us-east-1:123456789012:changeSet/my-change-set/bc9555ba-a949-xmpl-bfb8-f41d04ec5784",
 "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896"
}</pre>
      </li><li>
       <p>Lancez le jeu de modifications à l'aide de l'option <code class="code">disable-rollback</code>.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation execute-change-set --stack-name <code class="replaceable">myteststack</code> --change-set-name <code class="replaceable">my-change-set</code> -–disable-rollback</code></pre>
      </li><li>
       <p>Déterminez l'état de la pile à l'aide de l'option <code class="code">describe-stacks</code> ou <code class="code">describe-stack-events</code>.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "StackEvents": [
     <span>{</span>
        "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896",
        "EventId": "49c966a0-7b74-11ea-8071-024244bb0672",
        "StackName": "myteststack",
        "LogicalResourceId": " MyBucket",
        "PhysicalResourceId": "MyBucket",
        "ResourceType": "AWS::S3::Bucket",
        "Timestamp": "2020-04-10T21:43:17.015Z",
        "ResourceStatus": "UPDATE_FAILED"
        "ResourceStatusReason": "User XYZ is not allowed to perform S3::UpdateBucket on MyBucket"
     }
}</code></pre>
      </li><li>
       <p>Corrigez les erreurs d'autorisation et réessayez l'opération.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation update-stack --stack-name <code class="replaceable">myteststack</code> --use-previous-template --disable-rollback</code></pre>
       <p>La commande renvoie le résultat suivant.</p>
       <pre class="screen"><span>{</span>
    "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896"
}</pre>
      </li><li>
       <p>Décrivez l'état de la pile à l'aide de l'option <code class="code">describe-stacks</code> ou <code class="code">describe-stack-events</code>.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation describe-stacks --stack-name <code class="replaceable">myteststack</code></code></pre>
       <p>La commande renvoie le résultat suivant.</p>
       <pre class="screen"><span>{</span>
    "Stacks":  [
        <span>{</span>
            "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896",
            "Description": "AWS CloudFormation Sample Template",
            "Tags": [],
            "Outputs": [],
            "CreationTime": "2013-08-23T01:02:15.422Z",
            "Capabilities": [],
            "StackName": "myteststack",
            "StackStatus": "UPDATE_COMPLETE",
            "DisableRollback": true
        }
    ]
}</pre>
      </li></ol></div>
    </dd>
  </dl></awsdocs-tabs>
  
   
   <h3 id="roll-back-stack-cli">Restaurer la pile</h3>
   
   <div class="procedure"><h6>Pour restaurer une pile à partir de l'état CREATE_FAILED ou UPDATE_FAILED</h6><p>Spécifiez l'opération <code class="code">rollback-stack</code> pour restaurer une pile à son dernier état stable.</p><ul><li>
     <p>Lancez une restauration à l'aide de l'opération <code class="code">rollback-stack</code> et spécifiez le nom de la pile.</p>
     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation rollback-stack --stack-name <code class="replaceable">myteststack</code></code></pre>
     <p>La commande renvoie le résultat suivant.</p>
     <pre class="screen"><span>{</span>
    "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/myteststack/466df9e0-0dff-08e3-8e2f-5088487c4896"
}</pre>
    </li></ul></div>
   <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>L'opération <code class="code">rollback-stack</code> supprimera une pile si elle ne contient pas un dernier état stable connu.</p></div></div>
   
  
 <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./stack-resource-configuration-complete.html">Déploiement en pile</div><div id="next" class="next-link" accesskey="n" href="./refactor-stacks.html">Déplacement de ressources d'une pile à une autre</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stack-failure-options.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>