<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Poursuite de la restauration d'une mise à jour - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="using-cfn-updating-stacks-continueupdaterollback" /><meta name="default_state" content="using-cfn-updating-stacks-continueupdaterollback" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" /><meta name="description" content="Pour une pile indiquant l'état UPDATE_ROLLBACK_FAILED, corrigez l'erreur qui a entraîné l'échec et continuez à restaurer la mise à jour pour rétablir la pile à son état de fonctionnement (UPDATE_ROLLBACK_COMPLETE)." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Guide de l'utilisateur" /><meta name="abstract" content="Créez et gérez des déploiements AWS d'infrastructure de manière prévisible et répétée à l'aide de ce AWS CloudFormation guide de l'utilisateur." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Guide de l'utilisateur" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Guide de l'utilisateur" /><meta id="panorama-serviceConsolePage" value="Poursuite de la restauration d'une mise à jour" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Poursuite de la restauration d'une mise à jour - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,provisionnement des ressources,configuration des ressources,gestion de l'infrastructure,CloudFormer,CloudFormation pile,CloudFormation stackset,CloudFormation modèle,jeu de modifications" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide de l'utilisateur",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Utilisation des piles",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacks.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Mises à jour des piles AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Poursuite de la restauration d'une mise à jour",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Guide de l'utilisateur</a></div><div id="page-toc-src"><a href="#nested-stacks">Utilisation de ResourcesToSkip pour récupérer une hiérarchie de piles imbriquées</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="using-cfn-updating-stacks-continueupdaterollback">Poursuite de la restauration d'une mise à jour</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Une pile passe à l'<code class="code">UPDATE_ROLLBACK_FAILED</code>état dans lequel il n'est pas AWS CloudFormation possible d'annuler toutes les modifications lors d'une mise à jour. Par exemple, vous pouvez avoir une pile qui commence à revenir à une ancienne instance de base de données supprimée en dehors de CloudFormation. Comme il  CloudFormation  ne sait pas que la base de données a été supprimée, il suppose que l'instance de base de données existe toujours et tente d'y revenir, ce qui entraîne l'échec de l'annulation de la mise à jour.</p><p>Quand une pile présente l'état <code class="code">UPDATE_ROLLBACK_FAILED</code>, vous pouvez poursuivre sa restauration à un état de fonctionnement (<code class="code">UPDATE_ROLLBACK_COMPLETE</code>). Vous ne pouvez pas mettre à jour une pile dont l'état est <code class="code">UPDATE_ROLLBACK_FAILED</code>. Toutefois, si vous pouvez poursuivre la restauration, vous pouvez rétablir les paramètres d'origine de cette pile puis réessayer de la mettre à jour.</p><p>Dans la plupart des cas, vous devez corriger l'erreur qui entraîne l'échec de la restauration de la mise à jour avant de pouvoir continuer à restaurer la pile. Pour de plus amples informations, veuillez consulter . Dans d'autres cas, vous pouvez poursuivre la restauration de la mise à jour sans aucune modification (par exemple, lorsqu'une opération de la pile arrive à expiration).</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Si vous utilisez des piles imbriquées, la restauration de la pile parent tente de restaurer également toutes les piles enfants.</p></div></div><div class="procedure"><h6>Pour poursuivre la restauration d'une mise à jour (console)</h6><ol><li><p>Ouvrez la AWS CloudFormation console à l'<a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>adresse https://console.aws.amazon.com/cloudformation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
      <p>Sélectionnez la pile que vous souhaitez mettre à jour, choisissez <b>Actions</b> puis <b>Poursuivre la restauration de la mise à jour</b>.</p>

      <p>Si aucune des solutions ne <a href="./troubleshooting.html#troubleshooting-errors">Résolution des erreurs</a> fonctionne, vous pouvez utiliser l'option avancée pour ignorer les ressources qui ne  CloudFormation peuvent pas être restaurées avec succès. Vous devez <a href="./cfn-console-view-stack-data-resources.html">rechercher</a> et saisir les ID logiques des ressources que vous souhaitez ignorer. Spécifiez uniquement les ressources qui sont entrées dans <code class="code">UPDATE_FAILED</code> cet état pendant <code class="code">UpdateRollback</code> et non pendant la mise à jour directe.</p>
      <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Avertissement</h6></div><div class="awsdocs-note-text"><p>CloudFormation définit le statut des ressources spécifiées sur <code class="code">UPDATE_COMPLETE</code> et continue de faire reculer la pile. Une fois la restauration terminée, l'état des ressources ignorées ne correspond pas à celui des ressources contenues dans le modèle de pile. Avant de procéder à une autre mise à jour de pile, vous devez mettre à jour la pile ou les ressources de façon à les rendre cohérentes les unes par rapport aux autres. A défaut, les futures mises à jour de la pile risquent d'échouer et la pile deviendra irrécupérable.</p></div></div>
      <p>Spécifiez le nombre minimum de ressources requises pour restaurer votre pile avec succès. Par exemple, une mise à jour de ressource ayant échoué peut entraîner l'échec de ressources dépendantes. Dans ce cas, il n'est peut-être pas nécessaire d'ignorer les ressources dépendantes.</p>
      <p>Pour ignorer des ressources faisant partie de piles imbriquées, utilisez le format suivant : <code class="code"><code class="replaceable">NestedStackName</code>.<code class="replaceable">ResourceLogicalID</code></code>. Si vous souhaitez spécifier l'ID logique d'une ressource de pile (<code class="code">Type: AWS::CloudFormation::Stack</code>) dans la liste <code class="code">ResourcesToSkip</code>, sa ressource de pile imbriquée correspondante doit être à l'un des états suivants : <code class="code">DELETE_IN_PROGRESS</code>, <code class="code">DELETE_COMPLETE</code> ou <code class="code">DELETE_FAILED</code>.</p>
    </li></ol></div><div class="procedure"><h6>Pour poursuivre la restauration d'une mise à jour (AWS CLI)</h6><ul><li>
   <p>Utilisez la commande <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/continue-update-rollback.html">aws cloudformation continue-update-rollback</a></code> avec l'option <code class="code">stack-name</code> pour spécifier l'ID de la pile que vous souhaitez continuer à restaurer.</p></li></ul></div><h2 id="nested-stacks">Utilisation de <code class="code">ResourcesToSkip</code> pour récupérer une hiérarchie de piles imbriquées</h2>
    
    <p>Le schéma suivant illustre une hiérarchie de piles imbriquées à l'état <code class="code">UPDATE_ROLLBACK_FAILED</code>. Dans cet exemple, la pile racine <code class="code">WebInfra</code> comporte deux piles imbriquées : <code class="code">WebInfra-Compute</code> et <code class="code">WebInfra-Storage</code>, qui ont aussi une ou plusieurs piles imbriquées.</p>
    <div class="mediaobject">
       
        <img src="images/cfn-update-stack-continue-update-rollback_nested-stacks.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Schéma illustrant une hiérarchie de piles imbriquées à trois niveaux.&#xA;      " style="max-width:100%" />
       
       
    </div>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Les noms de pile de cet exemple sont tronqués par souci de simplification. Les noms des piles d'enfants sont généralement générés par  CloudFormation  et contiennent des chaînes aléatoires uniques, de sorte que les noms réels peuvent ne pas être faciles à utiliser.</p></div></div>      
    <p>Pour mettre la pile racine à un état opérationnel à l'aide de <code class="code">continue-update-rollback</code>, vous devez utiliser le paramètre <code class="code">resources-to-skip</code> pour ignorer les ressources pour lesquelles la restauration a échoué. Dans cet exemple, <code class="code">resources-to-skip</code> incluent les éléments suivants :</p>
    <div class="orderedlist">
       
       
       
       
    <ol><li><p>myCustom</p></li><li><p>WebInfra-Compute-ASG.myasg</p></li><li><p>WebInfra-Calculer. myLoadBalancer</p></li><li><p>WebInfra-Storage.DB</p></li></ol></div>
    <p>L'exemple suivant est la AWS CLI commande complète :</p>
    <pre class="programlisting"><div class="code-btn-container"></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">aws cloudformation continue-update-rollback --stack-name WebInfra \
    --resources-to-skip myCustom WebInfra-Compute-Asg.myAsg WebInfra-Compute-LB.myLoadBalancer WebInfra-Storage.DB</code></code></pre>
    <p>Nous avons spécifié les ressources de piles imbriquées à l'aide du format <code class="code"><code class="replaceable">NestedStackName</code>.<code class="replaceable">ResourceLogicalID</code></code>, mais pour les ressources de la pile racine, comme <em>myCustom</em>, nous avons indiqué uniquement l'ID logique.</p>
    <p><b>Recherche du nom de pile d'une pile imbriquée</b></p>
    <p>Vous pouvez trouver le nom d'une pile enfant dans son ID de pile ou son Amazon Resource Name (ARN). Dans l'exemple suivant, le nom de la pile est <em>WebInfra-Storage-Z2VKC706xKXT</em> :</p>
    <p><code class="code">arn:aws:cloudformation:us-east-1:123456789012:stack/WebInfra-Storage-Z2VKC706XKXT/ea9e7f90-54f7-11e6-a032-028f3d2330bd</code></p>  
    <p><b>Recherche de l'ID logique d'une pile imbriquée</b></p>
    <p>Vous pouvez trouver l'ID logique d'une pile enfant dans le définition de modèle de son parent. Dans le schéma, l'élément <code class="code">LogicalId</code> de la pile enfant <code class="code">WebInfra-Storage-DB</code> est <em>DB</em> dans son parent <code class="code">WebInfra-Storage</code>.</p>
    <p>Dans la  CloudFormation  console, vous pouvez également trouver l'identifiant logique dans la colonne <b>ID logique</b> de la ressource de pile sous l'onglet <b>Ressources</b> ou dans l'onglet <b>Événements</b>.</p>
<awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./protect-stack-resources.html">Empêcher les mises à jour des ressources de la pile</div><div id="next" class="next-link" accesskey="n" href="./using-cfn-stack-drift.html">Détection de modifications non gérées de la configuration des piles et des ressources</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>