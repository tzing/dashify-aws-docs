<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS::CloudFormation::Init - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="aws-resource-init" /><meta name="default_state" content="aws-resource-init" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="description" content="Incluez les métadonnées dans une instance Amazon EC2 pour le script d'assistant cfn-init à l'aide de la ressource AWS::CloudFormation::Init." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Guide de l'utilisateur" /><meta name="abstract" content="Créez et gérez des déploiements AWS d'infrastructure de manière prévisible et répétée à l'aide de ce AWS CloudFormation guide de l'utilisateur." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Guide de l'utilisateur" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Guide de l'utilisateur" /><meta id="panorama-serviceConsolePage" value="AWS::CloudFormation::Init" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS::CloudFormation::Init - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,provisionnement des ressources,configuration des ressources,gestion de l'infrastructure,CloudFormer,CloudFormation pile,CloudFormation stackset,CloudFormation modèle,jeu de modifications" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide de l'utilisateur",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Utilisation des modèles AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Anatomie du modèle",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-anatomy.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Metadonnées",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/metadata-section-structure.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "AWS::CloudFormation::Init",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/metadata-section-structure.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Guide de l'utilisateur</a></div><div id="page-toc-src"><a href="#aws-resource-cloudformation-init-syntax">Syntaxe</a><a href="#aws-resource-init-configsets">Jeux de configuration</a><a href="#aws-resource-init-commands">Commandes</a><a href="#aws-resource-init-files">Dépôt de </a><a href="#aws-resource-init-groups">Groups</a><a href="#aws-resource-init-packages">Packages</a><a href="#aws-resource-init-services">Services</a><a href="#aws-resource-init-sources">Sources</a><a href="#aws-resource-init-users">Users</a></div><div id="page-filters" style="display:none"><filter label="All" id="All"></filter><filter label="JSON" id="JSON"></filter><filter label="YAML" id="YAML"></filter></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="aws-resource-init"><code class="code">AWS::CloudFormation::Init</code></h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Utilisez le type <code class="code">AWS::CloudFormation::Init</code> pour inclure des métadonnées dans une instance Amazon EC2 pour le script d'assistant cfn-init. Si votre modèle appelle le script cfn-init, ce dernier recherche les métadonnées de ressource issues de la clé <code class="code">AWS::CloudFormation::Init</code>. Pour plus d'informations sur cfn-init, consultez <a href="./cfn-init.html">cfn-init</a>.</p><p>cfn-init prend en charge tous les types de métadonnées pour les systèmes Linux. Il prend en charge les types de métadonnées pour Windows avec les conditions décrites dans les sections suivantes.</p><p>Pour voir un exemple d'utilisation d'<code class="code">AWS::CloudFormation::Init</code> et du script d'assistant cfn-init, consultez <a href="./deploying.applications.html">Déploiement d'applications sur Amazon EC2 avec AWS CloudFormation</a>.</p><p>Pour voir un exemple qui montre comment utiliser cfn-init pour créer une pile Windows, consultez <a href="./cfn-windows-stacks-bootstrapping.html">Bootstrap Windows Stacks AWS CloudFormation</a>.</p>
      <h2 id="aws-resource-cloudformation-init-syntax">Syntaxe</h2>

      <p>La configuration est divisée en sections. L'extrait de modèle suivant montre comment vous pouvez associez des métadonnées pour cfn-init à une ressource d'instance EC2 dans le modèle.</p>
      <p>Les métadonnées sont organisées en clés de configuration, que vous pouvez regrouper en jeux de configuration. Vous pouvez spécifier un jeu de configuration lorsque vous appelez cfn-init dans votre modèle. Si vous ne spécifiez aucun jeu de configuration, cfn-init recherche une clé de configuration unique nommée <em>config</em>.</p>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Le script d'assistant cfn-init traite ces sections de configuration dans l'ordre suivant : packages, groupes, utilisateurs, sources, fichiers, commandes, puis services. Si vous avez besoin d'un ordre différent, séparez vos sections en clés de configuration distinctes, puis utilisez un jeu de configuration qui spécifie l'ordre dans lequel ces clés doivent être traitées.</p></div></div>

      <div id="JSON" name="JSON" class="section langfilter">
         <h3 id="aws-resource-cloudformation-init-syntax.json">JSON</h3>

         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Resources": <span>{</span>
  "MyInstance": <span>{</span>
    "Type": "AWS::EC2::Instance",
    "Metadata" : <span>{</span>
      "AWS::CloudFormation::Init" : <span>{</span>
        "config" : <span>{</span>
          "packages" : <span>{</span>
            :
          },
          "groups" : <span>{</span>
            :
          },
          "users" : <span>{</span>
            :
          },
          "sources" : <span>{</span>
            :
          },
          "files" : <span>{</span>
            :
          },
          "commands" : <span>{</span>
            :
          },
          "services" : <span>{</span>
            :
          }
        }
      }
    },
    "Properties": <span>{</span>
      :
    }
  }
}</code></pre>
      </div>
      <div id="YAML" name="YAML" class="section langfilter">
         <h3 id="aws-resource-cloudformation-init-syntax.yaml">YAML</h3>

         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Resources: 
  MyInstance: 
    Type: AWS::EC2::Instance
    Metadata: 
      AWS::CloudFormation::Init: 
        config: 
          packages: 
            :
          groups: 
            :
          users: 
            :
          sources: 
            :
          files: 
            :
          commands: 
            :
          services: 
            :
    Properties: 
      :</code></pre>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Pour spécifier la propriété <code class="code">AWS::CloudFormation::Init</code> d'une instance Amazon EC2, reportez-vous à l'<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-init.html#cfn-init-Examples">exemple Amazon Linux</a>.</p></div></div>
      </div>
    
      <h2 id="aws-resource-init-configsets">Jeux de configuration</h2>

      <p>Si vous souhaitez créer plusieurs clés de configuration traitées dans un ordre spécifique par cfn-init, créez un jeu de configuration qui contient ces clés dans l'ordre souhaité.</p>
       
         <h3 id="w9aac23c15c15c23c13b5">Jeu de configuration unique</h3>

         <p>L'extrait d'exemple de modèle suivant crée les jeux de configuration <code class="code">ascending</code> et <code class="code">descending</code>, qui incluent chacun deux clés de configuration.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example1.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"AWS::CloudFormation::Init" : <span>{</span>
    "configSets" : <span>{</span>
        "ascending" : [ "config1" , "config2" ],
        "descending" : [ "config2" , "config1" ]
    },
    "config1" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$CFNTEST\" &gt; test.txt",
                "env" : <span>{</span> "CFNTEST" : "I come from config1." },
                "cwd" : "~"
            }
        }
    },
    "config2" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$CFNTEST\" &gt; test.txt",
                "env" : <span>{</span> "CFNTEST" : "I come from config2" },
                "cwd" : "~"
            }
        }
    }
}     </code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example1.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWS::CloudFormation::Init: 
  configSets: 
    ascending: 
      - "config1"
      - "config2"
    descending: 
      - "config2"
      - "config1"
  config1: 
    commands: 
      test: 
        command: "echo \"$CFNTEST\" &gt; test.txt"
        env: 
          CFNTEST: "I come from config1."
        cwd: "~"
  config2: 
    commands: 
      test: 
        command: "echo \"$CFNTEST\" &gt; test.txt"
        env: 
          CFNTEST: "I come from config2"
        cwd: "~"</code></pre>
         </div>
          
            <h4 id="w9aac23c15c15c23c13b5b9">Appels cfn-init connexes</h4>

            <p>Les exemples suivants d'appels à cfn-init utilisent les jeux de configuration précédents comme référence. Les exemples d'appels sont abrégés pour plus de clarté. Pour voir la syntaxe complète, consultez <a href="./cfn-init.html">cfn-init</a>.</p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>Si un appel à cfn-init spécifie le jeu de configuration <code class="code">ascending</code> :</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c ascending</code></code></pre>
                  <p>le script traite <code class="code">config1</code>, puis <code class="code">config2</code>, et le fichier test.txt contient le texte <code class="code">I
                        come from config2</code>.</p>
               </li><li class="listitem">
                  <p>Si un appel à cfn-init spécifie le jeu de configuration <code class="code">descending</code> :</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c descending</code></code></pre>
                  <p>le script traite <code class="code">config2</code>, puis <code class="code">config1</code>, et le fichier test.txt contient le texte <code class="code">I
                        come from config1</code>.</p>
               </li></ul></div>
          
       
       
         <h3 id="w9aac23c15c15c23c13b7">Plusieurs jeux de configuration</h3>

         <p>Vous pouvez créer plusieurs jeux de configuration et les appeler en série à l'aide du script cfn-init. Chaque jeu de configuration peut contenir une liste de clés de configuration ou des références à d'autres jeux de configuration. Par exemple, l'extrait de modèle suivant crée trois jeux de configuration. Le premier, <code class="code">test1</code>, contient une seule clé de configuration nommée <code class="code">1</code>. Le second, <code class="code">test2</code>, contient une référence au jeu de configuration <code class="code">test1</code> et une clé de configuration nommée <code class="code">2</code>. Le troisième, default, contient une référence au jeu de configuration <code class="code">test2</code>.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example2.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"AWS::CloudFormation::Init" : <span>{</span>
    "configSets" : <span>{</span>
        "test1" : [ "1" ],
        "test2" : [ <span>{</span> "ConfigSet" : "test1" }, "2" ],
        "default" : [ <span>{</span> "ConfigSet" : "test2" } ]
    },
    "1" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$MAGIC\" &gt; test.txt",
                "env" : <span>{</span> "MAGIC" : "I come from the environment!" },
                "cwd" : "~"
            }
        }
    },
    "2" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$MAGIC\" &gt;&gt; test.txt",
                "env" : <span>{</span> "MAGIC" : "I am test 2!" },
                "cwd" : "~"
            }
        }
    }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example2.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWS::CloudFormation::Init:
  1:
    commands:
      test:
        command: "echo \"$MAGIC\" &gt; test.txt"
        env:
          MAGIC: "I come from the environment!"
        cwd: "~"
  2:
    commands:
      test:
        command: "echo \"$MAGIC\" &gt;&gt; test.txt"
        env:
          MAGIC: "I am test 2!"
        cwd: "~"
  configSets: 
    test1:
      - "1"
    test2:
      -
        ConfigSet: "test1"
      - "2"
    default:
      -
        ConfigSet: "test2"</code></pre>
         </div>
          
            <h4 id="w9aac23c15c15c23c13b7b9">Appels cfn-init connexes</h4>

            <p>Les appels suivants à cfn-init font référence aux jeux de configuration déclarés dans l'extrait de modèle précédent. Les exemples d'appels sont abrégés pour plus de clarté. Pour voir la syntaxe complète, consultez <a href="./cfn-init.html">cfn-init</a>.</p>
            <div class="itemizedlist">
                
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>Si vous spécifiez <code class="code">test1</code> uniquement :</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c test1</code></code></pre>
                  <p>cfn-init traite la clé de configuration <code class="code">1</code> uniquement.</p>
               </li><li class="listitem">
                  <p>Si vous spécifiez <code class="code">test2</code> uniquement :</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c test2</code></code></pre>
                  <p>cfn-init traite la clé de configuration <code class="code">1</code>, puis la clé de configuration <code class="code">2</code>.</p>
               </li><li class="listitem">
                  <p>Si vous spécifiez le jeu de configuration <code class="code">default</code> (ou aucun jeu de configuration) :</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c default</code></code></pre>
                  <p>vous obtenez le même comportement que si vous spécifiez le jeu de configuration <code class="code">test2</code>.</p>
               </li></ul></div>
          
       
    
      <h2 id="aws-resource-init-commands">Commandes</h2>

      <p>Vous pouvez utiliser la clé de commande pour exécuter des commandes dans l'instance EC2. Les commandes sont traitées par ordre alphabétique en fonction de leur nom.</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c17b5"><thead>
               <tr>
                  <th>Clé</th>
                  <th>Obligatoire</th>
                  <th>Description</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>command</p>
                  </td>
                  <td tabindex="-1">Obligatoire</td>
                  <td tabindex="-1">
                     <p>Soit un tableau, soit une chaîne spécifiant la commande à exécuter. Si vous utilisez un tableau, vous n'avez pas besoin de caractères d'espacement ou d'inclure des paramètres de commande entre guillemets. N'utilisez pas le tableau pour spécifier plusieurs commandes.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>env</p>
                  </td>
                  <td tabindex="-1">Facultatif</td>
                  <td tabindex="-1">
                     <p>Définit des variables d'environnement pour la commande. Cette propriété remplace, plutôt que d'ajouter, l'environnement existant.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>cwd</p>
                  </td>
                  <td tabindex="-1">Facultatif</td>
                  <td tabindex="-1">
                     <p>Répertoire de travail.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>test</p>
                  </td>
                  <td tabindex="-1">Facultatif</td>
                  <td tabindex="-1">
                     <p>Commande de test qui détermine si cfn-init exécute les commandes spécifiées dans la clé de commande. Si le test réussit, cfn-init exécute les commandes. Le script cfn-init exécute le test dans un interpréteur de commandes, comme Bash ou <code>cmd.exe</code>. La réussite du test dépend du code de sortie que l'interpréteur renvoie.</p>
                     <p>Pour Linux, la commande de test doit retourner le code de sortie <code class="code">0</code> pour que le test réussisse. Pour Windows, la commande de test doit renvoyer la valeur %ERRORLEVEL% <code class="code">0</code>.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>ignoreErrors</p>
                  </td>
                  <td tabindex="-1">Facultatif</td>
                  <td tabindex="-1">
                     <p>Valeur booléenne qui détermine si cfn-init continue de s'exécuter si la commande contenue dans la clé de commande échoue (renvoie une valeur autre que zéro). Définissez la valeur <code class="code">true</code> si vous souhaitez que cfn-init continuer son exécution même en cas d'échec de la commande. Définissez la valeur <code class="code">false</code> si vous souhaitez que cfn-init arrête l'exécution si la commande échoue. La valeur par défaut est <code class="code">false</code>.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>waitAfterCompletion</p>
                  </td>
                  <td tabindex="-1">Facultatif</td>
                  <td tabindex="-1">
                     <p>Pour les systèmes Windows uniquement. Spécifie la durée (en secondes) à attendre après la fin d'une commande si cette dernière entraîne un redémarrage. La valeur par défaut est de 60 secondes. La valeur « forever » indique à cfn-init qu'il doit s'arrêter et reprendre uniquement une fois que le redémarrage est terminé. Définissez cette valeur sur <code class="code">0</code> si vous ne souhaitez pas attendre chaque commande.</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="w9aac23c15c15c23c15b7">Exemple</h3>

         <p>L'extrait de l'exemple suivant appelle la commande echo si le fichier <code class="code">~/test.txt</code> n'existe pas.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-commands-example.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"commands" : <span>{</span>
    "test" : <span>{</span>
        "command" : "echo \"$MAGIC\" &gt; test.txt",
        "env" : <span>{</span> "MAGIC" : "I come from the environment!" },
        "cwd" : "~",
        "test" : "test ! -e ~/test.txt",
        "ignoreErrors" : "false"
    },
    "test2" : <span>{</span>
        "command" : "echo \"$MAGIC2\" &gt; test2.txt",
        "env" : <span>{</span> "MAGIC2" : "I come from the environment!" },
        "cwd" : "~",
        "test" : "test ! -e ~/test2.txt",
        "ignoreErrors" : "false"
    }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-commands-example.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">commands:
  test:
    command: "echo \"$MAGIC\" &gt; test.txt"
    env:
      MAGIC: "I come from the environment!"
    cwd: "~"
    test: "test ! -e ~/test.txt"
    ignoreErrors: "false"
  test2:
    command: "echo \"$MAGIC2\" &gt; test2.txt"
    env:
      MAGIC2: "I come from the environment!"
    cwd: "~"
    test: "test ! -e ~/test2.txt"
    ignoreErrors: "false"</code></pre>
         </div>
       
    
      <h2 id="aws-resource-init-files">Dépôt de </h2>

      <p>Vous pouvez utiliser la clé <code class="code">files</code> pour créer des fichiers sur l'instance EC2. Le contenu peut être intégré dans le modèle ou extrait à partir d'une URL. Les fichiers sont écrits sur disque par ordre lexicographique. Le tableau suivant répertorie les clés prises en charge.</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c19b5"><thead>
               <tr>
                  <th>Clé</th>
                  <th>Description</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>content</p>
                  </td>
                  <td tabindex="-1">
                     <p>Chaîne ou objet JSON avec le bon format. Si vous utilisez un objet JSON pour votre contenu, le format JSON sera écrit dans un fichier sur le disque. Toute fonction intrinsèque, telle que <code class="code">Fn::GetAtt</code> ou <code class="code">Ref</code>, est évaluée avant l'écriture de l'objet JSON sur le disque. Lorsque vous créez un lien symbolique, spécifiez la cible du lien en tant que contenu.</p>
                     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Si vous avez créé un lien symbolique, le script d'assistant modifie les autorisations du fichier cible. Actuellement, vous ne pouvez pas créer un lien symbolique sans modifier les autorisations du fichier cible.</p></div></div>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>source</p>
                  </td>
                  <td tabindex="-1">
                     <p>Une URL à partir de laquelle charger le fichier. Cette option ne peut pas être spécifiée avec la clé de contenu.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>encoding</p>
                  </td>
                  <td tabindex="-1">
                     <p>Le format d'encodage. Utilisé uniquement si le contenu est une chaîne. L'encodage n'est pas appliqué si vous utilisez une source.</p>
                     <p>Valeurs valides : <code class="code">plain</code> | <code class="code">base64</code></p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>groupe</p>
                  </td>
                  <td tabindex="-1">
                     <p>Nom du groupe auquel appartient ce fichier. Non pris en charge pour les systèmes Windows.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>owner</p>
                  </td>
                  <td tabindex="-1">
                     <p>Nom de l'utilisateur auquel appartient ce fichier. Non pris en charge pour les systèmes Windows.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>mode</p>
                  </td>
                  <td tabindex="-1">
                     <p>Valeur octale à six chiffres qui représente le mode de ce fichier. Non pris en charge pour les systèmes Windows. Utilisez les trois premiers chiffres pour les liens symboliques et les trois derniers chiffres pour définir les autorisations. Pour créer un lien symbolique, spécifiez <code class="userinput">120<code class="replaceable">xxx</code></code>, où <code class="code">xxx</code> définit les autorisations du fichier cible. Pour définir des autorisations pour un fichier, utilisez les trois derniers chiffres, tels que <code class="userinput">000644</code>.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>authentification</p>
                  </td>
                  <td tabindex="-1">
                     <p>Nom d'une méthode d'authentification à utiliser. Celle-ci remplace toute authentification par défaut. Vous pouvez utiliser cette propriété pour sélectionner une méthode d'authentification que vous définissez avec la ressource <a href="./aws-resource-authentication.html">AWS::CloudFormation::Authentication</a>.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>context</p>
                  </td>
                  <td tabindex="-1">
                     <p>Spécifie un contexte pour les fichiers qui doivent être traités en tant que <a href="http://mustache.github.io/mustache.5.html" rel="noopener noreferrer" target="_blank"><span>modèles mustache</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. Pour utiliser cette clé, vous devez au préalable installer <code class="code">aws-cfn-bootstrap</code> 1.3–11 ou version ultérieure en plus de <a href="https://github.com/defunkt/pystache" rel="noopener noreferrer" target="_blank"><span>pystache</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="w9aac23c15c15c23c17b7">Exemples</h3>

         <p>L'exemple d'extrait suivant crée un fichier nommé setup.mysql dans le cadre d'une installation plus grande.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-setup-mysql.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"files" : <span>{</span>
  "/tmp/setup.mysql" : <span>{</span>
    "content" : <span>{</span> "Fn::Join" : ["", [
      "CREATE DATABASE ", <span>{</span> "Ref" : "DBName" }, ";\n",
      "CREATE USER '", <span>{</span> "Ref" : "DBUsername" }, "'@'localhost' IDENTIFIED BY '",
                       <span>{</span> "Ref" : "DBPassword" }, "';\n",
      "GRANT ALL ON ", <span>{</span> "Ref" : "DBName" }, ".* TO '", <span>{</span> "Ref" : "DBUsername" },
                       "'@'localhost';\n",
      "FLUSH PRIVILEGES;\n"
      ]]},
    "mode"  : "000644",
    "owner" : "root",
    "group" : "root"
  }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-setup-mysql.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">files: 
  /tmp/setup.mysql: 
    content: !Sub |
      CREATE DATABASE $<span>{</span>DBName};
      CREATE USER '$<span>{</span>DBUsername}'@'localhost' IDENTIFIED BY '$<span>{</span>DBPassword}';
      GRANT ALL ON $<span>{</span>DBName}.* TO '$<span>{</span>DBUsername}'@'localhost';
      FLUSH PRIVILEGES;
    mode: "000644"
    owner: "root"
    group: "root"</code></pre>
         </div>
         <p>Le modèle complet est disponible à l'<a href="https://s3.amazonaws.com/cloudformation-templates-us-east-1/Drupal_Single_Instance.template" rel="noopener noreferrer" target="_blank"><span>adresse suivante : https://s3.amazonaws.com/ cloudformation-templates-us-east -1/Drupal_Single_Instance.template</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
         <p>L'exemple d'extrait suivant crée un lien symbolique <code class="code">/tmp/myfile2.txt</code> qui renvoie vers le fichier <code class="code">/tmp/myfile1.txt</code>. Les autorisations du fichier cible <code class="code">/tmp/myfile1.txt</code> sont définies par la valeur de mode <code class="code">644</code>.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-symlink.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"files" : <span>{</span>
  "/tmp/myfile2.txt" : <span>{</span>
    "content" : "/tmp/myfile1.txt",
    "mode" : "120644"
  }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-symlink.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">files:
  /tmp/myfile2.txt:
    content: "/tmp/myfile1.txt"
    mode: "120644"</code></pre>
         </div>
         <p>Les modèles mustache sont utilisés principalement pour créer des fichiers de configuration. Par exemple, vous pouvez stocker un fichier de configuration dans un compartiment S3 et interpoler les références  GetAtts  à partir du modèle, au lieu de l'utiliser. <a href="./intrinsic-function-reference-join.html">Fn::Join</a> L'exemple d'extrait suivant génère la sortie « Content for test9 » dans <code>/tmp/test9.txt</code>.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-test9.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">
"files" : <span>{</span>
    "/tmp/test9.txt" : <span>{</span>
        "content" : "Content for <span>{</span><span>{</span>name}}",
        "context" : <span>{</span> "name" : "test9" }
    }
} </code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-test9.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">files:
  /tmp/test9.txt:
    content: "Content for <span>{</span><span>{</span>name}}"
    context:
      name: "test9"</code></pre>
         </div>
         <p>Lorsque vous travaillez avec des modèles mustache, notez les éléments suivants :</p>
         <div class="itemizedlist">
             
             
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>La clé de contexte doit être présente pour les fichiers à traiter.</p>
            </li><li class="listitem">
               <p>La clé de contexte doit être un mappage clé-valeur, mais elle peut être imbriquée.</p>
            </li><li class="listitem">
               <p>Vous pouvez traiter les fichiers avec du contenu intégré avec la clé content et les fichiers à distance avec la clé source.</p>
            </li><li class="listitem">
               <p>La prise en charge de Mustache dépend de la version pystache. La version 0.5.2 prend en charge la <a href="https://github.com/mustache/spec/tree/v1.1.2" rel="noopener noreferrer" target="_blank"><span>spécification Mustache 1.1.2</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
            </li></ul></div>
       
    
      <h2 id="aws-resource-init-groups">Groups</h2>

      <p>Vous pouvez utiliser la clé groups pour créer des groupes Linux/UNIX et pour attribuer des ID de groupe. La clé groups n'est pas prise en charge par les systèmes Windows.</p>
      <p>Pour créer un groupe, ajoutez une nouvelle paire clé-valeur qui mappe un nouveau nom de groupe à un ID de groupe facultatif. La clé des groupes peut contenir un ou plusieurs noms de groupe. Le tableau suivant répertorie les clés disponibles.</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c21b7"><thead>
               <tr>
                  <th>Clé</th>
                  <th>Description</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>
                        <code class="code">gid</code></p>
                  </td>
                  <td tabindex="-1">
                     <p>Numéro d'identification d'un groupe.</p>
                     <p>Si un ID de groupe est spécifié et que le nom du groupe existe déjà, la création du groupe échoue. Si un autre groupe contient l'ID de groupe spécifié, le système d'exploitation peut refuser la création du groupe.</p>
                     <p>Exemple : <code class="code"><span>{</span> "gid" : "23" }</code></p>
                  </td>
               </tr>
            </table></div></div>
      
       
         <h3 id="aws-resource-init-groups-snippet">Exemple d'extrait</h3>

         <p>L'extrait suivant spécifie un groupe nommé <code class="code">groupOne</code> sans attribuer d'ID de groupe, et un groupe nommé <code class="code">groupTwo</code> qui a spécifié <code class="code">45</code> comme valeur d'ID de groupe.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-groups-snippet.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"groups" : <span>{</span>
    "groupOne" : <span>{</span>},
    "groupTwo" : <span>{</span> "gid" : "45" }
}</code></pre>
         </div>
         
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-groups-snippet.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">groups:
  groupOne: <span>{</span>}
  groupTwo:
    gid: "45"</code></pre>
         </div>
       
    
      <h2 id="aws-resource-init-packages">Packages</h2>

      <p>Vous pouvez utiliser la clé packages pour télécharger et installer des applications et des composants prépackagés. Sur les systèmes Windows, la clé packages prend uniquement en charge le programme d'installation MSI.</p>
       
         <h3 id="aws-resource-init-packages-formats">Formats de packages pris en charge</h3>

         <p>Le script cfn-init prend actuellement en charge les formats de packages suivants : apt, msi, python, rpm, rubygems, yum et Zypper. Les packages sont traités dans l'ordre suivant : rpm, yum/apt/zypper, puis rubygems et python. Il n'existe pas d'ordre établi entre les packages rubygems et python, et les packages inclus dans chaque gestionnaire de package n'ont aucune garantie d'être installés selon un certain ordre.</p>
       
       
         <h3 id="aws-resource-init-packages-versions">Spécification des versions</h3>

         <p>Au sein de chaque gestionnaire de package, chaque package est spécifié sous la forme d'un nom de package et d'une liste de versions. La version peut être une chaîne, une liste de versions, ou une chaîne ou une liste vide. Une chaîne ou une liste vide indique que vous souhaitez la dernière version. Pour le gestionnaire rpm, la version est spécifiée sous la forme d'un chemin d'accès à un fichier sur disque ou d'une URL.</p>
         <p>Si vous spécifiez une version d'un package, cfn-init tente d'installer cette version, même si une version plus récente du package est déjà installée sur l'instance. Certains gestionnaires de package prennent en charge plusieurs versions, mais pas tous. Vérifiez la documentation de votre gestionnaire de package pour plus d'informations. Si vous ne spécifiez pas de version et si une version du package est déjà installée, le script cfn-init n'installe pas de nouvelle version. Il suppose que vous souhaitez conserver et utiliser la version existante.</p>
       
       
         <h3 id="aws-resource-init-packages-snippet">Exemples d'extraits</h3>

          
            <h4 id="w9aac23c15c15c23c21b9b3">RPM, yum, Rubygems et Zypper</h4>

            <p>L'extrait suivant spécifie une URL de version pour rpm, demande les dernières versions à yum et Zypper et la version 0.10.2 de chef à rubygems :</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-packages-example1.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"rpm" : <span>{</span>
  "epel" : "http://download.fedoraproject.org/pub/epel/5/i386/epel-release-5-4.noarch.rpm"
},
"yum" : <span>{</span>
  "httpd" : [],
  "php" : [],
  "wordpress" : []
},
"rubygems" : <span>{</span>
  "chef" : [ "0.10.2" ]
},
"zypper" : <span>{</span>
  "git" : []
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-packages-example1.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">rpm:
  epel: "http://download.fedoraproject.org/pub/epel/5/i386/epel-release-5-4.noarch.rpm"
yum:
  httpd: []
  php: []
  wordpress: []
rubygems:
  chef:
    - "0.10.2"
zypper:
  git: []</code></pre>
            </div>
          
          
            <h4 id="w9aac23c15c15c23c21b9b5">Package MSI</h4>

            <p>L'extrait suivant spécifie une URL pour un package MSI :</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-packages-example2.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"msi" : <span>{</span>
  "awscli" : "https://s3.amazonaws.com/aws-cli/AWSCLI64.msi"
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-packages-example2.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">msi:
  awscli: "https://s3.amazonaws.com/aws-cli/AWSCLI64.msi"</code></pre>
            </div>
          
       
    
      <h2 id="aws-resource-init-services">Services</h2>

      <p>Vous pouvez utiliser la clé services pour définir les services qui doivent être activés ou désactivés lors du lancement de l'instance. Sur les systèmes Linux, cette clé est prise en charge avec sysvinit ou systemd. Sur les systèmes Windows, elle est prise en charge en utilisant le gestionnaire de services Windows.</p>
      <p>La clé services vous permet également de spécifier les dépendances des sources, des packages et des fichiers. De cette façon, si un redémarrage est nécessaire en raison de l'installation de fichiers, cfn-init s'occupe du redémarrage du service. Par exemple, si vous téléchargez le package Apache HTTP Server, son installation lance automatiquement Apache HTTP Server pendant le processus de création de la pile. Toutefois, si la configuration Apache HTTP Server est mise à jour ultérieurement lors de la création de la pile, la mise à jour ne prendra effet, sauf si le serveur Apache est redémarré. Vous pouvez utiliser la clé services pour vous assurer que le service Apache HTTP est redémarré.</p>
      <p>Le tableau suivant répertorie les clés prises en charge.</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c25b9"><thead>
               <tr>
                  <th>Clé</th>
                  <th>Description</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>ensureRunning</p>
                  </td>
                  <td tabindex="-1">
                     <p>Définissez la valeur true pour garantir l'exécution du service après que cfn-init a terminé.</p>
                     <p>Définissez la valeur false pour garantir la non-exécution du service après que cfn-init a terminé.</p>
                     <p>Ignorez cette clé pour n'apporter aucune modification à l'état du service.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>activé</p>
                  </td>
                  <td tabindex="-1">
                     <p>Définissez la valeur true pour garantir le démarrage automatique du service en cas de redémarrage.</p>
                     <p>Définissez la valeur false pour garantir le non-démarrage automatique du service en cas de redémarrage.</p>
                     <p>Ignorez cette clé pour n'apporter aucune modification à cette propriété.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>files</p>
                  </td>
                  <td tabindex="-1">
                     <p>Liste de fichiers. Si cfn-init en modifie un directement via le bloc de fichiers, ce service sera redémarré.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>sources</p>
                  </td>
                  <td tabindex="-1">
                     <p>Liste de répertoires. Si cfn-init développe une archive dans l'une de ces répertoires, ce service sera redémarré.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>packages</p>
                  </td>
                  <td tabindex="-1">
                     <p>Mappage du gestionnaire de package avec la liste des noms de package. Si cfn-init installe ou met à jour un de ces packages, ce service sera redémarré.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>commands</p>
                  </td>
                  <td tabindex="-1">
                     <p>Liste de noms de commandes. Si cfn-init exécute la commande spécifiée, ce service sera redémarré.</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="w9aac23c15c15c23c23c11">Exemples</h3>

          
            <h4 id="w9aac23c15c15c23c23c11b3">Linux</h4>

            <p>L'extrait Linux suivant configure les services comme suit :</p>
            <div class="itemizedlist">
                
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>Le service nginx sera redémarré si cfn-init modifie <code class="code">/etc/nginx/nginx.conf</code> ou <code class="code">/var/www/html</code>.</p>
               </li><li class="listitem">
                  <p>Le service php-fastcgi sera redémarré si cfn-init installe ou met à jour php ou spawn-fcgi avec yum.</p>
               </li><li class="listitem">
                  <p>Le service sendmail sera arrêté et désactivé à l'aide de systemd.</p>
               </li></ul></div>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-services-example1.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"services" : <span>{</span>
  "sysvinit" : <span>{</span>
    "nginx" : <span>{</span>
      "enabled" : "true",
      "ensureRunning" : "true",
      "files" : ["/etc/nginx/nginx.conf"],
      "sources" : ["/var/www/html"]
    },
    "php-fastcgi" : <span>{</span>
      "enabled" : "true",
      "ensureRunning" : "true",
      "packages" : <span>{</span> "yum" : ["php", "spawn-fcgi"] }
    }
  },
  "systemd": <span>{</span>
    "sendmail" : <span>{</span>
      "enabled" : "false",
      "ensureRunning" : "false"
    }
  }
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-services-example1.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">services:
  sysvinit:
    nginx:
      enabled: "true"
      ensureRunning: "true"
      files:
        - "/etc/nginx/nginx.conf"
      sources:
        - "/var/www/html"
    php-fastcgi:
      enabled: "true"
      ensureRunning: "true"
      packages:
        yum:
          - "php"
          - "spawn-fcgi"
  systemd:
    sendmail:
      enabled: "false"
      ensureRunning: "false"</code></pre>
               <p>Pour utiliser systemd avec un service, le service doit disposer d'un fichier d'unité systemd configuré. Le fichier d'unité suivant permet à systemd de démarrer et d'arrêter le démon <a href="./cfn-hup.html">cfn-hup</a> dans la cible de service multiutilisateurs :</p>
                  
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="conf ">[Unit]
Description=cfn-hup daemon
[Service]
ExecStart=/usr/bin/cfn-hup -v
PIDFile=/var/run/cfn-hup.pid
[Install]
WantedBy=multi-user.target</code></pre>
               <p>Cette configuration suppose que cfn-hup est installé sous le répertoire <em>/usr/bin</em>. Cependant, l'emplacement d'installation de cfn-hup peut varier selon les plateformes. Vous pouvez remplacer cette configuration en créant un fichier de remplacement dans <em>/etc/system/cfn-hup.service.d/override.conf</em> comme suit :</p>
                  
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="conf "># In this example, cfn-hup executable is available under /usr/local/bin
[Service]
ExecStart=
ExecStart=/usr/local/bin/cfn-hup -v</code></pre>
            </div>
          
          
            <h4 id="aws-resource-init-windows-example">Windows</h4>

            <p>L'extrait Windows suivant démarre le service <a href="./cfn-hup.html">cfn-hup</a>, le définit comme automatique et le redémarre si <code class="code">cfn-init</code> modifie les fichiers de configuration spécifiés :</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-services-example2.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"services" : <span>{</span>
  "windows" : <span>{</span>
    "cfn-hup" : <span>{</span>
      "enabled" : "true",
      "ensureRunning" : "true",
      "files" : ["c:\\cfn\\cfn-hup.conf", "c:\\cfn\\hooks.d\\cfn-auto-reloader.conf"]
    }
  }
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-services-example2.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">services:
  windows:
    cfn-hup:
      enabled: "true"
      ensureRunning: "true"
      files:
        - "c:\\cfn\\cfn-hup.conf"
        - "c:\\cfn\\hooks.d\\cfn-auto-reloader.conf"</code></pre>
            </div>
          
       
    
      <h2 id="aws-resource-init-sources">Sources</h2>

      <p>Vous pouvez utiliser la clé sources pour télécharger un fichier d'archives et le décompresser dans un répertoire cible de l'instance EC2. Cette clé est entièrement prise en charge par les systèmes Linux et Windows.</p>
       
         <h6>Formats pris en charge</h6>
         <p>Formats pris en charge :</p>
       
      <div class="itemizedlist">
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><code class="code">tar</code></p>
         </li><li class="listitem">
            <p><code class="code">tar+gzip</code></p>
         </li><li class="listitem">
            <p><code class="code">tar+bz2</code></p>
         </li><li class="listitem">
            <p><code class="code">zip</code></p>
         </li></ul></div>
     
         <h3 id="aws-resource-init-sources-examples">Exemples</h3>
      
            <h4 id="aws-resource-init-sources-examples-github">GitHub</h4>
            <p>Si vous l'utilisez  GitHub  comme système de contrôle de source, vous pouvez utiliser cfn-init et le mécanisme de paquetage des sources pour extraire une version spécifique de votre application.  GitHub vous permet de créer un fichier .zip ou .tar à partir d'une version spécifique via une URL comme suit :</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="text ">https://github.com/&lt;your directory&gt;/(zipball|tarball)/&lt;version&gt;</code></pre>
            <p>Par exemple, l'extrait suivant extrait la version <em>main</em> sous forme de fichier <code>.tar</code>.</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-sources-example1.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"sources" : <span>{</span>
  "/etc/puppet" : "https://github.com/user1/cfn-demo/tarball/main"
  }</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-sources-example1.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">sources:
  /etc/puppet: "https://github.com/user1/cfn-demo/tarball/main"</code></pre>
            </div>
          
      
            <h4 id="aws-resource-init-sources-examples-s3">S3 Bucket</h4>
            <p>L'exemple suivant télécharge une archive à partir d'un compartiment S3 et la décompresse dans <code class="code">/etc/myapp</code> :</p>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Vous pouvez utiliser les informations d'authentification pour une source. Cependant, vous ne pouvez pas intégrer une clé authentication dans le bloc sources. Au lieu de cela, vous devez inclure une clé buckets dans le bloc <code class="code">S3AccessCreds</code>. Pour plus d'informations sur les informations d'identification Amazon S3, consultez <a href="./aws-resource-authentication.html">AWS::CloudFormation::Authentication</a>.</p><p><span>Pour voir un exemple, consultez l’<a href="https://s3.amazonaws.com/cloudformation-templates-us-east-1/S3Bucket_SourceAuth.template" rel="noopener noreferrer" target="_blank"><span>exemple de modèle</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</span></p></div></div>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-sources-example2.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"sources" : <span>{</span>
  "/etc/myapp" : "https://s3.amazonaws.com/mybucket/myapp.tar.gz"
  }</code></pre>
               
               
               

            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-sources-example2.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">sources:
  /etc/myapp: "https://s3.amazonaws.com/mybucket/myapp.tar.gz"</code></pre>
               
               
               


            </div>
          
       
    
      <h2 id="aws-resource-init-users">Users</h2>

      <p>Vous pouvez utiliser la clé users pour créer des utilisateurs Linux/UNIX dans l'instance EC2. La clé users n'est pas prise en charge par les systèmes Windows.</p>
      <p>Le tableau suivant répertorie les clés prises en charge.</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c29b7"><thead>
               <tr>
                  <th>Clé</th>
                  <th>Description</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>uid</p>
                  </td>
                  <td tabindex="-1">
                     <p>ID d'un utilisateur. Le processus de création échoue si le nom d'utilisateur existe avec un autre ID d'utilisateur. Si l'ID d'utilisateur est déjà attribué à un utilisateur existant, le système d'exploitation peut refuser la requête de création.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>groups</p>
                  </td>
                  <td tabindex="-1">
                     <p>Liste de noms de groupes. L'utilisateur sera ajouté à chaque groupe de la liste.</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>homeDir</p>
                  </td>
                  <td tabindex="-1">
                     <p>Répertoire de base de l'utilisateur.</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="aws-resource-init-users-example">Exemple</h3>

         <p>Les utilisateurs sont créés en tant qu'utilisateurs du système non interactif avec le shell <code class="code">/sbin/nologin</code>. Ce paramètre est intégré à la conception et ne peut pas être modifié.</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-users-example.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"users" : <span>{</span>
    "myUser" : <span>{</span>
        "groups" : ["groupOne", "groupTwo"],
        "uid" : "50",
        "homeDir" : "/tmp"
    }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-users-example.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">users:
  myUser:
    groups:
      - "groupOne"
      - "groupTwo"
    uid: "50"
    homeDir: "/tmp"</code></pre>
         </div>
       
   <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./aws-resource-authentication.html">AWS::CloudFormation::Authentication</div><div id="next" class="next-link" accesskey="n" href="./aws-resource-cloudformation-interface.html">AWS::CloudFormation::Interface</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>