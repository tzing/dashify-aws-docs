<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ressources personnalisées - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="template-custom-resources" /><meta name="default_state" content="template-custom-resources" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" /><meta name="description" content="Spécifie des ressources personnalisées de sorte que vous puissiez inclure des ressources non liées à AWS dans une pile AWS CloudFormation via la ressource AWS::CloudFormation::CustomResource." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Guide de l'utilisateur" /><meta name="abstract" content="Créez et gérez des déploiements AWS d'infrastructure de manière prévisible et répétée à l'aide de ce AWS CloudFormation guide de l'utilisateur." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Guide de l'utilisateur" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Guide de l'utilisateur" /><meta id="panorama-serviceConsolePage" value="Ressources personnalisées" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Ressources personnalisées - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-custom-resources.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,provisionnement des ressources,configuration des ressources,gestion de l'infrastructure,CloudFormer,CloudFormation pile,CloudFormation stackset,CloudFormation modèle,jeu de modifications" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide de l'utilisateur",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Utilisation des modèles AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Ressources personnalisées",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-guide.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Guide de l'utilisateur</a></div><div id="page-toc-src"><a href="#how-custom-resources-work">Fonctionnement des ressources personnalisées</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="template-custom-resources">Ressources personnalisées</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><div class="itemizedlist">
            <p>Le  CloudFormation  registre offre plusieurs avantages par rapport aux ressources personnalisées, notamment :</p>
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>La prise en charge de la modélisation, du provisionnement et de la gestion des ressources d'applications tierces</p>
            </li><li class="listitem">
                <p>La prise en charge des opérations <code class="code">Create</code>, <code class="code">Read</code>, <code class="code">Update</code>, <code class="code">Delete</code> et <code class="code">List</code> (<code class="code">CRUDL</code>)</p>
            </li><li class="listitem">
                <p>La prise en charge de la détection de l'écart sur les types de ressources privées et tierces</p>
            </li></ul></div><p>Contrairement aux ressources personnalisées, les ressources basées sur le registre n'ont pas besoin d'associer une rubrique Amazon SNS ou une fonction Lambda pour effectuer des opérations <code class="code">CRUDL</code>. Pour plus d'informations sur le  CloudFormation  registre, consultez la section <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/registry.html">Utilisation du AWS  CloudFormation  registre</a>.</p></div></div><p>Les ressources personnalisées vous permettent d'écrire une logique de mise en service personnalisée dans les modèles qu'AWS CloudFormation exécute chaque fois que vous créez, mettez à jour (si vous avez modifié la ressource personnalisée) ou supprimez des piles. Par exemple, vous pouvez inclure des ressources qui ne sont pas accessibles en tant que <a href="./aws-template-resource-type-ref.html">types de ressources</a> AWS CloudFormation. Vous pouvez inclure ces ressources à l'aide de ressources personnalisées. De cette façon, vous pouvez continuer à gérer toutes les ressources connexes dans une seule pile.</p><p>Utilisez le type de ressource <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudformation-customresource.html"><code class="code">AWS::CloudFormation::CustomResource</code></a> ou <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudformation-customresource.html#aws-resource-cloudformation-customresource--remarks"><code class="code">Custom::<code class="replaceable">MyCustomResourceTypeName</code></code></a> pour définir les ressources personnalisées de vos modèles. Les ressources personnalisées nécessitent une propriété : le jeton de service, qui spécifie où AWS CloudFormation envoie les demandes, tel qu'une rubrique Amazon SNS.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Si vous utilisez la fonctionnalité de <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-endpoints.html">point de terminaison d'un VPC</a>, les ressources personnalisées de ce VPC doivent avoir accès aux compartiments S3 spécifiques à AWS CloudFormation. Les ressources personnalisées doivent envoyer des réponses à une URL Amazon S3 pré-signée. Si elles ne peuvent pas envoyer des réponses à Amazon S3, AWS CloudFormation ne recevra pas de réponse et l'opération de la pile échouera. Pour plus d’informations, consultez <a href="./cfn-vpce-bucketnames.html">Configuration des points de terminaison d'un VPC pour AWS CloudFormation</a>.</p></div></div>
        <h2 id="how-custom-resources-work">Fonctionnement des ressources personnalisées</h2>
        <p>Toutes les actions effectuées pour une ressource personnalisée impliquent trois parties.</p>
        <div class="variablelist">
             
             
             
        <dl>
                <dt><span class="term">template developer</span></dt>
                <dd>
                    <p>Crée un modèle qui inclut un type de ressource personnalisée. Le template developer spécifie le jeton de service et des données du modèle.</p>
                </dd>
             
                <dt><span class="term">custom resource provider</span></dt>
                <dd>
                    <p>Possède la ressource personnalisée et détermine comment gérer les requêtes provenant d'AWS CloudFormation et comment y répondre. Le custom resource provider doit fournir un jeton de service que le template developer utilise.</p>
                </dd>
             
                <dt><span class="term">AWS CloudFormation</span></dt>
                <dd>
                    <p>Lors d'une opération de pile, envoie une demande à un jeton de service qui est spécifié dans le modèle, puis attend une réponse avant de procéder à cette opération.</p>
                </dd>
            </dl></div>
        <p>Le template developer et le custom resource provider peuvent être la même personne ou entité, mais le processus est le même. Les étapes suivantes décrivent le processus général :</p>
        <div class="orderedlist">
             
             
             
             
        <ol><li>
                <p>Le template developer définit une ressource personnalisée dans son modèle, qui inclut un jeton de service et les paramètres de données d'entrée. En fonction de la ressource personnalisée, les données d'entrée peuvent être obligatoires. Toutefois, le jeton de service est toujours requis.</p>
                <p>Le jeton de service spécifie où AWS CloudFormation envoie les demandes (par exemple, l'ARN d'une rubrique Amazon SNS ou d'une fonction AWS Lambda). Pour plus d’informations, consultez <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudformation-customresource.html"><code class="code">AWS::CloudFormation::CustomResource</code></a>. Le jeton de service et la structure des données d'entrée sont définis par le custom resource provider.</p>
            </li><li>
                <p>Chaque fois que quelqu'un utilise le modèle pour créer, mettre à jour ou supprimer une ressource personnalisée, AWS CloudFormation envoie une demande au jeton de service spécifié. Le jeton de service doit provenir de la même région que celle dans laquelle vous créez la pile.</p>
                <p>Dans cette demande, AWS CloudFormation inclut des informations telles que le type de demande et une URL Amazon Simple Storage Service pré-signée, à laquelle la ressource personnalisée envoie les réponses. Pour plus d'informations sur les éléments inclus dans la requête, consultez <a href="./crpg-ref-requests.html">Objets de requêtes de ressources personnalisées</a>.</p>
                <p>L'échantillon de données suivant présente ce qu'AWS CloudFormation inclut dans une requête :</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "RequestType" : "Create",
   "ResponseURL" : "http://pre-signed-S3-url-for-response",
   "StackId" : "arn:aws:cloudformation:us-west-2:123456789012:stack/stack-name/guid",
   "RequestId" : "unique id for this create request",
   "ResourceType" : "Custom::TestResource",
   "LogicalResourceId" : "MyTestResource",
   "ResourceProperties" : <span>{</span>
      "Name" : "Value",
      "List" : [ "1", "2", "3" ]
   }
}</code></pre>
                <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Dans cet exemple, <code class="code">ResourceProperties</code> permet à AWS CloudFormation de créer une charge utile personnalisée à envoyer à la fonction Lambda.</p></div></div>
            </li><li>
                <p>Le custom resource provider traite la demande AWS CloudFormation et renvoie la réponse <code class="code">SUCCESS</code> ou <code class="code">FAILED</code> à l'URL pré-signée. Le custom resource provider fournit la réponse dans un fichier au format JSON et la télécharge vers l'URL S3 pré-signée. Pour plus d'informations, veuillez consulter la rubrique <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/PresignedUrlUploadObject.html">Téléchargement d'objets utilisant des URL pré-signées</a> dans le <em>Guide du développeur Amazon Simple Storage Service</em>.</p>
                <p>Dans cette réponse, le custom resource provider peut aussi inclure les paires nom-valeur auxquelles le template developer peut accéder. Par exemple, la réponse peut inclure les données de sortie si la requête a abouti ou un message d'erreur en cas d'échec. Pour plus d'informations sur les réponses, consultez <a href="./crpg-ref-responses.html">Objets de réponse des ressources personnalisées</a>.</p>
                <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Si les paires nom-valeur contiennent des informations sensibles, vous devez utiliser le champ <code class="code">NoEcho</code> pour masquer la sortie de la ressource personnalisée. Sinon, les valeurs sont visibles via des API qui affichent des valeurs de propriétés de surface (telles que <code class="code">DescribeStackEvents</code>).</p><p>Pour plus d’informations sur l’utilisation de <code class="code">NoEcho</code> pour masquer des informations sensibles, consultez la documentation sur la bonne pratique consistant à <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/best-practices.html#creds">ne pas intégrer les informations d’identification dans vos modèles</a>.</p></div></div>
                <p>Le custom resource provider est chargé d'écouter la requête et d'y répondre. Par exemple, pour les notifications Amazon SNS, le custom resource provider doit écouter les notifications envoyées à l'ARN d'une rubrique spécifique et y répondre. AWS CloudFormation attend et écoute la réponse à l'emplacement de l'URL pré-signée.</p>
                <p>L'échantillon de données suivant montre ce qu'une ressource personnalisée peut inclure dans une réponse :</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Status" : "SUCCESS",
   "PhysicalResourceId" : "TestResource1",
   "StackId" : "arn:aws:cloudformation:us-west-2:123456789012:stack/stack-name/guid",
   "RequestId" : "unique id for this create request",
   "LogicalResourceId" : "MyTestResource",
   "Data" : <span>{</span>
      "OutputName1" : "Value1",
      "OutputName2" : "Value2",
   }
}</code></pre>
            </li><li>
                <p>Après avoir obtenu une réponse <code class="code">SUCCESS</code>, AWS CloudFormation procède à l'opération de pile. Sans réponse ou si une réponse <code class="code">FAILED</code> est renvoyée, l'opération échoue. Les données de sortie de la ressource personnalisée sont stockées à l'emplacement de l'URL pré-signée. Le template developer peut récupérer les données via la fonction <a href="./intrinsic-function-reference-getatt.html">Fn::GetAtt</a>.</p>
            </li></ol></div>
        
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./generate-IaC-apigateway-restapi.html">Ressources AWS::ApiGateway::RestApi</div><div id="next" class="next-link" accesskey="n" href="./template-custom-resources-sns.html">Ressources personnalisées basées sur Amazon Simple Notification Service</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-custom-resources.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-custom-resources.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>