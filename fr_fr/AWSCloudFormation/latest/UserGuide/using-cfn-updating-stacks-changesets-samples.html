<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Exemples de jeux de modifications - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="using-cfn-updating-stacks-changesets-samples" /><meta name="default_state" content="using-cfn-updating-stacks-changesets-samples" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" /><meta name="description" content="Tirez des leçons d'exemples AWS CloudFormation d'ensembles de modifications." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Guide de l'utilisateur" /><meta name="abstract" content="Créez et gérez des déploiements AWS d'infrastructure de manière prévisible et répétée à l'aide de ce AWS CloudFormation guide de l'utilisateur." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Guide de l'utilisateur" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Guide de l'utilisateur" /><meta id="panorama-serviceConsolePage" value="Exemples de jeux de modifications" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Exemples de jeux de modifications - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,provisionnement des ressources,configuration des ressources,gestion de l'infrastructure,CloudFormer,CloudFormation pile,CloudFormation stackset,CloudFormation modèle,jeu de modifications" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide de l'utilisateur",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Utilisation des piles",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacks.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Mises à jour des piles AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Mise à jour des piles à l'aide de jeux de modifications",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Exemples de jeux de modifications",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Guide de l'utilisateur</a></div><div id="page-toc-src"><a href="#using-cfn-updating-stacks-changesets-samples-directly-editing-a-template">Modification directe d'un modèle</a><a href="#using-cfn-updating-stacks-changesets-samples-modifying-a-single-input-parameter-value">Modification d'une valeur de paramètre d'entrée</a><a href="#using-cfn-updating-stacks-changesets-samples-determining-the-value-of-the-replacement-field">Détermination de la valeur du champ Replacement</a><a href="#using-cfn-updating-stacks-changesets-samples-adding-and-removing-resources">Ajout et suppression de ressources</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="using-cfn-updating-stacks-changesets-samples">Exemples de jeux de modifications</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Cette section fournit des exemples d'ensembles de modifications qui  CloudFormation  pourraient être créés pour les modifications de pile courantes. Ces exemples illustrent comment modifier un modèle directement, mettre à jour un paramètre d'entrée unique, planifier la recréation (ou le remplacement) des ressources (qui empêche de perdre les données qui n'étaient pas sauvegardées ou d'interrompre des applications en cours d'exécution dans votre pile) et comment ajouter ou supprimer des ressources. Pour décrire le fonctionnement des jeux de modifications, nous parcourrons les modifications qui ont été soumises et parlerons du jeu de modifications généré. Comme chaque exemple repose sur le précédent et présume que vous l'avez compris, nous vous recommandons de les lire dans l'ordre. Pour obtenir une description de chaque champ d'un jeu de modifications, veuillez consulter la rubrique <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_Change.html">Change</a> dans la <em>Référence d'APIAWS CloudFormation </em>.</p><p>Vous pouvez utiliser la <a href="./using-cfn-updating-stacks-changesets-view.html">console</a> ou l' AWS CLIopération  CloudFormation <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_DescribeChangeSet.html"><code class="code">DescribeChangeSet</code></a>API pour afficher les détails de l'ensemble de modifications.</p><p>Nous avons généré chacun des jeux de modifications suivants à partir d'une pile avec l’<a href="https://s3.amazonaws.com/cloudformation-examples/user-guide/changesets/ec2-instance.txt" rel="noopener noreferrer" target="_blank"><span>exemple de modèle</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> :</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Description" : "A sample EC2 instance template for testing change sets.",
  "Parameters" : <span>{</span>
    "Purpose" : <span>{</span>
      "Type" : "String",
      "Default" : "testing",
      "AllowedValues" : ["testing", "production"],
      "Description" : "The purpose of this instance."
    },
    "KeyPairName" : <span>{</span>
      "Type": "AWS::EC2::KeyPair::KeyName",
      "Description" : "Name of an existing EC2 KeyPair to enable SSH access to the instance"
    },
    "InstanceType" : <span>{</span>
      "Type" : "String",
      "Default" : "t2.micro",
      "AllowedValues" : ["t2.micro", "t2.small", "t2.medium"],
      "Description" : "The EC2 instance type."
    }
  },
  "Resources" : <span>{</span>
    "MyEC2Instance" : <span>{</span>
      "Type" : "AWS::EC2::Instance",
      "Properties" : <span>{</span>
        "KeyName" : <span>{</span> "Ref" : "KeyPairName" },
        "InstanceType" : <span>{</span> "Ref" : "InstanceType" },
        "ImageId" : "ami-8fcee4e5",
        "Tags" : [
          <span>{</span>
            "Key" : "Purpose",
            "Value" : <span>{</span> "Ref" : "Purpose" }
          }
        ]
      }
    }
  }
}</code></pre>
      <h2 id="using-cfn-updating-stacks-changesets-samples-directly-editing-a-template">Modification directe d'un modèle</h2>

      <p>Lorsque vous modifiez directement des ressources dans le modèle de la pile afin de générer un jeu de modifications,  CloudFormation  considère qu'il s'agit d'une modification directe, par opposition aux modifications lancées par une valeur de paramètre mise à jour. Le jeu de modifications suivant, qui a ajouté une balise à l'instance <code class="code">i-1abc23d4</code>, est un exemple de modification directe. Toutes les autres valeurs d'entrée, telles que les valeurs de paramètres et les capacités, restent les mêmes. Nous nous concentrerons donc sur la structure <code class="code">Changes</code>.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/SampleStack/1a2345b6-0000-00a0-a123-00abc0abc000",
    "Status": "CREATE_COMPLETE",
    "ChangeSetName": "SampleChangeSet-direct",
    "Parameters": [
        <span>{</span>
            "ParameterValue": "testing",
            "ParameterKey": "Purpose"
        },
        <span>{</span>
            "ParameterValue": "MyKeyName",
            "ParameterKey": "KeyPairName"
        },
        <span>{</span>
            "ParameterValue": "t2.micro",
            "ParameterKey": "InstanceType"
        }
    ],
    "Changes": [
        <span>{</span>
            "ResourceChange": <span>{</span>
                "ResourceType": "AWS::EC2::Instance",
                "PhysicalResourceId": "i-1abc23d4",
                "Details": [
                    <span>{</span>
                        "ChangeSource": "DirectModification",
                        "Evaluation": "Static",
                        "Target": <span>{</span>
                            "Attribute": "Tags",
                            "RequiresRecreation": "Never"
                        }
                    }
                ],
                "Action": "Modify",
                "Scope": [
                    "Tags"
                ],
                "LogicalResourceId": "MyEC2Instance",
                "Replacement": "False"
            },
            "Type": "Resource"
        }
    ],
    "CreationTime": "2020-11-18T23:35:25.813Z",
    "Capabilities": [],
    "StackName": "SampleStack",
    "NotificationARNs": [],
    "ChangeSetId": "arn:aws:cloudformation:us-east-1:123456789012:changeSet/SampleChangeSet-direct/1a2345b6-0000-00a0-a123-00abc0abc000"
}</code></pre>
      <p>Dans <code class="code">Changes</code>, il n'y a qu'une seule structure <code class="code">ResourceChange</code>. Cette structure décrit des informations telles que le type de ressource qui  CloudFormation  va changer, l'action  CloudFormation  à entreprendre, l'ID de la ressource, l'étendue de la modification et si la modification nécessite un remplacement ( CloudFormation création d'une nouvelle ressource puis suppression de l'ancienne). Dans l'exemple, l'ensemble de modifications indique que cela  CloudFormation  modifiera l'<code class="code">Tags</code>attribut de l'instance <code class="code">i-1abc23d4</code> EC2 et ne nécessite pas le remplacement de l'instance.</p>
      <p>Dans la <code class="code">Details</code> structure,  CloudFormation  qualifie cette modification de modification directe qui ne nécessitera jamais de recréer (remplacer) l'instance. Vous pouvez exécuter cette modification en toute confiance, en sachant que cela  CloudFormation  ne remplacera pas l'instance.</p>
      <p>CloudFormation montre ce changement sous forme d'<code class="code">Static</code>évaluation. Une évaluation statique permet de déterminer la valeur de la balise avant d'exécuter l'ensemble de modifications.  CloudFormation  Dans certains cas, vous ne  CloudFormation  pouvez déterminer une valeur qu'après avoir exécuté un ensemble de modifications.  CloudFormationqualifie ces modifications d'<code class="code">Dynamic</code>évaluations. Par exemple, si vous faites référence à une ressource mise à jour qui est remplacée de manière conditionnelle, vous ne  CloudFormation  pouvez pas déterminer si la référence à la ressource mise à jour va changer.</p>
     
      <h2 id="using-cfn-updating-stacks-changesets-samples-modifying-a-single-input-parameter-value">Modification d'une valeur de paramètre d'entrée</h2>

      <p>Lorsque vous modifiez une valeur de paramètre d'entrée,  CloudFormation  génère deux modifications pour chaque ressource qui utilise la valeur de paramètre mise à jour. Dans cet exemple, nous souhaitons mettre en évidence ce à quoi ressemblent ces modifications, ainsi que les informations que vous devez cibler. L'exemple suivant a été généré en modifiant uniquement la valeur du paramètre d'entrée <code class="code">Purpose</code>.</p>
      <p>Le paramètre <code class="code">Purpose</code> spécifie une valeur de clé de balise pour l'instance EC2. Dans cet exemple, la valeur de paramètre <code class="code">testing</code> a été remplacée par <code class="code">production</code>. La nouvelle valeur apparaît dans la structure <code class="code">Parameters</code>.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/SampleStack/1a2345b6-0000-00a0-a123-00abc0abc000",
    "Status": "CREATE_COMPLETE",
    "ChangeSetName": "SampleChangeSet",
    "Parameters": [
        <span>{</span>
            "ParameterValue": "production",
            "ParameterKey": "Purpose"
        },
        <span>{</span>
            "ParameterValue": "MyKeyName",
            "ParameterKey": "KeyPairName"
        },
        <span>{</span>
            "ParameterValue": "t2.micro",
            "ParameterKey": "InstanceType"
        }
    ],
    "Changes": [
        <span>{</span>
            "ResourceChange": <span>{</span>
                "ResourceType": "AWS::EC2::Instance",
                "PhysicalResourceId": "i-1abc23d4",
                "Details": [
                    <span>{</span>
                        "ChangeSource": "DirectModification",
                        "Evaluation": "Dynamic",
                        "Target": <span>{</span>
                            "Attribute": "Tags",
                            "RequiresRecreation": "Never"
                        }
                    },
                    <span>{</span>
                        "CausingEntity": "Purpose",
                        "ChangeSource": "ParameterReference",
                        "Evaluation": "Static",
                        "Target": <span>{</span>
                            "Attribute": "Tags",
                            "RequiresRecreation": "Never"
                        }
                    }
                ],
                "Action": "Modify",
                "Scope": [
                    "Tags"
                ],
                "LogicalResourceId": "MyEC2Instance",
                "Replacement": "False"
            },
            "Type": "Resource"
        }
    ],
    "CreationTime": "2020-11-18T23:59:18.447Z",
    "Capabilities": [],
    "StackName": "SampleStack",
    "NotificationARNs": [],
    "ChangeSetId": "arn:aws:cloudformation:us-east-1:123456789012:changeSet/SampleChangeSet/1a2345b6-0000-00a0-a123-00abc0abc000"
}</code></pre>
      <p>La structure <code class="code">Changes</code> fonctionne de manière similaire à l'exemple <a href="#using-cfn-updating-stacks-changesets-samples-directly-editing-a-template">Modification directe d'un modèle</a>. Il n'existe qu'une seule structure<code class="code">ResourceChange</code>. Elle décrit une modification apportée à l'attribut <code class="code">Tags</code> de l'instance EC2 <code class="code">i-1abc23d4</code>.</p>
      <p>Toutefois, dans la structure <code class="code">Details</code>, le jeu de modifications présente deux changements pour l'attribut <code class="code">Tags</code>, même si une seule valeur de paramètre a été modifiée. Les ressources qui référencent une valeur de paramètre modifiée (à l'aide de la fonction intrinsèque <code class="code">Ref</code>) entraînent toujours deux modifications : une avec une évaluation <code class="code">Dynamic</code> et une autre avec une évaluation <code class="code">Static</code>. Pour voir ces types de modification, consultez les champs suivants :</p>
      <div class="itemizedlist">
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p>Pour la modification de l'évaluation <code class="code">Static</code>, consultez le champ <code class="code">ChangeSource</code>. Dans cet exemple, le champ <code class="code">ChangeSource</code> équivaut à <code class="code">ParameterReference</code>, ce qui signifie que cette modification est le résultat de la mise à jour de la valeur de référence du paramètre. Le jeu de modifications doit comporter une modification de l'évaluation <code class="code">Dynamic</code> similaire.</p>
        </li><li class="listitem">
          <p>Pour identifier la modification de l'évaluation <code class="code">Dynamic</code> correspondante, comparez la structure <code class="code">Target</code> des deux modifications, qui contient les mêmes informations. Dans cet exemple, la structure <code class="code">Target</code> des deux modifications contient les mêmes valeurs pour les champs <code class="code">Attribute</code> et <code class="code">RequireRecreation</code>.</p>
        </li></ul></div>
      <p>Pour ces types de modifications, concentrez-vous sur l'évaluation statique, qui fournit des informations plus détaillées sur la modification. Dans cet exemple, l'évaluation statique indique que le changement est le résultat de la modification de la valeur de référence du paramètre (<code class="code">ParameterReference</code>). Le paramètre exact qui a été modifié est signalé par le champ <code class="code">CauseEntity</code> (le paramètre <code class="code">Purpose</code>).</p>
     
      <h2 id="using-cfn-updating-stacks-changesets-samples-determining-the-value-of-the-replacement-field">Détermination de la valeur du champ Replacement</h2>

      <p>Le <code class="code">Replacement</code> champ d'une <code class="code">ResourceChange</code> structure indique s'il est  CloudFormation  prévu de recréer la ressource. La planification de la recréation (ou du remplacement) de la ressource vous empêche de perdre les données qui n'étaient pas sauvegardées ou d'interrompre des applications en cours d'exécution dans votre pile.</p>
      <p>La valeur du champ <code class="code">Replacement</code> varie selon qu'une modification nécessite un remplacement, ce qui est indiqué par le champ <code class="code">RequiresRecreation</code> dans la structure <code class="code">Target</code> d'une modification. Par exemple, si le champ <code class="code">RequiresRecreation</code> indique <code class="code">Never</code>, le champ <code class="code">Replacement</code> contient la valeur <code class="code">False</code>. Toutefois, si plusieurs modifications sont apportées à une seule ressource et que chaque modification a une valeur différente pour le <code class="code">RequiresRecreation</code> champ,  CloudFormation  met à jour la ressource en utilisant le comportement le plus intrusif. En d'autres termes, si seulement l'une des nombreuses modifications nécessite un remplacement,  CloudFormation  doit remplacer la ressource et, par conséquent, définir le champ <code class="code">Replacement</code> sur <code class="code">True</code>.</p>
      <p>Le jeu de modifications suivant a été généré en modifiant les valeurs pour tous les paramètres (<code class="code">Purpose</code>, <code class="code">InstanceType</code> et <code class="code">KeyPairName</code>), qui sont toutes utilisées par l'instance EC2. Avec ces modifications, il  CloudFormation  sera nécessaire de remplacer l'instance car le <code class="code">Replacement</code> champ est égal à<code class="code">True</code>.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/SampleStack/1a2345b6-0000-00a0-a123-00abc0abc000",
    "Status": "CREATE_COMPLETE",
    "ChangeSetName": "SampleChangeSet-multiple",
    "Parameters": [
        <span>{</span>
            "ParameterValue": "production",
            "ParameterKey": "Purpose"
        },
        <span>{</span>
            "ParameterValue": "MyNewKeyName",
            "ParameterKey": "KeyPairName"
        },
        <span>{</span>
            "ParameterValue": "t2.small",
            "ParameterKey": "InstanceType"
        }
    ],
    "Changes": [
        <span>{</span>
            "ResourceChange": <span>{</span>
                "ResourceType": "AWS::EC2::Instance",
                "PhysicalResourceId": "i-7bef86f8",
                "Details": [
                    <span>{</span>
                        "ChangeSource": "DirectModification",
                        "Evaluation": "Dynamic",
                        "Target": <span>{</span>
                            "Attribute": "Properties",
                            "Name": "KeyName",
                            "RequiresRecreation": "Always"
                        }
                    },
                    <span>{</span>
                        "ChangeSource": "DirectModification",
                        "Evaluation": "Dynamic",
                        "Target": <span>{</span>
                            "Attribute": "Properties",
                            "Name": "InstanceType",
                            "RequiresRecreation": "Conditionally"
                        }
                    },
                    <span>{</span>
                        "ChangeSource": "DirectModification",
                        "Evaluation": "Dynamic",
                        "Target": <span>{</span>
                            "Attribute": "Tags",
                            "RequiresRecreation": "Never"
                        }
                    },
                    <span>{</span>
                        "CausingEntity": "KeyPairName",
                        "ChangeSource": "ParameterReference",
                        "Evaluation": "Static",
                        "Target": <span>{</span>
                            "Attribute": "Properties",
                            "Name": "KeyName",
                            "RequiresRecreation": "Always"
                        }
                    },
                    <span>{</span>
                        "CausingEntity": "InstanceType",
                        "ChangeSource": "ParameterReference",
                        "Evaluation": "Static",
                        "Target": <span>{</span>
                            "Attribute": "Properties",
                            "Name": "InstanceType",
                            "RequiresRecreation": "Conditionally"
                        }
                    },
                    <span>{</span>
                        "CausingEntity": "Purpose",
                        "ChangeSource": "ParameterReference",
                        "Evaluation": "Static",
                        "Target": <span>{</span>
                            "Attribute": "Tags",
                            "RequiresRecreation": "Never"
                        }
                    }
                ],
                "Action": "Modify",
                "Scope": [
                    "Tags",
                    "Properties"
                ],
                "LogicalResourceId": "MyEC2Instance",
                "Replacement": "True"
            },
            "Type": "Resource"
        }
    ],
    "CreationTime": "2020-11-18T00:39:35.974Z",
    "Capabilities": [],
    "StackName": "SampleStack",
    "NotificationARNs": [],
    "ChangeSetId": "arn:aws:cloudformation:us-east-1:123456789012:changeSet/SampleChangeSet-multiple/1a2345b6-0000-00a0-a123-00abc0abc000"
}</code></pre>
      <p>Consultez chaque modification (évaluations statiques dans la structure <code class="code">Details</code>) pour identifier celle qui nécessite le remplacement de la ressource. Dans cet exemple, chaque modification a une valeur différente pour le <code class="code">RequireRecreation</code> champ, mais la modification apportée à la <code class="code">KeyName</code> propriété présente le comportement de mise à jour le plus intrusif, nécessitant toujours une recréation.  CloudFormation remplacera l'instance car le nom de la clé a été modifié.</p>
      <p>Si le nom de clé n'avait pas changé, la modification de la propriété <code class="code">InstanceType</code> aurait le comportement de mise à jour le plus intrusif (<code class="code">Conditionally</code>). Le champ <code class="code">Replacement</code> indiquerait <code class="code">Conditionally</code>. Pour connaître les conditions dans lesquelles l'instance  CloudFormation  est remplacée, consultez le comportement de mise à jour de la <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-instance.html#cfn-ec2-instance-instancetype"><code class="code">InstanceType</code></a>propriété.</p>
     
      <h2 id="using-cfn-updating-stacks-changesets-samples-adding-and-removing-resources">Ajout et suppression de ressources</h2>

      <p>L'exemple suivant a été généré en soumettant un modèle modifié qui supprime l'instance EC2 et ajoute un groupe Auto Scaling, ainsi qu'une configuration de lancement.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/SampleStack/1a2345b6-0000-00a0-a123-00abc0abc000",
    "Status": "CREATE_COMPLETE",
    "ChangeSetName": "SampleChangeSet-addremove",
    "Parameters": [
        <span>{</span>
            "ParameterValue": "testing",
            "ParameterKey": "Purpose"
        },
        <span>{</span>
            "ParameterValue": "MyKeyName",
            "ParameterKey": "KeyPairName"
        },
        <span>{</span>
            "ParameterValue": "t2.micro",
            "ParameterKey": "InstanceType"
        }
    ],
    "Changes": [
        <span>{</span>
            "ResourceChange": <span>{</span>
                "Action": "Add",
                "ResourceType": "AWS::AutoScaling::AutoScalingGroup",
                "Scope": [],
                "Details": [],
                "LogicalResourceId": "AutoScalingGroup"
            },
            "Type": "Resource"
        },
        <span>{</span>
            "ResourceChange": <span>{</span>
                "Action": "Add",
                "ResourceType": "AWS::AutoScaling::LaunchConfiguration",
                "Scope": [],
                "Details": [],
                "LogicalResourceId": "LaunchConfig"
            },
            "Type": "Resource"
        },
        <span>{</span>
            "ResourceChange": <span>{</span>
                "ResourceType": "AWS::EC2::Instance",
                "PhysicalResourceId": "i-1abc23d4",
                "Details": [],
                "Action": "Remove",
                "Scope": [],
                "LogicalResourceId": "MyEC2Instance"
            },
            "Type": "Resource"
        }
    ],
    "CreationTime": "2020-11-18T01:44:08.444Z",
    "Capabilities": [],
    "StackName": "SampleStack",
    "NotificationARNs": [],
    "ChangeSetId": "arn:aws:cloudformation:us-east-1:123456789012:changeSet/SampleChangeSet-addremove/1a2345b6-0000-00a0-a123-00abc0abc000"
}</code></pre>
      <p><code class="code">Changes</code> comporte trois structures <code class="code">ResourceChange</code>, une pour chaque ressource. Pour chaque ressource, le <code class="code">Action</code> champ indique si elle est  CloudFormation  ajoutée ou supprimée. Les champs <code class="code">Scope</code> et <code class="code">Details</code> sont vides, car ils s'appliquent uniquement aux ressources modifiées.</p>
      <p>Pour les nouvelles ressources,  CloudFormation  vous ne pouvez pas déterminer la valeur de certains champs tant que vous n'avez pas exécuté l'ensemble de modifications. Par exemple,  CloudFormation  ne fournit pas les identifiants physiques du groupe Auto Scaling et de la configuration de lancement car ils n'existent pas encore.  CloudFormation crée les nouvelles ressources lorsque vous exécutez l'ensemble de modifications.</p>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./using-cfn-updating-stacks-changesets-delete.html">Suppression d'un jeu de modifications</div><div id="next" class="next-link" accesskey="n" href="./using-cfn-updating-stacks-direct.html">Mise à jour directe des piles</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-samples.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>