<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Détection des modifications de configuration non gérées dans les ensembles de pile - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="stacksets-drift" /><meta name="default_state" content="stacksets-drift" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" /><meta name="description" content="Même si vous gérez vos piles et les ressources qu'elles contiennent CloudFormation, les utilisateurs peuvent modifier ces ressources en dehors de CloudFormation. Les utilisateurs peuvent modifier une ressource directement en utilisant le service sous-jacent qui a créé la ressource. En effectuant la détection de l'écart sur un ensemble de piles, vous pouvez déterminer la non correspondance ou l'" /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Guide de l'utilisateur" /><meta name="abstract" content="Créez et gérez des déploiements AWS d'infrastructure de manière prévisible et répétée à l'aide de ce AWS CloudFormation guide de l'utilisateur." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Guide de l'utilisateur" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Guide de l'utilisateur" /><meta id="panorama-serviceConsolePage" value="Détection des modifications de configuration non gérées dans les ensembles de pile" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Détection des modifications de configuration non gérées dans les ensembles de pile - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacksets-drift.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,provisionnement des ressources,configuration des ressources,gestion de l'infrastructure,CloudFormer,CloudFormation pile,CloudFormation stackset,CloudFormation modèle,jeu de modifications" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide de l'utilisateur",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Travailler avec AWS CloudFormation StackSets",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/what-is-cfnstacksets.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Détection des modifications de configuration non gérées dans les ensembles de pile",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/what-is-cfnstacksets.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Guide de l'utilisateur</a></div><div id="page-toc-src"><a href="#stacksets-drift-how">Comment  CloudFormation  effectuer la détection de la dérive sur un ensemble de piles</a><a href="#stacksets-drift-stop">Arrêt de la détection de l'écart sur un ensemble de piles</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="stacksets-drift">Détection des modifications de configuration non gérées dans les ensembles de pile</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Même si vous gérez vos piles et les ressources qu'elles contiennent CloudFormation, les utilisateurs peuvent modifier ces ressources en dehors de CloudFormation. Les utilisateurs peuvent modifier une ressource directement en utilisant le service sous-jacent qui a créé la ressource. En effectuant la détection de l'écart sur un ensemble de piles, vous pouvez déterminer la non correspondance ou l'<em>écart</em> de certaines instances de pile appartenant à cet ensemble de piles par rapport à la configuration attendue.</p>
        <h2 id="stacksets-drift-how">Comment  CloudFormation  effectuer la détection de la dérive sur un ensemble de piles</h2>
        <p>Lorsqu'il  CloudFormation  effectue une détection de dérive sur un ensemble de piles, il effectue une détection de dérive sur la pile associée à chaque instance de pile de l'ensemble de piles. Pour ce faire,  CloudFormation  compare l'état actuel de chaque ressource de la pile avec l'état attendu de cette ressource, tel que défini dans le modèle de la pile et tous les paramètres d'entrée spécifiés. Si l'état actuel d'une ressource diffère de l'état attendu, cette ressource est considérée comme présentant un écart. Si une ou plusieurs ressources d'une pile présentent un écart, alors la pile elle-même est considérée comme présentant un écart, et les instances de pile auxquelles la pile est associée sont également considérées comme présentant un écart. Si une ou plusieurs instances de pile d'un ensemble de piles présentent un écart, l'ensemble de piles est considéré comme présentant un écart.</p>
        <p>La détection des dérives identifie les modifications non gérées, c'est-à-dire les modifications apportées aux piles situées en dehors de.  CloudFormation Les modifications apportées directement  CloudFormation  à une pile, plutôt qu'au niveau de l'ensemble de piles, ne sont pas considérées comme de la dérive. Supposons par exemple que vous ayez une pile associée à une instance de pile d'un ensemble de piles. Si vous mettiez  CloudFormation  à jour cette pile pour utiliser un modèle différent, cela n'est pas considéré comme une dérive, même si cette pile possède désormais un modèle différent de celui des autres piles appartenant à l'ensemble de piles. En effet, la pile correspond toujours à la configuration de modèle et de paramètre attendue dans  CloudFormation.</p>
        <p>Pour des informations détaillées sur la manière dont  CloudFormation  la détection de la dérive sur une pile est effectuée, voir<a href="./using-cfn-stack-drift.html">Détection de modifications non gérées de la configuration des piles et des ressources</a>.</p>
        <p>Comme il  CloudFormation  effectue une détection de dérive sur chaque pile individuellement, il prend en compte toutes les valeurs de paramètres remplacées pour déterminer si une pile a dérivé. Pour de plus amples informations sur le remplacement des paramètres de modèle dans les instances de pile, veuillez consulter <a href="./stackinstances-override.html">Paramètres de substitution sur des instances de piles</a>.</p>
        <p>Si vous effectuez une détection de dérive <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-stack-drift.html">directement sur une pile</a> associée à une instance de pile, ces résultats de dérive ne sont pas disponibles sur la page de <b>StackSets</b>console.</p>

    <div class="procedure"><h6>Pour détecter la dérive sur un ensemble de piles à l'aide du AWS Management Console</h6><ol><li><p>Ouvrez la AWS CloudFormation console à l'<a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>adresse https://console.aws.amazon.com/cloudformation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
            <p>Sur la <b>StackSets</b>page, sélectionnez l'ensemble de piles sur lequel vous souhaitez effectuer une détection de dérive.</p>
        </li><li>
            <p>Dans le menu <b>Actions</b> sélectionnez <b>Detect drifts (Détecter les écarts)</b>.</p>
            <p>CloudFormation affiche une barre d'informations indiquant que la détection de dérive a été initiée pour l'ensemble de piles sélectionné.</p>
        </li><li>
            <p>Facultatif : pour suivre la progression de l'opération de détection de l'écart :</p>
            <ol><li>
                    <p>Sélectionnez le nom de l'ensemble de piles pour afficher la page <b>Stackset details (Détails de l'ensemble de piles)</b>.</p>
                </li><li>
                    <p>Sélectionnez l'onglet <b>Operations (Opérations)</b> sélectionnez l'opération de détection de l'écart, puis sélectionnez <b>View drift details (Afficher les détails de l'écart)</b>.</p>
                </li></ol>
            <p>CloudFormation affiche la boîte de dialogue <b>Détails de l'opération</b>.</p>
        </li><li>
            <p>Attendez que l'opération de détection de dérive soit  CloudFormation  terminée. Lorsque l'opération de détection de dérive est terminée, le <b>statut de dérive et l'</b><b>heure du dernier contrôle de dérive</b> sont mis à  CloudFormation  jour pour votre ensemble de piles. Ces champs sont répertoriés dans l'onglet <b>Vue d'ensemble</b> de la page de <b>StackSet détails</b> de l'ensemble de piles sélectionné.</p>
            <p>Le temps nécessaire à l'opération de détection de l'écart diffère en fonction du nombre d'instances de piles et du nombre de ressources incluses dans l'ensemble de piles. Vous ne pouvez exécuter qu'une seule opération de détection de dérive sur un ensemble de piles donné à la fois.  CloudFormation poursuit l'opération de détection de dérive même après avoir fermé la barre d'informations.</p>
        </li><li>
            <p>Pour consulter les résultats de détection de l'écart pour les instances de piles d'un ensemble de piles, sélectionnez l'onglet <b>Stack instances (Instances de pile)</b>.</p>
            <p>La colonne <b>Nom de la pile</b> répertorie le nom de la pile associée à chaque instance de pile et la colonne <b>Statut de l'écart</b> répertorie le statut de l'écart de cette pile. Une pile est considérée comme ayant dérivé si une ou plusieurs de ses ressources ont dérivé.</p>
        </li><li>
            <p>Pour consulter les résultats de détection de l'écart pour la pile associée à une instance de pile spécifique :</p>
            <ol><li>
                    <p>Choisissez l'onglet <b>Opérations</b>.</p>
                </li><li>
                    <p>Sélectionnez l'opération d'écart pour laquelle vous souhaitez afficher les résultats de détection de dérive l'écart. Un volet fractionné affichera le statut et le motif de l'instance de pile pour l'opération sélectionnée. Pour une opération d'écart, la colonne du motif du statut indique le statut de l'écart d'une instance de pile.</p>
                </li><li>
                    <p>Choisissez l'instance de pile pour laquelle vous souhaitez afficher les détails de l'écart, puis choisissez <b>Afficher les écarts des ressources.</b> La table <b>Statut de l'écart de ressource</b> de la page <b>Écarts de ressources</b> répertorie chaque ressource de pile avec son statut d'écart et la dernière fois que la détection de l'écart a été lancée sur la ressource. L'ID logique et l'ID physique de chaque ressource sont affichés pour vous aider à l'identifier.</p>
                </li></ol>
        </li><li>
            <p>Vous pouvez trier les ressources en fonction de leur statut d'écart à l'aide de la colonne <b>Statut de l'écart</b>.</p>
            <p>Pour afficher les détails sur une ressource modifiée :</p>
            <ol><li>
                    <p>La ressource étant sélectionnée, sélectionnez <b>Afficher les détails de l'écart</b>.</p>
                    <p>CloudFormation affiche la page détaillée de dérive pour cette ressource en particulier. Cette page répertorie les différences entre les ressources. Elle répertorie également les valeurs des propriétés attendues et actuelles des ressources.</p>
                    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Si la pile appartient à une région et à un compte différents de ceux auxquels vous êtes actuellement connecté, le bouton <b>Détecter l'écart</b> sera désactivé et vous ne pourrez pas afficher les détails.</p></div></div>
                </li></ol>
            <div class="mediaobject">
                 
                    <img src="images/console-stacks-drifts-drift-details-differences-1.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                    La section Statut de l'écart de ressource de la page Détails de l'écart contient les informations d'écart de chaque ressource de la pile qui prend en charge la détection de l'écart. Ces détails incluent le statut de l'écart et les valeurs de propriété prévues et actuelles.&#xA;                " style="max-width:100%" />
                 
                 
            </div>

        </li></ol></div><div class="procedure"><h6>Pour détecter la dérive sur un ensemble de piles à l'aide du AWS CLI</h6><p>Pour détecter la dérive sur l'ensemble d'une pile à l'aide de AWS CLI, utilisez les <code class="code">aws
                cloudformation</code> commandes suivantes :</p><div class="itemizedlist">
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/detect-stack-set-drift.html">detect-stack-set-drift</a></code> pour lancer une opération de détection de l'écart sur une pile.</p>
            </li><li class="listitem">
                <p><code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/describe-stack-set-operation.html">describe-stack-set-operation</a></code> pour surveiller le statut de l'opération de détection de l'écart de la pile.</p>
            </li><li class="listitem">
                <p>Une fois l'opération de détection de l'écart terminée, utilisez les commandes suivantes pour renvoyer les informations d'écart souhaitées :</p>
                <div class="itemizedlist">
                     
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Utilisez <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/describe-stack-set.html">describe-stack-set</a></code> pour renvoyer des informations détaillées sur l'ensemble de piles, y compris des informations détaillées sur la dernière opération d'écart <em>effectuée</em> sur l'ensemble de piles. (Les informations sur les opérations d'écart en cours ne sont pas incluses.)</p>
                    </li><li class="listitem">
                        <p>Utilisez <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/list-stack-instances.html">list-stack-instances</a></code> pour renvoyer une liste des instances de pile appartenant à l'ensemble de piles, y compris le statut de l'écart et l'heure de la dernière vérification de l'écart de chaque instance.</p>
                    </li><li class="listitem">
                        <p>Utilisez <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/describe-stack-instance.html">describe-stack-instance</a></code> pour renvoyer des informations détaillées sur une instance de pile spécifique, y compris le statut de l'écart et l'heure de la dernière vérification de l'écart.</p>
                    </li><li class="listitem">
                        <p>Permet <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/list-stack-instance-resource-drifts.html">list-stack-instance-resource-drifts</a></code> de renvoyer des informations détaillées sur l'état de dérive de chaque ressource dans une instance de pile.</p>
                    </li><li class="listitem">
                        <p>Utilisez <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/stack-instance-resource-drifts-summary.html">stack-instance-resource-drifts-summary</a></code> pour renvoyer des informations récapitulatives sur les dérives de ressources d'une instance de pile.</p>
                    </li></ul></div>
            </li></ul></div><ol><li>
            <p>Utilisez <code class="code">detect-stack-set-drift</code> pour détecter l'écart sur un ensemble de piles entier et les instances de piles qui lui sont associées.</p>
            <p>L'exemple suivant lance la détection de l'écart sur l'ensemble de piles <code class="code">stack-set-drift-example</code>.</p>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">aws cloudformation detect-stack-set-drift \
    --stack-set-name stack-set-drift-example</code>
<code class="computeroutput" copy="false"><span>{</span>
    "OperationId": "c36e44aa-3a83-411a-b503-cb611example"
}</code></code></pre>
        </li><li>
            <p>Étant donné que les opérations de détection de l'écart des ensembles de piles peuvent être longues, utilisez <code class="code">describe-stack-set-operation</code> pour surveiller le statut de l'opération. Cette commande utilise l'ID de détection de l'écart de l'ensemble de piles renvoyé par la commande <code class="code">detect-stack-set-drift</code>.</p>
            <p>Les exemples suivants utilisent l'ID d'opération de l'exemple précédent pour renvoyer des informations sur l'opération de détection de l'écart de l'ensemble de piles. Dans cet exemple, l'opération est toujours en cours d'exécution. Sur les sept instances de piles associées à cet ensemble de piles, une instance de pile a déjà été détectée comme présentant un écart, deux instances sont synchronisées et la détection de l'écart pour les quatre instances de piles restantes est toujours en cours. Étant donné qu'une instance présente un écart, le statut de l'écart de l'ensemble de piles lui-même est désormais <code class="code">DRIFTED</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">aws cloudformation describe-stack-set-operation \
    --stack-set-name stack-set-drift-example \
    --operation-id c36e44aa-3a83-411a-b503-cb611example</code>
<code class="computeroutput" copy="false">
<span>{</span>
    "StackSetOperation": <span>{</span>
        "Status": "RUNNING",
        "AdministrationRoleARN": "arn:aws:iam::123456789012:role/AWSCloudFormationStackSetAdministrationRole",
        "OperationPreferences": <span>{</span>
            "RegionOrder": []
        },
        "ExecutionRoleName": "AWSCloudFormationStackSetExecutionRole",
        "StackSetDriftDetectionDetails": <span>{</span>
            "DriftedStackInstancesCount": 1,
            "TotalStackInstancesCount": 7,
            "LastDriftCheckTimestamp": "2019-12-04T20:34:28.543Z",
            "InSyncStackInstancesCount": 2,
            "InProgressStackInstancesCount": 4,
            "DriftStatus": "DRIFTED",
            "FailedStackInstancesCount": 0
        },
        "Action": "DETECT_DRIFT",
        "CreationTimestamp": "2019-12-04T20:33:13.673Z",
        "StackSetId": "stack-set-drift-example:bd1f4017-d4f9-432e-a73f-8c22example",
        "OperationId": "c36e44aa-3a83-411a-b503-cb611example"
    }
}</code></code></pre>
            <p>Cet exemple illustre la même commande exécutée ultérieurement et montre les informations renvoyées une fois l'opération de détection de l'écart terminée. Deux des sept instances de piles associées à cet ensemble de piles présentent un écart. Le statut de l'ensemble de piles lui-même devient <code class="code">DRIFTED</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">aws cloudformation describe-stack-set-operation \
    --stack-set-name stack-set-drift-example \
    --operation-id c36e44aa-3a83-411a-b503-cb611example</code>
<code class="computeroutput" copy="false">
<span>{</span>
    "StackSetOperation": <span>{</span>
        "Status": "SUCCEEDED",
        "AdministrationRoleARN": "arn:aws:iam::123456789012:role/AWSCloudFormationStackSetAdministrationRole",
        "OperationPreferences": <span>{</span>
            "RegionOrder": []
        } 
        "ExecutionRoleName": "AWSCloudFormationStackSetExecutionRole",
        "EndTimestamp": "2019-12-04T20:37:32.829Z",
        "StackSetDriftDetectionDetails": <span>{</span>
            "DriftedStackInstancesCount": 2,
            "TotalStackInstancesCount": 7,
            "LastDriftCheckTimestamp": "2019-12-04T20:36:55.612Z",
            "InSyncStackInstancesCount": 5,
            "InProgressStackInstancesCount": 0,
            "DriftStatus": "DRIFTED",
            "FailedStackInstancesCount": 0
        },
        "Action": "DETECT_DRIFT",
        "CreationTimestamp": "2019-12-04T20:33:13.673Z",
        "StackSetId": "stack-set-drift-example:bd1f4017-d4f9-432e-a73f-8c22example",
        "OperationId": "c36e44aa-3a83-411a-b503-cb611example"
    }
}</code></code></pre>
        </li><li>
            <p>Lorsque l'opération de détection de l'écart de l'ensemble de piles est terminée, utilisez les commandes <code class="code">describe-stack-set</code>, <code class="code">list-stack-instances</code>, <code class="code">describe-stack-instance</code> et <code class="code">list-stack-instance-resource-drifts</code> pour consulter les résultats.</p>
            <p>La commande <code class="code">describe-stack-set</code> inclut les mêmes informations détaillées sur l'écart que celles renvoyées par la commande <code class="code">describe-stack-set-operation</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">aws cloudformation describe-stack-set \
    --stack-set-name stack-set-drift-example</code>
<code class="computeroutput" copy="false"><span>{</span>
    "StackSet": <span>{</span>
        "Status": "ACTIVE",
        "Description": "Demonstration of drift detection on stack sets.",
        "Parameters": [],
        "Tags": [
            <span>{</span>
                "Value": "Drift detection",
                "Key": "Feature"
            }
        ], 
        "ExecutionRoleName": "AWSCloudFormationStackSetExecutionRole",
        "Capabilities": [],
        "AdministrationRoleARN": "arn:aws:iam::123456789012:role/AWSCloudFormationStackSetAdministrationRole",
        "StackSetDriftDetectionDetails": <span>{</span>
            "DriftedStackInstancesCount": 2,
            "TotalStackInstancesCount": 7,
            "LastDriftCheckTimestamp": "2019-12-04T20:36:55.612Z",
            "InProgressStackInstancesCount": 0,
            "DriftStatus": "DRIFTED",
            "DriftDetectionStatus": "COMPLETED",
            "InSyncStackInstancesCount": 5,
            "FailedStackInstancesCount": 0
        },
        "StackSetARN": "arn:aws:cloudformation:us-east-1:123456789012:stackset/stack-set-drift-example:bd1f4017-d4f9-432e-a73f-8c22example",
        "TemplateBody": [details omitted],
        "StackSetId": "stack-set-drift-example:bd1f4017-d4f9-432e-a73f-8c22ebexample",
        "StackSetName": "stack-set-drift-example"
    }
}</code></code></pre>
            <p>Vous pouvez utiliser la commande <code class="code">list-stack-instances</code> pour renvoyer des informations récapitulatives sur les instances de piles associées à un ensemble de piles, y compris le statut de l'écart de chaque instance de pile.</p>
            <p>Dans cet exemple, l'exécution de <code class="code">list-stack-instances</code> sur l'exemple d'ensemble de piles, où le filtre du statut de l'écart est défini sur <code class="code">DRIFTED</code>, nous permet d'identifier les deux instances de piles dont le statut de l'écart est <code class="code">DRIFTED</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">aws cloudformation list-stack-instances \
    --stack-set-name stack-set-drift-example \
    --filters Name=DRIFT_STATUS,Values=DRIFTED</code>
<code class="computeroutput" copy="false"><span>{</span>
"Summaries": [
        <span>{</span>
"StackId": "arn:aws:cloudformation:eu-west-1:123456789012:stack/StackSet-stack-set-drift-example-b0fb6083-60c0-4e39-af15-2f071e0db90c/0e4f0940-16d4-11ea-93d8-0641cexample",
            "Status": "CURRENT",
            "Account": "012345678910",
            "Region": "eu-west-1",
            "LastDriftCheckTimestamp": "2019-12-04T20:37:32.687Z",
            "DriftStatus": "DRIFTED",
            "StackSetId": "stack-set-drift-example:bd1f4017-d4f9-432e-a73f-8c22eexample
            "LastOperationId": "c36e44aa-3a83-411a-b503-cb611example"
        },
        <span>{</span>
            "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/StackSet-stack-set-drift-example-b7fde68e-e541-44c2-b33d-ef2e2988071a/008e6030-16d4-11ea-8090-12f89example",
            "Status": "CURRENT",
            "Account": "123456789012",
            "Region": "us-east-1",
            "LastDriftCheckTimestamp": "2019-12-04T20:34:28.275Z",
            "DriftStatus": "DRIFTED",
            "StackSetId": "stack-set-drift-example:bd1f4017-d4f9-432e-a73f-8c22eexample"
            "LastOperationId": "c36e44aa-3a83-411a-b503-cb611example"
        },
        
        [additional stack instances omitted]
 
    ]
}</code></code></pre>
            <p>La commande <code class="code">describe-stack-instance</code> renvoie également ces informations, mais pour une seule instance de pile, comme dans l'exemple ci-dessous.</p>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">aws cloudformation describe-stack-instance \
    --stack-set-name stack-set-drift-example \
    --stack-instance-account 012345678910 --stack-instance-region us-east-1</code>
<code class="computeroutput" copy="false"><span>{</span>
    "StackInstance": <span>{</span>
        "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/StackSet-stack-set-drift-example-b7fde68e-e541-44c2-b33d-ef2e2988071a/008e6030-16d4-11ea-8090-12f89example",
        "Status": "CURRENT",
        "Account": "123456789012",
        "Region": "us-east-1",
        "ParameterOverrides": [],
        "DriftStatus": "DRIFTED",
        "LastDriftCheckTimestamp": "2019-12-04T20:34:28.275Z",
        "StackSetId": "stack-set-drift-example:bd1f4017-d4f9-432e-a73f-8c22eexample"
        "LastOperationId": "c36e44aa-3a83-411a-b503-cb611example"
    }
}</code></code></pre>
        </li><li>
            <p>Une fois que vous avez identifié les instances de pile qui ont dérivé, vous pouvez utiliser les informations relatives aux instances de pile renvoyées par les <code class="code">describe-stack-instance</code> commandes <code class="code">list-stack-instances</code> or pour exécuter <a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/list-stack-instance-resource-drifts.html">list-stack-instance-resource-drifts</a>. Cette commande renvoie des informations détaillées sur les ressources de la pile qui présentent un écart pour une opération d'écart particulière.</p>
            <p>L'exemple suivant utilise le paramètre <code class="code">stack-instance-resource-drift-statuses</code> pour demander des informations d'écart de pile pour les ressources qui ont été modifiées ou supprimées dans le précédent exemple d'opération d'écart. La demande renvoie des informations sur la seule ressource qui a été modifiée, y compris des détails sur deux de ses propriétés et leurs valeurs qui ont été modifiées. Aucune ressource n'a été supprimée.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">aws cloudformation list-stack-instance-resource-drifts \
    --stack-set-name my-stack-set-with-resource-drift \
    --stack-instance-account 123456789012 \
    --stack-instance-region us-east-1 \
    --operation-id c36e44aa-3a83-411a-b503-cb611example \
    --stack-instance-resource-drift-statuses MODIFIED DELETED</code>

<code class="computeroutput" copy="false"><span>{</span>
    "Summaries": [
        <span>{</span>
            "StackId": "arn:aws:cloudformation:us-east-1:123456789012:stack/my-stack-set-with-resource-drift/489e5570-df85-11e7-a7d9-50example",
            "ResourceType": "AWS::SQS::Queue",
            "Timestamp": "2018-03-26T17:23:34.489Z",
            "PhysicalResourceId": "https://sqs.us-east-1.amazonaws.com/123456789012/my-stack-with-resource-drift-Queue-494PBHCO76H4",
            "StackResourceDriftStatus": "MODIFIED",
            "PropertyDifferences": [
                <span>{</span>
                    "PropertyPath": "/DelaySeconds",
                    "ActualValue": "120",
                    "ExpectedValue": "20",
                    "DifferenceType": "NOT_EQUAL"
                },
                <span>{</span>
                    "PropertyPath": "/RedrivePolicy/maxReceiveCount",
                    "ActualValue": "12",
                    "ExpectedValue": "10",
                    "DifferenceType": "NOT_EQUAL"
                }
            ],
            "LogicalResourceId": "Queue"
        }
    ]
}</code></code></pre>
        </li></ol></div>
        <h2 id="stacksets-drift-stop">Arrêt de la détection de l'écart sur un ensemble de piles</h2>
        <p>Étant donné que l'opération de détection de l'écart sur un ensemble de piles peut être long, vous pouvez parfois souhaiter arrêter une opération de détection de l'écart en cours d'exécution sur un ensemble de piles.</p>
        <div class="procedure"><h6>Pour arrêter la détection de l'écart sur un ensemble de piles à l'aide de l' AWS Management Console</h6><ol><li><p>Ouvrez la AWS CloudFormation console à l'<a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>adresse https://console.aws.amazon.com/cloudformation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
                <p>Sur la <b>StackSets</b>page, sélectionnez le nom du stack set.</p>
                <p>CloudFormation affiche la page de <b>StackSets détails</b> de l'ensemble de piles sélectionné.</p>
            </li><li>
                <p>Sur la page de <b>StackSets détails</b>, sélectionnez l'onglet <b>Opérations</b>, puis sélectionnez l'opération de détection de dérive.</p>
            </li><li>
                <p>Sélectionnez <b>Stop operation (Arrêter l'opération)</b>.</p>
            </li></ol></div>
        <div class="procedure"><h6>Pour arrêter la détection de l'écart sur un ensemble de piles à l'aide de l' AWS CLI</h6><ul><li>
                <p>Utilisez la commande <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/stop-stack-set-operation.html">stop-stack-set-operation</a></code>. Vous devez fournir à la fois le nom de l'ensemble de piles et l'ID d'opération de l'opération de détection de l'écart de l'ensemble de piles.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">aws cloudformation stop-stack-set-operation \
    --stack-set-name stack-set-drift-example \
    --operation-id 624af370-311a-11e8-b6b7-500cexample</code></code></pre>
            </li></ul></div>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./stacksets-account-gating.html">Portails de compte de destination</div><div id="next" class="next-link" accesskey="n" href="./stacksets-import.html">Importation d'une pile dans un ensemble de piles.</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacksets-drift.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacksets-drift.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>