<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Déplacement de ressources d'une pile à une autre - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="refactor-stacks" /><meta name="default_state" content="refactor-stacks" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" /><meta name="description" content="Utilisez la fonction resource import pour déplacer des ressources d'une pile à une autre." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Guide de l'utilisateur" /><meta name="abstract" content="Créez et gérez des déploiements AWS d'infrastructure de manière prévisible et répétée à l'aide de ce AWS CloudFormation guide de l'utilisateur." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Guide de l'utilisateur" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Guide de l'utilisateur" /><meta id="panorama-serviceConsolePage" value="Déplacement de ressources d'une pile à une autre" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Déplacement de ressources d'une pile à une autre - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/refactor-stacks.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,provisionnement des ressources,configuration des ressources,gestion de l'infrastructure,CloudFormer,CloudFormation pile,CloudFormation stackset,CloudFormation modèle,jeu de modifications" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide de l'utilisateur",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Utilisation des piles",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacks.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Déplacement de ressources d'une pile à une autre",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacks.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Guide de l'utilisateur</a></div><div id="page-toc-src"><a href="#refactor-stacks-console">Remaniement d'une pile à l'aide de la AWS Management Console</a><a href="#refactor-stacks-cli">Remaniement d'une pile à l'aide de la AWS CLI</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="refactor-stacks">Déplacement de ressources d'une pile à une autre</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>À l'aide de la fonction <code class="code">resource import</code>, vous pouvez déplacer des ressources d'une pile à une autre ou les <em>remanier</em>, . Vous devez d'abord ajouter une politique de suppression <code class="code">Retain</code> à la ressource que vous souhaitez déplacer pour vous assurer que la ressource est préservée lorsque vous la supprimez de la pile source et que vous l'importez dans la pile cible.</p><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Toutes les ressources ne prennent pas en charge les opérations d'importation. Veuillez consulter <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/resource-import-supported-resources.html">Ressources prenant en charge les opérations d'importation</a> avant de supprimer une ressource de votre pile. Si vous supprimez de votre pile une ressource qui ne prend pas en charge les opérations d'importation, vous ne pouvez pas importer la ressource dans une autre pile ou la ramener dans la pile source.</p></div></div>
      <h2 id="refactor-stacks-console">Remaniement d'une pile à l'aide de la AWS Management Console</h2>
      
      <div class="procedure"><ol><li>
            <p>Dans le modèle source, spécifiez une <code class="code">Retain</code> <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html">DeletionPolicy</a> pour la ressource que vous souhaitez déplacer.</p>
            <p>Dans l'exemple de modèle source suivant, <code class="code">Games</code> est la cible de ce remaniement.</p>
            <div class="example"><h6>Exemple JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Import test",
    "Resources": <span>{</span>
        "ServiceTable":<span>{</span>
           "Type":"AWS::DynamoDB::Table",
           "Properties":<span>{</span>
              "TableName":"Service",
              "AttributeDefinitions":[
                 <span>{</span>
                    "AttributeName":"key",
                    "AttributeType":"S"
                 }
              ],
              "KeySchema":[
                 <span>{</span>
                    "AttributeName":"key",
                    "KeyType":"HASH"
                 }
              ],
              "ProvisionedThroughput":<span>{</span>
                 "ReadCapacityUnits":5,
                 "WriteCapacityUnits":1
              }
           }
        },
        "GamesTable": <span>{</span>
            "Type": "AWS::DynamoDB::Table",
            <b>"DeletionPolicy": "Retain",</b>
            "Properties": <span>{</span>
                "TableName": "Games",
                "AttributeDefinitions": [
                    <span>{</span>
                        "AttributeName": "key",
                        "AttributeType": "S"
                    }
                ],
                "KeySchema": [
                    <span>{</span>
                        "AttributeName": "key",
                        "KeyType": "HASH"
                    }
                ],
                "ProvisionedThroughput": <span>{</span>
                    "ReadCapacityUnits": 5,
                    "WriteCapacityUnits": 1
                }
            }
        }
    }
}</code></pre></div></div>
            
         </li><li>
            <p>Ouvrez la console AWS CloudFormation afin d'effectuer une mise à jour de la pile et appliquer la politique de suppression.</p>
            <ol><li>
                  <p>Dans la page <b>Piles</b>, avec la pile sélectionnée, choisissez <b>Mettre à jour</b>.</p>
         </li><li>
                  <p>Sous <b>Prepare template (Préparer le modèle)</b>, choisissez <b>Replace current template (Remplacer le modèle actuel)</b>.</p>
               </li><li>
                  <p>Dans <b>Specify template (Spécifier le modèle)</b>, indiquez le modèle source mis à jour avec l'attribut <code class="code">DeletionPolicy</code> défini sur <code class="code">GamesTable</code>, puis choisissez <b>Suivant</b>.</p>  
                  <div class="itemizedlist">
                      
                      
                  <ul class="itemizedlist"><li class="listitem">
                        <p>Choisissez <b>Amazon S3 URL (URL Amazon S3)</b>, puis spécifiez l'URL du modèle source mis à jour dans la zone de texte.</p>
                     </li><li class="listitem">
                        <p>Choisissez <b>Upload a template file (Télécharger un fichier de modèle)</b>, puis recherchez le fichier de modèle source mis à jour.</p>
                     </li></ul></div>
               </li><li>
                  <p>Dans la page <b>Specify stack details (Spécifier les détails de la pile)</b> aucune modification n'est requise. Choisissez <b>Next (Suivant)</b>.</p>
               </li><li>
                  <p>Dans la page <b>Configure stack options (Configurer les options de pile)</b> aucune modification n'est requise. Choisissez <b>Next (Suivant)</b>.</p>
               </li><li>
                  <p>Dans la page de <b>vérification du <code class="replaceable">nom de la pile</code></b>, vérifiez vos modifications. Si votre modèle contient des ressources IAM, sélectionnez <b>I acknowledge that this template may create IAM resources (Je sais que ce modèle peut créer des ressources IAM)</b> pour confirmer que vous souhaitez utiliser des ressources IAM dans le modèle. Pour plus d'informations sur l'utilisation de ressources IAM dans les modèles, consultez <a href="./using-iam-template.html">Contrôler l'accès avec AWS Identity and Access Management</a>. Mettez ensuite à jour votre pile source en créant un jeu de modifications ou mettez à jour votre pile source directement.</p>
               </li></ol>
         </li><li>
            <p>Supprimez la ressource, les paramètres associés et les sorties du modèle source, puis ajoutez-les au modèle cible.</p>
            <p>Le modèle source ressemble maintenant à ce qui suit.</p>
            <div class="example"><h6>Exemple JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Import test",
    "Resources": <span>{</span>
        "ServiceTable":<span>{</span>
           "Type":"AWS::DynamoDB::Table",
           "Properties":<span>{</span>
              "TableName":"Service",
              "AttributeDefinitions":[
                 <span>{</span>
                    "AttributeName":"key",
                    "AttributeType":"S"
                 }
              ],
              "KeySchema":[
                 <span>{</span>
                    "AttributeName":"key",
                    "KeyType":"HASH"
                 }
              ],
              "ProvisionedThroughput":<span>{</span>
                 "ReadCapacityUnits":5,
                 "WriteCapacityUnits":1
              }
           }
        }
    }
}</code></pre></div></div>
            <p>L'exemple de modèle cible suivant a actuellement la ressource <code class="code">PlayersTable</code> et contient maintenant également <code class="code">GamesTable</code>.</p>
            <div class="example"><h6>Exemple JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Import test",
    "Resources": <span>{</span>
        "PlayersTable": <span>{</span>
            "Type": "AWS::DynamoDB::Table",
            "Properties": <span>{</span>
                "TableName": "Players",
                "AttributeDefinitions": [
                    <span>{</span>
                        "AttributeName": "key",
                        "AttributeType": "S"
                    }
                ],
                "KeySchema": [
                    <span>{</span>
                        "AttributeName": "key",
                        "KeyType": "HASH"
                    }
                ],
                "ProvisionedThroughput": <span>{</span>
                    "ReadCapacityUnits": 5,
                    "WriteCapacityUnits": 1
                }
            }
        },
        "GamesTable": <span>{</span>
            "Type": "AWS::DynamoDB::Table",
            <b>"DeletionPolicy": "Retain",</b>
            "Properties": <span>{</span>
                "TableName": "Games",
                "AttributeDefinitions": [
                    <span>{</span>
                        "AttributeName": "key",
                        "AttributeType": "S"
                    }
                ],
                "KeySchema": [
                    <span>{</span>
                        "AttributeName": "key",
                        "KeyType": "HASH"
                    }
                ],
                "ProvisionedThroughput": <span>{</span>
                    "ReadCapacityUnits": 5,
                    "WriteCapacityUnits": 1
                }
            }
        }
    }
}</code></pre></div></div>
         </li><li>
            <p>Répétez les étapes 2 et 3 pour mettre à jour à nouveau la pile source, afin, cette fois, de supprimer la ressource cible de la pile.</p>
         </li><li>
            <p>Effectuez une opération d'importation pour ajouter <code class="code">GamesTable</code> à la pile cible.</p> 
            <ol><li>
                  <p>Sur la page <b>Piles</b>, sélectionnez la pile parent, choisissez <b>Stack actions (Actions pour la pile)</b>, puis <b>Import resources into stack (Importer les ressources dans la pile)</b>.</p>
                  <div class="mediaobject">
                      
                        <img src="images/stack-actions-import.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                        Option Import resources into stack (Importer les ressources dans la pile) dans la console.&#xA;                     " />
                      
                      
                  </div>
               </li><li>
            <p>Lisez la page <b>Vue d'ensemble de l'importation</b> pour obtenir la liste des éléments que vous devez fournir dans le cadre de cette opération. Ensuite, choisissez <b>Next</b> (Suivant).</p>
         </li><li>
            <p>Dans la page <b>Specify template</b> (Spécifier un modèle) effectuez l'une des opérations suivantes, puis choisissez <b>Next</b> (Suivant).</p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>Choisissez <b>Amazon S3 URL (URL Amazon S3)</b>, puis spécifiez une URL dans la zone de texte.</p>
               </li><li class="listitem">
                  <p>Choisissez <b>Upload a template file (Charger un fichier de modèle)</b>, puis recherchez un fichier à télécharger.</p>
               </li></ul></div>
         </li><li>
            <p>Dans la page <b>Identify resources (Identifier les ressources)</b> identifiez la ressource que vous déplacez (dans cet exemple, <code class="code">GamesTable</code>).</p>
            <div class="orderedlist">
                
                
                
            <ol><li>
                  <p>Sous <b>Identifier property (Propriété de l'identifiant)</b>, choisissez le type d'identifiant de ressource. Par exemple, une ressource <code class="code">AWS::DynamoDB::Table</code> peut être identifiée à l'aide de la propriété <code class="code">TableName</code>.</p>
               </li><li>
                  <p>Sous <b>Identifier value (Valeur de l'identifiant)</b>, tapez la valeur réelle de la propriété. Par exemple, <code class="code"><code class="replaceable">GamesTables</code></code>.</p>
                  <div class="mediaobject">
                      
                        <img src="images/resources-to-import-identifiers.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                        Page d'identification des ressources de la console.&#xA;                     " />
                      
                      
                  </div>
               </li><li>
                  <p>Choisissez <b>Next (Suivant)</b>.</p>
               </li></ol></div>
         </li><li>
            <p>Dans la page <b>Specify stack details (Spécifier les détails de la pile)</b>, modifiez les paramètres souhaités, puis choisissez <b>Suivant</b>. Un jeu de modifications est crée automatiquement.</p>
            <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>L'opération d'importation échoue si vous modifiez des paramètres existants qui lacent une opération de création, de mise à jour ou de suppression.</p></div></div>
         </li><li>
            <p>Dans la page de <b>vérification de <code class="replaceable">nom de la pile</code></b>, vérifiez que la ressource correcte est importée, puis choisissez <b>Import resources (Importer les ressources)</b>. Le jeu de modifications lance la dernière étape est alors automatiquement exécuté. Toutes les <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-console-add-tags.html">balises au niveau de la pile</a> sont appliquées aux ressources importées à ce moment-là.</p>
         </li><li>
            <p>Le panneau <b>Événements</b> de la page <b>Stack details (Détails de la pile)</b> pour votre pile parent s'affiche.</p>
            <div class="mediaobject">
                
                  <img src="images/import-events.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                  Onglet Événements de la console.&#xA;               " />
                
                
            </div>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Il n'est pas nécessaire d'exécuter la détection de l'écart sur la pile parent après cette opération d'importation, car la ressource <code class="code">AWS::CloudFormation::Stack</code> est déjà gérée par AWS CloudFormation.</p></div></div>
         </li></ol>
         </li></ol></div>
      
    
      <h2 id="refactor-stacks-cli">Remaniement d'une pile à l'aide de la AWS CLI</h2>
   <div class="procedure"><ol><li>
         <p>Dans le modèle source, spécifiez une <code class="code">Retain</code> <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html">DeletionPolicy</a> pour la ressource que vous souhaitez déplacer.</p>
         <p>Dans l'exemple de modèle source suivant, <code class="code">GamesTable</code> est la cible de ce remaniement.</p>
         <div class="example"><h6>Exemple JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Import test",
    "Resources": <span>{</span>
        "ServiceTable":<span>{</span>
           "Type":"AWS::DynamoDB::Table",
           "Properties":<span>{</span>
              "TableName":"Service",
              "AttributeDefinitions":[
                 <span>{</span>
                    "AttributeName":"key",
                    "AttributeType":"S"
                 }
              ],
              "KeySchema":[
                 <span>{</span>
                    "AttributeName":"key",
                    "KeyType":"HASH"
                 }
              ],
              "ProvisionedThroughput":<span>{</span>
                 "ReadCapacityUnits":5,
                 "WriteCapacityUnits":1
              }
           }
        },
        "GamesTable": <span>{</span>
            "Type": "AWS::DynamoDB::Table",
            <b>"DeletionPolicy": "Retain",</b>
            "Properties": <span>{</span>
                "TableName": "Games",
                "AttributeDefinitions": [
                    <span>{</span>
                        "AttributeName": "key",
                        "AttributeType": "S"
                    }
                ],
                "KeySchema": [
                    <span>{</span>
                        "AttributeName": "key",
                        "KeyType": "HASH"
                    }
                ],
                "ProvisionedThroughput": <span>{</span>
                    "ReadCapacityUnits": 5,
                    "WriteCapacityUnits": 1
                }
            }
        }
    }
}</code></pre></div></div>
      </li><li>
         <p>Mettez à jour la pile source afin d'appliquer la politique de suppression à la ressource.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation update-stack --stack-name "<code class="replaceable">source-stack-name</code>"</code></pre>
      </li><li>
         <p>Supprimez la ressource, les paramètres associés, et les sorties du modèle source, puis ajoutez-les au modèle cible.</p>
         <p>Le modèle source ressemble maintenant à ce qui suit.</p>
         <div class="example"><h6>Exemple JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Import test",
    "Resources": <span>{</span>
        "ServiceTable":<span>{</span>
           "Type":"AWS::DynamoDB::Table",
           "Properties":<span>{</span>
              "TableName":"Service",
              "AttributeDefinitions":[
                 <span>{</span>
                    "AttributeName":"key",
                    "AttributeType":"S"
                 }
              ],
              "KeySchema":[
                 <span>{</span>
                    "AttributeName":"key",
                    "KeyType":"HASH"
                 }
              ],
              "ProvisionedThroughput":<span>{</span>
                 "ReadCapacityUnits":5,
                 "WriteCapacityUnits":1
              }
           }
        }
    }
}</code></pre></div></div>
         <p>L'exemple de modèle cible suivant a actuellement la ressource <code class="code">PlayersTable</code> et contient maintenant également <code class="code">GamesTable</code>.</p>
         <div class="example"><h6>Exemple JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Import test",
    "Resources": <span>{</span>
        "PlayersTable": <span>{</span>
            "Type": "AWS::DynamoDB::Table",
            "Properties": <span>{</span>
                "TableName": "Players",
                "AttributeDefinitions": [
                    <span>{</span>
                        "AttributeName": "key",
                        "AttributeType": "S"
                    }
                ],
                "KeySchema": [
                    <span>{</span>
                        "AttributeName": "key",
                        "KeyType": "HASH"
                    }
                ],
                "ProvisionedThroughput": <span>{</span>
                    "ReadCapacityUnits": 5,
                    "WriteCapacityUnits": 1
                }
            }
        },
        "GamesTable": <span>{</span>
            "Type": "AWS::DynamoDB::Table",
            <b>"DeletionPolicy": "Retain",</b>
            "Properties": <span>{</span>
                "TableName": "Games",
                "AttributeDefinitions": [
                    <span>{</span>
                        "AttributeName": "key",
                        "AttributeType": "S"
                    }
                ],
                "KeySchema": [
                    <span>{</span>
                        "AttributeName": "key",
                        "KeyType": "HASH"
                    }
                ],
                "ProvisionedThroughput": <span>{</span>
                    "ReadCapacityUnits": 5,
                    "WriteCapacityUnits": 1
                }
            }
        }
    }
}</code></pre></div></div>
      </li><li>
         <p>Mettez à jour la pile source afin de supprimer la ressource <code class="code">GamesTable</code> et ses paramètres et sorties associés de la pile.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation update-stack --stack-name "<code class="replaceable">source-stack-name</code>"</code></pre>
      </li><li>
         <p>Créez un jeu de modifications de type <code class="code">IMPORT</code> avec les paramètres suivants. <code class="code">--resources-to-import</code> ne prend pas en charge le YAML en ligne.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">&gt;</code><code class="userinput">aws cloudformation create-change-set
    --stack-name <code class="replaceable">TargetStack</code> --change-set-name <code class="replaceable">ImportChangeSet</code>
    <b>--change-set-type <code class="replaceable">IMPORT</code>
    --resources-to-import "[<span>{</span>\"ResourceType\":\"<code class="replaceable">AWS::DynamoDB::Table</code>\",\"LogicalResourceId\":\"<code class="replaceable">GamesTable</code>\",\"ResourceIdentifier\":<span>{</span>\"<code class="replaceable">TableName</code>\":\"<code class="replaceable">Games</code>\"}}]"</b>
    --template-body <code class="replaceable">file://templateToImport.json</code></code></code></pre>
         <p>L'AWS CLI prend également en charge les fichiers texte en entrée pour le paramètre <code class="code">resources-to-import</code>, comme indiqué dans l'exemple précédent.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="text ">--resources-to-import <code class="replaceable">file://resourcesToImport.txt</code></code></pre>
          <p>Dans cette démonstration, <code class="replaceable">fichier://resourcesToImport.txt</code> contient les éléments suivants.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">[
  <span>{</span>
      "ResourceType":"AWS::DynamoDB::Table",
      "LogicalResourceId":"GamesTable",
      "ResourceIdentifier": <span>{</span>
        "TableName":"Games"
      }
  }
]</code></pre>
      </li><li>
         <p>Vérifiez le jeu de modifications pour vous assurer que la ressource correcte est importée dans la pile cible.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation describe-change-set --change-set-name <code class="replaceable">ImportChangeSet</code></code></pre>
      </li><li>
          <p>Lancez le jeu de modifications pour importer la ressource dans la pile cible. Toutes les <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-console-add-tags.html">balises au niveau de la pile</a> sont appliquées aux ressources importées à ce moment-là. Une fois l'opération <code class="code">(IMPORT_COMPLETE)</code> terminée, la ressource est importée avec succès.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation execute-change-set --change-set-name <code class="replaceable">ImportChangeSet</code> --stack-name (TargetStackName)</code></pre>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Il n'est pas nécessaire d'exécuter la détection de l'écart sur la pile cible après cette opération d'importation car la ressource est déjà gérée par AWS CloudFormation.</p></div></div>
      </li></ol></div>
   <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./stack-failure-options.html">Options d'échec de pile</div><div id="next" class="next-link" accesskey="n" href="./resource-import-supported-resources.html">Support des types de ressources</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/refactor-stacks.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/refactor-stacks.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>