<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Création de conditions Wait dans un gabarit - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="using-cfn-waitcondition" /><meta name="default_state" content="using-cfn-waitcondition" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><meta name="description" content="Créez une condition d'attente dans un modèle pour coordonner la création des ressources d'une pile ou suivre la progression d'un processus de configuration." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Guide de l'utilisateur" /><meta name="abstract" content="Créez et gérez des déploiements AWS d'infrastructure de manière prévisible et répétée à l'aide de ce AWS CloudFormation guide de l'utilisateur." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Guide de l'utilisateur" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Guide de l'utilisateur" /><meta id="panorama-serviceConsolePage" value="Création de conditions Wait dans un gabarit" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Création de conditions Wait dans un gabarit - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,provisionnement des ressources,configuration des ressources,gestion de l'infrastructure,CloudFormer,CloudFormation pile,CloudFormation stackset,CloudFormation modèle,jeu de modifications" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide de l'utilisateur",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Utilisation des modèles AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Procédures",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/CHAP_Using.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Création de conditions Wait dans un gabarit",
        "item" : "https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/CHAP_Using.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Guide de l'utilisateur</a></div><div id="page-toc-src"><a href="#using-cfn-waitconditionhandle">Utilisation d'un descripteur de condition d'attente</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="using-cfn-waitcondition">Création de conditions Wait dans un gabarit</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Pour les ressources Amazon EC2 et Auto Scaling, nous vous recommandons d'utiliser un  CreationPolicy  attribut plutôt que des conditions d'attente. Ajoutez un  CreationPolicy  attribut à ces ressources et utilisez le script d'assistance cfn-signal pour signaler qu'un processus de création d'instance s'est terminé avec succès.</p><p>Pour plus d’informations, consultez <a href="./aws-attribute-creationpolicy.html">Attribut CreationPolicy</a> ou <a href="./deploying.applications.html">Déploiement d'applications sur Amazon EC2 avec AWS CloudFormation</a>.</p></div></div><p>Avec la ressource <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-waitconditionhandle.html"><code class="code">AWS::CloudFormation::WaitConditionHandle</code></a> et l'attribut <a href="./aws-attribute-creationpolicy.html">Attribut CreationPolicy</a>, vous pouvez effectuer les actions suivantes :</p><div class="itemizedlist">
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>Coordonner la création des ressources de la pile avec d'autres actions de configuration externes à la création de la pile</p>
         </li><li class="listitem">
            <p>Suivre la progression d'un processus de configuration</p>
         </li></ul></div><p>Par exemple, vous pouvez commencer la création d'une autre ressource lorsque la configuration de l'application est partiellement terminée, ou vous pouvez envoyer des signaux lors d'un processus d'installation et de configuration afin de suivre la progression.</p><h2 id="using-cfn-waitconditionhandle">Utilisation d'un descripteur de condition d'attente</h2>
            
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Si vous utilisez la fonctionnalité de point de <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-endpoints.html">terminaison VPC</a>, les ressources du VPC qui répondent aux conditions d'attente doivent avoir accès à des compartiments Amazon Simple Storage Service ( AWS CloudFormationAmazon S3) spécifiques. Les ressources doivent envoyer les réponses aux conditions d'attente à une URL Amazon S3 pré-signée. Si elles ne peuvent pas envoyer des réponses à Amazon S3, AWS CloudFormation
ne recevra pas de réponse et l'opération de la pile échouera. Pour plus d'informations, consultez <a href="./cfn-vpce-bucketnames.html">Configuration des points de terminaison d'un VPC pour AWS CloudFormation</a> et <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies-vpc-endpoint.html">Exemple de politiques de compartiment pour les points de terminaison d'un VPC pour Amazon S3</a>.</p></div></div>
            <p>Vous pouvez utiliser la condition d'attente et le gestionnaire de conditions d'attente pour AWS CloudFormation suspendre la création d'une pile et attendre un signal avant de continuer à créer la pile. Par exemple, vous pouvez avoir envie de télécharger et de configurer des applications dans une instance Amazon EC2 avant de considérer la création de cette instance Amazon EC2 comme étant terminée.</p>
            <p>La liste suivante résume le fonctionnement d'une condition d'attente avec un descripteur de condition d'attente :</p>
            <div class="itemizedlist">
                 
                 
                 
                 
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>AWS CloudFormation crée une condition d'attente comme n'importe quelle autre ressource. Lorsqu'il AWS CloudFormation crée une condition d'attente, il indique le statut de la condition d'attente comme CREATE_IN_PROGRESS et attend de recevoir le nombre requis de signaux de réussite ou que le délai d'expiration de la condition d'attente ait expiré. S'il AWS CloudFormation  reçoit le nombre requis de signaux de réussite avant l'expiration du délai imparti, il continue à créer la pile ; sinon, il définit le statut de la condition d'attente sur <code class="code">CREATE_FAILED</code> et annule la pile.</p>
                </li><li class="listitem">
                    <p>La <code class="code">Timeout</code> propriété détermine le temps d' AWS CloudFormation attente pour obtenir le nombre requis de signaux de réussite. <code class="code">Timeout</code>est une propriété limitée au minimum, ce qui signifie que le délai d'expiration ne survient pas avant l'heure que vous spécifiez, mais qu'il peut survenir peu de temps après. La durée maximale que vous pouvez spécifier est de 43 200 secondes (12 heures).</p>
                </li><li class="listitem">
                    <p>Généralement, vous préférez qu'une condition d'attente commence juste après la création d'une ressource spécifique, telle qu'une instance Amazon EC2, une instance DB RDS ou un groupe Auto Scaling. Pour ce faire, ajoutez l'<a href="./aws-attribute-dependson.html">attribut DependsOn</a> à une condition d'attente. Lorsque vous ajoutez l'attribut <code class="code">DependsOn</code> à une condition d'attente, vous précisez qu'elle n'est créée qu'après une ressource particulière. Lorsque la condition d'attente est créée, AWS CloudFormation commence le délai d'attente et attend les signaux de réussite.</p>
                </li><li class="listitem">
                    <p>Vous pouvez également utiliser l'attribut <code class="code">DependsOn</code> avec d'autres ressources. Par exemple, vous souhaitez peut-être créer une instance de base de données Amazon RDS et configurer une base de données sur cette instance de base de données avant de créer les instances EC2 qui utilisent cette base de données. Dans ce cas, créez une condition d'attente possédant un attribut <code class="code">DependsOn</code> qui spécifie l'instance de base de données, puis créez des ressources d'instance EC2 avec des attributs <code class="code">DependsOn</code> qui définissent la condition d'attente. Cette approche permet de garantir que les instances EC2 sont créées juste après l'instance DB et la condition d'attente.</p>
                </li><li class="listitem">
                    <p>AWS CloudFormation doit recevoir un nombre spécifié de signaux de réussite pour une condition d'attente avant de définir le statut de cette condition d'attente pour <code class="code">CREATE_COMPLETE</code> poursuivre la création de la pile. La propriété de la condition d'attente <code class="code">Count</code> spécifie le nombre de signaux de réussite. Si aucun nombre n'est défini, la valeur par défaut est de 1.</p>
                </li><li class="listitem">
                    <p>Une condition d'attente nécessite un descripteur de condition d'attente pour configurer une URL pré-signée qui sert de mécanisme de signalement. L'URL présignée vous permet d'envoyer un signal sans avoir à fournir vos AWS informations d'identification. Vous utilisez cette URL pour signaler la réussite ou l'échec, laquelle est encapsulée dans une instruction JSON. Pour voir le format de la déclaration JSON, consultez le <a href="#using-cfn-waitcondition-signaljson">Format JSON d'un signal envoyé à une condition d'attente</a>.</p>
                </li><li class="listitem">
                    <p>Si une condition d'attente reçoit le nombre requis de signaux de réussite (tels que définis dans la propriété Count) avant l'expiration du délai imparti, AWS CloudFormation marque la condition d'attente comme telle <code class="code">CREATE_COMPLETE</code> et continue à créer la pile. Dans le cas contraire, la condition d'attente AWS CloudFormation échoue et la pile est annulée (par exemple, si le délai expire sans les signaux de réussite requis ou si un signal d'échec est reçu).</p>
                </li></ul></div>
            <div class="procedure"><h6>Pour utiliser une condition d'attente dans une pile :</h6><ol><li>
                    <p>Déclarez une ressource <code class="code">AWS::CloudFormation::WaitConditionHandle</code> dans le modèle de la pile. Un descripteur de condition d'attente ne possède aucune propriété. Toutefois, une référence à une ressource <code class="code">WaitConditionHandle</code> correspond à une URL pré-signée que vous pouvez utiliser pour signaler la réussite ou la défaillance de <code class="code">WaitCondition</code>. Par exemple :</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"myWaitHandle" : <span>{</span>
     "Type" : "AWS::CloudFormation::WaitConditionHandle",
     "Properties" : <span>{</span>
     }
}</code></pre>
                </li><li>
                    <p>Déclarez une ressource <code class="code">AWS::CloudFormation::WaitCondition</code> dans le modèle de la pile. Une ressource <code class="code">WaitCondition</code> inclut deux propriétés obligatoires : <code class="code">Handle</code> est une référence à <code class="code">WaitConditionHandle</code> déclaré dans le modèle et <code class="code">Timeout</code> représente le nombre de secondes qu'attend AWS CloudFormation . Vous pouvez éventuellement définir la <code class="code">Count</code> propriété, qui détermine le nombre de signaux de réussite que la condition d'attente doit recevoir avant de AWS CloudFormation pouvoir reprendre la création de la pile.</p>
                    <p>Pour contrôler quand la condition d'attente est déclenchée, vous définissez l'attribut <code class="code">DependsOn</code> au niveau de celle-ci. Une clause <code class="code">DependsOn</code> associe une ressource à la condition d'attente. Une fois que AWS CloudFormation
a créé la ressource <code class="code">DependsOn</code>, il bloque la création des ressources de la pile jusqu'à ce que l'un des événements suivants se produisent : a) le délai expire b) le nombre de signaux de requis est reçu c) un signal de défaillance est reçu.</p>
                    <p>Voici un exemple de condition d'attente qui commence après la création réussie de la ressource <code class="code">Ec2Instance</code>, utilise la ressource <code class="code">myWaitHandle</code> comme <code class="code">WaitConditionHandle</code>, a un délai d'attente de 4 500 secondes et a la valeur par défaut <code class="code">Count</code> de 1 (puisqu'aucune propriété <code class="code">Count</code> n'est spécifiée) :</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"myWaitCondition" : <span>{</span>
    "Type" : "AWS::CloudFormation::WaitCondition",
    "DependsOn" : "Ec2Instance",
    "Properties" : <span>{</span>
        "Handle" : <span>{</span> "Ref" : "myWaitHandle" },
        "Timeout" : "4500"
    }
}</code></pre>
                </li><li>
                    <p>Obtenez l'URL pré-signée à utiliser pour le signalement.</p>
                    <p>Dans le modèle, l'URL pré-signée peut être récupérée en transmettant le nom logique de la ressource <code class="code">AWS::CloudFormation::WaitConditionHandle</code> à la fonction intrinsèque Ref. Par exemple, vous pouvez utiliser la propriété <code class="code">UserData</code> sur les ressources <code class="code">AWS::EC2::Instance</code> pour transmettre l'URL pré-signée aux instances Amazon EC2 de sorte que les scripts ou les applications qui s'exécutent sur ces instances puissent signaler une réussite ou une défaillance à AWS CloudFormation :</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"UserData" : <span>{</span>
   "Fn::Base64" : <span>{</span>
       "Fn::Join" : [ "", ["SignalURL=", <span>{</span> "Ref" : "myWaitHandle" } ] ]
   }
}</code></pre>
                    <p>Remarque : Dans les outils de ligne de AWS CloudFormation commande AWS Management Console ou dans les outils de ligne de commande, l'URL présignée est affichée sous forme d'identifiant physique de la ressource de gestion des conditions d'attente.</p>
                </li><li>
                    <p>Sélectionnez une méthode de détection du moment où la pile active la condition d'attente.</p>
                    <p>Si vous créez la pile avec les notifications activées, AWS CloudFormation publie une notification pour chaque événement de la pile dans le sujet spécifié. Si vous ou votre application vous abonnez à cette rubrique, vous pouvez suivre les notifications d'événement de création de descripteur de condition d'attente et récupérer l'URL pré-signée à partir de cette notification.</p>
                    <p>Vous pouvez également surveiller les événements de la pile à l' AWS Management Consoleaide des outils de ligne de AWS CloudFormation commande ou de l' AWS CloudFormation API.</p>
                </li><li>
                    <p>Utilisez l'URL pré-signée pour signaler la réussite ou l'échec.</p>
                    <p>Pour envoyer un signal, vous envoyez un message de requête HTTP à l'aide de l'URL pré-signée. Il doit s'agir d'une méthode de requête <code class="code">PUT</code>, et l'en-tête <code class="code">Content-Type</code> doit être une chaîne vide ou doit être omise. Le message de requête doit correspondre à une structure JSON dont le format est similaire à celui qui est spécifié dans <a href="#using-cfn-waitcondition-signaljson">Format JSON d'un signal envoyé à une condition d'attente</a>.</p>
                    <p>Vous devez envoyer le nombre de signaux de réussite spécifié par la <code class="code">Count</code> propriété afin de AWS CloudFormation poursuivre la création de la pile. Si la valeur de <code class="code">Count</code> est supérieure à 1, la valeur <code class="code">UniqueId</code> de chaque signal doit être unique pour tous les signaux envoyés à une condition d'attente particulière. <code class="code">UniqueId</code> constitue une chaîne alphanumérique arbitraire.</p>
                    <p>Une commande <code class="code">curl</code> est l'un des moyens permettant d'envoyer un signal. L'exemple suivant montre une ligne de commande <code class="code">curl</code> qui indique la réussite à une condition d'attente.</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">curl -T /tmp/a \
  "https://cloudformation-waitcondition-test.s3.amazonaws.com/arn%3Aaws%3Acloudformation%3A<span>us-east-2</span>%3A034017226601%3Astack%2Fstack-gosar-20110427004224-test-stack-with-WaitCondition--VEYW%2Fe498ce60-70a1-11e0-81a7-5081d0136786%2FmyWaitConditionHandle?Expires=1303976584&amp;AWSAccessKeyId=AKIAIOSFODNN7EXAMPLE&amp;Signature=ik1twT6hpS4cgNAw7wyOoRejVoo%3D"</code></code></pre>
                    <p>où le fichier/tmp/a contient la structure JSON suivante :</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">
<span>{</span>
   "Status" : "SUCCESS",
   "Reason" : "Configuration Complete",
   "UniqueId" : "ID1234",
   "Data" : "Application has completed configuration."
}</code></pre>
                    <p>Cet exemple montre une ligne de commande <code class="code">curl</code> qui envoie le même signal de réussite, sauf qu'il envoie la structure JSON comme paramètre dans la ligne de commande.</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">curl -X PUT \
  -H 'Content-Type:' --data-binary '<span>{</span>"Status" : "SUCCESS","Reason" : "Configuration Complete","UniqueId" : "ID1234","Data" : "Application has completed configuration."}' \
  "https://cloudformation-waitcondition-test.s3.amazonaws.com/arn%3Aaws%3Acloudformation%3A<span>us-east-2</span>%3A034017226601%3Astack%2Fstack-gosar-20110427004224-test-stack-with-WaitCondition--VEYW%2Fe498ce60-70a1-11e0-81a7-5081d0136786%2FmyWaitConditionHandle?Expires=1303976584&amp;AWSAccessKeyId=AKIAIOSFODNN7EXAMPLE&amp;Signature=ik1twT6hpS4cgNAw7wyOoRejVoo%3D"</code></code></pre>
                </li></ol></div>
            <h3 id="using-cfn-waitcondition-signaljson">Format JSON d'un signal envoyé à une condition d'attente</h3>
                
                <p>Lorsque vous envoyez un signal à une condition d'attente, vous devez utiliser le format JSON suivant :</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Status" : "StatusValue",
  "UniqueId" : "Some UniqueId",
  "Data" : "Some Data",
  "Reason" : "Some Reason"
}</code></pre>
                <p>Où :</p>
                <p><em>StatusValue</em>doit être l'une des valeurs suivantes :</p>
                <div class="itemizedlist">
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p><em>SUCCESS</em> indique un signal de réussite.</p>
                    </li><li class="listitem">
                        <p><em>FAILURE</em> indique un signal d'échec et déclenche l'échec de la condition d'attente et la restauration de la pile.</p>
                    </li></ul></div>
                <p><em><code class="code">UniqueId</code></em>identifie le signal à AWS CloudFormation. Si la <code class="code">Count</code> propriété de la condition d'attente est supérieure à 1, la <code class="code">UniqueId</code> valeur doit être unique pour tous les signaux envoyés pour une condition d'attente particulière ; sinon, le signal AWS CloudFormation sera considéré comme une retransmission du signal précédemment envoyé avec le même signal<code class="code">UniqueId</code>, et le signal sera ignoré.</p>
                <p><em><code class="code">Data</code></em> correspond aux informations que vous souhaitez renvoyer avec le signal. La <code class="code">Data</code> valeur est accessible en appelant la <a href="./intrinsic-function-reference-getatt.html">Fn::GetAtt fonction</a> dans le modèle. Par exemple, si vous créez la valeur de sortie suivante pour la condition d'attente<code class="code">mywaitcondition</code>, vous pouvez utiliser la <code class="code">aws cloudformation describe-stacks</code> commande, l'opération d'<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_DescribeStacks.html"><code class="code">DescribeStacks</code></a>API ou l'onglet <b>Sorties</b> de la AWS CloudFormation console pour afficher les signaux <code class="code">Data</code> envoyés par des signaux valides envoyés à AWS CloudFormation : </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">
"WaitConditionData" : <span>{</span>
  "Value" : <span>{</span> "Fn::GetAtt" : [ "mywaitcondition", "Data" ]},
  "Description" : "The data passed back as part of signalling the WaitCondition"
},
            </code></pre>
                <p>La <a href="./intrinsic-function-reference-getatt.html">Fn::GetAtt fonction</a> renvoie le <code class="code">UniqueId</code> et <code class="code">Data</code> sous forme de paire nom/valeur dans une structure JSON. Voici un exemple d'attribut <code class="code">Data</code> renvoyé par la valeur de sortie <code class="code">WaitConditionData</code> définie ci-dessus :</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>"Signal1":"Application has completed configuration."}</code></pre>
                <p><em>Reason</em> est une chaîne sans aucune autre restriction de contenu, si ce n'est qu'elle doit être conforme au format JSON.</p>
             
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./deploying.applications.html">Déploiement d’applications</div><div id="next" class="next-link" accesskey="n" href="./CHAP_TemplateQuickRef.html">Extraits de modèle</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>