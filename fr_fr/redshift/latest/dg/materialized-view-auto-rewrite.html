<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Réécriture automatique des requêtes pour utiliser des vues matérialisées - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="materialized-view-auto-rewrite" /><meta name="default_state" content="materialized-view-auto-rewrite" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-auto-rewrite.html" /><meta name="description" content="Amazon Redshift peut réécrire les requêtes pour utiliser une vue matérialisée." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guide du développeur de base de données" /><meta name="abstract" content="Créez et gérez un entrepôt de données avec Amazon Redshift, service d’entrepôt de données au niveau de l’entreprise, pouvant atteindre plusieurs Po et entièrement géré." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-auto-rewrite.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-auto-rewrite.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guide du développeur de base de données" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guide du développeur de base de données" /><meta id="panorama-serviceConsolePage" value="Réécriture automatique des requêtes pour utiliser des vues matérialisées" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Réécriture automatique des requêtes pour utiliser des vues matérialisées - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#materialized-view-auto-rewrite" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-auto-rewrite.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-auto-rewrite.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-auto-rewrite.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,entrepôt de données,développeur,exemples de données,database,développeur de base de données,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide du développeur de base de données",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Création de vues matérialisées dans Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-overview.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Réécriture automatique des requêtes pour utiliser des vues matérialisées",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-overview.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#materialized-view-auto-rewrite" target="_blank" rel="noopener noreferrer" title="Ouvrir le PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guide du développeur de base de données</a></div><div id="page-toc-src"><a href="#mv_auto-rewrite_usage">Notes d’utilisation</a><a href="#mv_auto-rewrite_limitations">Limites</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="materialized-view-auto-rewrite">Réécriture automatique des requêtes pour utiliser des vues matérialisées</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Vous pouvez utiliser la réécriture automatique des requêtes des vues matérialisées pour qu’Amazon Redshift réécrive les requêtes afin d’utiliser les vues matérialisées. Cela accélère les applications des requêtes, même celles qui ne font pas explicitement référence à une vue matérialisée. Lorsqu’Amazon Redshift réécrit des requêtes, il utilise uniquement des vues matérialisées à jour.</p>
            <h2 id="mv_auto-rewrite_usage">Notes d’utilisation</h2>
          
     
        <p>Pour vérifier si la réécriture automatique des requêtes est utilisée, vérifiez le plan de requête ou STL_EXPLAIN. Voici une instruction SELECT et la sortie EXPLAIN du plan de requête d’origine.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT catgroup, SUM(qtysold) AS sold
FROM category c, event e, sales s
WHERE c.catid = e.catid AND e.eventid = s.eventid
GROUP BY 1;

EXPLAIN 
 XN HashAggregate  (cost=920021.24..920021.24 rows=1 width=35)
   -&gt;  XN Hash Join DS_BCAST_INNER  (cost=440004.53..920021.22 rows=4 width=35)
         Hash Cond: ("outer".eventid = "inner".eventid)
         -&gt;  XN Seq Scan on sales s  (cost=0.00..7.40 rows=740 width=6)
         -&gt;  XN Hash  (cost=440004.52..440004.52 rows=1 width=37)
               -&gt;  XN Hash Join DS_BCAST_INNER  (cost=0.01..440004.52 rows=1 width=37)
                     Hash Cond: ("outer".catid = "inner".catid)
                     -&gt;  XN Seq Scan on event e  (cost=0.00..2.00 rows=200 width=6)
                     -&gt;  XN Hash  (cost=0.01..0.01 rows=1 width=35)
                           -&gt;  XN Seq Scan on category c  (cost=0.00..0.01 rows=1 width=35)</code></pre>
                <p>Voici la sortie EXPLAIN après une réécriture automatique réussie. Cette sortie inclut une analyse de la vue matérialisée dans le plan de requête qui remplace des parties du plan de requête d’origine. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">* EXPLAIN 
     XN HashAggregate  (cost=11.85..12.35 rows=200 width=41)
       -&gt;  XN Seq Scan on mv_tbl__tickets_mv__0 derived_table1  (cost=0.00..7.90 rows=790 width=41)
</code></pre>
                
            
            
            
                
                
                
                <p>Seules les  up-to-date  (nouvelles) vues matérialisées sont prises en compte pour la réécriture automatique des requêtes, quelle que soit la stratégie d'actualisation (automatique, planifiée ou manuelle). Par conséquent, la requête d'origine renvoie  up-to-date  des résultats. Lorsqu’une vue matérialisée est explicitement référencée dans les requêtes, Amazon Redshift accède aux données stockées dans la vue matérialisée. Il est possible que ces données ne reflètent pas les dernières modifications des tables de base de la vue matérialisée.</p>
            <p>Vous pouvez utiliser la réécriture automatique des requêtes des vues matérialisées créées sur le cluster version 1.0.20949 ou ultérieure.</p>
            <p>Vous pouvez interrompre la réécriture automatique des requêtes au niveau de la séance en définissant SET mv_enable_aqmv_for_session sur FALSE.</p>
               
            
            
          
            
         
            <h2 id="mv_auto-rewrite_limitations">Limites</h2>
            <p>Voici les limites de l’utilisation de la réécriture automatique des requêtes des vues matérialisées :</p>
            <div class="itemizedlist">
                 
               
                 
           
            <ul class="itemizedlist"><li class="listitem"><p>La réécriture automatique des requêtes fonctionne avec des vues matérialisées qui ne font pas référence à ou n’incluent aucun des éléments suivants :</p>
                <div class="itemizedlist">
                     
                     
                     
                     
                     
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem"><p>Sous-requêtes</p></li><li class="listitem"><p>Outer join left, right ou full</p></li><li class="listitem"><p>Opérations d’ensemble </p></li><li class="listitem"><p>Toutes les fonctions d’agrégation, sauf SUM, COUNT, MIN, MAX et AVG. (Il s’agit des seules fonctions d’agrégation qui fonctionnent avec la réécriture automatique des requêtes.)</p></li><li class="listitem"><p>Toutes les fonctions d’agrégation avec DISTINCT</p></li><li class="listitem"><p>Toutes les fonctions de fenêtrage</p></li><li class="listitem"><p>Clauses SELECT DISTINCT ou HAVING</p></li><li class="listitem"><p>Tables externes</p></li><li class="listitem"><p>Toute autre vue matérialisée</p></li></ul></div></li><li class="listitem"><p>La réécriture automatique des requêtes réécrit les requêtes SELECT qui font référence aux tables Amazon Redshift définies par l’utilisateur. Amazon Redshift ne réécrit pas les requêtes suivantes :</p>
                  <div class="itemizedlist">
                       
                       
                       
                       
                  <ul class="itemizedlist"><li class="listitem"><p>Les instructions CREATE TABLE AS</p></li><li class="listitem"><p>Les instructions SELECT INTO</p></li><li class="listitem"><p>Les requêtes sur des catalogues ou des tables système</p></li><li class="listitem"><p>Les requêtes avec jointures externes ou clause SELECT DISTINCT</p></li></ul></div></li><li class="listitem"><p>Si une requête n’est pas réécrite automatiquement, vérifiez si vous disposez de l’autorisations SELECT sur la vue matérialisée et si l’option <a href="./r_mv_enable_aqmv_for_session.html">mv_enable_aqmv_for_session</a> est définie sur TRUE. </p>
            <p>Vous pouvez également vérifier si vos vues matérialisées sont éligibles à la réécriture automatique des requêtes en inspectant STV_MV_INFO. Pour plus d'informations, consultez <a href="./r_STV_MV_INFO.html">STV_MV_INFO</a>.</p></li></ul></div>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./materialized-view-query.html">Interrogation d’une vue matérialisée</div><div id="next" class="next-link" accesskey="n" href="./materialized-view-refresh.html">Actualisation d’une vue matérialisée</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-auto-rewrite.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-auto-rewrite.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>