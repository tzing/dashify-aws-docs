<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Recommandations Amazon Redshift Advisor - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="advisor-recommendations" /><meta name="default_state" content="advisor-recommendations" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/advisor-recommendations.html" /><meta name="description" content="Amazon Redshift Advisor met à votre disposition des recommandations sur la façon d'optimiser votre cluster Amazon Redshift afin d'augmenter ses performances et de réduire les coûts d'exploitation. Vous trouverez des explications sur chaque recommandation dans la console, comme décrit précédemment. Vous trouverez des informations supplémentaires sur ces recommandations dans les sections suivantes :" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guide du développeur de base de données" /><meta name="abstract" content="Créez et gérez un entrepôt de données avec Amazon Redshift, service d’entrepôt de données au niveau de l’entreprise, pouvant atteindre plusieurs Po et entièrement géré." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/advisor-recommendations.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/advisor-recommendations.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/advisor-recommendations.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/advisor-recommendations.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/advisor-recommendations.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/advisor-recommendations.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/advisor-recommendations.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/advisor-recommendations.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/advisor-recommendations.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/advisor-recommendations.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/advisor-recommendations.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/advisor-recommendations.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/advisor-recommendations.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/advisor-recommendations.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/advisor-recommendations.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/advisor-recommendations.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/advisor-recommendations.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/advisor-recommendations.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/advisor-recommendations.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/advisor-recommendations.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/advisor-recommendations.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/advisor-recommendations.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guide du développeur de base de données" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guide du développeur de base de données" /><meta id="panorama-serviceConsolePage" value="Recommandations Amazon Redshift Advisor" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Recommandations Amazon Redshift Advisor - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#advisor-recommendations" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/advisor-recommendations.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/advisor-recommendations.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/advisor-recommendations.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,entrepôt de données,développeur,exemples de données,database,développeur de base de données,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide du développeur de base de données",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Bonnes pratiques Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/best-practices.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Utilisation des recommandations Amazon Redshift Advisor",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/advisor.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Recommandations Amazon Redshift Advisor",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/advisor.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#advisor-recommendations" target="_blank" rel="noopener noreferrer" title="Ouvrir le PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guide du développeur de base de données</a></div><div id="page-toc-src"><a href="#cluster-compress-s3-recommendation">Compresser les objets de fichiers Amazon S3 chargés par COPY</a><a href="#isolate-active-dbs-recommendation">Isolation de plusieurs bases de données actives</a><a href="#reallocate-wlm-recommendation">Réallocation de la mémoire de gestion de charge de travail (WLM)</a><a href="#skip-compression-analysis-recommendation">Omission de l'analyse de compression durant l'exécution de la commande COPY</a><a href="#split-s3-objects-recommendation">Fractionnement des objets Amazon S3 chargés par COPY</a><a href="#update-table-statistics-recommendation">Mise à jour des statistiques de table</a><a href="#enable-sqa-recommendation">Activer l'accélération des requêtes courtes</a><a href="#alter-diststyle-distkey-recommendation">Modifier les clés de distribution sur les tables</a><a href="#alter-sortkey-recommendation">Modification des clés de tri au niveau des tables</a><a href="#alter-compression-encoding-recommendation">Modifier les encodages de compression sur les colonnes</a><a href="#data-type-recommendation">Recommandations sur les types de données</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="advisor-recommendations">Recommandations Amazon Redshift Advisor</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Amazon Redshift Advisor met à votre disposition des recommandations sur la façon d'optimiser votre cluster Amazon Redshift afin d'augmenter ses performances et de réduire les coûts d'exploitation. Vous trouverez des explications sur chaque recommandation dans la console, comme décrit précédemment. Vous trouverez des informations supplémentaires sur ces recommandations dans les sections suivantes : </p><div class="highlights" id="inline-topiclist"><h6>Rubriques</h6><ul><li><a href="#cluster-compress-s3-recommendation">Compresser les objets de fichiers Amazon S3 chargés par COPY</a></li><li><a href="#isolate-active-dbs-recommendation">Isolation de plusieurs bases de données actives</a></li><li><a href="#reallocate-wlm-recommendation">Réallocation de la mémoire de gestion de charge de travail (WLM)</a></li><li><a href="#skip-compression-analysis-recommendation">Omission de l'analyse de compression durant l'exécution de la commande COPY</a></li><li><a href="#split-s3-objects-recommendation">Fractionnement des objets Amazon S3 chargés par COPY</a></li><li><a href="#update-table-statistics-recommendation">Mise à jour des statistiques de table</a></li><li><a href="#enable-sqa-recommendation">Activer l'accélération des requêtes courtes</a></li><li><a href="#alter-diststyle-distkey-recommendation">Modifier les clés de distribution sur les tables</a></li><li><a href="#alter-sortkey-recommendation">Modification des clés de tri au niveau des tables</a></li><li><a href="#alter-compression-encoding-recommendation">Modifier les encodages de compression sur les colonnes</a></li><li><a href="#data-type-recommendation">Recommandations sur les types de données</a></li></ul></div>
            <h2 id="cluster-compress-s3-recommendation">Compresser les objets de fichiers Amazon S3 chargés par COPY</h2>
            <p>La commande COPY tire parti de l'architecture de traitement massivement parallèle (MPP) d'Amazon Redshift pour lire et charger des données en parallèle. Il peut lire des fichiers à partir d'Amazon S3, des tables DynamoDB et des sorties texte à partir d'un ou plusieurs hôtes distants. </p>
            <p>En cas de chargement de grandes quantités de données, nous vous recommandons vivement d'utiliser la commande COPY pour charger des fichiers de données compressés à partir de S3. La compression de jeux de données volumineux permet de réduire le temps de chargement des fichiers sur Amazon S3. La commande COPY peut également accélérer le processus de chargement en décompressant les fichiers au fur et à mesure de leur lecture. </p>
            <p><b>Analyse</b></p>
            <p>Les performances des commandes COPY à exécution longue qui chargent de grands ensembles de données non compressés peuvent souvent être améliorées. L'analyse Advisor identifie les commandes COPY qui chargent de grands ensembles de données non compressés. Dans ce cas, Advisor génère une recommandation visant à mettre en œuvre la compression sur les fichiers sources dans Amazon S3. </p>


            <p><b>Recommandation</b></p>
            <p>Veillez à ce que chaque commande COPY qui charge une quantité de données significative ou qui s'exécute longuement ingère des objets de données compressés à partir d'Amazon S3. Vous pouvez identifier les commandes COPY qui chargent des jeux de données volumineux non compressés à partir d'Amazon S3 en exécutant la commande SQL suivante en tant que super-utilisateur.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
SELECT
    wq.userid, query, exec_start_time AS starttime, COUNT(*) num_files,
    ROUND(MAX(wq.total_exec_time/1000000.0),2) execution_secs,
    ROUND(SUM(transfer_size)/(1024.0*1024.0),2) total_mb,
    SUBSTRING(querytxt,1,60) copy_sql
FROM stl_s3client s
JOIN stl_query q USING (query)
JOIN stl_wlm_query wq USING (query)
WHERE s.userid&gt;1 AND http_method = 'GET'
    AND POSITION('COPY ANALYZE' IN querytxt) = 0
    AND aborted = 0 AND final_state='Completed'
GROUP BY 1, 2, 3, 7
HAVING SUM(transfer_size) = SUM(data_size) 
AND SUM(transfer_size)/(1024*1024) &gt;= 5
ORDER BY 6 DESC, 5 DESC;         
          </code></pre>
            <p>Si les données temporaires restent dans Amazon S3 après leur chargement, ce qui est courant dans les architectures de lac de données, leur stockage sous une forme compressée peut réduire vos coûts de stockage. </p>
            <p><b>Conseils d'implémentation</b></p>

            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>La taille idéale des objets est de 1 à 128 Mo après compression.</p>
               </li><li class="listitem">
                  <p>Vous pouvez compresser vos fichiers à l'aide des formats gzip, lzop ou bzip2.</p>
               </li></ul></div>

          
            <h2 id="isolate-active-dbs-recommendation">Isolation de plusieurs bases de données actives</h2>
            <p>Comme bonne pratique, nous recommandons d'isoler les bases de données dans Amazon Redshift les unes des autres. Les requêtes s'exécutent dans une base de données spécifique et ne peuvent accéder aux données des autres bases de données du cluster. Toutefois, les requêtes que vous exécutez dans toutes les bases de données d'un cluster partagent le même espace de stockage de cluster sous-jacent et les mêmes ressources de calcul. Lorsqu'un cluster unique contient plusieurs bases de données actives, leurs charges de travail sont généralement sans lien.</p>
            <p><b>Analyse</b></p>
            <p>L'analyse Advisor passe en revue toutes les bases de données du cluster à la recherche des charges de travail actives s'exécutant en même temps. Si des charges de travail actives sont exécutées en même temps, Advisor génère une recommandation pour envisager la migration des bases de données vers des clusters Amazon Redshift distincts.</p>

            <p><b>Recommandation</b></p>
            <p>Vous devez envisager de déplacer chaque base de données faisant l'objet de requêtes actives vers un cluster dédié distinct. L'utilisation d'un cluster distinct peut réduire les conflits de ressources et améliorer les performances des requêtes. En effet, cela vous permet de définir la taille de chaque cluster en fonction du stockage, des coûts et des performances attendus pour chaque charge de travail. En outre, les charges de travail non liées utilisent souvent des configurations de gestion de charge de travail différentes.</p>
            <p>Pour identifier les bases de données qui sont activement utilisées, vous pouvez utiliser la commande SQL suivante en tant que super-utilisateur :</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
SELECT database,
  COUNT(*) as num_queries,
  AVG(DATEDIFF(sec,starttime,endtime)) avg_duration,
  MIN(starttime) as oldest_ts,
  MAX(endtime) as latest_ts
FROM stl_query
WHERE userid &gt; 1
GROUP BY database;            
         </code></pre>
            <p><b>Conseils d'implémentation</b></p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>Étant donné qu'un utilisateur doit se connecter à chaque base de données de façon spécifique et que les requêtes ne peuvent accéder qu'à une seule base de données, le déplacement des bases de données vers d'autres clusters a un impact minimal sur les utilisateurs.</p>
               </li><li class="listitem">
                  <p>Pour déplacer une base de données, vous pouvez procéder comme suit : </p>
                  <div class="orderedlist">
                      
                      
                      
                  <ol><li>
                        <p>Restaurez temporairement un instantané du cluster actuel sur un cluster de même taille.</p>
                     </li><li>
                        <p>Supprimez toutes les bases de données du nouveau cluster, à l'exception de la base de données cible à déplacer.</p>
                     </li><li>
                        <p>Redimensionnez le cluster sur un type de nœud approprié et tenez compte de la charge de travail de la base de données.</p>
                     </li></ol></div>

               </li></ul></div>
          
            <h2 id="reallocate-wlm-recommendation">Réallocation de la mémoire de gestion de charge de travail (WLM)</h2>
            <p>Amazon Redshift achemine les requêtes utilisateur vers <a href="./cm-c-defining-query-queues.html">Implémentation de la gestion manuelle de la charge de travail</a> en vue de leur traitement. La gestion de la charge de travail (WLM) définit comment ces requêtes sont acheminées vers les files d'attente. Amazon Redshift alloue à chaque file d'attente une partie de la mémoire disponible du cluster. La mémoire d'une file d'attente est répartie entre les emplacements de requête de la file d'attente. </p>
            <p>Lorsqu'une file d'attente est configurée avec plus d'emplacements que la charge de travail n'en requiert, la mémoire allouée à ces emplacements inutilisés est sous-utilisée. La réduction des emplacements configurés en fonction des exigences de la charge de travail maximale permet de redistribuer la mémoire sous-utilisée aux emplacements actifs et peut améliorer ainsi les performances des requêtes. </p>
            <p><b>Analyse</b></p>
            <p>L'analyse Advisor passe en revue les exigences en matière de simultanéité de la charge de travail afin d'identifier les files d'attente de requêtes ayant des emplacement inutilisés. Advisor génère une recommandation conseillant de réduire le nombre d'emplacements dans une file d'attente lorsqu'il détecte les éléments suivants :</p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>Une file d'attente avec des emplacements complètement inactifs pendant l'analyse.</p>
               </li><li class="listitem">
                  <p>Une file d'attente avec plus de quatre emplacements dont au moins deux sont inactifs pendant l'analyse.</p>
               </li></ul></div>

            <p><b>Recommandation</b></p>
            <p>La réduction des emplacements configurés en fonction des exigences de la charge de travail maximale permet de redistribuer la mémoire sous-utilisée aux emplacements actifs. Envisagez de réduire le nombre d'emplacements configurés pour les files d'attente où les emplacements n'ont jamais été totalement utilisés. Pour identifier ces files d'attente, vous pouvez comparer les exigences horaires maximales des emplacements de chaque file d'attente en exécutant la commande SQL suivante en tant que super-utilisateur :</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
WITH
 generate_dt_series AS (select sysdate - (n * interval '5 second') as dt from (select row_number() over () as n from stl_scan limit 17280)),
 apex AS (
     SELECT iq.dt, iq.service_class, iq.num_query_tasks, count(iq.slot_count) as service_class_queries, sum(iq.slot_count) as service_class_slots
     FROM
         (select gds.dt, wq.service_class, wscc.num_query_tasks, wq.slot_count
         FROM stl_wlm_query wq
         JOIN stv_wlm_service_class_config wscc ON (wscc.service_class = wq.service_class AND wscc.service_class &gt; 5)
         JOIN generate_dt_series gds ON (wq.service_class_start_time &lt;= gds.dt AND wq.service_class_end_time &gt; gds.dt)
         WHERE wq.userid &gt; 1 AND wq.service_class &gt; 5) iq
     GROUP BY iq.dt, iq.service_class, iq.num_query_tasks),
     maxes as (SELECT apex.service_class, trunc(apex.dt) as d, date_part(h,apex.dt) as dt_h, max(service_class_slots) max_service_class_slots
                     from apex group by apex.service_class, apex.dt, date_part(h,apex.dt))
SELECT apex.service_class - 5 AS queue, apex.service_class, apex.num_query_tasks AS max_wlm_concurrency, maxes.d AS day, maxes.dt_h || ':00 - ' || maxes.dt_h || ':59' as hour, MAX(apex.service_class_slots) as max_service_class_slots
FROM apex
JOIN maxes ON (apex.service_class = maxes.service_class AND apex.service_class_slots = maxes.max_service_class_slots)
GROUP BY  apex.service_class, apex.num_query_tasks, maxes.d, maxes.dt_h
ORDER BY apex.service_class, maxes.d, maxes.dt_h;            
         </code></pre>
            <p>La colonne <code class="code">max_service_class_slots</code> représente le nombre maximum d'emplacements de requêtes WLM dans la file d'attente de requêtes pour cette heure. S'il existe des files d'attente sous-utilisées, mettez en œuvre l'optimisation de la réduction des créneaux en <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/managing-parameter-groups-console.html#parameter-group-modify">modifiant un groupe de paramètres</a>, comme décrit dans le <em>Guide de gestion Amazon Redshift</em>.</p>
            <p><b>Conseils d'implémentation</b></p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>Si votre charge de travail est fortement variable en volume, veillez à ce que l'analyse capture une période d'utilisation maximale. Si tel n'a pas été le cas, exécutez la commande SQL précédente à plusieurs reprises afin de surveiller les exigences maximales en matière de simultanéité. </p>
               </li><li class="listitem">
                  <p>Pour plus d'informations sur l'interprétation des résultats de requête à partir du code SQL précédent, consultez le <a href="https://github.com/awslabs/amazon-redshift-utils/blob/master/src/AdminScripts/wlm_apex_hourly.sql" rel="noopener noreferrer" target="_blank"><span>script wlm_apex_hourly.sql</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> sur GitHub.</p>
               </li></ul></div>

          
            <h2 id="skip-compression-analysis-recommendation">Omission de l'analyse de compression durant l'exécution de la commande COPY</h2>
            <p>Lorsque vous chargez des données dans une table vide avec un encodage de compression déclaré avec la commande COPY, Amazon Redshift applique une compression de stockage. Cette optimisation permet de s'assurer que les données de votre cluster sont stockées efficacement, même lorsqu'elles sont chargées par les utilisateurs finaux. L'analyse requise pour appliquer la compression peut prendre un certain temps.</p>

            <p><b>Analyse</b></p>
            <p>L'analyse Advisor recherche les opérations COPY qui ont été retardées par l'analyse de compression automatique. L'analyse détermine les encodages de compression en échantillonnant les données pendant leur chargement. Cet échantillon est similaire à celui effectué par la commande <a href="./r_ANALYZE_COMPRESSION.html">ANALYZE COMPRESSION</a>. </p>
            <p>Lorsque vous chargez des données dans le cadre d'un processus structuré, tel qu'un traitement par lot ETL (extraction, transformation, chargement) pendant la nuit, vous pouvez définir la compression à l'avance. Vous pouvez également optimiser vos définitions de table en omettant cette phase de façon permanente sans aucun impact négatif.</p>
            <p><b>Recommandation</b></p>
            <p>Pour améliorer la réactivité de la commande COPY en omettant la phase d'analyse de compression, implémentez l'une des actions suivantes :</p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>Utilisez le paramètre de colonne <code class="code">ENCODE</code> lors de la création des tables que vous chargez à l'aide de la commande COPY.</p>
               </li><li class="listitem">
                  <p>Désactivez totalement la compression en indiquant le paramètre <code class="code">COMPUPDATE OFF</code> dans la commande COPY.</p>
               </li></ul></div>
            <p>La meilleure solution est généralement d'utiliser l'encodage de colonne lors de la création de table, car cette approche permet également de conserver le bénéfice du stockage des données compressées sur le disque. Vous pouvez utiliser la commande ANALYZE COMPRESSION pour suggérer les encodages de compression, mais vous devez recréer la table pour appliquer ces encodages. Pour automatiser ce processus, vous pouvez vous servir de l'utilitaire AWS<a href="https://github.com/awslabs/amazon-redshift-utils/tree/master/src/ColumnEncodingUtility" rel="noopener noreferrer" target="_blank"><span>ColumnEncodingUtility</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, qui se trouve sur GitHub. </p>
            <p>Pour identifier les opérations COPY récentes qui ont déclenché une analyse de compression automatique, utilisez la commande SQL suivante :</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
  WITH xids AS (
    SELECT xid FROM stl_query WHERE userid&gt;1 AND aborted=0 
    AND querytxt = 'analyze compression phase 1' GROUP BY xid
    INTERSECT SELECT xid FROM stl_commit_stats WHERE node=-1)
SELECT a.userid, a.query, a.xid, a.starttime, b.complyze_sec, 
    a.copy_sec, a.copy_sql
FROM (SELECT q.userid, q.query, q.xid, date_trunc('s',q.starttime) 
    starttime, substring(querytxt,1,100) as copy_sql, 
    ROUND(datediff(ms,starttime,endtime)::numeric / 1000.0, 2) copy_sec
    FROM stl_query q JOIN xids USING (xid)
    WHERE (querytxt ilike 'copy %from%' OR querytxt ilike '% copy %from%') 
    AND querytxt not like 'COPY ANALYZE %') a
LEFT JOIN (SELECT xid, 
    ROUND(sum(datediff(ms,starttime,endtime))::numeric / 1000.0,2) complyze_sec 
    FROM stl_query q JOIN xids USING (xid)
    WHERE (querytxt like 'COPY ANALYZE %' 
    OR querytxt like 'analyze compression phase %') 
    GROUP BY xid ) b ON a.xid = b.xid
WHERE b.complyze_sec IS NOT NULL ORDER BY a.copy_sql, a.starttime;
         </code></pre>
            <p><b>Conseils d'implémentation</b></p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>Veillez à ce que toutes les tables de taille significative créées durant vos processus ETL (par exemple, tables intermédiaires et tables temporaires) déclarent un encodage de compression pour toutes les colonnes, exceptée la première clé de tri.</p>
               </li><li class="listitem">
                  <p>Estimez la taille de la table en cours de chargement pour toute sa durée de vie pour chacune des commandes COPY identifiées par la commande SQL précédente. Si vous êtes sûr que la table restera extrêmement petite, désactivez totalement la compression à l'aide du paramètre <code class="code">COMPUPDATE OFF</code>. Sinon, créez la table avec une compression explicite avant de la charger avec la commande COPY.</p>
               </li></ul></div>
          
            <h2 id="split-s3-objects-recommendation">Fractionnement des objets Amazon S3 chargés par COPY</h2>
            <p>La commande COPY tire parti de l'architecture de traitement massivement parallèle (MPP) d'Amazon Redshift pour lire et charger des données à partir de fichiers sur Amazon S3. La commande COPY charge les données en parallèle à partir de plusieurs fichiers, répartissant la charge de travail entre les nœuds de votre cluster. Afin d'obtenir un débit optimal, nous vous recommandons vivement de fractionner vos données en plusieurs fichiers pour tirer parti du traitement parallèle. </p>
            <p><b>Analyse</b></p>
            <p>L'analyse Advisor identifie les commandes COPY qui chargent les jeux de données volumineux contenus dans un petit nombre de fichiers placés temporairement dans Amazon S3. Les performances des commandes COPY à exécution longue qui chargent de grands ensembles de données à partir de quelques fichiers peuvent souvent être améliorées. Quand Advisor détermine que l'exécution de ces commandes COPY prend un temps significatif, il crée une recommandation conseillant d'accroître le parallélisme en fractionnant les données en fichiers supplémentaires dans Amazon S3. </p>
            <p><b>Recommandation</b></p>
            <p>Dans ce cas, nous recommandons les actions suivantes, répertoriées par ordre de priorité :</p>
            <div class="orderedlist">
                
                
                
            <ol><li>
                  <p>Optimisez les commandes COPY qui chargent moins de fichiers que le nombre de nœuds de cluster.</p>
               </li><li>
                  <p>Optimisez les commandes COPY qui chargent moins de fichiers que le nombre de tranches de cluster. </p>
               </li><li>
                  <p>Optimisez les commandes COPY où le nombre de fichiers n'est pas un multiple du nombre de tranches du cluster.</p>
               </li></ol></div>
            <p>Certaines commandes COPY chargent une quantité importante de données ou ont une durée d'exécution importante. Pour ces commandes, nous vous recommandons de charger un nombre d'objets de données d'Amazon S3 équivalent à un multiple du nombre de tranches présentes dans le cluster. Pour identifier combien d'objets S3 chaque commande COPY a chargé, exécutez le code SQL suivant en tant que super-utilisateur. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
SELECT
    query, COUNT(*) num_files,
    ROUND(MAX(wq.total_exec_time/1000000.0),2) execution_secs,
    ROUND(SUM(transfer_size)/(1024.0*1024.0),2) total_mb,
    SUBSTRING(querytxt,1,60) copy_sql
FROM stl_s3client s
JOIN stl_query q USING (query)
JOIN stl_wlm_query wq USING (query)
WHERE s.userid&gt;1 AND http_method = 'GET'
    AND POSITION('COPY ANALYZE' IN querytxt) = 0
    AND aborted = 0 AND final_state='Completed'
GROUP BY query, querytxt
HAVING (SUM(transfer_size)/(1024*1024))/COUNT(*) &gt;= 2
ORDER BY CASE
WHEN COUNT(*) &lt; (SELECT max(node)+1 FROM stv_slices) THEN 1
WHEN COUNT(*) &lt; (SELECT COUNT(*) FROM stv_slices WHERE node=0) THEN 2
ELSE 2+((COUNT(*) % (SELECT COUNT(*) FROM stv_slices))/(SELECT COUNT(*)::DECIMAL FROM stv_slices))
END, (SUM(transfer_size)/(1024.0*1024.0))/COUNT(*) DESC;   
            
         </code></pre>
            <p><b>Conseils d'implémentation</b></p>
            <div class="itemizedlist">
                
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>Le nombre de tranches par nœud dépend de la taille de nœud du cluster. Pour plus d'informations sur le nombre de tranches dans les différents types de nœuds, consultez la rubrique <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-clusters.html#rs-about-clusters-and-nodes">Clusters et nœuds dans Amazon Redshift</a> dans le <em>Guide de gestion Amazon Redshift</em>. </p>
               </li><li class="listitem">
                  <p>Vous pouvez charger plusieurs fichiers en spécifiant un préfixe commun, ou clé de préfixe, pour l'ensemble, ou en indiquant explicitement les fichiers dans un fichier manifeste. Pour plus d'informations sur le chargement des fichiers, consultez <a href="./t_splitting-data-files.html">Chargement de données à partir de fichiers compressés et non compressés</a>.</p>
               </li><li class="listitem">
                  <p>Amazon Redshift ne prend pas en compte la taille des fichiers lors de la répartition de la charge de travail. Fractionnez vos fichiers de données de chargement de telle sorte que les fichiers soient à peu près de taille égale, entre 1 Mo et 1 Go après compression. </p>
               </li></ul></div>
          
            <h2 id="update-table-statistics-recommendation">Mise à jour des statistiques de table</h2>
            <p>Amazon Redshift utilise un optimiseur de requêtes basé sur les coûts pour choisir le plan d'exécution optimal des requêtes. Les estimations de coût reposent sur les statistiques de table générées via la commande ANALYZE. Lorsque les statistiques sont obsolètes ou manquantes, la base de données peut choisir un plan d'exécution des requêtes moins efficace, en particulier pour les requêtes complexes. Le maintien à jour des statistiques permet d'exécuter des requêtes complexes en un temps minimal. </p>
            <p><b>Analyse</b></p>
            <p>L'analyse Advisor effectue le suivi des tables dont les statistiques sont obsolètes ou manquantes. Elle passe en revue les métadonnées d'accès aux tables qui sont associées à des requêtes complexes. Si des statistiques sont manquantes pour des tables qui font l'objet d'accès fréquents avec des modèles complexes, Advisor crée une recommandation <b>critique</b> conseillant d'exécuter la commande ANALYZE. Si des statistiques sont obsolètes pour des tables qui font l'objet d'accès fréquents avec des modèles complexes, Advisor crée une recommandation <b>suggérée</b> conseillant d'exécuter la commande ANALYZE.</p>

            <p><b>Recommandation</b></p>
            <p>Chaque fois que le contenu de la table change de façon significative, mettez à jour les statistiques à l'aide de la commande ANALYZE. Nous recommandons d'exécuter la commande ANALYZE chaque fois qu'un nombre important de nouvelles lignes de données est chargé dans une table existante à l'aide de la commande COPY ou INSERT. Nous recommandons également d'exécuter la commande ANALYZE chaque fois qu'un nombre important de lignes sont modifiées à l'aide de la commande UPDATE ou DELETE. Pour identifier les tables ayant des statistiques manquantes ou obsolètes, exécutez la commande SQL suivante en tant que super-utilisateur. Les résultats sont classés de la plus grande à la plus petite table. </p>
            <p>Pour identifier les tables ayant des statistiques manquantes ou obsolètes, exécutez la commande SQL suivante en tant que super-utilisateur. Les résultats sont classés de la plus grande à la plus petite table.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
SELECT
   ti.schema||'.'||ti."table" tablename,
   ti.size table_size_mb,
   ti.stats_off statistics_accuracy
 FROM svv_table_info ti
 WHERE ti.stats_off &gt; 5.00
 ORDER BY ti.size DESC;          
         </code></pre>
            <p><b>Conseils d'implémentation</b></p>
            
                  <p>Le seuil par défaut d'ANALYZE est de 10 %. Cela signifie que la commande ANALYZE ignore une table donnée si moins de 10 % des lignes de la table ont été modifiées depuis la dernière exécution d'ANALYZE. Par conséquent, vous pouvez choisir d'émettre les commandes ANALYZE à la fin de chaque processus ETL. Cette approche signifie que la commande ANALYZE est souvent ignorée mais vous permet d'être sûr qu'elle n'est exécutée que lorsque cela est nécessaire.</p>
              
                  <p>C'est sur les colonnes utilisées dans les jointures (par exemple, <code class="code">JOIN tbl_a ON col_b</code>) ou comme prédicats (par exemple, <code class="code">WHERE col_b = 'xyz'</code>) que les statistiques ANALYZE ont le plus fort impact. Par défaut, la commande ANALYZE collecte des statistiques pour toutes les colonnes de la table spécifiée. Si nécessaire, vous pouvez réduire le temps requis pour exécuter la commande ANALYZE en ne l'exécutant que pour les colonnes sur lesquelles elle a le plus d'impact. Vous pouvez exécuter la commande SQL suivante pour identifier les colonnes utilisées comme prédicats : Vous pouvez également laisser Amazon Redshift choisir les colonnes à analyser en spécifiant <code class="code">ANALYZE PREDICATE COLUMNS</code>. </p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">WITH predicate_column_info as (
SELECT ns.nspname AS schema_name, c.relname AS table_name, a.attnum as col_num,  a.attname as col_name,
        CASE
            WHEN 10002 = s.stakind1 THEN array_to_string(stavalues1, '||') 
            WHEN 10002 = s.stakind2 THEN array_to_string(stavalues2, '||')
            WHEN 10002 = s.stakind3 THEN array_to_string(stavalues3, '||')
            WHEN 10002 = s.stakind4 THEN array_to_string(stavalues4, '||')
            ELSE NULL::varchar
        END AS pred_ts
   FROM pg_statistic s
   JOIN pg_class c ON c.oid = s.starelid
   JOIN pg_namespace ns ON c.relnamespace = ns.oid
   JOIN pg_attribute a ON c.oid = a.attrelid AND a.attnum = s.staattnum)
SELECT schema_name, table_name, col_num, col_name,
       pred_ts NOT LIKE '2000-01-01%' AS is_predicate,
       CASE WHEN pred_ts NOT LIKE '2000-01-01%' THEN (split_part(pred_ts, '||',1))::timestamp ELSE NULL::timestamp END as first_predicate_use,
       CASE WHEN pred_ts NOT LIKE '%||2000-01-01%' THEN (split_part(pred_ts, '||',2))::timestamp ELSE NULL::timestamp END as last_analyze
FROM predicate_column_info;</code></pre>
            <p>Pour plus d'informations, consultez <a href="./t_Analyzing_tables.html">Analyse des tables</a>.</p>
          
            <h2 id="enable-sqa-recommendation">Activer l'accélération des requêtes courtes</h2>
            <p>L'accélération des requêtes courtes (SQA) établit la priorité des requêtes de courte durée sélectionnées sur les requêtes de longue durée. SQA exécute des requêtes de courte durée dans un espace dédié, afin que les requêtes SQA ne soient pas forcées d'attendre dans des files d'attente derrière les requêtes de longue durée. SQA priorise uniquement les requêtes de courte durée qui sont placées dans une file d'attente définie par l'utilisateur. Avec SQA, les requêtes de courte durée commencent à s'exécuter plus rapidement et les utilisateurs obtiennent les résultats plus rapidement. </p>
            <p>Si vous activez l'accélération des requêtes courtes (SQA), vous pouvez réduire ou éliminer les files d'attente de gestion de charge de travail (WLM) dédiées à l'exécution des requêtes courtes. De plus, les requêtes de longue durée n'ont pas besoin de se heurter à des requêtes courtes pour obtenir des emplacements dans une file d'attente afin que vous puissiez configurer vos files d'attente WLM pour utiliser moins d'emplacements de requêtes. Lorsque vous utilisez une simultanéité réduite, le débit de requêtes est accru et les performances systèmes globales sont améliorées pour la plupart des charges de travail. Pour plus d'informations, consultez <a href="./wlm-short-query-acceleration.html">Utilisation de l’accélération des requêtes courtes</a>. </p>
            <p><b>Analyse</b></p>
            <p>Advisor vérifie les modèles de charge de travail et indique le nombre de requêtes récentes où l'accélération des requêtes courtes doit réduire la latence et le temps d'attente quotidien pour les requêtes admissibles à l'accélération des requêtes courtes.</p>
            <p><b>Recommandation</b></p>
            <p>Modifiez la configuration de WLM pour activer l'accélération SQA. Amazon Redshift utilise un algorithme de machine learning pour analyser chaque requête éligible. Les prédictions s'améliorent à mesure que l'accélération des requêtes courtes apprend de vos modèles de requêtes. Pour plus d'informations, consultez <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/workload-mgmt-config.html">Configuration de la gestion de la charge de travail</a>. </p>
            <p>Lorsque vous activez l'accélération SQA, WLM définit par défaut le temps d'exécution maximal des requêtes courtes sur « dynamic ». Il est recommandé de conserver cette valeur pour la durée d'exécution maximale SQA. </p>
            <p><b>Conseils d'implémentation</b></p>
            <p>Pour vérifier si l'accélération SQA est activée, exécutez la requête suivante. Si la requête renvoie une ligne, l'accélération SQA est activée.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select * from stv_wlm_service_class_config 
where service_class = 14;</code></pre>
            <p>Pour de plus amples informations, veuillez consulter <a href="./wlm-short-query-acceleration.html#wlm-monitoring-sqa">Surveillance de la SQA</a>. </p>
          
            <h2 id="alter-diststyle-distkey-recommendation">Modifier les clés de distribution sur les tables</h2>
            <p>Amazon Redshift distribue les lignes de la table dans le cluster selon le style de distribution de la table. Les tables avec une distribution KEY nécessitent une colonne comme clé de distribution (DISTKEY). Une ligne de table est affectée à une tranche de nœud d'un cluster en fonction de la valeur de sa colonne DISTKEY. </p>
            <p>Une colonne DISTKEY appropriée place un nombre similaire de lignes sur chaque tranche de nœud et est fréquemment référencée dans les conditions de jonction. Une jonction optimisée se produit lorsque les tables sont jointes sur leurs colonnes DISTKEY, accélérant ainsi la performance des requêtes.</p>
            
            <p><b>Analyse</b></p>
            <p>Advisor analyse la charge de travail de votre cluster pour identifier la clé de distribution la plus appropriée aux tables pouvant bénéficier de manière significative d'un style de distribution KEY. </p>
            
            <p><b>Recommandation</b></p>
            <p>Advisor fournit des instructions <a href="./r_ALTER_TABLE.html">ALTER TABLE</a> qui modifient les colonnes DISTSTYLE et DISTKEY d'une table en fonction de son analyse. Pour obtenir un avantage significatif en termes de performances, toutes les instructions SQL d'un groupe de recommandations doivent être implémentées. </p>
            <p>La redistribution d'une table de taille importante avec ALTER TABLE consomme des ressources de cluster et nécessite des verrouillages temporaires de table à différents moments. Implémentez chaque groupe de recommandations lorsque les autres charges de travail du cluster sont légères. Pour plus d'informations sur l'optimisation des propriétés d'une distribution de table, consultez l'article <a href="https://aws.amazon.com/blogs/big-data/amazon-redshift-engineerings-advanced-table-design-playbook-distribution-styles-and-distribution-keys/" rel="noopener noreferrer" target="_blank"><span>Amazon Redshift Engineering's Advanced Table Design Playbook : Distribution Styles and Distribution Keys</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. </p>        
            <p>Pour plus d'informations sur ALTER DISTSYLE et DISTKEY, consultez <a href="./r_ALTER_TABLE.html">ALTER TABLE</a>. </p>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Si vous ne voyez pas de recommandation, cela ne signifie pas nécessairement que les styles de distribution actuels sont les plus appropriés. Advisor s'abstient de formuler des recommandations lorsqu'il n'y a pas suffisamment de données ou que les avantages escomptés de la redistribution sont faibles. </p><p>Les recommandations d'Advisor s'appliquent à une table particulière et ne s'appliquent pas nécessairement à une table contenant une colonne portant le même nom. Les tables qui partagent un nom de colonne peuvent avoir des caractéristiques différentes, à moins que les données à l'intérieur des tables soient les mêmes. </p><p>Si vous voyez des recommandations pour des tables intermédiaires créées ou abandonnées par des tâches ETL, modifiez vos processus ETL pour utiliser les clés de distribution recommandées par Advisor. </p></div></div>

          
            <h2 id="alter-sortkey-recommendation">Modification des clés de tri au niveau des tables</h2>
            <p>Amazon Redshift trie les lignes des tables en fonction de leur <a href="./t_Sorting_data.html">clé de tri</a>. Le tri des lignes de table repose sur les valeurs des colonnes de clé de tri. </p>
            <p>Le tri d'une table en fonction d'une clé de tri appropriée peut accélérer les performances des requêtes, en particulier celles dont les prédicats sont limités à la plage, en réduisant le nombre de blocs de table à lire à partir du disque. </p>
            
            <p><b>Analyse</b></p>
            <p>Advisor analyse la charge de travail de votre cluster sur plusieurs jours afin d'identifier une clé de tri utile pour vos tables. </p>
            
            <p><b>Recommandation</b></p>
            <p> Advisor fournit deux groupes d'instructions ALTER TABLE qui modifient la clé de tri d'une table en fonction de son analyse : </p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem"><p>Instructions qui modifient une table qui ne possède actuellement pas de clé de tri pour ajouter une clé de tri COMPOUND.</p></li><li class="listitem"><p>Instructions qui modifient une clé de tri depuis INTERLEAVED en COMPOUND ou en aucune clé de tri.</p>
                  <p>L'utilisation de clés de tri composé réduit de façon importante la charge de maintenance. Les tables dotées de clés de tri composé n'ont pas besoin des opérations VACUUM REINDEX onéreuses qui sont requises pour les tris entrelacés. En pratique, les clés de tri composées sont plus efficaces que les clés de tri entrelacées pour la grande majorité des charges de travail d'Amazon Redshift. Toutefois, si une table est petite, il est plus efficace de ne pas avoir de clé de tri pour éviter les frais généraux de stockage des clés de tri.</p></li></ul></div>
            
            <p>Lors du tri d'une table volumineuse avec ALTER TABLE, les ressources de cluster sont consommées et des verrous de table sont requis à différents moments. Mettez en œuvre chaque recommandation lorsque la charge de travail d'un cluster est modérée. Pour plus d'informations sur l'optimisation des configurations des clés de tri de table, consultez l'article <a href="https://aws.amazon.com/blogs/big-data/amazon-redshift-engineerings-advanced-table-design-playbook-compound-and-interleaved-sort-keys/" rel="noopener noreferrer" target="_blank"><span>Amazon Redshift Engineering's Advanced Table Design Playbook: Compound and Interleaved Sort Keys</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. </p>        
            <p>Pour plus d'informations sur ALTER SORTKEY, consultez <a href="./r_ALTER_TABLE.html">ALTER TABLE</a>. </p>
            
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Si vous ne voyez pas de recommandation pour une table, cela ne signifie pas nécessairement que la configuration actuelle est la plus appropriée. Advisor s'abstient de formuler des recommandations lorsqu'il n'y a pas suffisamment de données ou que les avantages escomptés du tri sont faibles. </p><p>Les recommandations d'Advisor s'appliquent à une table particulière et pas nécessairement à une table contenant une colonne présentant les mêmes nom et type de données. Les tables qui partagent des noms de colonne peuvent faire l'objet de recommandations différentes en fonction de leurs données et de la charge de travail. </p></div></div>
            
          
            <h2 id="alter-compression-encoding-recommendation">Modifier les encodages de compression sur les colonnes</h2>
            <p>La compression est une opération au niveau des colonnes qui réduit la taille des données lorsque celles-ci sont stockées. La compression est utilisée dans Amazon Redshift pour conserver l'espace de stockage et améliorer les performances des requêtes en réduisant la quantité des I/O sur le disque. Nous recommandons un encodage de compression optimal pour chaque colonne en fonction de son type de données et des modèles de requête. Avec une compression optimale, les requêtes peuvent s'exécuter plus efficacement et la base de données peut occuper un espace de stockage minimal. </p>
            
            <p><b>Analyse</b></p>
            <p>Advisor analyse en permanence la charge de travail de votre cluster et le schéma de la base de données afin d'identifier l'encodage de compression optimal pour chaque colonne de la table.</p>
            
            <p><b>Recommandation</b></p>
            <p>Advisor fournit des instructions ALTER TABLE qui modifient l'encodage de compression de colonnes particulières, sur la base de son analyse. </p>
            <p>Le changement des encodages de compression des colonnes avec <a href="./r_ALTER_TABLE.html">ALTER TABLE</a> consomme des ressources du cluster et nécessite des verrous de table à différents moments. Il est préférable de mettre en œuvre les recommandations lorsque la charge de travail du cluster est légère. </p>
            <p>Pour référence, <a href="./r_ALTER_TABLE_examples_basic.html">Exemples ALTER TABLE</a> présente plusieurs instructions qui modifient l'encodage d'une colonne.</p>        
            
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Advisor s'abstient de formuler des recommandations lorsqu'il n'y a pas assez de données ou que le bénéfice attendu d'un changement de codage est faible.</p></div></div>
            
          
            <h2 id="data-type-recommendation">Recommandations sur les types de données</h2>
            <p>Amazon Redshift dispose d'une bibliothèque de types de données SQL pour différents cas d'utilisation. Il s'agit notamment de types entiers comme <code class="code">INT</code> et de types destinés à stocker des personnages, comme <code class="code">VARCHAR</code>. Redshift stocke les types de manière optimisée afin de fournir un accès rapide et de bonnes performances de requête. De plus, Redshift fournit des fonctions pour des types spécifiques, que vous pouvez utiliser pour formater ou effectuer des calculs sur des résultats de requête. </p>
            
            <p><b>Analyse</b></p>
            <p>Advisor analyse en permanence la charge de travail de votre cluster et le schéma de la base de données afin d'identifier les colonnes susceptibles de bénéficier considérablement d'un changement de type de données.</p>
            
            <p><b>Recommandation</b></p>
            
            <p> Advisor fournit une instruction <code class="code">ALTER TABLE</code> qui ajoute une nouvelle colonne avec le type de données suggéré. Une instruction <code class="code">UPDATE</code> d'accompagnement copie les données de la colonne existante vers la nouvelle colonne. Après avoir créé la nouvelle colonne et chargé les données, modifiez vos requêtes et vos scripts d'ingestion pour accéder à la nouvelle colonne. Exploitez ensuite les fonctionnalités et fonctions spécialisées dans le nouveau type de données, que l'on trouve dans <a href="./c_SQL_functions.html">Référence sur les fonctions SQL</a>. </p>
            <p> La copie de données existantes dans la nouvelle colonne peut prendre du temps. Nous vous recommandons d'implémenter chaque recommandation d'Advisor lorsque la charge de travail du cluster est légère. Consultez la liste des types de données disponibles à l'adresse <a href="./c_Supported_data_types.html">Types de données</a>. </p>
            <p> Notez qu'Advisor s'abstient de formuler des recommandations lorsqu'il n'y a pas assez de données ou que le bénéfice attendu d'un changement de type de données est faible. </p>        
            
         <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./access-advisor.html">Access Advisor</div><div id="next" class="next-link" accesskey="n" href="./tutorials-redshift.html">Didacticiels</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/advisor-recommendations.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/advisor-recommendations.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>