<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Didacticiel : Utiliser les fonctions SQL spatiales avec Amazon Redshift - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="spatial-tutorial" /><meta name="default_state" content="spatial-tutorial" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/spatial-tutorial.html" /><meta name="description" content="Suivez ce didacticiel pour en savoir plus sur l’utilisation des fonctions SQL spatiales avec Amazon Redshift." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guide du développeur de base de données" /><meta name="abstract" content="Créez et gérez un entrepôt de données avec Amazon Redshift, service d’entrepôt de données au niveau de l’entreprise, pouvant atteindre plusieurs Po et entièrement géré." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/spatial-tutorial.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/spatial-tutorial.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/spatial-tutorial.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/spatial-tutorial.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/spatial-tutorial.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/spatial-tutorial.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/spatial-tutorial.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/spatial-tutorial.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/spatial-tutorial.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/spatial-tutorial.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/spatial-tutorial.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/spatial-tutorial.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/spatial-tutorial.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/spatial-tutorial.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/spatial-tutorial.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/spatial-tutorial.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/spatial-tutorial.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/spatial-tutorial.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/spatial-tutorial.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/spatial-tutorial.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/spatial-tutorial.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/spatial-tutorial.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guide du développeur de base de données" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guide du développeur de base de données" /><meta id="panorama-serviceConsolePage" value="Didacticiel : Utiliser les fonctions SQL spatiales avec Amazon Redshift" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Didacticiel : Utiliser les fonctions SQL spatiales avec Amazon Redshift - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#spatial-tutorial" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/spatial-tutorial.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/spatial-tutorial.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/spatial-tutorial.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,entrepôt de données,développeur,exemples de données,database,développeur de base de données,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide du développeur de base de données",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Interrogation des données spatiales dans Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/geospatial-overview.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Didacticiel : Utiliser les fonctions SQL spatiales avec Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/geospatial-overview.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#spatial-tutorial" target="_blank" rel="noopener noreferrer" title="Ouvrir le PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guide du développeur de base de données</a></div><div id="page-toc-src"><a href="#spatial-tutorial-prerequisites">Prérequis</a><a href="#spatial-tutorial-test-data">Étape 1 : Créer des tables et charger des données de test</a><a href="#spatial-tutorial-query">Étape 2 : Interroger les données spatiales</a><a href="#spatial-tutorial-clean-up">Étape 3 : Nettoyer vos ressources</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="spatial-tutorial">Didacticiel : Utiliser les fonctions SQL spatiales avec Amazon Redshift</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Ce didacticiel explique comment utiliser certaines fonctions SQL spatiales avec Amazon Redshift </p><p>Pour ce faire, vous interrogez deux tables à l’aide de fonctions SQL spatiales. Le didacticiel utilise des données provenant de jeux de données publics qui mettent en corrélation les données de localisation des logements locatifs avec des codes postaux à Berlin, en Allemagne. </p><div class="highlights" id="inline-topiclist"><h6>Rubriques</h6><ul><li><a href="#spatial-tutorial-prerequisites">Prérequis</a></li><li><a href="#spatial-tutorial-test-data">Étape 1 : Créer des tables et charger des données de test</a></li><li><a href="#spatial-tutorial-query">Étape 2 : Interroger les données spatiales</a></li><li><a href="#spatial-tutorial-clean-up">Étape 3 : Nettoyer vos ressources</a></li></ul></div>
        <h2 id="spatial-tutorial-prerequisites">Prérequis</h2>
           
        <p>Pour ce didacticiel, vous avez besoin des ressources suivantes :</p>
           
        <div class="itemizedlist">
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                        <p>Un cluster et une base de données Amazon Redshift existants auxquels vous pouvez accéder et que vous pouvez mettre à jour. Dans le cluster existant, vous créez des tables, chargez des exemples de données et exécutez des requêtes SQL pour démontrer les fonctions spatiales. Votre cluster doit disposer d’au moins deux nœuds. Pour savoir comment créer un cluster, suivez les étapes du <a href="https://docs.aws.amazon.com/redshift/latest/gsg/">Guide de démarrage d’Amazon Redshift</a>. </p>
            </li><li class="listitem">
                        <p>Pour utiliser l’éditeur de requêtes Amazon Redshift, assurez-vous que votre cluster se trouve dans une région AWS qui prend en charge l’éditeur de requêtes. Pour plus d’informations, consultez <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/query-editor.html">Interrogation d’une base de données à l’aide de l’éditeur de requêtes</a> dans le <em>Guide de gestion Amazon Redshift</em>. </p>
            </li><li class="listitem">
                        <p>Les informations d’identification AWS de votre cluster Amazon Redshift qui lui permettent de charger des données de test à partir d’Amazon S3. Pour plus d’informations sur l’accès à d’autres services AWS tels qu’Amazon S3, consultez <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/authorizing-redshift-service.html">Autoriser Amazon Redshift à accéder aux services AWS</a>.</p>
            </li><li class="listitem">
                        <p>Le rôle AWS Identity and Access Management (IAM) nommé <code class="code">mySpatialDemoRole</code>, qui a la politique gérée <code class="code">AmazonS3ReadOnlyAccess</code> attachée pour lire les données Amazon S3. Pour créer un rôle avec l’autorisation de charger les données à partir d’un compartiment Amazon S3, consultez <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/copy-unload-iam-role.html">Autorisation d’opérations COPY, UNLOAD, CREATE EXTERNAL FUNCTION et CREATE EXTERNAL SCHEMA à l’aide de rôles IAM</a> dans le <em>Guide de gestion Amazon Redshift</em>. </p>
            </li><li class="listitem"><p>Une fois que vous avez créé le rôle IAM <code class="code">mySpatialDemoRole</code>, celui-ci nécessite une association avec votre cluster Amazon Redshift. Pour plus d’informations sur la création d’une association, consultez <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/copy-unload-iam-role.html">Autorisation d’opérations COPY, UNLOAD, CREATE EXTERNAL FUNCTION et CREATE EXTERNAL SCHEMA à l’aide de rôles IAM</a> dans le <em>Guide de gestion Amazon Redshift</em>. </p>    
            </li></ul></div>   

        
        <h2 id="spatial-tutorial-test-data">Étape 1 : Créer des tables et charger des données de test</h2>
            
            
             
            <p>Les données source utilisées par ce didacticiel se trouvent dans des fichiers nommés <code>accommodations.csv</code> et <code>zipcodes.csv</code>. </p>
        <p>Le fichier <code>accommodations.csv</code> comprend des données open source provenant de insideairbnb.com. Le fichier <code>zipcodes.csv</code> fournit des codes postaux qui sont des données open source de l’institut national de statistique de Berlin-Brandebourg en Allemagne (Amt für Statistik Berlin-Brandebourg). Les deux sources de données sont fournies sous licence Creative Commons. Les données sont limitées à la région de Berlin, en Allemagne. Ces fichiers se trouvent dans un compartiment public Amazon S3 à utiliser avec ce didacticiel. </p>
            
            <p>Vous pouvez éventuellement télécharger les données source à partir des liens Amazon S3 suivants :</p> 
            <div class="itemizedlist">
                 
                 
            <ul class="itemizedlist"><li class="listitem"><p><a href="https://s3.amazonaws.com/redshift-downloads/spatial-data/accommodations.csv" rel="noopener noreferrer" target="_blank"><span> Données source pour la table <code class="code">accommodations</code></span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. </p></li><li class="listitem"><p><a href="https://s3.amazonaws.com/redshift-downloads/spatial-data/zipcode.csv" rel="noopener noreferrer" target="_blank"><span> Données source pour la table <code class="code">zipcode</code></span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. </p></li></ul></div>
            
           <p>Utilisez la procédure suivante pour créer des tables et charger les données de test. </p>

            <div class="procedure"><h6>Pour créer des tables et charger les données de test</h6><ol><li>
                    <p>Ouvrez l’éditeur de requêtes Amazon Redshift. Pour plus d’informations sur l’utilisation de l’éditeur de requêtes, consultez <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/query-editor.html">Interrogation d’une base de données à l’aide de l’éditeur de requêtes</a> dans le <em>Guide de la gestion du cluster Amazon Redshift</em>. </p> 
                </li><li>
                    <p>Supprimez toutes les tables utilisées par ce didacticiel si elles existent déjà dans votre base de données. Pour plus d'informations, consultez <a href="#spatial-tutorial-clean-up">Étape 3 : Nettoyer vos ressources</a>. </p>
                </li><li>
                    <p>Créez la table <code class="code">accommodations</code> pour stocker l’emplacement géographique de chaque hébergement (longitude et latitude), le nom de la liste et d’autres données métier. </p>
                <p>Ce didacticiel parcourt les locations de chambres à Berlin, en Allemagne. La colonne <code class="code">shape</code> stocke les points géographiques de l’emplacement des logements. Les autres colonnes contiennent des informations sur la location. </p>
                    <p>Pour créer la table <code class="code">accommodations</code>, exécutez l’instruction SQL suivante dans l’éditeur de requêtes Amazon Redshift. </p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE TABLE public.accommodations (
  id INTEGER PRIMARY KEY,
  shape GEOMETRY,
  name VARCHAR(100),
  host_name VARCHAR(100),
  neighbourhood_group VARCHAR(100),
  neighbourhood VARCHAR(100),
  room_type VARCHAR(100),
  price SMALLINT,
  minimum_nights SMALLINT,
  number_of_reviews SMALLINT,
  last_review DATE,
  reviews_per_month NUMERIC(8,2),
  calculated_host_listings_count SMALLINT, 
  availability_365 SMALLINT
);</code></pre>
               </li><li>
                    <p>Créez la table <code class="code">zipcode</code> dans l’éditeur de requêtes pour stocker les codes postaux de Berlin. </p>
                <p>Un <em>code postal</em> est défini en tant que polygone dans la colonne <code class="code">wkb_geometry</code>. Les autres colonnes décrivent les métadonnées spatiales supplémentaires sur le code postal. </p>
                <p>Pour créer la table <code class="code">zipcode</code>, exécutez l’instruction SQL suivante dans l’éditeur de requêtes Amazon Redshift. </p>
                    
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE TABLE public.zipcode (
  ogc_field INTEGER PRIMARY KEY NOT NULL,
  wkb_geometry GEOMETRY,
  gml_id VARCHAR(256),
  spatial_name VARCHAR(256),
  spatial_alias VARCHAR(256),
  spatial_type VARCHAR(256)
 );</code></pre>
                    
                </li><li>
                    <p>Chargez les tables à l’aide des exemples de données. </p>
                <p>Les données de cet exemple se trouvent dans un compartiment Amazon S3 qui accorde un accès en lecture à tous les utilisateurs AWS authentifiés. Assurez-vous que vous fournissez les informations d’identification AWS valides qui permettent d’accéder à Amazon S3. </p>
                <p>Pour charger les données de test dans vos tables, exécutez les commandes COPY suivantes. Remplacez <code class="replaceable"><code class="code">account-number</code></code> par votre propre numéro de compte AWS. Le segment de la chaîne d’informations d’identification entre guillemets simples ne peut pas comporter d’espaces ou de sauts de ligne. </p>
                    
                    
  
                                                         
                            
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">COPY public.accommodations 
FROM 's3://redshift-downloads/spatial-data/accommodations.csv' 
DELIMITER ';' 
IGNOREHEADER 1 REGION 'us-east-1'
CREDENTIALS 'aws_iam_role=arn:aws:iam::<code class="replaceable">account-number</code>:role/mySpatialDemoRole';
</code></pre>
                            
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">COPY public.zipcode 
FROM 's3://redshift-downloads/spatial-data/zipcode.csv' 
DELIMITER ';' 
IGNOREHEADER 1 REGION 'us-east-1'
CREDENTIALS 'aws_iam_role=arn:aws:iam::<code class="replaceable">account-number</code>:role/mySpatialDemoRole';
</code></pre>  
 
 
                            
                            
                             
                            
                </li><li>
                    <p>Vérifiez que chaque table s’est chargée correctement en exécutant les commandes suivantes. </p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">select count(*) from accommodations;</code></pre>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">select count(*) from zipcode;</code></pre>
                    <p>Les résultats suivants indiquent le nombre de lignes dans chaque tableau de données de test.</p>
                    <div class="table-container"><div class="table-contents"><table id="w319aac25c67c11c13c12b9"><thead>
                                <tr>
                                    <th>Nom de la table</th>
                                    <th>Lignes</th>
                                </tr>
                            </thead>
                                <tr>
                                    <td tabindex="-1">Hébergements</td>
                                    <td tabindex="-1">22 248</td>
                                </tr>
                                <tr>
                                    <td tabindex="-1">zipcode</td>
                                    <td tabindex="-1">190</td>
                                </tr>
                            </table></div></div>
                </li></ol></div>                       
     
        <h2 id="spatial-tutorial-query">Étape 2 : Interroger les données spatiales</h2>

        <p>Une fois vos tables créées et chargées, vous pouvez les interroger à l’aide des instructions SQL SELECT. Les requêtes suivantes illustrent certaines des informations que vous pouvez récupérer. Vous pouvez écrire de nombreuses autres requêtes qui utilisent des fonctions spatiales pour répondre à vos besoins. </p>
        <div class="procedure"><h6>Pour interroger les données spatiales</h6><ol><li>
                <p>Interrogez les données pour obtenir le nombre total d’éléments stockés dans la table <code class="code">accommodations</code>, comme illustré ci-dessous. Le système de référence spatiale est le système géodésique mondial (WGS) 84, qui possède l’identifiant de référence spatiale unique 4326.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT count(*) FROM public.accommodations WHERE ST_SRID(shape) = 4326;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
 count
-------
 22248</code></pre>                
            </li><li>
                <p>Extrayez les objets géométriques au format WKT (Well-known text) avec quelques attributs en plus. En outre, vous pouvez vérifier si ces données de code postal sont également stockées dans le système géodésique mondial (WGS) 84, qui utilise l’ID de référence spatiale (SRID) 4326. Les données spatiales doivent être stockées dans le même système de référence spatiale pour être interopérables. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT ogc_field, spatial_name, spatial_type, ST_SRID(wkb_geometry), ST_AsText(wkb_geometry) 
FROM public.zipcode 
ORDER BY spatial_name;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
ogc_field  spatial_name  spatial_type  st_srid  st_astext
---------------------------------------------------------------
0           10115        Polygon        4326     POLYGON((...))
4           10117        Polygon        4326     POLYGON((...))
8           10119        Polygon        4326     POLYGON((...))
...
(190 rows returned)</code></pre>
                
            </li><li>
                <p>Sélectionnez le polygone de Berlin Mitte (10117), un arrondissement de Berlin, au format GeoJSON, sa dimension et le nombre de points dans ce polygone. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT ogc_field, spatial_name, ST_AsGeoJSON(wkb_geometry), ST_Dimension(wkb_geometry), ST_NPoints(wkb_geometry)
FROM public.zipcode 
WHERE spatial_name='10117';</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
ogc_field  spatial_name  spatial_type                                   st_dimension  st_npoint
-----------------------------------------------------------------------------------------------
4           10117         <span>{</span>"type":"Polygon", "coordinates":[[[...]]]}    2             331
</code></pre>
                
            </li><li>
                <p>Exécutez la commande SQL suivante pour voir combien d’hébergements se trouvent à moins de 500 mètres de la porte de Brandebourg. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT count(*) 
FROM public.accommodations 
WHERE ST_DistanceSphere(shape, ST_GeomFromText('POINT(13.377704 52.516431)', 4326)) &lt; 500;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
count
------
  29
</code></pre>
                             
            </li><li>
                <p>Obtenez l’emplacement approximatif de la porte de Brandebourg à partir des données stockées dans les hébergements répertoriés comme étant à proximité en exécutant la requête suivante.</p>
                <p>Cette requête nécessite une sous-sélection. Le nombre obtenu n’est pas le même parce que l’emplacement interrogé diffère de la requête précédente, car il est plus proche des hébergements. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">WITH poi(loc) as (
  SELECT st_astext(shape) FROM accommodations WHERE name LIKE '%brandenburg gate%'
)
SELECT count(*) 
FROM accommodations a, poi p
WHERE ST_DistanceSphere(a.shape, ST_GeomFromText(p.loc, 4326)) &lt; 500;</code></pre>                
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
count
------
  60
</code></pre>  
                
              
            </li><li>
                <p>Exécutez la requête suivante pour afficher les détails de tous les hébergements autour de la porte de Brandebourg, classés par prix dans l’ordre décroissant. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT name, price, ST_AsText(shape) 
FROM public.accommodations
WHERE ST_DistanceSphere(shape, ST_GeomFromText('POINT(13.377704 52.516431)', 4326)) &lt; 500
ORDER BY price DESC;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
name                                                   price  st_astext
-------------------------------------------------------------------------------------------------------
DUPLEX APARTMENT/PENTHOUSE in 5* LOCATION! 7583        300    POINT(13.3826510209548 52.5159819722552)
DUPLEX-PENTHOUSE IN FIRST LOCATION! 7582               300    POINT(13.3799997083855 52.5135918444834)
... 
(29 rows returned)
</code></pre> 
                
                             
            </li><li>
                <p>Exécutez la requête suivante pour récupérer l’hébergement le plus cher avec son code postal. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT 
  a.price, a.name, ST_AsText(a.shape), 
  z.spatial_name, ST_AsText(z.wkb_geometry) 
FROM accommodations a, zipcode z 
WHERE price = 9000 AND ST_Within(a.shape, z.wkb_geometry);</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
price   name                                 st_astext                                  spatial_name      st_astext
-------------------------------------------------------------------------------------------------------------------------------------------------
9000    Ueber den Dächern Berlins Zentrum    POINT(13.334436985013 52.4979779501538)    10777             POLYGON((13.3318284987227 52.4956021172799,...
</code></pre>               
            </li><li>
                <p>Calculez le prix maximum, minimum ou médian des hébergements à l’aide d’une sous-requête. </p>
                <p>La requête suivante répertorie le prix médian des logements par code postal. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT 
  a.price, a.name, ST_AsText(a.shape), 
  z.spatial_name, ST_AsText(z.wkb_geometry) 
FROM accommodations a, zipcode z 
WHERE 
  ST_Within(a.shape, z.wkb_geometry) AND 
  price = (SELECT median(price) FROM accommodations)
ORDER BY a.price;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
price name                            st_astext                                   spatial_name   st_astext
---------------------------------------------------------------------------------------------------------------------------------------------                    
45    "Cozy room Berlin-Mitte"        POINT(13.3864349535358 52.5292016386514)    10115          POLYGON((13.3658598465795 52.535659581048,...
...
(723 rows returned)
</code></pre> 
                
            </li><li>
                <p>Exécutez la requête suivante pour récupérer le nombre d’hébergements répertoriés à Berlin. Les points chauds sont regroupés par code postal et triés par quantité d’informations fournies. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT z.spatial_name as zip, count(*) as numAccommodations 
FROM public.accommodations a, public.zipcode z
WHERE ST_Within(a.shape, z.wkb_geometry)
GROUP BY zip 
ORDER BY numAccommodations DESC;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
zip  	numaccommodations
----------------------------
10245	872
10247	832
10437	733
10115	664
...
(187 rows returned)
</code></pre>
            </li></ol></div>




     
           <h2 id="spatial-tutorial-clean-up">Étape 3 : Nettoyer vos ressources</h2>
           
           
           <p>Votre cluster continue d’accumuler les frais aussi longtemps qu’il est en cours d’exécution. Lorsque vous aurez terminé ce didacticiel, vous pourrez supprimer votre exemple de cluster. </p>
           <p>Si vous souhaitez conserver le cluster, mais récupérer le stockage utilisé par les tables de données de test, exécutez les commandes suivantes pour supprimer les tables. </p>
           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">drop table public.accommodations cascade;</code></pre>
           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">drop table public.zipcode cascade;</code></pre>
           
       <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./geospatial-overview.html">Interrogation des données spatiales</div><div id="next" class="next-link" accesskey="n" href="./spatial-copy-shapefile.html">Chargement d’un shapefile</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/spatial-tutorial.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/spatial-tutorial.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>