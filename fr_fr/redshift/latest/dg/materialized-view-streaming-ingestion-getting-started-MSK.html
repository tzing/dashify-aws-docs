<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Mise en route de l’ingestion en streaming à partir d’Amazon Managed Streaming for Apache Kafka - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="materialized-view-streaming-ingestion-getting-started-MSK" /><meta name="default_state" content="materialized-view-streaming-ingestion-getting-started-MSK" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" /><meta name="description" content="Découvrez comment configurer l’ingestion en streaming à partir d’Amazon Managed Streaming for Apache Kafka." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guide du développeur de base de données" /><meta name="abstract" content="Créez et gérez un entrepôt de données avec Amazon Redshift, service d’entrepôt de données au niveau de l’entreprise, pouvant atteindre plusieurs Po et entièrement géré." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guide du développeur de base de données" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guide du développeur de base de données" /><meta id="panorama-serviceConsolePage" value="Mise en route de l’ingestion en streaming à partir d’Amazon Managed Streaming for Apache Kafka" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Mise en route de l’ingestion en streaming à partir d’Amazon Managed Streaming for Apache Kafka - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#materialized-view-streaming-ingestion-getting-started-MSK" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,entrepôt de données,développeur,exemples de données,database,développeur de base de données,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide du développeur de base de données",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Création de vues matérialisées dans Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-overview.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Ingestion en streaming",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-streaming-ingestion.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Mise en route de l’ingestion en streaming à partir d’Amazon Managed Streaming for Apache Kafka",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-streaming-ingestion.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#materialized-view-streaming-ingestion-getting-started-MSK" target="_blank" rel="noopener noreferrer" title="Ouvrir le PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guide du développeur de base de données</a></div><div id="page-toc-src"><a href="#materialized-view-streaming-ingestion-getting-started-MSK-setup">Configuration de l’IAM et exécution de l’ingestion en streaming depuis Kafka</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="materialized-view-streaming-ingestion-getting-started-MSK">Mise en route de l’ingestion en streaming à partir d’Amazon Managed Streaming for Apache Kafka</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p> L’objectif de l’ingestion en streaming Amazon Redshift est de simplifier le processus afin d’ingérer directement des données de flux depuis un service de streaming vers Amazon Redshift ou Amazon Redshift sans serveur. Cela fonctionne avec Amazon MSK et Amazon MSK sans serveur, ainsi qu’avec Kinesis. L’ingestion en streaming Amazon Redshift supprime le besoin d’organiser un flux Kinesis Data Streams ou une rubrique Amazon MSK dans Amazon S3 avant d’ingérer les données de flux dans Amazon Redshift.</p><p> Sur le plan technique, l’ingestion en streaming provenant d’Amazon Kinesis Data Streams et d’Amazon Managed Streaming for Apache Kafka fournit une ingestion à faible latence et à haute vitesse des données de flux ou de rubrique dans une vue matérialisée Amazon Redshift. Après la configuration, l’actualisation de la vue matérialisée vous permet d’intégrer de gros volumes de données. </p><p>Configurez l’ingestion en streaming Amazon Redshift pour Amazon MSK en procédant comme suit :</p><div class="orderedlist">
                         
                         
                    <ol><li><p>Créez un schéma externe qui correspond à la source de données en streaming.</p></li><li><p>Créez une vue matérialisée qui fait référence au schéma externe.</p></li></ol></div><p>Vous devez disposer d’une source Amazon MSK avant de configurer l’ingestion en streaming Amazon Redshift. Si vous n’avez pas de source, suivez les instructions de la section <a href="https://docs.aws.amazon.com/msk/latest/developerguide/getting-started.html">Getting Started Using Amazon MSK</a> (Mise en route avec Amazon MSK).</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p><em>Ingestion en streaming et Amazon Redshift Serverless</em> – Les étapes de configuration décrites dans cette rubrique s'appliquent aux clusters provisionnés Amazon Redshift et à Amazon Redshift Serverless. Pour plus d'informations, consultez <a href="./materialized-view-streaming-ingestion.html#materialized-view-streaming-ingestion-considerations">Considérations de l’ingestion en streaming</a>.</p></div></div>
                        <h2 id="materialized-view-streaming-ingestion-getting-started-MSK-setup">Configuration de l’IAM et exécution de l’ingestion en streaming depuis Kafka</h2>
                        <p>En supposant que vous avez un cluster Amazon MSK disponible, la première étape consiste à définir un schéma dans Redshift avec <code class="code">CREATE EXTERNAL SCHEMA</code> et de référencer la rubrique Kafka en tant que source de données. Ensuite, pour accéder aux données dans la rubrique, définissez le <code class="code">STREAM</code> dans une vue matérialisée. Vous pouvez stocker des enregistrements de votre rubrique au format <code class="code">SUPER</code> semi-structuré, ou définir un schéma qui entraîne la conversion des données en types de données Amazon Redshift. Lorsque vous interrogez la vue matérialisée, les enregistrements renvoyés sont une  point-in-time  vue du sujet.</p>
                        <div class="procedure"><ol><li><p>Créez un rôle IAM avec une politique d’approbation permettant à votre cluster Amazon Redshift ou à Amazon Redshift sans serveur d’endosser le rôle. Pour plus d’informations sur la configuration de la politique d’approbation pour le rôle IAM, consultez <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/authorizing-redshift-service.html">Autorisation d’Amazon Redshift à accéder à d’autres services AWS en votre nom</a>. Une fois créé, le rôle doit avoir la politique IAM suivante, qui autorise de communiquer avec le cluster Amazon Kinesis. La politique dont vous avez besoin dépend de la méthode d’authentification utilisée sur votre cluster, si vous utilisez Amazon MSK. Consultez <a href="https://docs.aws.amazon.com/msk/latest/developerguide/kafka_apis_iam.html">Authentication and Authorization for Apache Kafka APIs</a> (Authentification et autorisation pour les API Apache Kafka) pour connaître les méthodes d’authentification disponibles dans Amazon MSK.</p>
                                <p>Une politique IAM pour Amazon MSK utilisant un accès non authentifié :</p>
                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "VisualEditor0",
            "Effect": "Allow",
            "Action": [
                "kafka:GetBootstrapBrokers"
            ],
            "Resource": "*"
        }
    ]
}</code></pre>
                                <p>Une politique IAM pour Amazon MSK avec l’authentification IAM :</p>
                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "MSKIAMpolicy",
            "Effect": "Allow",
            "Action": [
                "kafka-cluster:ReadData",
                "kafka-cluster:DescribeTopic",
                "kafka-cluster:Connect"
            ],
            "Resource": [
                "arn:aws:kafka:*:0123456789:cluster/*/*",
                "arn:aws:kafka:*:0123456789:topic/*/*/*"
            ]
        },
        <span>{</span>
            "Sid": "MSKPolicy",
            "Effect": "Allow",
            "Action": [
                "kafka:GetBootstrapBrokers"
            ],
            "Resource": "*"
        }
    ]
}</code></pre>
                            </li><li><p> Vérifiez votre VPC et vérifiez que votre cluster Amazon Redshift ou Amazon Redshift sans serveur dispose d’une route pour accéder à votre cluster Amazon MSK. Les règles de groupe de sécurité entrant pour votre cluster Amazon MSK doivent autoriser le groupe de sécurité de votre cluster Amazon Redshift ou de votre groupe de travail Amazon Redshift sans serveur. Les ports que vous spécifiez dépendent de la méthode d’authentification utilisée pour votre cluster, lorsque vous utilisez Amazon MSK. Pour en savoir plus, consultez <a href="https://docs.aws.amazon.com/msk/latest/developerguide/port-info.html">Informations sur les ports</a> et <a href="https://docs.aws.amazon.com/msk/latest/developerguide/aws-access.html">Accès depuis AWS mais en dehors du VPC</a>.</p>
                                
                                <p>Notez que l’authentification client avec mTLS n’est pas prise en charge pour l’ingestion en streaming. Pour plus d’informations, consultez <a href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-streaming-ingestion.html#materialized-view-streaming-ingestion-limitations">Limites</a>.</p>
                            <p>Le tableau suivant montre les options de configuration complémentaires à définir pour l’ingestion en streaming depuis Amazon MSK :</p>
                                <div class="table-container"><div class="table-contents"><table id="w319aac21c47c15c15b5b3b6"><thead>
                                            <tr>
                                                <th>Configuration Amazon Redshift</th>
                                                <th>Configuration d’Amazon MSK</th>
                                                <th>Port à ouvrir entre Redshift et Amazon MSK</th>
                                            </tr>
                                        </thead>
                                            <tr>
                                                <td tabindex="-1"> AUTHENTICATION NONE </td>
                                                <td tabindex="-1"> Transport TLS désactivé </td>
                                                <td tabindex="-1">9092</td>
                                            </tr>
                                            <tr>
                                                <td tabindex="-1"> AUTHENTICATION NONE </td>
                                                <td tabindex="-1"> Transport TLS activé </td>
                                                <td tabindex="-1">9094</td>
                                            </tr>
                                            <tr>
                                                <td tabindex="-1"> AUTHENTICATION IAM </td>
                                                <td tabindex="-1"> IAM </td>
                                                <td tabindex="-1">9098/9198</td>
                                            </tr>
                                        </table></div></div>
                                <p>L’authentification Amazon Redshift est définie dans l’instruction CREATE EXTERNAL SCHEMA.</p>
                                <p>Si l’authentification mTLS (Mutual Transport Layer Security) est activée sur le cluster Amazon MSK, la configuration d’Amazon Redshift pour utiliser AUTHENTICATION NONE lui indique d’utiliser le port 9094 pour un accès non authentifié. Toutefois, cela échouera, car le port est utilisé par l’authentification mTLS. De ce fait, nous vous recommandons de passer à la configuration AUTHENTICATION IAM quand vous utilisez mTLS.</p>    
                            </li><li><p>Activez le routage VPC amélioré sur votre cluster Amazon Redshift ou dans votre groupe de travail Amazon Redshift sans serveur. Pour plus d’informations, consultez <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/enhanced-vpc-enabling-cluster.html">Activation du routage VPC amélioré</a>.</p>
                                <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Afin de récupérer l'URL du broker Bootstrap Amazon MSK, Amazon Redshift effectue <a href="https://docs.aws.amazon.com/msk/1.0/apireference/clusters-clusterarn-bootstrap-brokers.html#GetBootstrapBrokers">GetBootstrapBrokers</a>un appel d'API en utilisant les autorisations fournies par le rôle IAM attaché. Notez que pour que cette demande aboutisse lorsque le routage VPC amélioré est activé, le sous-réseau de votre cluster provisionné Amazon Redshift ou de votre groupe de travail Amazon Redshift Serverless doit disposer d'une passerelle NAT ou d'une passerelle Internet. Les ACL de votre réseau et les règles sortantes de votre groupe de sécurité pour le sous-réseau susmentionné doivent également autoriser l'accès aux points de terminaison du service Amazon MSK API. Pour plus d'informations, consultez <a href="https://docs.aws.amazon.com/general/latest/gr/msk.html">Amazon Managed Streaming for Apache Kafka Endpoints and quotas</a>.</p></div></div>
                            </li><li><p>Dans Amazon Redshift, créez un schéma externe à mapper au cluster Amazon MSK. </p>
                                
                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE EXTERNAL SCHEMA MySchema
FROM MSK
IAM_ROLE <span>{</span> default | 'iam-role-arn' }
AUTHENTICATION <span>{</span> none | iam }
CLUSTER_ARN 'msk-cluster-arn';</code></pre>
                                
                                <p>Dans la clause <code class="code">FROM</code>, Amazon MSK indique que le schéma mappe les données en provenance de Managed Kafka Services. </p> 
                                    <p> L’ingestion en streaming pour Amazon MSK fournit les types d’authentification suivants lorsque vous créez le schéma externe : </p>
                                    <div class="itemizedlist">
                                         
                                         
                                    <ul class="itemizedlist"><li class="listitem"><p><b>none</b> – Indique l’absence de toute étape d’authentification.</p></li><li class="listitem"><p><b>iam</b> – Indique une authentification IAM. Lorsque vous choisissez cette option, vérifiez que le rôle IAM dispose des autorisations nécessaires à l’authentification IAM. </p></li></ul></div>
                                <p>Les autres méthodes d’authentification Amazon MSK, telles que l’authentification TLS ou l’authentification par nom d’utilisateur et mot de passe, ne sont pas prises en charge pour l’ingestion en streaming. </p>
                                <p> <code class="code">CLUSTER_ARN</code> spécifie le cluster Amazon MSK comme source du streaming.</p>       
                            </li><li>
                                <p>Créez une vue matérialisée pour consommer les données de la rubrique. L’exemple suivant définit une vue matérialisée avec des données source JSON. Notez que la vue suivante confirme que les données correspondent à une source JSON et l’utf8. Les noms de rubrique Kafka sont sensibles à la casse et peuvent contenir des lettres majuscules et minuscules. Pour ingérer à partir de rubriques dont les noms sont en majuscules, vous pouvez définir la configuration <code class="code">enable_case_sensitive_identifier</code> sur <code class="code">true</code> au niveau du cluster. Pour plus d’informations, consultez <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_names.html">Noms et identificateurs</a> et <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_enable_case_sensitive_identifier.html">enable_case_sensitive_identifier</a>.</p>
                                
                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE MATERIALIZED VIEW MyView AUTO REFRESH YES AS
SELECT kafka_partition, 
 kafka_offset, 
 kafka_timestamp_type, 
 kafka_timestamp, 
 kafka_key, 
 JSON_PARSE(kafka_value) as Data, 
 kafka_headers
FROM MySchema."mytopic"
WHERE CAN_JSON_PARSE(kafka_value);</code></pre>
                    <p>Pour activer l’actualisation automatique, utilisez <code class="code">AUTO REFRESH YES</code>. L’actualisation manuelle est le comportement par défaut. </p>
                                <p>Les colonnes de métadonnées incluent ce qui suit :</p>
                                <div class="table-container"><div class="table-contents"><table id="w319aac21c47c15c15b5b9b9"><thead>
                                            <tr>
                                                <th>Colonne de métadonnées</th>
                                                <th>Type de données</th>
                                                <th>Description</th>
                                            </tr>
                                        </thead>
                                            <tr>
                                                <td tabindex="-1"> kafka_partition </td>
                                                <td tabindex="-1"> bigint </td>
                                                <td tabindex="-1"> ID de partition de l’enregistrement issu de la rubrique Kafka </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1"> kafka_offset </td>
                                                <td tabindex="-1"> bigint </td>
                                                <td tabindex="-1"> Décalage de l’enregistrement dans la rubrique Kafka pour une partition donnée </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1"> kafka_timestamp_type </td>
                                                <td tabindex="-1"> char(1) </td>
                                                <td tabindex="-1">
                                                    <p>Type d’horodatage utilisé dans l’enregistrement Kafka :</p> 
                                                    <div class="itemizedlist">
                                                         
                                                         
                                                         
                                                    <ul class="itemizedlist"><li class="listitem"><p><em>C</em> – Enregistrer l’heure de création (CREATE_TIME) côté client</p></li><li class="listitem"><p><em>L</em> – Enregistrer l’heure d’ajout (LOG_APPEND_TIME) côté serveur Kafka </p></li><li class="listitem"><p><em>U</em> – Enregistrer l’heure de création indisponible (NO_TIMESTAMP_TYPE)</p></li></ul></div>
                                                </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1"> kafka_timestamp </td>
                                                <td tabindex="-1"> horodatage sans fuseau horaire </td>
                                                <td tabindex="-1"> Valeur timestamp de l’enregistrement </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1"> kafka_key </td>
                                                <td tabindex="-1"> varbyte </td>
                                                <td tabindex="-1"> La clé de l’enregistrement de Kafka </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1"> kafka_value </td>
                                                <td tabindex="-1"> varbyte </td>
                                                <td tabindex="-1"> L’enregistrement reçu de Kafka </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1"> kafka_headers </td>
                                                <td tabindex="-1"> super </td>
                                                <td tabindex="-1"> L’en-tête de l’enregistrement reçu de Kafka </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1"> refresh_time </td>
                                                <td tabindex="-1"> horodatage sans fuseau horaire </td>
                                                <td tabindex="-1"> L’heure de début de l’actualisation </td>
                                            </tr>
                                        </table></div></div>
                                
                                <p>Il est important de noter que s’il existe une logique métier dans votre définition de vue matérialisée, les erreurs d’analyse peuvent bloquer l’ingestion en streaming dans certains cas. Cela peut vous amener à supprimer et recréer la vue matérialisée. Pour éviter cela, nous vous recommandons de simplifier autant que possible votre logique d’analyse et de réaliser la plupart des vérifications de votre logique métier sur les données après l’ingestion. L’exemple suivant vous montre comment utiliser <a href="./CAN_JSON_PARSE.html">Fonction CAN_JSON_PARSE</a> pour éviter les erreurs et mieux ingérer les données.</p>
                                
                            </li><li><p>Actualisez la vue, ce qui appelle Amazon Redshift à lire à partir de la rubrique et à charger des données dans la vue matérialisée.</p>
                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">REFRESH MATERIALIZED VIEW MyView;</code></pre>
                            </li><li><p>Interrogez les données dans la vue matérialisée.</p>
                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select * from MyView;</code></pre>
                                <p>La vue matérialisée est mise à jour directement à partir de la rubrique lorsque <code class="code">REFRESH</code> est exécuté. Vous créez une vue matérialisée qui se mappe à la source de données de la rubrique Kafka. Vous pouvez effectuer des filtrages et des agrégations sur les données dans le cadre de la définition de la vue matérialisée. Votre vue matérialisée de l’ingestion en streaming (la vue matérialisée de base) ne peut référencer qu’une seule rubrique Kafka. Toutefois, vous pouvez créer des vues matérialisées supplémentaires qui se joignent à la vue matérialisée de base et à d’autres vues ou tables matérialisées.</p>
                            </li></ol></div>
                        <p>Pour plus d’informations sur les limites relatives à l’ingestion en streaming, consultez <a href="./materialized-view-streaming-ingestion.html#materialized-view-streaming-ingestion-limitations">Limites</a>.</p>
                    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./materialized-view-streaming-ingestion-getting-started.html">Mise en route de l’ingestion en streaming à partir d’Amazon Kinesis Data Streams</div><div id="next" class="next-link" accesskey="n" href="./materialized-view-streaming-ingestion-example-station-data.html">Didacticiel sur l’ingestion en streaming de données de bornes de véhicules électriques avec Kinesis</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>