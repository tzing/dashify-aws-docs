<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CREATE FUNCTION - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_CREATE_FUNCTION" /><meta name="default_state" content="r_CREATE_FUNCTION" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_FUNCTION.html" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guide du développeur de base de données" /><meta name="abstract" content="Créez et gérez un entrepôt de données avec Amazon Redshift, service d’entrepôt de données au niveau de l’entreprise, pouvant atteindre plusieurs Po et entièrement géré." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_FUNCTION.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guide du développeur de base de données" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guide du développeur de base de données" /><meta id="panorama-serviceConsolePage" value="CREATE FUNCTION" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>CREATE FUNCTION - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_CREATE_FUNCTION" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_FUNCTION.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_FUNCTION.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_FUNCTION.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,entrepôt de données,développeur,exemples de données,database,développeur de base de données,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide du développeur de base de données",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Référence SQL",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Commandes SQL",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "CREATE FUNCTION",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_SQL_commands.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_CREATE_FUNCTION" target="_blank" rel="noopener noreferrer" title="Ouvrir le PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guide du développeur de base de données</a></div><div id="page-toc-src"><a href="#r_CREATE_FUNCTION-privileges">Privilèges requis</a><a href="#r_CREATE_FUNCTION-synopsis">Syntaxe</a><a href="#r_CREATE_FUNCTION-parameters">Paramètres</a><a href="#r_CREATE_FUNCTION-usage-notes">Notes d’utilisation</a><a href="#r_CREATE_FUNCTION-examples">Exemples</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="r_CREATE_FUNCTION">CREATE FUNCTION</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p> </p><p>Permet de créer une fonction scalaire définie par l’utilisateur à l’aide d’une clause SELECT SQL ou d’un programme Python.</p><p>Pour plus d’informations et d’exemples, consultez <a href="./user-defined-functions.html">Création de fonctions définies par l'utilisateur</a>.</p>
         <h2 id="r_CREATE_FUNCTION-privileges">Privilèges requis</h2>
         <p>Les privilèges suivants sont requis pour CREATE FUNCTION :</p>
         <div class="itemizedlist">
             
             
         <ul class="itemizedlist"><li class="listitem"><p>Pour CREATE FUNCTION :</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem"><p>Le super-utilisateur peut utiliser à la fois des langages fiables et non fiables pour créer des fonctions.</p></li><li class="listitem"><p>Les utilisateurs disposant du privilège CREATE [ OR REPLACE ] FUNCTION peuvent créer des fonctions avec des langages fiables.</p></li></ul></div>
            </li><li class="listitem"><p>Pour REPLACE FUNCTION :</p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem"><p>Superuser</p></li><li class="listitem"><p>Utilisateurs disposant du privilège CREATE [ OR REPLACE ] FUNCTION</p></li><li class="listitem"><p>Propriétaire de la fonction</p></li></ul></div>
            </li></ul></div>
       
         <h2 id="r_CREATE_FUNCTION-synopsis">Syntaxe</h2>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">CREATE [ OR REPLACE ] FUNCTION <em>f_function_name</em>
( <span>{</span> [<em>py_arg_name</em> <em> py_arg_data_type</em> |
<em>sql_arg_data_type</em> } [ , ... ] ] )
RETURNS <em>data_type</em>
<span>{</span> VOLATILE | STABLE | IMMUTABLE }
AS $$
  <span>{</span> <em>python_program</em> | <em>SELECT_clause</em> }
$$ LANGUAGE <span>{</span> plpythonu | sql }</code></pre>
       
         <h2 id="r_CREATE_FUNCTION-parameters">Paramètres</h2>
         <div class="variablelist">
             
             
             
             
             
             
             
             
             
         <dl>
               <dt><span class="term">OR REPLACE</span></dt>
               <dd>
                  <p>Spécifie que si une fonction ayant le même nom et les mêmes types de données pour les arguments en entrée, ou <em>signature</em>, existe déjà, la fonction existante est remplacée. Vous pouvez uniquement remplacer une fonction par une nouvelle fonction qui définit un ensemble identique de types de données. Vous devez être un super-utilisateur pour remplacer une fonction.</p>
                  <p>Si vous définissez une fonction avec le même nom qu’une fonction existante, mais avec une signature différente, vous créez une nouvelle fonction. En d’autres termes, le nom de la fonction est surchargé. Pour plus d'informations, consultez <a href="./udf-naming-udfs.html#udf-naming-overloading-function-names">Surcharge des noms de fonctions</a>.</p>
               </dd>
             
               <dt><span class="term"> <em>f_function_name</em> </span></dt>
               <dd>
                  <p>Nom de la fonction. Si vous spécifiez un nom de schéma (tel que <code class="code">myschema.myfunction</code>), la fonction est créée à l’aide du schéma spécifié. Sinon, la fonction est créée dans le schéma en cours. Pour plus d’informations sur les noms valides, consultez <a href="./r_names.html">Noms et identificateurs</a>.</p>
                  <p>Nous vous recommandons d’utiliser le préfixe <code class="code">f_</code> pour tous les noms de fonctions UDF. Comme Amazon Redshift réserve le préfixe <code class="code">f_</code> pour les noms UDF, si vous utilisez le préfixe <code class="code">f_</code>, vous vous assurez que votre nom UDF n’est pas conflit avec un nom existant ou futur de fonction SQL intégré à Amazon Redshift. Pour plus d'informations, consultez <a href="./udf-naming-udfs.html">Attribution d'un nom aux fonctions UDF</a>.</p>
                  <p>Vous pouvez définir plus d’une fonction portant le même nom de fonction si les types de données des arguments en entrée sont différents. En d’autres termes, le nom de la fonction est surchargé. Pour plus d'informations, consultez <a href="./udf-naming-udfs.html#udf-naming-overloading-function-names">Surcharge des noms de fonctions</a>.</p>
               </dd>
             
               <dt><span class="term"> <em>py_arg_name py_arg_data_type | sql_arg_data type</em> </span></dt>
               <dd>
                  <p>Pour une fonction Python définie par l’utilisateur, une liste des noms d’arguments en entrée et des types de données. Pour une fonction SQL définie par l’utilisateur, une liste des types de données, sans nom d’argument. Dans une fonction Python définie par l’utilisateur, faites référence aux arguments à l’aide des noms d’arguments. Dans une fonction SQL définie par l’utilisateur, faites référence aux arguments à l’aide de $1, $2, et ainsi de suite, en fonction de l’ordre des arguments dans la liste d’arguments. </p>
                  <p>Pour une fonction SQL définie par l’utilisateur, les types de données d’entrée et de retour peuvent être de n’importe quel type de données Amazon Redshift standard. Pour une fonction Python définie par l’utilisateur, les types de données entrant et de retour peuvent être SMALLINT, INTEGER, BIGINT, DECIMAL, REAL, DOUBLE PRECISION, BOOLEAN, CHAR, VARCHAR, DATE ou TIMESTAMP. En outre, les fonctions Python définies par l’utilisateur (UDF) prennent en charge le type de données ANYELEMENT. Ce type de données est automatiquement converti en un type de données standard en fonction du type de données de l’argument correspondant fourni lors de l’exécution. Si plusieurs arguments utilisent ANYELEMENT, ils se résolvent dans le même type de données lors de l’exécution, en fonction du premier argument ANYELEMENT de la liste. Pour plus d’informations, consultez <a href="./udf-data-types.html">Types de données de fonctions Python définies par l'utilisateur</a> et <a href="./c_Supported_data_types.html">Types de données</a>.</p>

                  <p>Vous pouvez spécifier un maximum de 32 arguments.</p>
               </dd>
             
               <dt><span class="term"> RETURNS <em>type_données</em> </span></dt>
               <dd>
                  <p>Type de données de la valeur renvoyée par la fonction. Le type de données RETURNS peut être n’importe quel type de données Amazon Redshift standard. En outre, les fonctions Python définies par l’utilisateur peuvent utiliser un type de données ANYELEMENT, qui est automatiquement converti en un type de données standard en fonction de l’argument fourni lors de l’exécution. Si vous spécifiez ANYELEMENT pour le type de données retournées, au moins un argument doit utiliser ANYELEMENT. Le type de données retournées correspond au type de données fourni pour l’argument ANYELEMENT lors de l’appel de la fonction. Pour plus d'informations, consultez <a href="./udf-data-types.html">Types de données de fonctions Python définies par l'utilisateur</a>.</p>
               </dd>
             
               <dt><span class="term"> VOLATILE | STABLE | IMMUTABLE </span></dt>
               <dd>
                  <p>Informe l’optimiseur de requête à propos de l’instabilité de la fonction. </p>
                  <p>Vous obtiendrez la meilleure optimisation possible si vous qualifiez votre fonction avec la catégorie d’instabilité la plus stricte qui s’y applique. Toutefois, si la catégorie est trop stricte, il existe un risque que l’optimiseur ignore par erreur certains appels, d’où un jeu de résultats incorrect. En matière de rigueur, en commençant par la moins stricte, les catégories d’instabilité sont les suivantes :</p>
                  <div class="itemizedlist">
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem">
                        <p>VOLATILE</p>
                     </li><li class="listitem">
                        <p>STABLE</p>
                     </li><li class="listitem">
                        <p>IMMUTABLE</p>
                     </li></ul></div>
                  
                  <p>VOLATILE</p>
                  <p>Soit les mêmes arguments, la fonction peut renvoyer des résultats différents sur des appels successifs, y compris pour les lignes d’une même instruction. Comme l’optimiseur de requête ne peut pas effectuer d’hypothèse sur le comportement d’une fonction volatile, une requête qui utilise une fonction volatile doit réévaluer la fonction pour chaque ligne d’entrée.</p>
                  <p>STABLE</p>
                  <p>Soit les mêmes arguments, la fonction est garantie renvoyer les mêmes résultats pour toutes les lignes traitées au sein d’une même instruction. La fonction peut renvoyer des résultats différents lorsqu’elle est appelée dans différents instructions. Cette catégorie permet à l’optimiseur d’optimiser plusieurs appels de la fonction au sein d’une même instruction en un seul appel de l’instruction. </p>
                  <p>IMMUTABLE</p>
                  <p>Soit les mêmes arguments, la fonction renvoie toujours le même résultat, indéfiniment. Quand une requête appelle une fonction <code class="code">IMMUTABLE</code> avec des arguments constants, l’optimiseur pré-évalue la fonction.</p>
               </dd>
             
               <dt><span class="term">AS $$ <em>instruction</em> $$</span></dt>
               <dd>
                  <p> Construction qui englobe l’instruction à exécuter. Les mots-clés littéraux <code class="code">AS $$</code> et <code class="code">$$</code> sont obligatoires. </p>
                  <p>Amazon Redshift requiert que vous placiez l’instruction dans votre fonction à l’aide d’un format appelé guillemets dollar. Tout ce qui se trouve dans l’encadrement est passé exactement comme tel. Vous n’avez pas besoin de définir de séquence d’échappement pour les caractères spéciaux, car les contenus de la chaîne sont écrits littéralement. </p>
                  <p> Avec les <em>guillemets dollar</em>, vous utilisez une paire de symboles dollar ($$) pour marquer le début et la fin de l’instruction à exécuter, comme illustré dans l’exemple suivant. </p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">$$ <code class="replaceable">my statement</code> $$</code></pre>
                  <p> Le cas échéant, entre les symboles dollar de chaque paire, vous pouvez spécifier une chaîne pour aider à identifier l’instruction. La chaîne que vous utilisez doit être la même au début et à la fin des paires d’encadrement. Cette chaîne est sensible à la casse et suit les mêmes contraintes qu’un identificateur sans guillemets, sauf que celui-ci ne peut pas contenir de symboles dollar. L’exemple suivant utilise la chaîne <code class="code">test</code>. </p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">$test$ <code class="replaceable">my statement</code> $test$</code></pre>

                  <p>Pour plus d’informations sur les guillemets dollar, consultez relative aux constantes de chaîne avec guillemet dollar dans <a href="https://www.postgresql.org/docs/9.4/static/sql-syntax-lexical.html" rel="noopener noreferrer" target="_blank"><span>Lexical Structure</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> dans la documentation PostgreSQL. </p>
               </dd>
             
               <dt><span class="term"><em>python_program</em> </span></dt>
               <dd>
                  <p>Programme exécutable Python valide qui renvoie une valeur. L’instruction que vous transmettez avec la fonction doit être conforme aux exigences de mise en retrait telles que spécifiées dans le <a href="https://www.python.org/dev/peps/pep-0008/#indentation" rel="noopener noreferrer" target="_blank"><span>Guide de style pour Python Code</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> sur le site web Python. Pour plus d'informations, consultez <a href="./udf-python-language-support.html">Prise en charge du langage Python pour les fonctions UDF</a>.</p>
               </dd>
             
               <dt><span class="term"><em>clause_SQL</em> </span></dt>
               <dd>
                  <p>Clause SELECT SQL.</p>
                  <p>La clause SELECT ne peut pas inclure les types de clause suivants :</p>
                  <div class="itemizedlist">
                      
                      
                      
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem">
                        <p>FROM</p>
                     </li><li class="listitem">
                        <p>INTO</p>
                     </li><li class="listitem">
                        <p>WHERE</p>
                     </li><li class="listitem">
                        <p>GROUP BY</p>
                     </li><li class="listitem">
                        <p>ORDER BY</p>
                     </li><li class="listitem">
                        <p>LIMIT</p>
                     </li></ul></div>
               </dd>
             
               <dt><span class="term">LANGUAGE <span>{</span> plpythonu | sql } </span></dt>
               <dd>
                  <p>Pour Python, spécifiez <code class="code">plpythonu</code>. Pour SQL, spécifiez <code class="code">sql</code>. Vous devez avoir l’autorisation pour USAGE ON LANGUAGE pour SQL ou plpythonu. Pour plus d'informations, consultez <a href="./udf-security-and-privileges.html">Privilèges et sécurité des fonctions UDF</a>.</p>
               </dd>
            </dl></div>
       
         <h2 id="r_CREATE_FUNCTION-usage-notes">Notes d’utilisation</h2>
          
            <h3 id="r_CREATE_FUNCTION-usage-notes-nested-functions">Fonctions imbriquées</h3>
            <p>Vous pouvez appeler une autre fonction SQL définie par l’utilisateur à partir d’une fonction SQL définie par l’utilisateur. La fonction imbriquée doit exister lorsque vous exécutez la commande CREATE FUNCTION. Amazon Redshift ne suit pas les dépendances des fonctions UDF, donc si vous supprimez la fonction imbriquée, Amazon Redshift ne renvoie pas d’erreur. Toutefois, la fonction définie par l’utilisateur échoue si la fonction imbriquée n’existe pas. Par exemple, la fonction suivante appelle la fonction <code class="code">f_sql_greater
               </code>dans la clause SELECT.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create function f_sql_commission (float, float )
  returns float
stable
as $$
  select f_sql_greater ($1, $2)
$$ language sql;</code></pre>
          
          
            <h3 id="r_CREATE_FUNCTION-usage-notes-security-and-privileges">Privilèges et sécurité des fonctions UDF</h3>
            <p>Pour créer une fonction définie par l’utilisateur, vous devez avoir l’autorisation pour USAGE ON LANGUAGE pour SQL ou plpythonu (Python). Par défaut, USAGE ON LANGUAGE SQL est accordé à PUBLIC. Toutefois, vous devez accorder explicitement USAGE ON LANGUAGE PLPYTHONU à des utilisateurs ou des groupes spécifiques. </p>
            <p>Pour révoquer le privilège USAGE pour SQL, révoquez d’abord USAGE de PUBLIC. Ensuite, accordez le privilège USAGE pour SQL uniquement aux utilisateurs ou groupes spécifiques autorisés à créer des fonctions SQL définies par l’utilisateur. L’exemple suivant révoque le privilège USAGE pour SQL de PUBLIC, puis accorde USAGE au groupe d’utilisateurs <code class="code">udf_devs</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">revoke usage on language sql from PUBLIC;
grant usage on language sql to group udf_devs;</code></pre>
            <p>Pour exécuter une fonction définie par l’utilisateur, vous devez disposer de l’autorisation d’exécution pour chaque fonction. Par défaut, l’autorisation d’exécution pour les nouvelles fonctions définies par l’utilisateur est accordée à PUBLIC. Pour limiter l’utilisation, révoquez l’autorisation d’exécution de PUBLIC pour la fonction. Ensuite, accordez le privilège à des individus ou à des groupes spécifiques. </p>
            <p>L’exemple ci-dessous révoque l’autorisation d’exécution de la fonction <code class="code">f_py_greater</code> de PUBLIC, puis accorde USAGE au groupe d’utilisateurs <code class="code">udf_devs</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">revoke execute on function f_py_greater(a float, b float) from PUBLIC;
grant execute on function f_py_greater(a float, b float) to group udf_devs;</code></pre>
            <p>Les super-utilisateurs ont tous les privilèges par défaut. </p>
            <p>Pour plus d’informations, consultez <a href="./r_GRANT.html">GRANT</a> et <a href="./r_REVOKE.html">REVOKE</a>.</p>
          
       
         <h2 id="r_CREATE_FUNCTION-examples">Exemples</h2>
          
            <h3 id="r_CREATE_FUNCTION-python-example">Exemple de fonction scalaire Python définie par l’utilisateur</h3>
            <p>L’exemple suivant crée une fonction Python définie par l’utilisateur qui compare deux entiers et renvoie la valeur la plus grande.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create function f_py_greater (a float, b float)
  returns float
stable
as $$
  if a &gt; b:
    return a
  return b
$$ language plpythonu;</code></pre>
            <p>L’exemple suivant interroge la table SALES et appelle la nouvelle fonction <code class="code">f_py_greater</code> pour renvoyer COMMISSION ou 20 % du PRICEPAID, quelle que soit la valeur la plus grande.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select f_py_greater (commission, pricepaid*0.20) from sales;</code></pre>
          
          
            <h3 id="r_CREATE_FUNCTION-sql-example">Exemple de fonction scalaire SQL définie par l’utilisateur</h3>
            <p>L’exemple suivant crée une fonction qui compare deux nombres et renvoie la valeur la plus grande. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create function f_sql_greater (float, float)
  returns float
stable
as $$
  select case when $1 &gt; $2 then $1
    else $2
  end
$$ language sql;</code></pre>
            <p>La requête suivante appelle la nouvelle fonction <code class="code">f_sql_greater</code> pour interroger la table SALES et renvoie COMMISSION ou 20 % du PRICEPAID, quelle que soit la valeur la plus grande.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select f_sql_greater (commission, pricepaid*0.20) from sales;</code></pre>
          
         
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_CREATE_EXTERNAL_VIEW.html">CREATE EXTERNAL VIEW (version préliminaire)</div><div id="next" class="next-link" accesskey="n" href="./r_CREATE_GROUP.html">CREATE GROUP</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_FUNCTION.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_FUNCTION.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>