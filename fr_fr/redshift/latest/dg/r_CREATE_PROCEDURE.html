<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CREATE PROCEDURE - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_CREATE_PROCEDURE" /><meta name="default_state" content="r_CREATE_PROCEDURE" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><meta name="description" content="Crée une nouvelle procédure stockée ou remplace une procédure existante pour la base de données actuelle." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guide du développeur de base de données" /><meta name="abstract" content="Créez et gérez un entrepôt des données avec Amazon Redshift, service d’entrepôt des données au niveau de l’entreprise, pouvant atteindre plusieurs Po et entièrement géré." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guide du développeur de base de données" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guide du développeur de base de données" /><meta id="panorama-serviceConsolePage" value="CREATE PROCEDURE" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>CREATE PROCEDURE - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_CREATE_PROCEDURE" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,entrepôt des données,développeur,exemples de données,database,développeur de base de données,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide du développeur de base de données",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Référence SQL",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Commandes SQL",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "CREATE PROCEDURE",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_SQL_commands.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_CREATE_PROCEDURE" target="_blank" rel="noopener noreferrer" title="Ouvrir le PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guide du développeur de base de données</a></div><div id="page-toc-src"><a href="#r_CREATE_PROCEDURE-privileges">Privilèges requis</a><a href="#r_CREATE_PROCEDURE-synopsis">Syntaxe</a><a href="#r_CREATE_PROCEDURE-parameters">Paramètres</a><a href="#r_CREATE_PROCEDURE-usage">Notes d’utilisation</a><a href="#r_CREATE_PROCEDURE-examples">Exemples</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="r_CREATE_PROCEDURE">CREATE PROCEDURE</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Crée une nouvelle procédure stockée ou remplace une procédure existante pour la base de données actuelle.</p><p>Pour plus d’informations et d’exemples, consultez <a href="./stored-procedure-overview.html">Création de procédures stockées dans Amazon Redshift</a>.</p>
         <h2 id="r_CREATE_PROCEDURE-privileges">Privilèges requis</h2>
         <p>Les privilèges suivants sont requis pour CREATE PROCEDURE :</p>
         <div class="itemizedlist">
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>Pour CREATE PROCEDURE :</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p>Superuser</p>
                  </li><li class="listitem">
                     <p>Utilisateurs disposant du privilège CREATE [OR REPLACE] PROCEDURE</p>
                  </li></ul></div>
            </li><li class="listitem">
               <p>Pour REPLACE PROCEDURE :</p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p>Superuser</p>
                  </li><li class="listitem">
                     <p>Utilisateurs disposant du privilège CREATE [OR REPLACE] PROCEDURE</p>
                  </li><li class="listitem">
                     <p>Propriétaire de la procédure</p>
                  </li></ul></div>
            </li></ul></div>
       
         <h2 id="r_CREATE_PROCEDURE-synopsis">Syntaxe</h2>

         
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">CREATE [ OR REPLACE ] PROCEDURE sp_procedure_name  
  ( [ [ argname ] [ argmode ] argtype [, ...] ] )
[ NONATOMIC ]
AS $$
  procedure_body
$$ LANGUAGE plpgsql
[ <span>{</span> SECURITY INVOKER | SECURITY DEFINER } ]
[ SET configuration_parameter <span>{</span> TO value | = value } ]
</code></pre>
       
         <h2 id="r_CREATE_PROCEDURE-parameters">Paramètres</h2>
         <div class="variablelist">
             
             
             
             
             
             
             
             
             
         <dl>
               <dt><span class="term"> OR REPLACE </span></dt>
               <dd>
                  <p>Clause qui spécifie que si une procédure ayant le même nom et les mêmes types de données, ou signature, existe déjà, la procédure existante est remplacée. Vous pouvez uniquement remplacer une procédure par une nouvelle procédure qui définit un ensemble identique de types de données. Vous devez être un super-utilisateur ou le propriétaire pour remplacer une procédure.</p>
                  <p>Si vous définissez une procédure avec le même nom qu’une procédure existante, mais une signature différente, vous créez une nouvelle procédure. Autrement dit, le nom de la procédure est surchargé. Pour plus d'informations, consultez <a href="./stored-procedure-naming.html#stored-procedure-overloading-name">Surcharge des noms de procédure</a>. </p>
               </dd>
             
               <dt><span class="term"> <em>sp_procedure_name</em> </span></dt>
               <dd>
                  <p>Nom de la procédure. Si vous spécifiez un nom de schéma (tel que <code class="userinput">myschema.myprocedure</code>), la procédure est créée à dans le schéma spécifié. Sinon, la procédure est créée dans le schéma en cours. Pour plus d’informations sur les noms valides, consultez <a href="./r_names.html">Noms et identificateurs</a>. </p>
                  <p>Nous vous conseillons d’utiliser le préfixe <code class="code">sp_</code> pour tous les noms des procédures stockées. Amazon Redshift réserve le préfixe <code class="code">sp_</code> pour les noms de procédures stockées. Utiliser le préfixe <code class="code">sp_</code> vous permet de garantir que le nom de votre procédure stockée n’est en conflit avec aucun nom de fonction ou de procédure stockée intégré à Amazon Redshift existant ou futur. Pour plus d'informations, consultez <a href="./stored-procedure-naming.html">Dénomination des procédures stockées</a>.</p>
                  <p>Vous pouvez définir plusieurs procédures portant le même nom si les types de données des arguments en entrée, ou signature, sont différents. Autrement dit, dans ce cas, le nom de la procédure est surchargé. Pour plus d'informations, consultez <a href="./stored-procedure-naming.html#stored-procedure-overloading-name">Surcharge des noms de procédure</a></p>
               </dd>
             
               <dt><span class="term"><em>[argname] [ argmode] argtype</em> </span></dt>
               <dd>
                  <p>Liste de noms d’arguments, de modes d’argument et de types de données. Seul le type de données est requis. Le nom et le mode sont facultatifs, et leur position peut être inversée.</p>
                  <p>Le mode de l’argument peut être IN, OUT ou INOUT. La valeur par défaut est IN.</p>
                  <p>Vous pouvez utiliser des arguments OUT et INOUT pour renvoyer une ou plusieurs valeurs à partir d’un appel de procédure. S’il existe des arguments OUT ou INOUT, l’appel de procédure renvoie une ligne de résultats contenant <em>n</em> colonnes, où <em>n</em> est le nombre total d’arguments OUT ou INOUT.</p>
                  <p>Les arguments INOUT sont des arguments à la fois en entrée et en sortie. Les <em>arguments en entrée</em> comprennent les arguments IN et INOUT, et les <em>arguments en sortie</em> comprennent les arguments OUT et INOUT.</p>
                  
                  <p>Les arguments OUT ne sont pas spécifiés dans le cadre de l’instruction CALL. Spécifiez les arguments INOUT dans l’instruction CALL de la procédure stockée. Les arguments INOUT peuvent s’avérer utiles lorsque vous transmettez ou renvoyez des valeurs à partir d’appels imbriqués, ainsi que lors du renvoi d’un type <code class="code">refcursor</code>. Pour plus d’informations sur les types <code class="code">refcursor</code>, consultez <a href="./c_PLpgSQL-statements.html#r_PLpgSQL-cursors">Curseurs</a>.</p>
                  <p>Les types de données d’arguments peuvent être de n’importe quel type de données Amazon Redshift standard. En outre, <code class="code">refcursor</code> peut être un type de données d’argument.</p>
                  <p>Vous pouvez spécifier un maximum de 32 arguments en entrée et de 32 arguments en sortie. </p>
               </dd>
             
               <dt><span class="term">AS $$ <em>procedure_body</em> $$ </span></dt>
               <dd>
                  <p>Construction qui englobe la procédure à exécuter. Les mots-clés littéraux AS $$ et $$ sont obligatoires.</p>
                  <p>Amazon Redshift requiert que vous placiez l’instruction dans votre procédure à l’aide d’un format appelé guillemets dollar. Tout ce qui se trouve dans l’encadrement est passé exactement comme tel. Vous n’avez pas besoin de définir de séquence d’échappement pour les caractères spéciaux, car les contenus de la chaîne sont écrits littéralement.</p>
                  <p>Avec les <em>guillemets dollar</em>, vous utilisez une paire de symboles dollar ($$) pour marquer le début et la fin de l’instruction à exécuter, comme illustré dans l’exemple suivant.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">$$ my statement $$</code></pre>
                  <p>Le cas échéant, entre les symboles dollar de chaque paire, vous pouvez spécifier une chaîne pour aider à identifier l’instruction. La chaîne que vous utilisez doit être la même au début et à la fin des paires d’encadrement. Cette chaîne est sensible à la casse et suit les mêmes contraintes qu’un identificateur sans guillemets, sauf que celui-ci ne peut pas contenir de symboles dollar. L’exemple suivant utilise la chaîne test.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">$test$ my statement $test$</code></pre>
                  <p>Cette syntaxe est également utile les guillemets dollar imbriqués. Pour plus d’informations sur les guillemets dollar, consultez relative aux constantes de chaîne avec guillemet dollar dans <a href="https://www.postgresql.org/docs/9.0/sql-syntax-lexical.html" rel="noopener noreferrer" target="_blank"><span>Lexical Structure</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> dans la documentation PostgreSQL.</p>
               </dd>
             
               <dt><span class="term"> <em>procedure_body</em> </span></dt>
               <dd>
                  <p>Ensemble d’instructions PL/pgSQL valides. Les instructions PL/pgSQL complémentent les commandes SQL avec des constructions procédurales, y compris des expressions de boucle et conditionnelles, pour contrôler le flux logique. La plupart des commandes SQL peuvent être utilisées dans le corps de la procédure, y compris celles du langage de modification de données (DML) telles que COPY, UNLOAD et INSERT, et celles du langage de définition de données (DDL) telles que CREATE TABLE. Pour plus d'informations, consultez <a href="./c_pl_pgSQL_reference.html">Guide de référence du langage PL/pgSQL</a>. </p>
               </dd>
             
               <dt><span class="term">LANGUAGE <em>plpgsql</em></span></dt>
               <dd>
                  <p>Valeur pour le langage. Spécifiez <code class="code">plpgsql</code>. Vous devez avoir l’autorisation pour USAGE ON LANGUAGE pour utiliser <code class="code">plpgsql</code>. Pour de plus amples informations, veuillez consulter <a href="./r_GRANT.html">GRANT</a>. </p>
               </dd>
             
                            
               <dt><span class="term">NONATOMIC</span></dt>
               <dd>
                  
                  <p>Crée la procédure stockée dans un mode de transaction non atomique. Le mode NONATOMIC valide automatiquement les déclarations à l’intérieur de la procédure. En outre, lorsqu’une erreur se produit à l’intérieur de la procédure NONATOMIC, l’erreur n’est pas relancée si elle est gérée par un bloc d’exception. Pour plus d’informations, consultez <a href="./stored-procedure-transaction-management.html">Gestion des transactions</a> et <a href="./c_PLpgSQL-statements.html#r_PLpgSQL-messages-errors">RAISE</a>.</p>
                  <p>Lorsque vous définissez une procédure stockée comme <code class="code">NONATOMIC</code>, tenez compte des éléments suivants :</p>
                  <div class="itemizedlist">
                      
                      
                     
                      
                     
                  <ul class="itemizedlist"><li class="listitem"><p>Lorsque vous imbriquez des appels de procédures stockées, toutes les procédures doivent être créées dans le même mode de transaction.</p></li><li class="listitem"><p>L’option <code class="code">SECURITY DEFINER</code> et l’option <code class="code">SET configuration_parameter</code> ne sont pas prises en charge lors de la création d’une procédure en mode NONATOMIC.</p></li><li class="listitem"><p>Tout curseur ouvert (explicitement ou implicitement) est fermé automatiquement lorsqu’une validation implicite est effectuée. Par conséquent, vous devez ouvrir une transaction explicite avant de commencer une boucle de curseur pour vous assurer que tout code SQL dans l’itération de la boucle n’est pas implicitement validé.</p></li></ul></div>
               </dd>
               
             
               <dt><span class="term">SECURITY INVOKER | SECURITY DEFINER</span></dt>
               <dd>
                  <p>L’option <code class="code">SECURITY DEFINER</code> n’est pas prise en charge lorsque <code class="code">NONATOMIC</code> est spécifié.</p>
                  <p>Le mode de sécurité pour la procédure détermine les privilèges d’accès de la procédure lors de l’exécution. La procédure doit être autorisée à accéder aux objets de la base de données sous-jacente. </p>
                  <p>Pour le mode SECURITY INVOKER, la procédure utilise les privilèges de l’utilisateur appelant la procédure. L’utilisateur doit disposer d’autorisations explicites sur les objets de la base de données sous-jacente. La valeur par défaut est SECURITY INVOKER.</p>
                  <p>Pour le mode SECURITY DEFINER, la procédure utilise les privilèges du propriétaire de la procédure. Le propriétaire de la procédure est défini comme l’utilisateur propriétaire de la procédure au moment de l’exécution, pas nécessairement l’utilisateur qui a initialement défini la procédure. L’utilisateur qui appelle la procédure doit détenir un privilège EXECUTE sur la procédure, mais il n’a pas besoin de privilèges sur les objets sous-jacents. </p>
               </dd>
             
               <dt><span class="term">SET configuration_parameter <span>{</span> TO value | = value }</span></dt>
               <dd>
                  <p>Ces options ne sont pas prises en charge lorsque <code class="code">NONATOMIC</code> est spécifié.</p>
                  <p>La clause SET entraîne la définition du <code class="code">configuration_parameter</code> spécifié sur la valeur spécifiée au lancement de la procédure. Cette clause restaure ensuite <code class="code">configuration_parameter</code> à sa valeur précédente à la fin de la procédure. </p>
               </dd>
            </dl></div>
       
         <h2 id="r_CREATE_PROCEDURE-usage">Notes d’utilisation</h2>
         <p>Si une procédure stockée a été créée à l’aide de l’option SECURITY DEFINER, lors de l’appel de la fonction CURRENT_USER depuis la procédure stockée, Amazon Redshift renvoie le nom d’utilisateur du propriétaire de la procédure stockée.</p>
       
         <h2 id="r_CREATE_PROCEDURE-examples">Exemples</h2>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Si vous rencontrez une erreur similaire à ce qui suit lors de l’exécution de ces exemples :</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">ERROR: 42601: [Amazon](500310) unterminated dollar-quoted string at or near "$$</code></pre><p>Consultez <a href="./stored-procedure-create.html">Présentation des procédures stockées dans Amazon Redshift</a>. </p></div></div>
         <p>L’exemple suivant crée une procédure avec deux paramètres d’entrée.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE OR REPLACE PROCEDURE test_sp1(f1 int, f2 varchar(20))
AS $$
DECLARE
  min_val int;
BEGIN
  DROP TABLE IF EXISTS tmp_tbl;
  CREATE TEMP TABLE tmp_tbl(id int);
  INSERT INTO tmp_tbl values (f1),(10001),(10002);
  SELECT INTO min_val MIN(id) FROM tmp_tbl;
  RAISE INFO 'min_val = %, f2 = %', min_val, f2;
END;
$$ LANGUAGE plpgsql;
</code></pre>
         
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p> Lorsque vous écrivez des procédures stockées, nous vous recommandons une bonne pratique pour sécuriser les valeurs sensibles : </p><p> Ne codez pas en dur des informations sensibles dans la logique des procédures stockées. Par exemple, n’attribuez pas de mot de passe utilisateur dans une instruction CREATE USER dans le corps d’une procédure stockée. Cela présente un risque de sécurité, car les valeurs codées en dur peuvent être enregistrées sous forme de métadonnées de schéma dans les tables du catalogue. Transmettez plutôt des valeurs sensibles, telles que des mots de passe, en tant qu’arguments à la procédure stockée, au moyen de paramètres. </p><p>Pour plus d’informations sur les procédures stockées, consultez <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_PROCEDURE.html">PROCÉDURE DE CRÉATION</a> et <a href="https://docs.aws.amazon.com/redshift/latest/dg/stored-procedure-overview.html">Création de procédures stockées dans Amazon Redshift</a>. Pour plus d’informations sur les tables catalogue, consultez <a href="https://docs.aws.amazon.com/redshift/latest/dg/c_intro_catalog_views.html">Tables de catalogue système</a>.</p></div></div>

         <p>L’exemple suivant crée une procédure avec un paramètre IN, un paramètre OUT et un paramètre INOUT.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE OR REPLACE PROCEDURE test_sp2(f1 IN int, f2 INOUT varchar(256), out_var OUT varchar(256))
AS $$
DECLARE
  loop_var int;
BEGIN
  IF f1 is null OR f2 is null THEN
    RAISE EXCEPTION 'input cannot be null';
  END IF;
  DROP TABLE if exists my_etl;
  CREATE TEMP TABLE my_etl(a int, b varchar);
    FOR loop_var IN 1..f1 LOOP
        insert into my_etl values (loop_var, f2);
        f2 := f2 || '+' || f2;
    END LOOP;
  SELECT INTO out_var count(*) from my_etl;
END;
$$ LANGUAGE plpgsql;
</code></pre>
         
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_create_model_use_cases.html">Cas d’utilisation</div><div id="next" class="next-link" accesskey="n" href="./r_CREATE_RLS_POLICY.html">CREATE RLS POLICY</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_PROCEDURE.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_PROCEDURE.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>