<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Amélioration des performances des requêtes d’Amazon Redshift Spectrum - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="c-spectrum-external-performance" /><meta name="default_state" content="c-spectrum-external-performance" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-spectrum-external-performance.html" /><meta name="description" content="Observez le plan de requête afin de déterminer quelles étapes ont été transmises à la couche Amazon Redshift Spectrum." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guide du développeur de base de données" /><meta name="abstract" content="Créez et gérez un entrepôt de données avec Amazon Redshift, service d’entrepôt de données au niveau de l’entreprise, pouvant atteindre plusieurs Po et entièrement géré." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-spectrum-external-performance.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guide du développeur de base de données" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guide du développeur de base de données" /><meta id="panorama-serviceConsolePage" value="Amélioration des performances des requêtes d’Amazon Redshift Spectrum" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Amélioration des performances des requêtes d’Amazon Redshift Spectrum - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#c-spectrum-external-performance" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-spectrum-external-performance.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-spectrum-external-performance.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-spectrum-external-performance.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,entrepôt de données,développeur,exemples de données,database,développeur de base de données,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide du développeur de base de données",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Interroger des données externes avec Amazon Redshift Spectrum",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-using-spectrum.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Amélioration des performances des requêtes d’Amazon Redshift Spectrum",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-using-spectrum.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#c-spectrum-external-performance" target="_blank" rel="noopener noreferrer" title="Ouvrir le PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guide du développeur de base de données</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="c-spectrum-external-performance">Amélioration des performances des requêtes d’Amazon Redshift Spectrum</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Observez le plan de requête afin de déterminer quelles étapes ont été transmises à la couche Amazon Redshift Spectrum. </p><p>Les étapes ci-après sont liées à la requête Redshift Spectrum :</p><div class="itemizedlist">
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>S3 Seq Scan </p>
         </li><li class="listitem">
            <p>S3  HashAggregate </p>
         </li><li class="listitem">
            <p>S3 Query Scan</p>
         </li><li class="listitem">
            <p>Scan Seq  PartitionInfo</p>
         </li><li class="listitem">
            <p>Partition Loop </p>
         </li></ul></div><p>L’exemple suivant présente le plan d’une requête qui joint une table externe à une table locale. Notez les  HashAggregate  étapes S3 Seq Scan et S3 qui ont été exécutées sur les données d'Amazon S3.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">explain
select top 10 spectrum.sales.eventid, sum(spectrum.sales.pricepaid) 
from spectrum.sales, event
where spectrum.sales.eventid = event.eventid
and spectrum.sales.pricepaid &gt; 30
group by spectrum.sales.eventid
order by 2 desc;</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
QUERY PLAN                                                                                                                                                                                
-----------------------------------------------------------------------------
XN Limit  (cost=1001055770628.63..1001055770628.65 rows=10 width=31)                                                                                                                      
  -&gt;  XN Merge  (cost=1001055770628.63..1001055770629.13 rows=200 width=31)                                                                                                               
        Merge Key: sum(sales.derived_col2)                                                                                                                                                
        -&gt;  XN Network  (cost=1001055770628.63..1001055770629.13 rows=200 width=31)                                                                                                       
              Send to leader                                                                                                                                                              
              -&gt;  XN Sort  (cost=1001055770628.63..1001055770629.13 rows=200 width=31)                                                                                                    
                    Sort Key: sum(sales.derived_col2)                                                                                                                                     
                    -&gt;  XN HashAggregate  (cost=1055770620.49..1055770620.99 rows=200 width=31)                                                                                           
                          -&gt;  XN Hash Join DS_BCAST_INNER  (cost=3119.97..1055769620.49 rows=200000 width=31)                                                                             
                                Hash Cond: ("outer".derived_col1 = "inner".eventid)                                                                                                       
                                -&gt;  XN S3 Query Scan sales  (cost=3010.00..5010.50 rows=200000 width=31)                                                                                  
                                      -&gt;  S3 HashAggregate  (cost=3010.00..3010.50 rows=200000 width=16)                                                                                  
                                            -&gt;  S3 Seq Scan spectrum.sales location:"s3://redshift-downloads/tickit/spectrum/sales" format:TEXT  (cost=0.00..2150.00 rows=172000 width=16)
                                                  Filter: (pricepaid &gt; 30.00)                                                                                                             
                                -&gt;  XN Hash  (cost=87.98..87.98 rows=8798 width=4)                                                                                                        
                                      -&gt;  XN Seq Scan on event  (cost=0.00..87.98 rows=8798 width=4)</code></pre><p>Notez les éléments suivants dans le plan de requête :</p><div class="itemizedlist">
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>Le nœud <code class="code">S3 Seq Scan</code> présente le filtre <code class="code">pricepaid &gt;
                  30.00</code> qui a été traité dans la couche Redshift Spectrum.</p>
            <p>Un nœud de filtre sous le nœud <code class="code">XN S3 Query Scan</code> indique le traitement des prédicats dans Amazon Redshift au-dessus des données renvoyées depuis la couche Redshift Spectrum.</p>
         </li><li class="listitem">
            <p>Le nœud <code class="code">S3 HashAggregate</code> référence le groupement dans la couche Redshift Spectrum correspondant au groupe par la clause (<code class="code">group by
               spectrum.sales.eventid</code>).</p>
         </li></ul></div><p>Pour améliorer les performances de Redshift Spectrum, procédez comme suit :</p><div class="itemizedlist">
          
          
          
          
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>Utilisez des fichiers de données au format Apache Parquet. Parquet stocke les données sous forme de colonnes, de sorte que Redshift Spectrum peut éliminer les colonnes inutiles de l’analyse. Si les données sont au format texte, Redshift Spectrum doit analyser l’intégralité du fichier.</p>
         </li><li class="listitem"> 
            <p>Utilisez plusieurs fichiers afin d’optimiser le traitement parallèle, Utilisez des fichiers d’une taille supérieure à 64 Mo. Faites en sorte que tous les fichiers aient à peu près la même taille afin que la charge de travail soit équitablement distribuée. Pour plus d'informations sur les fichiers Apache Parquet et les recommandations de configuration, voir <a href="https://parquet.apache.org/docs/file-format/configurations/" rel="noopener noreferrer" target="_blank"><span>Format de fichier : configurations</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> dans la <em>documentation d'Apache Parquet</em>.</p>
         </li><li class="listitem">
            <p>Utilisez dans vos requêtes aussi peu de colonnes que possible.</p>
         </li><li class="listitem">
            <p>Placez vos grandes tables de faits dans Amazon S3 et conservez vos tables de dimensions plus petites et fréquemment utilisées dans votre base de données Amazon Redshift locale.</p>
         </li><li class="listitem">
            <p>Mettez à jour les statistiques de table externe en définissant le paramètre numRows de TABLE PROPERTIES. Utilisez <a href="./r_CREATE_EXTERNAL_TABLE.html">CREATE EXTERNAL TABLE</a> ou <a href="./r_ALTER_TABLE.html">ALTER TABLE</a> pour définir le paramètre TABLE PROPERTIES numRows afin de refléter le nombre de lignes du tableau. Amazon Redshift n'analyse pas des tables externes pour générer les statistiques de table utilisées par l'optimiseur de requête afin de générer un plan de requête. Si des statistiques de table ne sont pas définies pour une table externe, Amazon Redshift génère un plan d’exécution de requête. Amazon Redshift génère ce plan en partant du principe que les tables externes sont les plus grandes tables et les tables locales les plus petites.</p>
         </li><li class="listitem">
            <p>Le planificateur de requêtes Amazon Redshift pousse les prédicats et les agrégations vers la couche de requêtes Redshift Spectrum lorsque cela est possible. Lorsque de grandes quantités de données sont renvoyées depuis Amazon S3, le traitement est limité par les ressources de votre cluster. Redshift Spectrum procède à un dimensionnement automatique afin de traiter les requêtes volumineuses. Ainsi, les performances globales s’améliorent chaque fois que vous pouvez transmettre le traitement à la couche Redshift Spectrum. </p>
         </li><li class="listitem">
            <p>Ecrivez les requêtes de façon à utiliser des filtres et des regroupements qui peuvent être transmis à la couche Redshift Spectrum.</p>
            <p>Voici quelques exemples d’opérations pouvant être transmises à la couche Redshift Spectrum :</p>
            <div class="itemizedlist">
                
                
                

                
            <ul class="itemizedlist"><li class="listitem">
                  <p>Clauses GROUP BY</p>
               </li><li class="listitem">
                  <p>Conditions de comparaison ou de correspondance de modèle, telles que LIKE.</p>
               </li><li class="listitem">
                  <p>Fonctions d’agrégation, telles que COUNT, SUM, AVG, MIN et MAX.</p>
               </li><li class="listitem">
                  <p>Fonctions de chaîne.</p>
               </li></ul></div>
            <p>Les opérations DISTINCT et ORDER BY, notamment, ne peuvent pas être transmises à la couche Redshift Spectrum.</p>
         </li><li class="listitem">
            <p>Utilisez des partitions afin de limiter les données analysées. Partitionnez les données en fonction des prédicats de requête les plus courants, puis réduisez les partitions en filtrant leurs colonnes. Pour de plus amples informations, consultez <a href="./c-spectrum-external-tables.html#c-spectrum-external-tables-partitioning">Partitionnement des tables externes Redshift Spectrum</a>.</p>
            <p>Interrogez <a href="./r_SVL_S3PARTITION.html">SVL_S3PARTITION</a> afin d’afficher le total des partitions et les partitions qualifiées.</p>
         </li><li class="listitem">
            <p> Utilisez le générateur de statistiques d’AWS Glue pour calculer les statistiques au niveau des colonnes pour les tables AWS Glue Data Catalog. Une fois qu’AWS Glue génère les statistiques pour les tables du catalogue de données, Amazon Redshift Spectrum utilise automatiquement ces statistiques pour optimiser le plan de requête. Pour plus d’informations sur le calcul des statistiques de niveau colonne à l’aide d’AWS Glue, consultez <a href="https://docs.aws.amazon.com/glue/latest/dg/column-statistics.html">Utilisation des statistiques de colonne</a> dans le <em>Guide du développeur AWS Glue</em>. </p>
         </li></ul></div><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./querying-iceberg-supported-data-types.html">Types de données pris en charge</div><div id="next" class="next-link" accesskey="n" href="./t_setting-data-handling-options.html">Définition des options de gestion des données</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-spectrum-external-performance.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-spectrum-external-performance.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>