<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>MERGE - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_MERGE" /><meta name="default_state" content="r_MERGE" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" /><meta name="description" content="Insère, met à jour et supprime des valeurs dans une table en fonction des valeurs d’une table source." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guide du développeur de base de données" /><meta name="abstract" content="Créez et gérez un entrepôt de données avec Amazon Redshift, service d’entrepôt de données au niveau de l’entreprise, pouvant atteindre plusieurs Po et entièrement géré." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_MERGE.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_MERGE.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_MERGE.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_MERGE.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_MERGE.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_MERGE.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_MERGE.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_MERGE.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guide du développeur de base de données" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guide du développeur de base de données" /><meta id="panorama-serviceConsolePage" value="MERGE" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>MERGE - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_MERGE" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,entrepôt de données,développeur,exemples de données,database,développeur de base de données,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide du développeur de base de données",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Référence SQL",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Commandes SQL",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "MERGE",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_SQL_commands.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_MERGE" target="_blank" rel="noopener noreferrer" title="Ouvrir le PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guide du développeur de base de données</a></div><div id="page-toc-src"><a href="#r_MERGE-synopsis">Syntaxe</a><a href="#r_MERGE-parameters">Paramètres</a><a href="#r_MERGE_usage_notes">Notes d’utilisation</a><a href="#sub-examples-merge">Exemples</a><a href="#r_MERGE-see-also">Consultez aussi</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="r_MERGE">MERGE</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Fusionne de manière conditionnelle les lignes d’une table source dans une table cible. Traditionnellement, cela ne peut être réalisé qu’en utilisant plusieurs instructions d’insertion, de mise à jour ou de suppression séparément. Pour plus d’informations sur les opérations que MERGE vous permet de combiner, consultez <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_UPDATE.html">UPDATE</a>, <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_DELETE.html">DELETE</a> et <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_INSERT_30.html">INSERT</a>.</p>
         <h2 id="r_MERGE-synopsis">Syntaxe</h2>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">MERGE INTO <em>target_table</em> 
USING <em>source_table</em> [ [ AS ] <em>alias</em> ] 
ON <em>match_condition</em> 
[ WHEN MATCHED THEN <span>{</span> UPDATE SET <em>col_name</em> = <span>{</span> <em>expr</em> } [,...] | DELETE }
WHEN NOT MATCHED THEN INSERT [ ( <em>col_name</em> [,...] ) ] VALUES ( <span>{</span> <em>expr</em> } [, ...] ) |
REMOVE DUPLICATES ]</code></pre>

       
         <h2 id="r_MERGE-parameters">Paramètres</h2>
         <div class="variablelist">
             
             
             
             
            
             
             
             

             
             
             
             
             
         <dl>
               <dt><span class="term"> <em>target_table</em></span></dt>
               <dd>
                  <p>Table temporaire ou permanente dans laquelle l’instruction MERGE est fusionnée.</p>
               </dd>
             
               <dt><span class="term"> <em>source_table</em></span></dt>
               <dd>
                  <p>Table temporaire ou permanente fournissant les lignes à fusionner dans <em>target_table</em>. <em>source_table</em> peut également être une table Spectrum. <em>source_table</em> ne peut pas être une vue ou une sous-requête.</p>
               </dd>
             
               <dt><span class="term"> <em>alias</em></span></dt>
               <dd>
                  <p>Nom alternatif temporaire pour <em>source_table</em>.</p>
                  <p>Ce paramètre est facultatif. L’<em>alias</em> précédent avec AS est également facultatif.</p>
               </dd>
             
               <dt><span class="term"> <em>match_condition</em></span></dt>
               <dd>
                  <p>Spécifie des prédicats égaux entre la colonne de la table source et la colonne de la table cible qui sont utilisés pour déterminer si les lignes de <em>source_table</em> peuvent correspondre aux lignes de <em>target_table</em>. Si la condition est remplie, MERGE exécute <em>matched_clause</em> pour cette ligne. Sinon, MERGE exécute <em>not_matched_clause</em> pour cette ligne.</p>
               </dd>
             
               <dt><span class="term">WHEN MATCHED</span></dt>
               <dd>
                  <p> Spécifie l’action à exécuter lorsque la condition de correspondance entre une ligne source et une ligne cible est évaluée sur True. Vous pouvez spécifier une action UPDATE ou une action DELETE. </p>
               </dd>
             
               <dt><span class="term">UPDATE</span></dt>
               <dd><p> Met à jour la ligne correspondante dans <em>target_table</em>. Seules les valeurs dans <em>col_name</em> que vous spécifiez sont mises à jour. </p></dd>
             
               <dt><span class="term">DELETE</span></dt>
               <dd><p> Supprime la ligne correspondante dans <em>target_table</em>. </p></dd>
             
               <dt><span class="term">WHEN NOT MATCHED</span></dt>
               <dd>
                  <p> Spécifie l’action à exécuter lorsque la condition de correspondance est évaluée sur False ou Unknown. Vous pouvez uniquement spécifier l’action d’insertion INSERT pour cette clause. </p>
               </dd>
             
               <dt><span class="term">INSERT</span></dt>
               <dd><p> Insère une ligne dans <em>target_table</em>. <em>col_name</em> cible peut être répertorié dans n’importe quel ordre. Si vous ne fournissez aucune valeur <em>col_name</em>, l’ordre par défaut correspond à l’ordre déclaré de toutes les colonnes de la table. </p></dd>
             
               <dt><span class="term"> <em>col_name</em></span></dt>
               <dd>
                  <p>Un ou plusieurs noms de colonnes que vous voulez modifier. N’incluez pas le nom de la table quand vous spécifiez la colonne cible.</p>
               </dd>
             
               <dt><span class="term"> <em>expr</em></span></dt>
               <dd>
                  <p>Expression définissant la nouvelle valeur pour <em>col_name</em>.</p>
               </dd>
             
               <dt><span class="term"> REMOVE DUPLICATES</span></dt>
               <dd>
                  <p>Spécifie que la commande MERGE s’exécute en mode simplifié. Le mode simplifié a les exigences suivantes :</p>
                  <div class="itemizedlist">
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem"><p> <em>target_table</em> et <em>source_table</em> doivent avoir le même nombre de colonnes et les mêmes types de colonnes compatibles. </p></li><li class="listitem"><p> Omettez la clause WHEN et les clauses UPDATE et INSERT de votre commande MERGE. </p></li><li class="listitem"><p> Utilisez la clause REMOVE DUPLICATES dans votre commande MERGE. </p></li></ul></div>
                  <p>En mode simplifié, MERGE effectue les opérations suivantes :</p>
                  <div class="itemizedlist">
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem"><p> Les lignes dans <em>target_table</em> qui ont une correspondance dans <em>source_table</em> sont mises à jour pour correspondre aux valeurs dans <em>source_table</em>. </p></li><li class="listitem"><p> Les lignes dans <em>source_table</em> qui n’ont pas de correspondance dans <em>target_table</em> sont insérées dans <em>target_table</em>. </p></li><li class="listitem"><p> Lorsque plusieurs lignes dans <em>target_table</em> correspondent à la même ligne dans <em>source_table</em>, les lignes dupliquées sont supprimées. Amazon Redshift conserve une ligne et la met à jour. Les lignes dupliquées qui ne correspondent pas à une ligne dans <em>source_table</em> restent inchangées. </p></li></ul></div>
                  <p>L’utilisation de REMOVE DUPLICATES donne de meilleures performances que l’utilisation de WHEN MATCHED et WHEN NOT MATCHED. Nous vous recommandons d’utiliser REMOVE DUPLICATES si <em>target_table</em> et <em>source_table</em> sont compatibles et si vous n’avez pas besoin de conserver les lignes dupliquées dans <em>target_table</em>.</p>
               </dd>
            </dl></div>
       
         <h2 id="r_MERGE_usage_notes">Notes d’utilisation</h2>
         <div class="itemizedlist">
             
             
             
             
             
             
            
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>Pour exécuter des instructions MERGE, vous devez être propriétaire à la fois de <em>source_table</em> et de <em>target_table</em>, ou disposer de l’autorisation SELECT pour ces tables. En outre, vous devez disposer des autorisations UPDATE, DELETE et INSERT pour <em>target_table</em> en fonction des opérations incluses dans votre instruction MERGE.</p>
            </li><li class="listitem">
               <p> <em>target_table</em> ne peut pas être une table système, une table de catalogue ou une table externe. </p>
            </li><li class="listitem">
               <p> <em>source_table</em> et <em>target_table</em> ne peuvent pas être la même table. </p>
            </li><li class="listitem">
               <p> Vous ne pouvez pas utiliser la clause WITH dans une instruction MERGE. </p>
            </li><li class="listitem">
               <p> Les lignes de la <em>target_table</em> ne peuvent pas correspondre à plusieurs lignes de la <em>source_table</em>. </p>
               <p>Prenez l’exemple suivant :</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (1, 'Bob'), (2, 'John');
INSERT INTO source VALUES (1, 'Tony'), (1, 'Alice'), (3, 'Bill');

MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN UPDATE SET id = source.id, name = source.name
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);
ERROR: Found multiple matches to update the same tuple.

MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN DELETE
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);
ERROR: Found multiple matches to update the same tuple.</code></pre>
               <p>Dans les deux instructions MERGE, l’opération échoue parce qu’il y a plusieurs lignes dans la table <code class="code">source</code> avec une valeur ID de <code class="code">1</code>.</p>
            </li><li class="listitem">
               <p> <em>match_condition</em> et <em>expr</em> ne peuvent pas référencer partiellement les colonnes de type SUPER. Par exemple, si votre objet de type SUPER est un tableau ou une structure, vous ne pouvez pas utiliser des éléments individuels de cette colonne pour <em>match_condition</em> ou <em>expr</em>, mais vous pouvez utiliser la colonne entière. </p>
               <p>Prenez l’exemple suivant :</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE IF NOT EXISTS target (key INT, value SUPER);
CREATE TABLE IF NOT EXISTS source (key INT, value SUPER);

INSERT INTO target VALUES (1, JSON_PARSE('<span>{</span>"key": 88}'));
INSERT INTO source VALUES (1, ARRAY(1, 'John')), (2, ARRAY(2, 'Bill'));

MERGE INTO target USING source ON target.key = source.key
WHEN matched THEN UPDATE SET value = source.value[0]
WHEN NOT matched THEN INSERT VALUES (source.key, source.value[0]);
ERROR: Partial reference of SUPER column is not supported in MERGE statement.</code></pre>
               <p>Pour plus d’informations sur le type SUPER, consultez <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SUPER_type.html">Type SUPER</a>.</p>
            </li><li class="listitem">
               <p>Si <em>source_table</em> est volumineuse, définir les colonnes de jointure de <em>target_table</em> et de <em>source_table</em> comme clés de distribution peut améliorer les performances.</p>
            </li><li class="listitem">
               <p>Pour utiliser la clause REMOVE DUPLICATES, vous devez disposer des autorisations SELECT, INSERT et DELETE pour <em>target_table</em>.</p>
            </li></ul></div>
       
         <h2 id="sub-examples-merge">Exemples</h2>
         <p>L’exemple suivant crée deux tables, puis exécute une opération MERGE sur celles-ci qui met à jour les lignes correspondantes dans la table cible et insère des lignes qui ne correspondent pas. Elle insère ensuite une autre valeur dans la table source et exécute une autre opération MERGE, qui supprime cette fois les lignes correspondantes et insère la nouvelle ligne de la table source.</p>
         <p>Créez et remplissez d’abord les tables source et cible.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (101, 'Bob'), (102, 'John'), (103, 'Susan');
INSERT INTO source VALUES (102, 'Tony'), (103, 'Alice'), (104, 'Bill');

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 102 | John
 103 | Susan
(3 rows)

SELECT * FROM source;
 id  |    name
-----+------------
 102 | Tony
 103 | Alice
 104 | Bill
(3 rows)</code></pre>
         <p>Fusionnez ensuite la table source dans la table cible, ce qui met à jour la table cible avec les lignes correspondantes et insère les lignes de la table source qui n’ont aucune correspondance.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN UPDATE SET id = source.id, name = source.name
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 102 | Tony
 103 | Alice
 104 | Bill
(4 rows)</code></pre>
         <p>Notez que les lignes dont les valeurs d’id sont 102 et 103 sont mises à jour pour correspondre aux valeurs de nom de la table cible. En outre, une nouvelle ligne avec une valeur d’id 104 et une valeur de nom Bill est insérée dans la table cible.</p>
         <p>Ensuite, insérez une nouvelle ligne dans la table source.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">INSERT INTO source VALUES (105, 'David');

SELECT * FROM source;
 id  |    name
-----+------------
 102 | Tony
 103 | Alice
 104 | Bill
 105 | David
(4 rows)</code></pre>
         <p>Enfin, exécutez une opération de fusion en supprimant les lignes correspondantes dans la table cible et en insérant les lignes qui ne correspondent pas.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN DELETE
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 105 | David
(2 rows)</code></pre>
         <p>Les lignes avec les valeurs d’id 102, 103 et 104 sont supprimées de la table cible, et une nouvelle ligne avec une valeur d’id de 105 et la valeur de nom David est insérée dans la table cible.</p>
         <p>L’exemple suivant affiche une commande MERGE utilisant la clause REMOVE DUPLICATES.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (30, 'Tony'), (11, 'Alice'), (23, 'Bill');
INSERT INTO source VALUES (23, 'David'), (22, 'Clarence');

MERGE INTO target USING source ON target.id = source.id REMOVE DUPLICATES;

SELECT * FROM target;
id | name
---+------------
30 | Tony
11 | Alice
23 | David
22 | Clarence
(4 rows)</code></pre>
         <p>L’exemple suivant affiche une commande MERGE utilisant la clause REMOVE DUPLICATES, qui supprime les lignes dupliquées de <em>target_table</em> si elles ont des lignes correspondantes dans <em>source_table</em>.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (30, 'Tony'), (30, 'Daisy'), (11, 'Alice'), (23, 'Bill'), (23, 'Nikki');
INSERT INTO source VALUES (23, 'David'), (22, 'Clarence');

MERGE INTO target USING source ON target.id = source.id REMOVE DUPLICATES;

SELECT * FROM target;
id | name
---+------------
30 | Tony
30 | Daisy
11 | Alice
23 | David
22 | Clarence
(5 rows)</code></pre>
         <p>Après l’exécution de MERGE, il n’y a qu’une seule ligne avec une valeur d’ID 23 dans <em>target_table</em>. Comme aucune ligne n’avait la valeur d’ID 30 dans <em>source_table</em>, les deux lignes dupliquées avec des valeurs d’ID 30 restent dans <em>target_table</em>.</p>
       
         <h2 id="r_MERGE-see-also">Consultez aussi</h2>
         <p>
            <a href="./r_INSERT_30.html">INSERT</a>, <a href="./r_UPDATE.html">UPDATE</a>,
            <a href="./r_DELETE.html">DELETE</a>
         </p>
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_LOCK.html">LOCK</div><div id="next" class="next-link" accesskey="n" href="./r_PREPARE.html">PREPARE</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>