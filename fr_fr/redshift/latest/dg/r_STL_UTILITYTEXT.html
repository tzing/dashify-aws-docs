<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>STL_UTILITYTEXT - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_STL_UTILITYTEXT" /><meta name="default_state" content="r_STL_UTILITYTEXT" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_STL_UTILITYTEXT.html" /><meta name="description" content="Capture le texte des commandes SQL autres que SELECT exécutées sur la base de données." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guide du développeur de base de données" /><meta name="abstract" content="Créez et gérez un entrepôt de données avec Amazon Redshift, service d’entrepôt de données au niveau de l’entreprise, pouvant atteindre plusieurs Po et entièrement géré." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_STL_UTILITYTEXT.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_STL_UTILITYTEXT.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guide du développeur de base de données" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guide du développeur de base de données" /><meta id="panorama-serviceConsolePage" value="STL_UTILITYTEXT" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>STL_UTILITYTEXT - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_STL_UTILITYTEXT" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_STL_UTILITYTEXT.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_STL_UTILITYTEXT.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_STL_UTILITYTEXT.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,entrepôt de données,développeur,exemples de données,database,développeur de base de données,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide du développeur de base de données",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Informations de référence sur les tables et les vues système",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm_chap_system-tables.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Surveillance système (clusters mis en service uniquement)",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_intro_system_views.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Vues STL pour la journalisation",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_intro_STL_tables.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "STL_UTILITYTEXT",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_intro_STL_tables.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_STL_UTILITYTEXT" target="_blank" rel="noopener noreferrer" title="Ouvrir le PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guide du développeur de base de données</a></div><div id="page-toc-src"><a href="#r_STL_UTILITYTEXT-table-columns">Colonnes de la table</a><a href="#r_STL_UTILITYTEXT-sample-queries">Exemples de requêtes</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="r_STL_UTILITYTEXT">STL_UTILITYTEXT</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Capture le texte des commandes SQL autres que SELECT exécutées sur la base de données.</p><p>Interrogez la vue STL_UTILITYTEXT pour capturer le sous-ensemble suivant d’instructions SQL exécutées sur le système :</p><div class="itemizedlist">
             
             
                         
             
             
             
             
             
             
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>ABORT, BEGIN, COMMIT, END, ROLLBACK</p>
            </li><li class="listitem">
                
                <p>ANALYSE</p>
            </li><li class="listitem">
                <p>CALL</p>
            </li><li class="listitem">
                <p>ANNULER</p>
            </li><li class="listitem">
                <p>COMMENT</p>
            </li><li class="listitem">
                <p>CREATE, ALTER, DROP DATABASE</p>
            </li><li class="listitem">
                <p>CREATE, ALTER, DROP USER</p>
            </li><li class="listitem">
                <p>EXPLAIN</p>
            </li><li class="listitem">
                <p>GRANT, REVOKE</p>
            </li><li class="listitem">
                <p>LOCK</p>
            </li><li class="listitem">
                <p>RESET</p>
            </li><li class="listitem">
                <p>SET</p>
            </li><li class="listitem">
                <p>MONTRER</p>
            </li><li class="listitem">
                <p>TRUNCATE</p>
            </li></ul></div><p>Consultez aussi <a href="./r_STL_DDLTEXT.html">STL_DDLTEXT</a>, <a href="./r_STL_QUERYTEXT.html">STL_QUERYTEXT</a> et <a href="./r_SVL_STATEMENTTEXT.html">SVL_STATEMENTTEXT</a>.</p><p>Utilisez les colonnes STARTTIME et ENDTIME pour découvrir quelles instructions ont été enregistrées pendant une période donnée. Les longs blocs de texte SQL sont divisés en lignes de 200 caractères de long ; la colonne SEQUENCE identifie les fragments de texte qui appartiennent à une seule instruction.</p><p>STL__UTILITYTEXT est visible par tous les utilisateurs. Les super-utilisateurs peuvent voir toutes les lignes, tandis que les utilisateurs standard peuvent voir uniquement leurs propres données. Pour plus d'informations, consultez <a href="./cm_chap_system-tables.html#c_visibility-of-data">Visibilité des données dans les tables et vues système</a>.</p><p>Tout ou partie des données de cette table sont également disponibles dans la vue de surveillance SYS <a href="./SYS_QUERY_HISTORY.html">SYS_QUERY_HISTORY</a>. Les données de la vue de surveillance SYS sont formatées pour être plus faciles à utiliser et à comprendre. Nous vous recommandons d’utiliser la vue de surveillance SYS pour vos requêtes.</p>
            <h2 id="r_STL_UTILITYTEXT-table-columns">Colonnes de la table</h2>


            <div class="table-container"><div class="table-contents"><table id="w319aac49c17b9d109c17b3"><thead>
                        <tr>
                            <th>Nom de la colonne </th>
                            <th>Type de données </th>
                            <th>Description </th>
                        </tr>
                    </thead>
                        <tr>
                            <td tabindex="-1">userid</td>
                            <td tabindex="-1">entier</td>
                            <td tabindex="-1">ID de l’utilisateur qui a généré l’entrée.</td>
                        </tr>
                        <tr>
                            <td tabindex="-1">xid </td>
                            <td tabindex="-1">bigint </td>
                            <td tabindex="-1">ID de transaction. </td>
                        </tr>
                        <tr>
                            <td tabindex="-1">pid </td>
                            <td tabindex="-1">entier </td>
                            <td tabindex="-1">ID de processus associé à l’instruction de la requête. </td>
                        </tr>
                        <tr>
                            <td tabindex="-1">étiquette </td>
                            <td tabindex="-1">caractère (320) </td>
                            <td tabindex="-1">Le nom du fichier utilisé pour exécuter la requête ou une étiquette définie avec une commande SET QUERY_GROUP. Si la requête n’est pas basée sur un fichier ou si le paramètre QUERY_GROUP n’est pas défini, le champ est vide. </td>
                        </tr>
                        <tr>
                            <td tabindex="-1">starttime</td>
                            <td tabindex="-1">timestamp</td>
                            <td tabindex="-1">Heure au format UTC du début de la requête. Le temps total inclut la mise en file d'attente et l'exécution avec 6 chiffres de précision pour les fractions de secondes. Par exemple : <code class="userinput">2009-06-12 11:29:19.131358</code>.</td>
                        </tr>
                        <tr>
                            <td tabindex="-1">endtime</td>
                            <td tabindex="-1">timestamp</td>
                            <td tabindex="-1">Heure au format UTC de l’exécution de la requête. Le temps total inclut la mise en file d'attente et l'exécution avec 6 chiffres de précision pour les fractions de secondes. Par exemple : <code class="userinput">2009-06-12 11:29:19.131358</code>.</td>
                        </tr>
                        <tr>
                            <td tabindex="-1">sequence </td>
                            <td tabindex="-1">entier </td>
                            <td tabindex="-1">Lorsqu’une seule instruction contient plus de 200 caractères, des lignes supplémentaires sont enregistrées pour l’instruction. Sequence 0 correspond à la première ligne, 1 à la deuxième, et ainsi de suite. </td>
                        </tr>
                        <tr>
                            <td tabindex="-1">text </td>
                            <td tabindex="-1">character(200) </td>
                            <td tabindex="-1">Texte SQL, par incréments de 200 caractères. Ce champ peut contenir des caractères spéciaux tels qu’une barre oblique inverse (<code class="code">\\</code>) et un caractère de saut de ligne (<code class="code">\n</code>).</td>
                        </tr>
                    </table></div></div>
         
            <h2 id="r_STL_UTILITYTEXT-sample-queries">Exemples de requêtes</h2>


            <p>La requête suivante renvoie le texte des commandes « utility » exécutées le 26 janvier 2012. Dans ce cas, quelques commandes SET et une commande SHOW ALL ont été exécutées : </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select starttime, sequence, rtrim(text)
from stl_utilitytext
where starttime like '2012-01-26%'
order by starttime, sequence;

starttime          | sequence |              rtrim
---------------------------+-----+----------------------------------
2012-01-26 13:05:52.529235 |   0 | show all;
2012-01-26 13:20:31.660255 |   0 | SET query_group to ''
2012-01-26 13:20:54.956131 |   0 | SET query_group to 'soldunsold.sql'
...</code></pre>
             
                <h3 id="r_STL_UTILITYTEXT-reconstruct-sql">Reconstruction de SQL stocké</h3>
                <p>Pour reconstruire le SQL stocké dans la colonne <code class="code">text</code> de STL_UTILITYTEXT, exécutez une instruction SELECT pour créer SQL depuis une ou plusieurs parties de la colonne <code class="code">text</code>. Avant d’exécuter le SQL reconstruit, remplacez tout caractère spécial (<code class="code">\n</code>) par un saut de ligne. Le résultat de l’instruction SELECT suivante se compose de lignes de SQL reconstruit dans le champ <code class="code">query_statement</code>.</p>
                
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT LISTAGG(CASE WHEN LEN(RTRIM(text)) = 0 THEN text ELSE RTRIM(text) END) WITHIN GROUP (ORDER BY sequence) as query_statement 
FROM stl_utilitytext GROUP BY xid order by xid;</code></pre>
                
                <p>Par exemple, la requête suivante définit une chaîne de zéros pour query_group. La requête elle-même contient plus de 200 caractères et est stockée dans plusieurs parties de STL_UTILITYTEXT.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">set query_group to '00000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000                  000000';</code></pre>
                
                <p>Dans cet exemple, la requête est stockée dans deux parties (lignes) de la colonne <code class="code">text</code> de STL_UTILITYTEXT.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">select query, sequence, text
from stl_utilitytext where query=pg_last_query_id() order by query desc, sequence limit 10;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">

         starttime          | sequence |                                                                                                   text                                                                                                   
----------------------------+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 2019-07-23 22:55:34.926198 |        0 | set query_group to '00000000000000000000000000000000000000000000000000000000000000000000000000000000\n0000000000000000000000000000000000000000000000000000000000000000000000000000000000
 2019-07-23 22:55:34.926198 |        1 |                   000000';</code></pre>
                             
                <p>Pour reconstruire le SQL stocké dans STL_UTILITYTEXT, exécutez le SQL suivant. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select LISTAGG(CASE WHEN LEN(RTRIM(text)) = 0 THEN text ELSE RTRIM(text) END, '') within group (order by sequence) AS query_statement 
from stl_utilitytext where query=pg_last_query_id();
</code></pre>
                <p>Pour utiliser le SQL reconstruit qui en résulte dans votre client, remplacez tout caractère spécial (<code class="code">\n</code>) par un saut de ligne. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
                                                                                                                                      query_statement                                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 set query_group to '00000000000000000000000000000000000000000000000000000000000000000000000000000000\n0000000000000000000000000000000000000000000000000000000000000000000000000000000000                  000000';
 </code></pre> 
                           
      
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_STL_USERLOG.html">STL_USERLOG</div><div id="next" class="next-link" accesskey="n" href="./r_STL_VACUUM.html">STL_VACUUM</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_STL_UTILITYTEXT.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_STL_UTILITYTEXT.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>