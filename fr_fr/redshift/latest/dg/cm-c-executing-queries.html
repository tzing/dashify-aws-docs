<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Affectation des requêtes à des files d’attente - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="cm-c-executing-queries" /><meta name="default_state" content="cm-c-executing-queries" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm-c-executing-queries.html" /><meta name="description" content="Trouvez des exemples sur la façon d’affecter des requêtes aux files d’attente en fonction des rôles utilisateurs, des groupes d’utilisateurs et des groupes de requêtes dans Amazon Redshift." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guide du développeur de base de données" /><meta name="abstract" content="Créez et gérez un entrepôt de données avec Amazon Redshift, service d’entrepôt de données au niveau de l’entreprise, pouvant atteindre plusieurs Po et entièrement géré." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm-c-executing-queries.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/cm-c-executing-queries.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/cm-c-executing-queries.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/cm-c-executing-queries.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/cm-c-executing-queries.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/cm-c-executing-queries.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/cm-c-executing-queries.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/cm-c-executing-queries.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/cm-c-executing-queries.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm-c-executing-queries.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm-c-executing-queries.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/cm-c-executing-queries.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/cm-c-executing-queries.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/cm-c-executing-queries.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/cm-c-executing-queries.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/cm-c-executing-queries.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/cm-c-executing-queries.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/cm-c-executing-queries.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/cm-c-executing-queries.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/cm-c-executing-queries.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/cm-c-executing-queries.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/cm-c-executing-queries.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guide du développeur de base de données" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guide du développeur de base de données" /><meta id="panorama-serviceConsolePage" value="Affectation des requêtes à des files d’attente" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Affectation des requêtes à des files d’attente - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#cm-c-executing-queries" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm-c-executing-queries.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm-c-executing-queries.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm-c-executing-queries.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,entrepôt de données,développeur,exemples de données,database,développeur de base de données,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide du développeur de base de données",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Implémentation de la gestion de la charge de travail",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm-c-implementing-workload-management.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Affectation des requêtes à des files d’attente",
        "item" : "https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm-c-implementing-workload-management.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#cm-c-executing-queries" target="_blank" rel="noopener noreferrer" title="Ouvrir le PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guide du développeur de base de données</a></div><div id="page-toc-src"><a href="#cm-c-executing-queries-assigning-queries-to-queues-based-on-user-roles">Affectation des requêtes aux files d’attente en fonction des rôles utilisateurs</a><a href="#cm-c-executing-queries-assigning-queries-to-queues-based-on-user-groups">Affectation des requêtes aux files d’attente en fonction des groupes d’utilisateurs</a><a href="#cm-c-executing-queries-assigning-a-query-to-a-query-group">Affectation d’une requête à un groupe de requêtes</a><a href="#cm-c-executing-queries-assigning-superuser-queue">Affectation des requêtes à la file d’attente Super-utilisateur</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="cm-c-executing-queries">Affectation des requêtes à des files d’attente</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Les exemples suivants affectent des requêtes à des files d’attente en fonction des rôles utilisateurs, des groupes d’utilisateurs et des groupes de requêtes.</p>
         <h2 id="cm-c-executing-queries-assigning-queries-to-queues-based-on-user-roles"> Affectation des requêtes aux files d’attente en fonction des rôles utilisateurs</h2>
         <p> Si un utilisateur se voit attribuer un rôle associé à une file d’attente, les requêtes exécutées par cet utilisateur sont affectées à cette file d’attente. L’exemple suivant crée un rôle utilisateur nommé <code class="code">sales_rw</code> et attribue ce rôle à l’utilisateur <code class="code">test_user</code>. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create role sales_rw;
grant role sales_rw to test_user;
</code></pre>
         <p>Vous pouvez également combiner les autorisations de deux rôles en attribuant explicitement un rôle à un autre rôle. L’attribution d’un rôle imbriqué à un utilisateur permet à l’utilisateur d’accéder aux deux rôles.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create role sales_rw;
create role sales_ro;
grant role sales_ro to role sales_rw;
grant role sales_rw to test_user;
</code></pre>
         <p>Pour voir la liste des utilisateurs auxquels des rôles ont été attribués dans le cluster, consultez la table SVV_USER_GRANTS. Pour voir la liste des rôles auxquels des rôles ont été attribués dans le cluster, consultez la table SVV_ROLE_GRANTS.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select * from svv_user_grants;
select * from svv_role_grants;</code></pre>
       
         <h2 id="cm-c-executing-queries-assigning-queries-to-queues-based-on-user-groups">Affectation des requêtes aux files d’attente en fonction des groupes d’utilisateurs</h2>


         <p>Si un nom de groupe d’utilisateurs est répertorié dans une définition de file d’attente, les requêtes exécutées par des membres de ce groupe d’utilisateurs sont affectées à la file d’attente correspondante. L’exemple suivant crée des groupes d’utilisateurs et ajoute des utilisateurs à des groupes à l’aide des commandes SQL <a href="./r_CREATE_USER.html">CREATE USER</a>, <a href="./r_CREATE_GROUP.html">CREATE GROUP</a> et <a href="./r_ALTER_GROUP.html">ALTER GROUP</a>.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create group admin_group with user admin246, admin135, sec555;
create user vp1234 in group ad_hoc_group password 'vpPass1234';
alter group admin_group add user analyst44, analyst45, analyst46;  </code></pre>
       
         <h2 id="cm-c-executing-queries-assigning-a-query-to-a-query-group">Affectation d’une requête à un groupe de requêtes</h2>


         <p>Vous pouvez affecter une requête à une file d’attente lors de l’exécution en affectant votre requête au groupe de requêtes approprié. Utilisez la commande SET pour commencer un groupe de requêtes.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">SET query_group TO <em><code class="replaceable">group_label</code></em>             </code></pre>
         <p>Ici, <code class="replaceable"><code class="code">group_label</code></code> est une étiquette de groupe de requête qui est répertoriée dans la configuration de WLM.</p>
         <p>Toutes les requêtes que vous exécutez après l’exécution de la commande <code class="code">SET query_group</code> s’exécutent comme membres du groupe de requêtes spécifié jusqu’à ce que vous réinitialisiez le groupe de requêtes ou que vous mettiez fin à votre session de connexion actuelle. Pour plus d’informations sur la définition et la réinitialisation des objets Amazon Redshift, consultez <a href="./r_SET.html">SET</a> et <a href="./r_RESET.html">RESET</a> dans le Guide de référence des commandes SQL.</p>
         <p>Les étiquettes de groupe de requêtes que vous spécifiez doivent être incluses dans la configuration WLM actuelle, sinon la commande <em>SET query_group</em> n’aura aucune incidence sur les files d’attente de requêtes.</p>
         <p>L’étiquette définie dans la clause TO est capturée dans les journaux de requêtes afin que vous puissiez utiliser l’étiquette à des fins de résolution de problèmes. Pour plus d’informations sur le paramètre de configuration query_group, consultez <a href="./r_query_group.html">query_group</a> dans la Référence de configuration.</p>
         <p>L’exemple suivant exécute deux requêtes dans le cadre du groupe de requêtes ’priority’, puis réinitialise le groupe de requêtes.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">set query_group to 'priority';
select count(*)from stv_blocklist;
select query, elapsed, substring from svl_qlog order by query desc limit 5; 
reset query_group;           </code></pre>

       
         <h2 id="cm-c-executing-queries-assigning-superuser-queue">Affectation des requêtes à la file d’attente Super-utilisateur</h2>


         <p>Pour affecter une requête à la file d’attente superutilisateur, connectez-vous à Amazon Redshift en tant que superutilisateur, puis exécutez la requête dans le groupe de celui-ci. Une fois terminé, réinitialisez le groupe de requêtes afin que les requêtes suivantes ne s’exécutent pas dans la file d’attente Super-utilisateur.</p>
         <p>L’exemple suivant affecte deux commandes à exécuter dans la file d’attente Super-utilisateur.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">set query_group to 'superuser';

analyze;
vacuum; 
reset query_group;</code></pre>
         <p>Pour afficher la liste des super-utilisateurs, interrogez la table catalogue système PG_USER.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select * from pg_user where usesuper = 'true';</code></pre>
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./cm-c-wlm-queue-assignment-rules.html">Règles d’affectation de file d’attente de WLM</div><div id="next" class="next-link" accesskey="n" href="./cm-c-wlm-dynamic-properties.html">Propriétés dynamiques et statiques</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm-c-executing-queries.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/cm-c-executing-queries.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>