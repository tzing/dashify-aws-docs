<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="de-DE"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>MERGE - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_MERGE" /><meta name="default_state" content="r_MERGE" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" /><meta name="description" content="Fügt basierend auf Werten aus einer Quelltabelle Werte in eine Tabelle ein, aktualisiert und löscht sie." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Datenbankentwicklerhandbuch" /><meta name="abstract" content="Erstellen und verwalten Sie ein Data Warehouse mit Amazon Redshift, einem vollständig verwalteten Petabyte-Data-Warehousing-Service auf Unternehmensniveau." /><meta name="guide-locale" content="de_de" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_MERGE.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_MERGE.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_MERGE.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_MERGE.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_MERGE.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_MERGE.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_MERGE.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_MERGE.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Datenbankentwicklerhandbuch" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Datenbankentwicklerhandbuch" /><meta id="panorama-serviceConsolePage" value="MERGE" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>MERGE - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_MERGE" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,Cluster,Data Warehouse,Developer,Musterdaten,Datenbank,Database Developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Datenbankentwicklerhandbuch",
        "item" : "https://docs.aws.amazon.com/de_de/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "SQL-Referenz",
        "item" : "https://docs.aws.amazon.com/de_de/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "SQL-Befehle",
        "item" : "https://docs.aws.amazon.com/de_de/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "MERGE",
        "item" : "https://docs.aws.amazon.com/de_de/redshift/latest/dg/c_SQL_commands.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_MERGE" target="_blank" rel="noopener noreferrer" title="PDF öffnen"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Dokumentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Datenbankentwicklerhandbuch</a></div><div id="page-toc-src"><a href="#r_MERGE-synopsis">Syntax</a><a href="#r_MERGE-parameters">Parameter</a><a href="#r_MERGE_usage_notes">Nutzungshinweise</a><a href="#sub-examples-merge">Beispiele</a><a href="#r_MERGE-see-also">Weitere Informationen finden Sie auch unter</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Die vorliegende Übersetzung wurde maschinell erstellt. Im Falle eines Konflikts oder eines Widerspruchs zwischen dieser übersetzten Fassung und der englischen Fassung (einschließlich infolge von Verzögerungen bei der Übersetzung) ist die englische Fassung maßgeblich.</p></awsui-alert><h1 class="topictitle" id="r_MERGE">MERGE</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Führt Zeilen aus einer Quelltabelle bedingt in einer Zieltabelle zusammen. Herkömmlicherweise ist dies nur durch separate Verwendung mehrerer Insert-, Update- oder Delete-Anweisungen möglich. Weitere Informationen zu den Operationen, die Sie mithilfe von MERGE kombinieren können, finden Sie unter <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_UPDATE.html">UPDATE</a>, <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_DELETE.html">DELETE</a> und <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_INSERT_30.html">INSERT</a>.</p>
         <h2 id="r_MERGE-synopsis">Syntax</h2>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">MERGE INTO <em>target_table</em> 
USING <em>source_table</em> [ [ AS ] <em>alias</em> ] 
ON <em>match_condition</em> 
[ WHEN MATCHED THEN <span>{</span> UPDATE SET <em>col_name</em> = <span>{</span> <em>expr</em> } [,...] | DELETE }
WHEN NOT MATCHED THEN INSERT [ ( <em>col_name</em> [,...] ) ] VALUES ( <span>{</span> <em>expr</em> } [, ...] ) |
REMOVE DUPLICATES ]</code></pre>

       
         <h2 id="r_MERGE-parameters">Parameter</h2>
         <div class="variablelist">
             
             
             
             
            
             
             
             

             
             
             
             
             
         <dl>
               <dt><span class="term"> <em>target_table</em></span></dt>
               <dd>
                  <p>Die temporäre oder permanente Tabelle, in die die MERGE-Anweisung zusammengeführt wird.</p>
               </dd>
             
               <dt><span class="term"> <em>source_table</em></span></dt>
               <dd>
                  <p>Die temporäre oder permanente Tabelle, die die Zeilen bereitstellt, die in <em>target_table</em>  zusammengeführt werden sollen. Als <em>source_table</em> kommen auch Spectrum-Tabellen infrage. <em>source_table</em> kann keine Ansicht oder Unterabfrage sein.</p>
               </dd>
             
               <dt><span class="term"> <em>alias</em></span></dt>
               <dd>
                  <p>Der temporäre alternative Name für <em>source_table</em>.</p>
                  <p>Dieser Parameter ist optional. Optional kann dem <em>Alias</em> auch AS vorangestellt sein.</p>
               </dd>
             
               <dt><span class="term"> <em>match_condition</em></span></dt>
               <dd>
                  <p>Gibt übereinstimmende Prädikate zwischen der Quelltabellenspalte und der Zieltabellenspalte an, anhand derer bestimmt wird, ob die Zeilen in <em>source_table</em> mit Zeilen in <em>target_table</em> abgeglichen werden können. Wenn die Bedingung erfüllt ist, führt MERGE <em>matched_clause</em> für diese Zeile aus. Andernfalls führt MERGE <em>not_matched_clause</em> für diese Zeile aus.</p>
               </dd>
             
               <dt><span class="term">WHEN MATCHED</span></dt>
               <dd>
                  <p> Gibt die Aktion an, die ausgeführt werden soll, wenn die Übereinstimmungsbedingung zwischen einer Quell- und einer Zielzeile „True“ (Wahr) ergibt. Sie können entweder eine UPDATE-Aktion oder eine DELETE-Aktion angeben. </p>
               </dd>
             
               <dt><span class="term">UPDATE</span></dt>
               <dd><p> Aktualisiert die übereinstimmende Zeile in <em>target_table</em>. Nur Werte in dem von Ihnen angegebenen <em>col_name</em> werden aktualisiert. </p></dd>
             
               <dt><span class="term">DELETE</span></dt>
               <dd><p> Löscht die übereinstimmende Zeile in <em>target_table</em>. </p></dd>
             
               <dt><span class="term">WHEN NOT MATCHED</span></dt>
               <dd>
                  <p> Gibt die Aktion an, die ausgeführt werden soll, wenn die Übereinstimmungsbedingung „False“ (Falsch) oder „Unknown“ (Unbekannt) ergibt. Sie können nur die INSERT-Einfügeaktion für diese Klausel angeben. </p>
               </dd>
             
               <dt><span class="term">INSERT</span></dt>
               <dd><p> Fügt eine Zeile in <em>target_table</em> ein. Der Ziel-<em>col_name</em> kann in beliebiger Reihenfolge aufgelistet werden. Wenn Sie keine <em>col_name</em>-Werte angeben, werden standardmäßig alle Spalten der Tabelle in ihrer deklarierten Reihenfolge angeordnet. </p></dd>
             
               <dt><span class="term"> <em>col_name</em></span></dt>
               <dd>
                  <p>Ein oder mehrere Spaltennamen, die Sie ändern möchten. Beziehen Sie den Tabellennamen bei der Angabe der Zielspalte nicht ein.</p>
               </dd>
             
               <dt><span class="term"> <em>expr</em></span></dt>
               <dd>
                  <p>Der Ausdruck, der den neuen Wert für <em>col_name</em> definiert.</p>
               </dd>
             
               <dt><span class="term"> REMOVE DUPLICATES</span></dt>
               <dd>
                  <p>Gibt an, dass der MERGE-Befehl im vereinfachten Modus ausgeführt wird. Für den vereinfachten Modus gelten folgende Anforderungen:</p>
                  <div class="itemizedlist">
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem"><p> <em>target_table</em> und <em>source_table</em> müssen dieselbe Anzahl von Spalten und kompatible Spaltentypen haben. </p></li><li class="listitem"><p> Lassen Sie die WHEN-Klausel und die UPDATE- und INSERT-Klauseln in Ihrem MERGE-Befehl weg. </p></li><li class="listitem"><p> Verwenden Sie die REMOVE DUPLICATES-Klausel in Ihrem MERGE-Befehl. </p></li></ul></div>
                  <p>Im vereinfachten Modus bewirkt MERGE Folgendes:</p>
                  <div class="itemizedlist">
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem"><p> Zeilen in <em>target_table</em>, die eine Übereinstimmung in <em>source_table</em> haben, werden aktualisiert, so dass sie den Werten in <em>source_table</em> entsprechen. </p></li><li class="listitem"><p> Zeilen in <em>source_table</em>, die keine Übereinstimmung in <em>target_table</em> haben, werden in <em>target_table</em> eingefügt. </p></li><li class="listitem"><p> Wenn mehrere Zeilen in <em>target_table</em> mit derselben Zeile in <em>source_table</em> übereinstimmen, werden die doppelten Zeilen entfernt. Amazon Redshift behält eine Zeile bei und aktualisiert sie. Doppelte Zeilen, die keiner Zeile in <em>source_table</em> entsprechen, bleiben unverändert. </p></li></ul></div>
                  <p>Die Verwendung von REMOVE DUPLICATES bietet eine bessere Leistung als die Verwendung von WHEN MATCHED und WHEN NOT MATCHED. Wir empfehlen die Verwendung von REMOVE DUPLICATES, wenn <em>target_table</em> und <em>source_table</em> kompatibel sind und Sie keine doppelten Zeilen in <em>target_table</em> beibehalten müssen.</p>
               </dd>
            </dl></div>
       
         <h2 id="r_MERGE_usage_notes">Nutzungshinweise</h2>
         <div class="itemizedlist">
             
             
             
             
             
             
            
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>Um MERGE-Anweisungen ausführen zu können, müssen Sie sowohl Besitzer von <em>source_table</em> als auch von <em>target_table</em> sein oder über die SELECT-Berechtigung für diese Tabellen verfügen. Darüber hinaus benötigen Sie UPDATE-, DELETE- und INSERT-Berechtigungen für <em>target_table</em>, je nachdem, welche Operationen in Ihrer MERGE-Anweisung enthalten sind.</p>
            </li><li class="listitem">
               <p> <em>target_table</em> kann keine Systemtabelle, Katalogtabelle oder externe Tabelle sein. </p>
            </li><li class="listitem">
               <p> <em>source_table</em> und <em>target_table</em> können nicht dieselbe Tabelle sein. </p>
            </li><li class="listitem">
               <p> Sie können die WITH-Klausel nicht in einer MERGE-Anweisung verwenden. </p>
            </li><li class="listitem">
               <p> Zeilen in <em>target_table</em> können nicht mit mehreren Zeilen in <em>source_table</em> übereinstimmen. </p>
               <p>Betrachten Sie das folgende Beispiel:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (1, 'Bob'), (2, 'John');
INSERT INTO source VALUES (1, 'Tony'), (1, 'Alice'), (3, 'Bill');

MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN UPDATE SET id = source.id, name = source.name
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);
ERROR: Found multiple matches to update the same tuple.

MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN DELETE
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);
ERROR: Found multiple matches to update the same tuple.</code></pre>
               <p>Bei beiden MERGE-Anweisungen schlägt der Vorgang fehl, da es mehrere Zeilen in der <code class="code">source</code>-Tabelle mit einem ID-Wert von <code class="code">1</code> gibt.</p>
            </li><li class="listitem">
               <p> <em>match_condition</em> und <em>expr</em> können nicht teilweise auf Spalten vom Typ SUPER verweisen. Wenn Ihr Objekt vom Typ SUPER beispielsweise ein Array oder eine Struktur ist, können Sie nicht einzelne Elemente dieser Spalte für <em>match_condition</em> oder <em>expr</em> verwenden, die gesamte Spalte dagegen schon. </p>
               <p>Betrachten Sie das folgende Beispiel:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE IF NOT EXISTS target (key INT, value SUPER);
CREATE TABLE IF NOT EXISTS source (key INT, value SUPER);

INSERT INTO target VALUES (1, JSON_PARSE('<span>{</span>"key": 88}'));
INSERT INTO source VALUES (1, ARRAY(1, 'John')), (2, ARRAY(2, 'Bill'));

MERGE INTO target USING source ON target.key = source.key
WHEN matched THEN UPDATE SET value = source.value[0]
WHEN NOT matched THEN INSERT VALUES (source.key, source.value[0]);
ERROR: Partial reference of SUPER column is not supported in MERGE statement.</code></pre>
               <p>Weitere Informationen zum Typ SUPER finden Sie unter <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SUPER_type.html">Typ SUPER</a>.</p>
            </li><li class="listitem">
               <p>Bei einer großen <em>source_table</em> kann die Leistung verbessert werden, indem die Join-Spalten von <em>target_table</em> und <em>source_table</em> als Verteilungsschlüssel definiert werden.</p>
            </li><li class="listitem">
               <p>Um die REMOVE DUPLICATES-Klausel benutzen zu können, benötigen Sie die SELECT-, INSERT- und DELETE-Berechtigungen für <em>target_table</em>.</p>
            </li></ul></div>
       
         <h2 id="sub-examples-merge">Beispiele</h2>
         <p>Im folgenden Beispiel werden zwei Tabellen erstellt und anschließend wird eine MERGE-Operation für sie ausgeführt. Dabei werden übereinstimmende Zeilen in der Zieltabelle aktualisiert und nicht übereinstimmende Zeilen eingefügt. Daraufhin wird ein weiterer Wert in die Quelltabelle eingefügt und eine weitere MERGE-Operation ausgeführt. Dieses Mal werden dabei übereinstimmende Zeilen gelöscht und die neue Zeile aus der Quelltabelle wird eingefügt.</p>
         <p>Erstellen Sie zunächst die Quell- und Zieltabellen und füllen Sie sie aus.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (101, 'Bob'), (102, 'John'), (103, 'Susan');
INSERT INTO source VALUES (102, 'Tony'), (103, 'Alice'), (104, 'Bill');

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 102 | John
 103 | Susan
(3 rows)

SELECT * FROM source;
 id  |    name
-----+------------
 102 | Tony
 103 | Alice
 104 | Bill
(3 rows)</code></pre>
         <p>Führen Sie anschließend die Quelltabelle mit der Zieltabelle zusammen. Aktualisieren Sie dabei die Zieltabelle mit übereinstimmenden Zeilen und fügen Sie Zeilen aus der Quelltabelle ein, zu denen es keine Übereinstimmung gibt.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN UPDATE SET id = source.id, name = source.name
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 102 | Tony
 103 | Alice
 104 | Bill
(4 rows)</code></pre>
         <p>Beachten Sie, dass die Zeilen mit den ID-Werten 102 und 103 aktualisiert werden, sodass sie den Namenswerten aus der Zieltabelle entsprechen. Außerdem wird eine neue Zeile mit dem ID-Wert 104 und dem Namenswert „Bill“ in die Zieltabelle eingefügt.</p>
         <p>Fügen Sie als Nächstes eine neue Zeile in die Quelltabelle ein.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">INSERT INTO source VALUES (105, 'David');

SELECT * FROM source;
 id  |    name
-----+------------
 102 | Tony
 103 | Alice
 104 | Bill
 105 | David
(4 rows)</code></pre>
         <p>Führen Sie abschließend eine Merge-Operation aus. Löschen Sie dabei übereinstimmende Zeilen in der Zieltabelle und fügen Sie nicht übereinstimmende Zeilen ein.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN DELETE
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 105 | David
(2 rows)</code></pre>
         <p>Die Zeilen mit den ID-Werten 102, 103 und 104 werden aus der Zieltabelle gelöscht, und eine neue Zeile mit dem ID-Wert 105 und dem Namenswert „David“ wird in die Zieltabelle eingefügt.</p>
         <p>Das folgende Beispiel zeigt einen MERGE-Befehl unter Verwendung der REMOVE DUPLICATES-Klausel.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (30, 'Tony'), (11, 'Alice'), (23, 'Bill');
INSERT INTO source VALUES (23, 'David'), (22, 'Clarence');

MERGE INTO target USING source ON target.id = source.id REMOVE DUPLICATES;

SELECT * FROM target;
id | name
---+------------
30 | Tony
11 | Alice
23 | David
22 | Clarence
(4 rows)</code></pre>
         <p>Das folgende Beispiel zeigt einen MERGE-Befehl, der die REMOVE DUPLICATES-Klausel benutzt und doppelte Zeilen aus <em>target_table</em> entfernt, wenn sie übereinstimmende Zeilen in <em>source_table</em> haben.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (30, 'Tony'), (30, 'Daisy'), (11, 'Alice'), (23, 'Bill'), (23, 'Nikki');
INSERT INTO source VALUES (23, 'David'), (22, 'Clarence');

MERGE INTO target USING source ON target.id = source.id REMOVE DUPLICATES;

SELECT * FROM target;
id | name
---+------------
30 | Tony
30 | Daisy
11 | Alice
23 | David
22 | Clarence
(5 rows)</code></pre>
         <p>Nach der Ausführung von MERGE gibt es in <em>target_table</em> nur eine Zeile mit dem ID-Wert 23. Da es in <em>source_table</em> keine Zeile mit dem ID-Wert 30 gab, verbleiben die beiden doppelten Zeilen mit den ID-Werten 30 in <em>target_table</em>.</p>
       
         <h2 id="r_MERGE-see-also">Weitere Informationen finden Sie auch unter</h2>
         <p>
            <a href="./r_INSERT_30.html">INSERT</a>, <a href="./r_UPDATE.html">UPDATE</a>,
            <a href="./r_DELETE.html">DELETE</a>
         </p>
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warnung" /> <strong>JavaScript ist in Ihrem Browser nicht verfügbar oder deaktiviert.</strong></p><p>Zur Nutzung der AWS-Dokumentation muss JavaScript aktiviert sein. Weitere Informationen finden auf den Hilfe-Seiten Ihres Browsers.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Dokumentkonventionen</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_LOCK.html">LOCK</div><div id="next" class="next-link" accesskey="n" href="./r_PREPARE.html">PREPARE</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Hat Ihnen diese Seite geholfen? – Ja</div><div class="content"><p>Vielen Dank, dass Sie uns mitgeteilt haben, dass wir gute Arbeit geleistet haben!</p><p>Würden Sie sich einen Moment Zeit nehmen, um uns mitzuteilen, was wir richtig gemacht haben, damit wir noch besser werden?</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Hat Ihnen diese Seite geholfen? – Nein</div><div class="content"><p>Vielen Dank, dass Sie uns mitgeteilt haben, dass diese Seite überarbeitet werden muss. Es tut uns Leid, dass wir Ihnen nicht weiterhelfen konnten.</p><p>Würden Sie sich einen Moment Zeit nehmen, um uns mitzuteilen, wie wir die Dokumentation verbessern können?</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>