<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="de-DE"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Beispiele für PIVOT und UNPIVOT - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_FROM_clause-pivot-unpivot-examples" /><meta name="default_state" content="r_FROM_clause-pivot-unpivot-examples" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" /><meta name="description" content="Enthält Beispiele für die Ausgabe von Zeilen in Spalten mit PIVOT oder von Spalten in Zeilen mit UNPIVOT." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Datenbankentwicklerhandbuch" /><meta name="abstract" content="Erstellen und verwalten Sie ein Data Warehouse mit Amazon Redshift, einem vollständig verwalteten Petabyte-Data-Warehousing-Service auf Unternehmensniveau." /><meta name="guide-locale" content="de_de" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Datenbankentwicklerhandbuch" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Datenbankentwicklerhandbuch" /><meta id="panorama-serviceConsolePage" value="Beispiele für PIVOT und UNPIVOT" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Beispiele für PIVOT und UNPIVOT - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_FROM_clause-pivot-unpivot-examples" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,Cluster,Data Warehouse,Developer,Musterdaten,Datenbank,Database Developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Datenbankentwicklerhandbuch",
        "item" : "https://docs.aws.amazon.com/de_de/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "SQL-Referenz",
        "item" : "https://docs.aws.amazon.com/de_de/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "SQL-Befehle",
        "item" : "https://docs.aws.amazon.com/de_de/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "SELECT",
        "item" : "https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_SELECT_synopsis.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "FROM-Klausel",
        "item" : "https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_FROM_clause30.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "Beispiele für PIVOT und UNPIVOT",
        "item" : "https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_FROM_clause30.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_FROM_clause-pivot-unpivot-examples" target="_blank" rel="noopener noreferrer" title="PDF öffnen"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Dokumentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Datenbankentwicklerhandbuch</a></div><div id="page-toc-src"><a href="#r_FROM_clause-pivot-examples">Beispiele für PIVOT</a><a href="#r_FROM_clause-unpivot-examples">Beispiele für UNPIVOT</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Die vorliegende Übersetzung wurde maschinell erstellt. Im Falle eines Konflikts oder eines Widerspruchs zwischen dieser übersetzten Fassung und der englischen Fassung (einschließlich infolge von Verzögerungen bei der Übersetzung) ist die englische Fassung maßgeblich.</p></awsui-alert><h1 class="topictitle" id="r_FROM_clause-pivot-unpivot-examples">Beispiele für PIVOT und UNPIVOT</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>PIVOT und UNPIVOT sind Parameter in der FROM-Klausel, die die Abfrageausgabe von Zeilen in Spalten bzw. von Spalten in Zeilen drehen. Sie stellen tabellarische Abfrageergebnisse in einem leicht lesbaren Format dar. In den folgenden Beispielen wird anhand von Testdaten und Abfragen ihre Verwendung dargestellt.</p><p>Weitere Informationen zu diesen und anderen Parametern finden Sie unter <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_FROM_clause30.html">FROM-Klausel</a>.</p>
               <h2 id="r_FROM_clause-pivot-examples">Beispiele für PIVOT</h2>
               <p>Richten Sie die Beispieltabelle und -daten ein und verwenden Sie sie, um die folgenden Beispielabfragen auszuführen.</p>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE part (
    partname varchar,
    manufacturer varchar,
    quality int,
    price decimal(12, 2)
);

INSERT INTO part VALUES ('prop', 'local parts co', 2, 10.00);
INSERT INTO part VALUES ('prop', 'big parts co', NULL, 9.00);
INSERT INTO part VALUES ('prop', 'small parts co', 1, 12.00);

INSERT INTO part VALUES ('rudder', 'local parts co', 1, 2.50);
INSERT INTO part VALUES ('rudder', 'big parts co', 2, 3.75);
INSERT INTO part VALUES ('rudder', 'small parts co', NULL, 1.90);

INSERT INTO part VALUES ('wing', 'local parts co', NULL, 7.50);
INSERT INTO part VALUES ('wing', 'big parts co', 1, 15.20);
INSERT INTO part VALUES ('wing', 'small parts co', NULL, 11.80);</code></pre>

               <p>PIVOT auf <code class="code">partname</code> mit einer <code class="code">AVG</code>-Aggregation auf <code class="code">price</code>.</p>
   
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT *
FROM (SELECT partname, price FROM part) PIVOT (
    AVG(price) FOR partname IN ('prop', 'rudder', 'wing')
);</code></pre>
               <p>Die Abfrage führt zur folgenden Ausgabe.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">  prop   |  rudder  |  wing
---------+----------+---------
 10.33   | 2.71     | 11.50</code></pre>
               <p>Im vorherigen Beispiel werden die Ergebnisse in Spalten umgewandelt. Das folgende Beispiel zeigt eine <code class="code">GROUP BY</code>-Abfrage, die die Durchschnittspreise in Zeilen und nicht in Spalten zurückgibt.</p>
 
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT partname, avg(price)
FROM (SELECT partname, price FROM part)
WHERE partname IN ('prop', 'rudder', 'wing')
GROUP BY partname;</code></pre>
               <p>Die Abfrage führt zur folgenden Ausgabe.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class=""> partname |  avg
----------+-------
 prop     | 10.33
 rudder   |  2.71
 wing     | 11.50</code></pre>
               <p>Ein <code class="code">PIVOT</code>-Beispiel mit <code class="code">manufacturer</code> als impliziter Spalte.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT *
FROM (SELECT quality, manufacturer FROM part) PIVOT (
    count(*) FOR quality IN (1, 2, NULL)
);</code></pre>
               <p>Die Abfrage führt zur folgenden Ausgabe.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class=""> manufacturer      | 1  | 2  | null
-------------------+----+----+------
 local parts co    | 1  | 1  |  1
 big parts co      | 1  | 1  |  1
 small parts co    | 1  | 0  |  2</code></pre>
               <p> Eingabetabellenspalten, die nicht in der <code class="code">PIVOT</code>-Definition referenziert sind, werden implizit zur Ergebnistabelle hinzugefügt. Dies ist zum Beispiel bei der <code class="code">manufacturer</code>-Spalte im vorigen Beispiel der Fall. Das Beispiel zeigt auch, dass <code class="code">NULL</code> ein gültiger Wert für den <code class="code">IN</code>-Operator ist. </p>
               <p><code class="code">PIVOT</code> im obigen Beispiel gibt ähnliche Informationen zurück wie die folgende Abfrage, die <code class="code">GROUP BY</code> umfasst. Der Unterschied besteht darin, dass <code class="code">PIVOT</code> den Wert <code class="code">0</code> für Spalte <code class="code">2</code> und den Hersteller <code class="code">small parts co</code> zurückgibt. Die <code class="code">GROUP BY</code>-Abfrage enthält keine entsprechende Zeile. In dem meisten Fällen fügt <code class="code">PIVOT</code> <code class="code">NULL</code> ein, wenn eine Zeile keine Eingabedaten für eine bestimmte Spalte aufweist. Das Zählaggregat gibt jedoch nicht <code class="code">NULL</code> zurück und <code class="code">0</code> ist der Standardwert.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT manufacturer, quality, count(*)
FROM (SELECT quality, manufacturer FROM part)
WHERE quality IN (1, 2) OR quality IS NULL
GROUP BY manufacturer, quality
ORDER BY manufacturer;</code></pre>
               <p>Die Abfrage führt zur folgenden Ausgabe.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class=""> manufacturer        | quality | count
---------------------+---------+-------
 big parts co        |         |     1
 big parts co        |       2 |     1
 big parts co        |       1 |     1
 local parts co      |       2 |     1
 local parts co      |       1 |     1
 local parts co      |         |     1
 small parts co      |       1 |     1
 small parts co      |         |     2</code></pre>
               <p> Der PIVOT-Operator akzeptiert optionale Aliase auf dem Aggregatausdruck und jedem Wert für den <code class="code">IN</code>-Operator. Verwenden Sie Aliase, um die Spaltennamen anzupassen. Wenn kein Aggregatalias vorliegt, werden nur <code class="code">IN</code>-Listenaliase verwendet. Andernfalls wird das Aggregatalias an den Spaltennamen angefügt (mit einem Unterstrich, um die Namen auseinanderzuhalten). </p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT *
FROM (SELECT quality, manufacturer FROM part) PIVOT (
    count(*) AS count FOR quality IN (1 AS high, 2 AS low, NULL AS na)
);</code></pre>
               <p>Die Abfrage führt zur folgenden Ausgabe.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class=""> manufacturer      | high_count  | low_count | na_count
-------------------+-------------+-----------+----------
 local parts co    |           1 |         1 |        1
 big parts co      |           1 |         1 |        1
 small parts co    |           1 |         0 |        2</code></pre>
               
               
               
    <p>Richten Sie die folgende Beispieltabelle und -daten ein und verwenden Sie sie, um die folgenden Beispielabfragen auszuführen. Die Daten stellen Buchungstermine für eine Reihe von Hotels dar.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE bookings (
    booking_id int,
    hotel_code char(8),
    booking_date date,
    price decimal(12, 2)
);

INSERT INTO bookings VALUES (1, 'FOREST_L', '02/01/2023', 75.12);
INSERT INTO bookings VALUES (2, 'FOREST_L', '02/02/2023', 75.00);
INSERT INTO bookings VALUES (3, 'FOREST_L', '02/04/2023', 85.54);

INSERT INTO bookings VALUES (4, 'FOREST_L', '02/08/2023', 75.00);
INSERT INTO bookings VALUES (5, 'FOREST_L', '02/11/2023', 75.00);
INSERT INTO bookings VALUES (6, 'FOREST_L', '02/14/2023', 90.00);

INSERT INTO bookings VALUES (7, 'FOREST_L', '02/21/2023', 60.00);
INSERT INTO bookings VALUES (8, 'FOREST_L', '02/22/2023', 85.00);
INSERT INTO bookings VALUES (9, 'FOREST_L', '02/27/2023', 90.00);

INSERT INTO bookings VALUES (10, 'DESERT_S', '02/01/2023', 98.00);
INSERT INTO bookings VALUES (11, 'DESERT_S', '02/02/2023', 75.00);
INSERT INTO bookings VALUES (12, 'DESERT_S', '02/04/2023', 85.00);

INSERT INTO bookings VALUES (13, 'DESERT_S', '02/05/2023', 75.00);
INSERT INTO bookings VALUES (14, 'DESERT_S', '02/06/2023', 34.00);
INSERT INTO bookings VALUES (15, 'DESERT_S', '02/09/2023', 85.00);

INSERT INTO bookings VALUES (16, 'DESERT_S', '02/12/2023', 23.00);
INSERT INTO bookings VALUES (17, 'DESERT_S', '02/13/2023', 76.00);
INSERT INTO bookings VALUES (18, 'DESERT_S', '02/14/2023', 85.00);

INSERT INTO bookings VALUES (19, 'OCEAN_WV', '02/01/2023', 98.00);
INSERT INTO bookings VALUES (20, 'OCEAN_WV', '02/02/2023', 75.00);
INSERT INTO bookings VALUES (21, 'OCEAN_WV', '02/04/2023', 85.00);

INSERT INTO bookings VALUES (22, 'OCEAN_WV', '02/06/2023', 75.00);
INSERT INTO bookings VALUES (23, 'OCEAN_WV', '02/09/2023', 34.00);
INSERT INTO bookings VALUES (24, 'OCEAN_WV', '02/12/2023', 85.00);

INSERT INTO bookings VALUES (25, 'OCEAN_WV', '02/13/2023', 23.00);
INSERT INTO bookings VALUES (26, 'OCEAN_WV', '02/14/2023', 76.00);
INSERT INTO bookings VALUES (27, 'OCEAN_WV', '02/16/2023', 85.00);

INSERT INTO bookings VALUES (28, 'CITY_BLD', '02/01/2023', 98.00);
INSERT INTO bookings VALUES (29, 'CITY_BLD', '02/02/2023', 75.00);
INSERT INTO bookings VALUES (30, 'CITY_BLD', '02/04/2023', 85.00);

INSERT INTO bookings VALUES (31, 'CITY_BLD', '02/12/2023', 75.00);
INSERT INTO bookings VALUES (32, 'CITY_BLD', '02/13/2023', 34.00);
INSERT INTO bookings VALUES (33, 'CITY_BLD', '02/17/2023', 85.00);

INSERT INTO bookings VALUES (34, 'CITY_BLD', '02/22/2023', 23.00);
INSERT INTO bookings VALUES (35, 'CITY_BLD', '02/23/2023', 76.00);
INSERT INTO bookings VALUES (36, 'CITY_BLD', '02/24/2023', 85.00);</code></pre>       
               
               <p> In dieser Beispielabfrage werden die Buchungsdatensätze zusammengezählt, um eine Gesamtsumme für jede Woche zu erhalten. Das Enddatum für jede Woche wird zu einem Spaltennamen.</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT * FROM
    (SELECT
       booking_id,
       (date_trunc('week', booking_date::date) + '5 days'::interval)::date as enddate,
       hotel_code AS "hotel code"
FROM bookings
) PIVOT (
    count(booking_id) FOR enddate IN ('2023-02-04','2023-02-11','2023-02-18') 
);</code></pre>
               <p>Die Abfrage führt zur folgenden Ausgabe.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class=""> hotel code | 2023-02-04  | 2023-02-11 | 2023-02-18
------------+-------------+------------+----------
 FOREST_L   |           3 |          2 |        1
 DESERT_S   |           4 |          3 |        2
 OCEAN_WV   |           3 |          3 |        3
 CITY_BLD   |           3 |          1 |        2</code></pre>
               
              
              
              
               <p> Amazon Redshift unterstützt CROSSTAB, um mehrere Spalten zu pivotieren. Mit einer Abfrage wie der folgenden können Sie jedoch Zeilendaten in Spalten ändern, ähnlich wie bei einer Aggregation mit PIVOT. Dabei werden dieselben Buchungsbeispieldaten wie im vorherigen Beispiel verwendet.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT 
  booking_date,
  MAX(CASE WHEN hotel_code = 'FOREST_L' THEN 'forest is booked' ELSE '' END) AS FOREST_L,
  MAX(CASE WHEN hotel_code = 'DESERT_S' THEN 'desert is booked' ELSE '' END) AS DESERT_S,
  MAX(CASE WHEN hotel_code = 'OCEAN_WV' THEN 'ocean is booked' ELSE '' END)  AS OCEAN_WV
FROM bookings
GROUP BY booking_date
ORDER BY booking_date asc;</code></pre>
               <p>Die Beispielabfrage ergibt Buchungsdaten, die neben kurzen Ausdrücken aufgeführt sind und angeben, welche Hotels gebucht wurden.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class=""> booking_date  | forest_l         | desert_s         | ocean_wv
---------------+------------------+------------------+--------------------
 2023-02-01    | forest is booked | desert is booked |  ocean is booked
 2023-02-02    | forest is booked | desert is booked |  ocean is booked
 2023-02-04    | forest is booked | desert is booked |  ocean is booked
 2023-02-05    |                  | desert is booked |        
 2023-02-06    |                  | desert is booked |         </code></pre>

               <p>Im Folgenden finden Sie Nutzungshinweise für <code class="code">PIVOT</code>:</p>
               <div class="itemizedlist">
                   
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem"><p><code class="code">PIVOT</code> kann auf Tabellen, Unterabfragen und allgemeine Tabellenausdrücke (CTEs) angewendet werden. <code class="code">PIVOT</code> kann nicht auf <code class="code">JOIN</code>-Ausdrücke, rekursive CTEs, <code class="code">PIVOT</code>- oder <code class="code">UNPIVOT</code>-Ausdrücke angewendet werden. Ebenfalls nicht unterstützt werden nicht verschachtelte <code class="code">SUPER</code>-Ausdrücke sowie verschachtelte Redshift-Spectrum-Tabellen.</p></li><li class="listitem"><p> <code class="code">PIVOT</code> unterstützt die Aggregatfunktionen <code class="code">COUNT</code>, <code class="code">SUM</code>, <code class="code">MIN</code>, <code class="code">MAX</code> und <code class="code">AVG</code>. </p></li><li class="listitem"><p>Der <code class="code">PIVOT</code>-Aggregatausdruck muss ein Aufruf einer unterstützten Aggregatfunktion sein. Komplexe Ausdrücke, die auf dem Aggregat aufbauen, werden nicht unterstützt. Die Aggregatargumente können keine Verweise auf Tabellen enthalten, bei denen es sich nicht um die <code class="code">PIVOT</code>-Eingabetabelle handelt. Korrelierte Verweise auf eine übergeordnete Abfrage werden ebenfalls nicht unterstützt. Das Aggregatargument kann Unterabfragen enthalten. Diese können intern oder in der <code class="code">PIVOT</code>-Eingabetabelle korreliert werden.</p></li><li class="listitem"><p> Die <code class="code">PIVOT IN</code>-Listenwerte können keine Spaltenverweise oder Unterabfragen sein. Alle Werte müssen mit dem <code class="code">FOR</code>-Spaltenverweis typenkompatibel sein. </p></li><li class="listitem"><p> Wenn die <code class="code">IN</code>-Listenwerte keine Aliase haben, generiert <code class="code">PIVOT</code> Standardspaltennamen. Bei konstanten <code class="code">IN</code>-Werten wie etwa „abc“ oder „5“ ist der Spaltennamen die Konstante. Bei komplexen Ausdrücken ist der Spaltenname ein Amazon-Redshift-Standardname wie etwa <code class="code">?column?</code>. </p></li></ul></div>


             
               <h2 id="r_FROM_clause-unpivot-examples">Beispiele für UNPIVOT</h2>
               <p>Richten Sie die Beispieldaten ein und verwenden Sie sie, um die folgenden Beispiele auszuführen.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE count_by_color (quality varchar, red int, green int, blue int);

INSERT INTO count_by_color VALUES ('high', 15, 20, 7);
INSERT INTO count_by_color VALUES ('normal', 35, NULL, 40);
INSERT INTO count_by_color VALUES ('low', 10, 23, NULL);</code></pre>
               <p><code class="code">UNPIVOT</code> in den Eingabespalten rot, grün und blau.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT *
FROM (SELECT red, green, blue FROM count_by_color) UNPIVOT (
    cnt FOR color IN (red, green, blue)
);</code></pre>
               <p>Die Abfrage führt zur folgenden Ausgabe.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class=""> color | cnt
-------+-----
 red   |  15
 red   |  35
 red   |  10
 green |  20
 green |  23
 blue  |   7
 blue  |  40</code></pre>
               <p>Standardmäßig werden <code class="code">NULL</code>-Werte in der Eingabespalte übersprungen und ergeben keine Ergebniszeile. </p>
               <p>Das folgende Beispiel zeigt <code class="code">UNPIVOT</code> mit <code class="code">INCLUDE NULLS</code>.</p>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT *
FROM (
    SELECT red, green, blue
    FROM count_by_color
) UNPIVOT INCLUDE NULLS (
    cnt FOR color IN (red, green, blue)
);</code></pre>
               <p>Die resultierende Ausgabe sieht wie folgt aus.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class=""> color | cnt
-------+-----
 red   |  15
 red   |  35
 red   |  10
 green |  20
 green |
 green |  23
 blue  |   7
 blue  |  40
 blue  |  </code></pre>
               <p>Wenn der Parameter <code class="code">INCLUDING NULLS</code> festgelegt wurde, generieren <code class="code">NULL</code>-Eingabewerte Ergebniszeilen.</p>
               <p><code class="code">The following query shows UNPIVOT</code> mit <code class="code">quality</code> als impliziter Spalte.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT *
FROM count_by_color UNPIVOT (
    cnt FOR color IN (red, green, blue)
);</code></pre>
               <p>Die Abfrage führt zur folgenden Ausgabe.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class=""> quality | color | cnt
---------+-------+-----
 high    | red   |  15
 normal  | red   |  35
 low     | red   |  10
 high    | green |  20
 low     | green |  23
 high    | blue  |   7
 normal  | blue  |  40</code></pre>
               <p>Spalten der Eingabetabelle, die nicht in der <code class="code">UNPIVOT</code>-Definition referenziert sind, werden implizit zur Ergebnistabelle hinzugefügt. Im Beispiel ist dies bei der <code class="code">quality</code>-Spalte der Fall.</p>
               <p>Das folgende Beispiel zeigt <code class="code">UNPIVOT</code> mit Aliasen für Werte in der <code class="code">IN</code>-Liste.</p>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT *
FROM count_by_color UNPIVOT (
    cnt FOR color IN (red AS r, green AS g, blue AS b)
);</code></pre>
               <p>Die vorige Abfrage führt zu der folgenden Ausgabe.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class=""> quality | color | cnt
---------+-------+-----
 high    | r     |  15
 normal  | r     |  35
 low     | r     |  10
 high    | g     |  20
 low     | g     |  23
 high    | b     |   7
 normal  | b     |  40</code></pre>
               <p>Der <code class="code">UNPIVOT</code>-Operator akzeptiert optionale Aliase auf jedem <code class="code">IN</code>-Listenwert. Jeder Alias ermöglicht die Anpassung der Daten in jeder <code class="code">value</code>-Spalte.</p>
               <p>Im Folgenden finden Sie Nutzungshinweise für <code class="code">UNPIVOT</code>.</p>

               <div class="itemizedlist">
                   

                   

                   

               <ul class="itemizedlist"><li class="listitem"><p><code class="code">UNPIVOT</code> kann auf Tabellen, Unterabfragen und allgemeine Tabellenausdrücke (CTEs) angewendet werden. <code class="code">UNPIVOT</code> kann nicht auf <code class="code">JOIN</code>-Ausdrücke, rekursive CTEs, <code class="code">PIVOT</code>- oder <code class="code">UNPIVOT</code>-Ausdrücke angewendet werden. Ebenfalls nicht unterstützt werden nicht verschachtelte <code class="code">SUPER</code>-Ausdrücke sowie verschachtelte Redshift-Spectrum-Tabellen.</p></li><li class="listitem"><p>Die Liste <code class="code">UNPIVOT IN</code> darf nur Spaltenverweise auf Eingabetabellen enthalten. Die <code class="code">IN</code>-Listenspalten müssen einen gemeinsamen Typ haben, mit dem sie alle kompatibel sind. Die <code class="code">UNPIVOT</code>-Wertspalte hat diesen gemeinsamen Typ. Der <code class="code">UNPIVOT</code>-Spaltenname hat den Typ <code class="code">VARCHAR</code>.</p></li><li class="listitem"><p>Wenn ein <code class="code">IN</code>-Listenwert keinen Alias hat, verwendet <code class="code">UNPIVOT</code> den Spaltennamen als Standardwert.</p></li></ul></div>




            <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warnung" /> <strong>JavaScript ist in Ihrem Browser nicht verfügbar oder deaktiviert.</strong></p><p>Zur Nutzung der AWS-Dokumentation muss JavaScript aktiviert sein. Weitere Informationen finden auf den Hilfe-Seiten Ihres Browsers.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Dokumentkonventionen</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_FROM_clause30.html">FROM-Klausel</div><div id="next" class="next-link" accesskey="n" href="./r_Join_examples.html">JOIN-Beispiele</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Hat Ihnen diese Seite geholfen? – Ja</div><div class="content"><p>Vielen Dank, dass Sie uns mitgeteilt haben, dass wir gute Arbeit geleistet haben!</p><p>Würden Sie sich einen Moment Zeit nehmen, um uns mitzuteilen, was wir richtig gemacht haben, damit wir noch besser werden?</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Hat Ihnen diese Seite geholfen? – Nein</div><div class="content"><p>Vielen Dank, dass Sie uns mitgeteilt haben, dass diese Seite überarbeitet werden muss. Es tut uns Leid, dass wir Ihnen nicht weiterhelfen konnten.</p><p>Würden Sie sich einen Moment Zeit nehmen, um uns mitzuteilen, wie wir die Dokumentation verbessern können?</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_FROM_clause-pivot-unpivot-examples.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>