<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="de-DE"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ausführen von ECS-Blau/Grün-Bereitstellungen CodeDeploy mithilfe von AWS CloudFormation - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="blue-green" /><meta name="default_state" content="blue-green" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/blue-green.html" /><meta name="description" content="Verwenden Sie AWS CloudFormation-Vorlagen, um ECS-Blau/Grün-Bereitstellungen über AWS CodeDeploy zu verwalten." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Leitfaden" /><meta name="abstract" content="Erstellen und verwalten Sie AWS Infrastrukturbereitstellungen vorhersehbar und wiederholt mithilfe von AWS CloudFormation mit diesem Benutzerhandbuch." /><meta name="guide-locale" content="de_de" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/blue-green.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/blue-green.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Leitfaden" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Leitfaden" /><meta id="panorama-serviceConsolePage" value="Ausführen von ECS-Blau/Grün-Bereitstellungen CodeDeploy mithilfe von AWS CloudFormation" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Ausführen von ECS-Blau/Grün-Bereitstellungen CodeDeploy mithilfe von AWS CloudFormation - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/blue-green.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/blue-green.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/blue-green.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,Ressourcenbereitstellung,Ressourcenkonfiguration,Infrastrukturverwaltung,CloudFormer,CloudFormation -Stack,CloudFormation Stackset,CloudFormation -Vorlage,Änderungssatz" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Leitfaden",
        "item" : "https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Arbeiten mit AWS CloudFormation-Vorlagen",
        "item" : "https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Ausführen von ECS-Blau/Grün-Bereitstellungen CodeDeploy mithilfe von AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-guide.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Dokumentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Leitfaden</a></div><div id="page-toc-src"><a href="#blue-green-required">Modellierung Ihrer Blau/Grün-Bereitstellung mithilfe von  CloudFormation -Ressourcen</a><a href="#blue-green-resources">Ressourcenaktualisierungen, die grüne Bereitstellungen auslösen</a><a href="#blue-green-considerations">Überlegungen zur Verwaltung von ECS-Blau/Grün-Bereitstellungen mit CloudFormation</a><a href="#blue-green-setup">Vorbereiten der Vorlage für die Durchführung von ECS-Blau/Grün-Bereitstellungen</a><a href="#blue-green-changesets">Überprüfen der Änderungssätze für Ihre Blau/Grün-Bereitstellung</a><a href="#blue-green-events">Anzeigen von Stack-Ereignissen für Ihre Blau/Grün-Bereitstellung</a><a href="#blue-green-template-reference">Vorlage – Referenz</a><a href="#blue-green-iam">Für Blau/Grün-Bereitstellungen erforderliche IAM-Berechtigungen</a><a href="#blue-green-template-example">Vorlagenbeispiel</a></div><div id="page-filters" style="display:none"><filter label="All" id="All"></filter><filter label="JSON" id="JSON"></filter><filter label="YAML" id="YAML"></filter></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Die vorliegende Übersetzung wurde maschinell erstellt. Im Falle eines Konflikts oder eines Widerspruchs zwischen dieser übersetzten Fassung und der englischen Fassung (einschließlich infolge von Verzögerungen bei der Übersetzung) ist die englische Fassung maßgeblich.</p></awsui-alert><h1 class="topictitle" id="blue-green">Ausführen von ECS-Blau/Grün-Bereitstellungen  CodeDeploy mithilfe von AWS CloudFormation</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Sie können verwenden CloudFormation , um ECS-Blau/Grün-Bereitstellungen über durchzuführenAWS CodeDeploy. Blau/Grün-Bereitstellungen sind eine sichere Bereitstellungsstrategie, die von bereitgestellt wird CodeDeploy , um Unterbrechungen zu minimieren, die durch das Ändern von Anwendungsversionen verursacht werden. Dies wird erreicht, indem Sie Ihre neue Anwendungsumgebung, die als <em>grün</em>, bezeichnet wird, zusammen mit Ihrer aktuellen Anwendung erstellen, die Ihren Live-Datenverkehr bedient und als <em>blau</em> bezeichnet wird. Dies ermöglicht eine gewisse Zeit für die Überwachung und das Testen der grünen Umgebung, bevor Ihr Live-Datenverkehr von blau nach grün geleitet wird und anschließend die blauen Ressourcen deaktiviert werden.</p><p>Wenn Sie verwenden,  CloudFormation um ECS-Blau/Grün-Bereitstellungen durchzuführen, erstellen Sie zunächst eine Stack-Vorlage, die die Ressourcen für Ihre blauen und grünen Anwendungsumgebungen definiert, einschließlich der zu verwendenden Datenverkehrsweiterleitungs- und Stabilisierungseinstellungen. Als Nächstes erstellen Sie einen Stack aus dieser Vorlage. Dadurch wird Ihre blaue (aktuelle) Anwendung generiert.  CloudFormation erstellt nur die blauen Ressourcen während der Stack-Erstellung. Ressourcen für eine grüne Bereitstellung werden erst erstellt, wenn sie erforderlich sind.</p><p>Wenn Sie dann in einem zukünftigen Stack-Update die Aufgabendefinition oder die Aufgabensatzressourcen in Ihrer blauen Anwendung aktualisieren,  CloudFormation führt Folgendes aus:</p><div class="itemizedlist">
         
         
         
    <ul class="itemizedlist"><li class="listitem"><p>Generiert alle notwendigen Ressourcen für eine grüne Anwendungsumgebung.</p></li><li class="listitem"><p>Verschiebt den Datenverkehr basierend auf den angegebenen Datenverkehrs-Weiterleitungsparametern.</p></li><li class="listitem"><p>Löscht die blauen Ressourcen.</p></li></ul></div><p>Wenn zu einem beliebigen Zeitpunkt ein Fehler auftritt, bevor die grüne Bereitstellung erfolgreich und abgeschlossen ist, führt  CloudFormation  den Stack in seinen Zustand zurück, bevor die gesamte grüne Bereitstellung initiiert wurde.</p><p>Damit Blau/Grün-Bereitstellungen für einen Stack  CloudFormation durchführen kann, fügen Sie die folgenden Informationen in die Stack-Vorlage ein:</p><div class="itemizedlist">
         
         
    <ul class="itemizedlist"><li class="listitem"><p>Ein <code class="code">Transform</code>-Abschnitt in Ihrer Vorlage, der die Transformation <code class="code">AWS::CodeDeployBlueGreen</code> aufruft, sowie ein <code class="code">Hook</code>-Abschnitt, der den Hook <code class="code">AWS::CodeDeploy::BlueGreen</code> aufruft.</p></li><li class="listitem"><p>Mindestens eine der ECS-Ressourcen, die eine Blau/Grün-Bereitstellung auslösen wird, wenn sie während einer Stack-Aktualisierung ersetzt wird. Derzeit sind diese Ressourcen <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskdefinition.html"><code class="code">AWS::ECS::TaskDefinition</code></a> und <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskset.html"><code class="code">AWS::ECS::TaskSet</code></a>.</p></li></ul></div><p>Wenn Sie dann eine Stack-Aktualisierung initiieren, die alle Eigenschaften der oben genannten Ressourcen aktualisiert, die benötigt,  CloudFormation um die Ressource zu ersetzen,  CloudFormation führt eine Blau/Grün-Bereitstellung durch, wie oben beschrieben. Weitere Informationen zum Verhalten von Ressourcenaktualisierungen finden Sie unter <a href="./using-cfn-updating-stacks-update-behaviors.html">Aktualisieren von Verhalten von Stack-Ressourcen</a>.</p><p>In einigen Fällen möchten Sie Ihre Stack-Vorlage so einrichten, dass Blau/Grün-Bereitstellungen aktiviert werden, <em>bevor</em> Sie den Stack erstellen. Sie können jedoch auch die Möglichkeit hinzufügen, Blau/Grün-Bereitstellungen für einen vorhandenen Stack  CloudFormation durchführen zu lassen. Fügen Sie dazu die erforderlichen Informationen zur vorhandenen Vorlage des Stacks hinzu.</p><p>Darüber hinaus empfehlen wir Ihnen, einen Änderungssatz für die grüne Bereitstellung zu  CloudFormation generieren, bevor Sie die Stack-Aktualisierung starten. Auf diese Weise können Sie die tatsächlichen Änderungen überprüfen, die am Stack vorgenommen werden. Weitere Informationen finden Sie unter <a href="./using-cfn-updating-stacks-changesets.html">Aktualisieren von Stacks mithilfe von Änderungssätzen</a>.</p>
        <h2 id="blue-green-required">Modellierung Ihrer Blau/Grün-Bereitstellung mithilfe von  CloudFormation -Ressourcen</h2>
        <p>Um eine ECS-Blau/Grün-Bereitstellung mit  CodeDeploy über durchzuführen CloudFormation, muss Ihre Vorlage die Ressourcen enthalten, die Ihre Bereitstellung modellieren, z. B. einen Amazon-ECS-Service und einen Load Balancer. Weitere Informationen dazu, was diese Ressourcen darstellen, finden Sie unter <a href="https://docs.aws.amazon.com/codedeploy/latest/userguide/deployment-steps-ecs.html#deployment-steps-prerequisites-ecs">Vor einer Amazon ECS-Bereitstellung</a> im <em>AWS CodeDeploy-Benutzerhandbuch</em>.</p>
        <div class="table-container"><div class="table-contents"><table id="w1348aac17c33c25b5"><thead>
                    <tr>
                        <th>Anforderung</th>
                        <th>Ressource</th>
                        <th>Erforderlich/optional</th>
                        <th>Löst die Blau/Grün-Bereitstellung aus, wenn sie ersetzt wird</th>
                    </tr>
                </thead>
                    <tr>
                        <td tabindex="-1">Amazon-ECS-Cluster</td>
                        <td tabindex="-1"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-cluster.html"><code class="code">AWS::ECS::Cluster</code></a></td>
                        <td tabindex="-1">Optional. Der Standard-Cluster kann verwendet werden.</td>
                        <td tabindex="-1">Nein</td>
                    </tr>
                    <tr>
                        <td tabindex="-1">Amazon-ECS-Service</td>
                        <td tabindex="-1"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-service.html"><code class="code">AWS::ECS::Service</code></a></td>
                        <td tabindex="-1">Erforderlich</td>
                        <td tabindex="-1">Nein</td>
                    </tr>
                    <tr>
                        <td tabindex="-1">Application oder Network Load Balancer</td>
                        <td tabindex="-1"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ecs-service-loadbalancer.html"><code class="code">AWS::ECS::Service
       LoadBalancer</code></a></td>
                        <td tabindex="-1">Erforderlich</td>
                        <td tabindex="-1">Nein</td>
                    </tr>
                    <tr>
                        <td tabindex="-1">Produktions-Listener</td>
                        <td tabindex="-1"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-listener.html"><code class="code">AWS::ElasticLoadBalancingV2::Listener</code></a></td>
                        <td tabindex="-1">Erforderlich</td>
                        <td tabindex="-1">Nein</td>
                    </tr>
                    <tr>
                        <td tabindex="-1">Listener testen </td>
                        <td tabindex="-1"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-listener.html"><code class="code">AWS::ElasticLoadBalancingV2::Listener</code></a></td>
                        <td tabindex="-1">Optional.</td>
                        <td tabindex="-1">Nein</td>
                    </tr>
                    <tr>
                        <td tabindex="-1">Zwei Zielgruppen</td>
                        <td tabindex="-1"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-targetgroup.html"><code class="code">AWS::ElasticLoadBalancingV2::TargetGroup</code></a></td>
                        <td tabindex="-1">Erforderlich</td>
                        <td tabindex="-1">Nein</td>
                    </tr>
                    <tr>
                        <td tabindex="-1">Amazon ECS-Aufgabendefinition </td>
                        <td tabindex="-1"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskdefinition.html"><code class="code">AWS::ECS::TaskDefinition</code></a></td>
                        <td tabindex="-1">Erforderlich</td>
                        <td tabindex="-1">Ja</td>
                    </tr>
                    <tr>
                        <td tabindex="-1">Container für Ihre Amazon ECS-Anwendung</td>
                        <td tabindex="-1"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ecs-taskdefinition-containerdefinitions.html#cfn-ecs-taskdefinition-containerdefinition-name.html"><code class="code">AWS::ECS::TaskDefinition ContainerDefinition Name</code></a></td>
                        <td tabindex="-1">Erforderlich</td>
                        <td tabindex="-1">Nein</td>
                    </tr>
                    <tr>
                        <td tabindex="-1">Ein Port für den Ersatzaufgabensatz</td>
                        <td tabindex="-1"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ecs-taskdefinition-portmapping.html#cfn-ecs-taskdefinition-portmapping-containerport"><code class="code">AWS::ECS::TaskDefinition PortMapping ContainerPort</code></a></td>
                        <td tabindex="-1">Erforderlich</td>
                        <td tabindex="-1">Nein</td>
                    </tr>
                </table></div></div>
     
        <h2 id="blue-green-resources">Ressourcenaktualisierungen, die grüne Bereitstellungen auslösen</h2>
        <p>Wenn Sie eine Stack-Aktualisierung durchführen, die eine Eigenschaft aktualisiert, die <a href="./using-cfn-updating-stacks-update-behaviors.html">Ersatz</a> für die folgenden ECS-Ressourcen erfordert, initiiert  CloudFormation eine grüne Bereitstellung:</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskdefinition.html"><code class="code">AWS::ECS::TaskDefinition</code></a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskset.html"><code class="code">AWS::ECS::TaskSet</code></a> </p></li></ul></div>
        
        <p>Durch das Aktualisieren von Eigenschaften in diesen Ressourcen, für die keine Ressourcenersetzung erforderlich ist, wird keine grüne Bereitstellung ausgelöst.</p>
        <p>Sie können keine Aktualisierungen für die obengenannten Ressourcen mit Aktualisierungen für andere Ressourcen in derselben Stack-Aktualisierung einschließen. Wenn Sie Ressourcen in der obigen Liste sowie andere Ressourcen im selben Stack aktualisieren müssen, führen Sie einen der folgenden Schritte aus:</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem"><p>Führen Sie zwei separate Stack-Aktualisierungsvorgänge durch: einen, die nur die Aktualisierungen der obengenannten Ressourcen enthält, und eine separate Stack-Aktualisierung, die Änderungen an anderen Ressourcen enthält.</p></li><li class="listitem"><p>Entfernen Sie die Abschnitte <code class="code">Hook</code> und <code class="code">Transform</code> aus Ihrer Vorlage und führen Sie dann die Stack-Aktualisierung durch. In diesem Fall führt  CloudFormation keine grüne Bereitstellung durch.</p></li></ul></div>
     
        <h2 id="blue-green-considerations">Überlegungen zur Verwaltung von ECS-Blau/Grün-Bereitstellungen mit CloudFormation</h2>
        <p>Sie sollten Folgendes berücksichtigen, wenn Sie Ihre Blau/Grün-Bereitstellung mit  CloudFormation definieren:</p>
        <div class="itemizedlist">
             
             
             
             
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem"><p>Nur Aktualisierungen bestimmter Ressourcen initiieren eine grüne Bereitstellung, wie unter beschrieben<a href="#blue-green-resources">Ressourcenaktualisierungen, die grüne Bereitstellungen auslösen</a>.</p></li><li class="listitem"><p>Sie können keine Aktualisierungen für Ressourcen, die grüne Bereitstellungen initiieren, und Aktualisierungen für andere Ressourcen in dieselbe Stack-Aktualisierung aufnehmen, wie unter beschrieben<a href="#blue-green-resources">Ressourcenaktualisierungen, die grüne Bereitstellungen auslösen</a>.</p></li><li class="listitem"><p>Sie können nur einen einzelnen ECS-Service als Bereitstellungsziel angeben.</p></li><li class="listitem"><p>Parameter, deren Werte von verschleiert werden,  CloudFormation können während einer grünen Bereitstellung nicht vom  CodeDeploy Service aktualisiert werden und führen zu einem Fehler und einem Stack-Aktualisierungsfehler. Dazu zählen:</p>
            <div class="itemizedlist">
                 
                 
            <ul class="itemizedlist"><li class="listitem"><p>Parameter, die mit dem Attribut <code class="code">NoEcho</code> definiert sind.</p></li><li class="listitem"><p>Parameter, die dynamische Referenzen verwenden, um ihre Werte von externen Diensten abzurufen. Weitere Informationen finden Sie unter <a href="./dynamic-references.html">Verwenden von dynamischen Referenzen zum Angeben von Vorlagenwerten</a>.</p></li></ul></div>
            </li><li class="listitem"><p>Um eine grüne Bereitstellung abzubrechen, die noch ausgeführt wird, brechen Sie die Stack-Aktualisierung in ab CloudFormation, nicht in  CodeDeploy oder ECS. Weitere Informationen finden Sie unter <a href="./using-cfn--stack-update-cancel.html">Stornieren einer Stack-Aktualisierung</a>. (Nach Abschluss einer Aktualisierung können Sie diese nicht mehr stornieren. Sie können einen Stack jedoch mit früheren Einstellungen erneut aktualisieren.)</p></li><li class="listitem"><p>Das Deklarieren <a href="./outputs-section-structure.html">Outputs</a> oder Verwenden von <a href="./intrinsic-function-reference-importvalue.html">Fn::ImportValue</a> zum Importieren von Werten aus anderen Stacks wird derzeit nicht für Vorlagen unterstützt, die Blau/Grün-ECS-Bereitstellungen definieren.</p></li><li class="listitem"><p><a href="./resource-import.html">Integrieren vorhandener Ressourcen in die - CloudFormation Verwaltung</a> wird derzeit nicht für Vorlagen unterstützt, die Blau/Grün-ECS-Bereitstellungen definieren.</p></li><li class="listitem"><p>Sie können den Hook <code class="code">AWS::CodeDeploy::BlueGreen</code> nicht in einer Vorlage verwenden, die verschachtelte Stack-Ressourcen enthält.</p></li><li class="listitem"><p>Sie können den Hook <code class="code">AWS::CodeDeploy::BlueGreen</code> nicht in einem <a href="./using-cfn-nested-stacks.html">verschachtelten Stack</a> verwenden.</p></li></ul></div>
        <p>Informationen dazu, wie sich die Verwendung von  CloudFormation zur Durchführung Ihrer ECS-Blau/Grün-Bereitstellungen über von einer standardmäßigen Amazon-ECS-Bereitstellung mit nur  CodeDeploy unterscheidet CodeDeploy, finden Sie unter <a href="https://docs.aws.amazon.com/codedeploy/latest/userguide/deployments-create-prerequisites.html">Unterschiede zwischen Amazon-ECS-Blau/Grün-Bereitstellungen über CloudFormation und Standard-Amazon-ECS-Bereitstellungen</a> im <em>AWS CodeDeploy -Benutzerhandbuch</em>.</p>
     
        <h2 id="blue-green-setup">Vorbereiten der Vorlage für die Durchführung von ECS-Blau/Grün-Bereitstellungen</h2>
        <p>Um Blau/Grün-Bereitstellungen auf Ihrem Stack zu aktivieren, fügen Sie die folgenden Abschnitte in Ihre Stack-Vorlage ein, bevor Sie eine Stack-Aktualisierung durchführen.</p>
        <div class="itemizedlist">
             
             
             
        <ul class="itemizedlist"><li class="listitem"><p>Fügen Sie Ihrer Vorlage einen Verweis auf die Transformation <code class="code">AWS::CodeDeployBlueGreen</code> hinzu:</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">    "Transform": [
        "AWS::CodeDeployBlueGreen"
    ],</code></pre>
</li><li class="listitem"><p>Fügen Sie einen <code class="code">Hook</code>-Abschnitt hinzu, der den Hook <code class="code">AWS::CodeDeploy::BlueGreen</code> aufruft und die Eigenschaften für Ihre Bereitstellung angibt. Verwenden Sie die Vorlagenreferenz unten als Leitfaden.</p></li><li class="listitem"><p>Definieren Sie im Abschnitt <code class="code">Resources</code> die blauen und grünen Ressourcen für Ihre Bereitstellung.</p></li></ul></div>
        <p>Sie können diese Abschnitte hinzufügen, wenn Sie die Vorlage zum ersten Mal erstellen (d. h. vor dem Erstellen des Stacks selbst), oder Sie können sie einer vorhandenen Vorlage hinzufügen, bevor Sie eine Stack-Aktualisierung durchführen. Wenn Sie die Blau/Grün-Bereitstellung für einen neuen Stack angeben, erstellt  CloudFormation nur die blauen Ressourcen während der Stack-Erstellung – Ressourcen für die grüne Bereitstellung werden erst erstellt, wenn sie während einer Stack-Aktualisierung erforderlich sind.</p>

     
        <h2 id="blue-green-changesets">Überprüfen der Änderungssätze für Ihre Blau/Grün-Bereitstellung</h2>
        <p>Es wird dringend empfohlen, einen Änderungssatz zu erstellen, bevor Sie eine Stack-Aktualisierung durchführen, die eine Grün-Bereitstellung initiiert. Auf diese Weise können Sie die tatsächlichen Änderungen sehen, die vor der Stack-Aktualisierung an Ihrem Stack vorgenommen werden. Beachten Sie, dass Ressourcenänderungen möglicherweise nicht in der Reihenfolge aufgeführt werden, in der sie während der Stack-Aktualisierung durchgeführt werden. Weitere Informationen finden Sie unter <a href="./using-cfn-updating-stacks-changesets.html">Aktualisieren von Stacks mithilfe von Änderungssätzen</a>.</p>
     
        <h2 id="blue-green-events">Anzeigen von Stack-Ereignissen für Ihre Blau/Grün-Bereitstellung</h2>
        <p>Sie können die Stack-Ereignisse, die bei jedem Schritt der ECS-Bereitstellung generiert wurden, in der Registerkarte <b>Ereignisse</b> der Seite <b>Stack</b> und mithilfe der AWS CLI anzeigen. Weitere Informationen finden Sie unter <a href="./using-cfn-updating-stacks-monitor-stack.html">Überwachen des Fortschritts eines Stack-Updates</a>.</p>
     
        <h2 id="blue-green-template-reference">Vorlage – Referenz</h2>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Hooks": <span>{</span>
  "Logical ID": <span>{</span>
    "Properties": <span>{</span>
      "TrafficRoutingConfig": <span>{</span>
        "Type": "Traffic routing type",
        "TimeBasedCanary": <span>{</span>
          "StepPercentage": Integer,
          "BakeTimeMins": Integer
        },
        "TimeBasedLinear": <span>{</span>
          "StepPercentage": Integer,
          "BakeTimeMins": Integer
        }
      },
      "AdditionalOptions": <span>{</span>"TerminationWaitTimeInMinutes": Integer},
      "LifecycleEventHooks": <span>{</span>
        "BeforeInstall": "FunctionName",
        "AfterInstall": "FunctionName",
        "AfterAllowTestTraffic": "FunctionName",
        "BeforeAllowTraffic": "FunctionName",
        "AfterAllowTraffic": "FunctionName"
      },
      "ServiceRole": "CodeDeployServiceRoleName",
      "Applications": [
        <span>{</span>
          "Target": <span>{</span>
            "Type": "AWS::ECS::Service",
            "LogicalID": "Resource Logical ID"
          },
          "ECSAttributes": <span>{</span>
            "TaskDefinitions": [
              "AWS::ECS::TaskDefinition Resource Logical ID (Blue)",
              "AWS::ECS::TaskDefinition Resource Logical ID (Green)"
            ],
            "TaskSets": [
              "AWS::ECS::TaskSet Resource Logical ID (Blue)",
              "AWS::ECS::TaskSet Resource Logical ID (Green)"
            ],
            "TrafficRouting": <span>{</span>
              "ProdTrafficRoute": <span>{</span>
                "Type": "AWS::ElasticLoadBalancingV2::Listener",
                "LogicalID": "Resource Logical ID (Production)"
              },
              "TestTrafficRoute": <span>{</span>
                "Type": "AWS::ElasticLoadBalancingV2::Listener",
                "LogicalID": "Resource Logical ID (Test)"
              },
              "TargetGroups": [
                "AWS::ElasticLoadBalancingV2::TargetGroup Resource Logical ID (Blue)",
                "AWS::ElasticLoadBalancingV2::TargetGroup Resource Logical ID (Green)"
              ]
            }
          }
        }
      ]
    },
    "Type": "AWS::CodeDeploy::BlueGreen"
  }
}</code></pre>
         
            <h3 id="blue-green-template-reference-props">Eigenschaften</h3>
            <div class="variablelist">
                 
                 
            <dl>
                    <dt><span class="term"><code class="code">Logical ID</code></span></dt>
                    <dd>
                        <p>Die logische ID muss alphanumerisch (A-Za-z0-9) und innerhalb der Vorlage eindeutig sein.</p>
                        <p><em>Erforderlich</em>: Ja</p>
                        <div class="variablelist">
                             
                        <dl>
                                <dt><span class="term"><code class="code">Properties</code></span></dt>
                                <dd>
                                    <p>Eigenschaften des Hooks.</p>
                                    <p><em>Erforderlich</em>: Ja</p>
                                    <div class="variablelist">
                                         
                                         
                                         
                                         
                                         
                                    <dl>
                                            <dt><span class="term"><code class="code">TrafficRoutingConfig</code></span></dt>
                                            <dd>
                                                <p>Konfigurationseinstellungen für Datenverkehrsweiterleitungen</p>
                                                <p><em>Required</em>: No</p>
                                                <p>Die Standardkonfiguration ist eine zeitbasierte Verschiebung des Canary-Verkehrs mit einem Schrittprozentsatz von 15 % und einer Bake-Zeit von fünf Minuten.</p>
                                                <div class="variablelist">
                                                    
                                                     
                                                <dl>
                                                        <dt><span class="term"><code class="code">Type</code></span></dt>
                                                        <dd>
                                                            <p>Der Typ des Datenverkehrs, der von der Bereitstellungskonfiguration verwendet wird.</p>
                                                            <p>Gültige Werte: AllAtOnce | TimeBasedCanary | TimeBasedLinear</p>
                                                            <p><em>Erforderlich</em>: Ja</p>
                                                            <div class="variablelist">
                                                                 
                                                                 
                                                            <dl>
                                                                    <dt><span class="term"><code class="code">TimeBasedCanary</code></span></dt>
                                                                    <dd>
                                                                        <p>Gibt eine Konfiguration an, die den Datenverkehr in zwei Schritten von einer Version der Bereitstellung auf eine andere verlagert.</p>
                                                                        <p><em>Erforderlich</em>: Bedingt: Wenn Sie <code class="code">TimeBasedCanary</code> als Datenverkehrs-Weiterleitungstyp angeben, müssen Sie den Parameter <code class="code">TimeBasedCanary</code> einschließen.</p>
                                                                        <div class="variablelist">
                                                                             
                                                                        <dl>
                                                                                <dt><span class="term"><code class="code">StepPercentage</code></span></dt>
                                                                                <dd>
                                                                                    <p>Der Prozentsatz des Datenverkehrs, der im ersten Schritt einer <code class="code">TimeBasedCanary</code>-Bereitstellung verschoben werden soll. Der Schrittprozentsatz muss 14 % oder höher sein.</p>
                                                                                    <p><em>Required</em>: No</p>
                                                                                </dd>
                                                                            </dl></div>
                                                                        <div class="variablelist">
                                                                             
                                                                        <dl>
                                                                                <dt><span class="term"><code class="code">BakeTimeMins</code></span></dt>
                                                                                <dd>
                                                                                    <p>Die Anzahl der Minuten zwischen der ersten und zweiten Verkehrsverschiebung einer <code class="code">TimeBasedCanary</code>-Bereitstellung.</p>
                                                                                    <p><em>Required</em>: No</p>
                                                                                </dd>
                                                                            </dl></div>
                                                                    </dd>
                                                                 
                                                                    <dt><span class="term"><code class="code">TimeBasedLinear</code></span></dt>
                                                                    <dd>
                                                                        <p>Gibt eine Konfiguration an, die den Datenverkehr in gleichen Schritten von einer Version der Bereitstellung in ein anderes gleiches Inkrement verlagert, wobei zwischen jedem Inkrement eine gleiche Anzahl von Minuten liegt.</p>
                                                                        <p><em>Erforderlich</em>: Bedingt: Wenn Sie <code class="code">TimeBasedLinear</code> als Datenverkehrs-Weiterleitungstyp angeben, müssen Sie den Parameter <code class="code">TimeBasedLinear</code> einschließen.</p>
                                                                        <div class="variablelist">
                                                                             
                                                                        <dl>
                                                                                <dt><span class="term"><code class="code">StepPercentage</code></span></dt>
                                                                                <dd>
                                                                                    <p>Der Prozentsatz des Datenverkehrs, der zu Beginn jedes Inkrements einer <code class="code">TimeBasedLinear</code>-Bereitstellung verschoben wird. Der Schrittprozentsatz muss 14 % oder höher sein.</p>
                                                                                    <p><em>Required</em>: No</p>
                                                                                </dd>
                                                                            </dl></div>
                                                                        <div class="variablelist">
                                                                             
                                                                        <dl>
                                                                                <dt><span class="term"><code class="code">BakeTimeMins</code></span></dt>
                                                                                <dd>
                                                                                    <p>Die Anzahl der Minuten zwischen jeder inkrementellen Verkehrsverschiebung einer <code class="code">TimeBasedLinear</code>-Bereitstellung.</p>
                                                                                    <p><em>Required</em>: No</p>
                                                                                </dd>
                                                                            </dl></div>
                                                                    </dd>
                                                                </dl></div>
                                                        </dd>
                                                    </dl></div>
                                            </dd>
                                         
                                            <dt><span class="term"><code class="code">AdditionalOptions</code></span></dt>
                                            <dd>
                                                <p>Zusätzliche Optionen für die Blau/Grün-Bereitstellung.</p>
                                                <p><em>Required</em>: No</p>
                                                <div class="variablelist">
                                                     
                                                <dl>
                                                        <dt><span class="term"><code class="code">TerminationWaitTimeInMinutes</code></span></dt>
                                                        <dd>
                                                            <p>Gibt die Wartezeit in Minuten an, bevor die blauen Ressourcen beendet werden.</p>
                                                            <p><em>Required</em>: No</p>
                                                        </dd>
                                                    </dl></div>
                                            </dd>
                                         
                                            <dt><span class="term"><code class="code">LifecycleEventHooks</code></span></dt>
                                            <dd>
                                                <p>Verwenden Sie Lebenszyklus-Ereignis-Hooks, um eine Lambda-Funktion anzugeben, die aufrufen  CodeDeploy kann, um eine Bereitstellung zu validieren. Sie können dieselbe Funktion oder eine andere für die Bereitstellungs-Lebenszyklusereignisse verwenden. Nach Abschluss der Validierungstests ruft die Lambda- AfterAllowTraffic Funktion auf  CodeDeploy und liefert ein Ergebnis von <code class="code">Succeeded</code> oder <code class="code">Failed</code>.</p>
                                                <p>Weitere Informationen finden Sie im <a href="https://docs.aws.amazon.com/codedeploy/latest/userguide/reference-appspec-file-structure-hooks.html">AppSpec Abschnitt „Hooks“</a> im <em>AWS CodeDeploy-Benutzerhandbuch.</em></p>
                                                <p><em>Required</em>: No</p>
                                                <div class="variablelist">
                                                     
                                                     
                                                     
                                                     
                                                     
                                                <dl>
                                                        <dt><span class="term"><code class="code">BeforeInstall</code></span></dt>
                                                        <dd>
                                                            <p>Funktion zur Ausführung von Aufgaben, bevor der neue Aufgabensatz erstellt ist.</p>
                                                            <p><em>Required</em>: No</p>
                                                        </dd>
                                                     
                                                        <dt><span class="term"><code class="code">AfterInstall</code></span></dt>
                                                        <dd>
                                                            <p>Funktion zur Ausführung von Aufgaben nach Erstellung des neuen Aufgabensatzes und Zuordnung einer der Zielgruppen.</p>
                                                            <p><em>Required</em>: No</p>
                                                        </dd>
                                                     
                                                        <dt><span class="term"><code class="code">AfterAllowTestTraffic</code></span></dt>
                                                        <dd>
                                                            <p>Funktion zur Ausführung von Aufgaben, wenn der Test-Listener Datenverkehr an den neuen Aufgabensatz sendet.</p>
                                                            <p><em>Required</em>: No</p>
                                                        </dd>
                                                     
                                                        <dt><span class="term"><code class="code">BeforeAllowTraffic</code></span></dt>
                                                        <dd>
                                                            <p>Funktion zur Ausführung von Aufgaben, wenn die zweite Zielgruppe dem neuen Aufgabensatz zugeordnet ist, aber bevor Datenverkehr an den neuen Aufgabensatz umgeleitet wurde.</p>
                                                            <p><em>Required</em>: No</p>
                                                        </dd>
                                                     
                                                        <dt><span class="term"><code class="code">AfterAllowTraffic</code></span></dt>
                                                        <dd>
                                                            <p>Funktion zur Ausführung von Aufgaben, wenn die zweite Zielgruppe Datenverkehr an den neuen Aufgabensatz sendet.</p>
                                                            <p><em>Required</em>: No</p>
                                                        </dd>
                                                    </dl></div>
                                            </dd>
                                         
                                            <dt><span class="term"><code class="code">ServiceRole</code></span></dt>
                                            <dd>
                                                <p>Die Ausführungsrolle für  CloudFormation , die zur Durchführung der Blau/Grün-Bereitstellungen verwendet werden soll. Eine Liste der erforderlichen Berechtigungen finden Sie unter <a href="#blue-green-iam">Für Blau/Grün-Bereitstellungen erforderliche IAM-Berechtigungen</a>.</p>
                                                <p><em>Erforderlich</em>: Ja</p>
                                            </dd>
                                         
                                            <dt><span class="term"><code class="code">Applications</code></span></dt>
                                            <dd>
                                                <p>Gibt die Eigenschaften der Amazon ECS-Anwendung an.</p>
                                                <p><em>Erforderlich</em>: Ja</p>
                                                <div class="variablelist">
                                                     
                                                     
                                                <dl>
                                                        <dt><span class="term"><code class="code">Target</code></span></dt>
                                                        <dd>
                                                            <p></p>
                                                            <p><em>Erforderlich</em>: Ja</p>
                                                            <div class="variablelist">
                                                                 
                                                                 
                                                            <dl>
                                                                    <dt><span class="term"><code class="code">Type</code></span></dt>
                                                                    <dd>
                                                                        <p>Der Ressourcentyp.</p>
                                                                        <p><em>Erforderlich</em>: Ja</p>
                                                                    </dd>
                                                                 
                                                                    <dt><span class="term"><code class="code">LogicalID</code></span></dt>
                                                                    <dd>
                                                                        <p>Die logische ID der Ressource.</p>
                                                                        <p><em>Erforderlich</em>: Ja</p>
                                                                    </dd>
                                                                </dl></div>
                                                        </dd>
                                                     
                                                        <dt><span class="term"><code class="code">ECSAttributes</code></span></dt>
                                                        <dd>
                                                            <p>Die Ressourcen, die die verschiedenen Anforderungen Ihrer Amazon ECS-Anwendungsbereitstellung darstellen.</p>
                                                            <p><em>Erforderlich</em>: Ja</p>
                                                            <div class="variablelist">
                                                                 
                                                                 
                                                                 
                                                            <dl>
                                                                    <dt><span class="term"><code class="code">TaskDefinitions</code></span></dt>
                                                                    <dd>
                                                                        <p>Die logische ID der <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskdefinition.html"><code class="code">AWS::ECS::TaskDefinition</code></a>-Ressource zum Ausführen des Docker-Containers, der Ihre Amazon ECS-Anwendung enthält.</p>
                                                                        <p><em>Erforderlich</em>: Ja</p>
                                                                    </dd>
                                                                 
                                                                    <dt><span class="term"><code class="code">TaskSets</code></span></dt>
                                                                    <dd>
                                                                        <p>Die logischen IDs der <code class="code">AWS::ECS::TaskSet</code>-Ressourcen, die als Aufgabensätze für die Anwendung verwendet werden sollen.</p>
                                                                        <p><em>Erforderlich</em>: Ja</p>
                                                                    </dd>
                                                                 
                                                                    <dt><span class="term"><code class="code">TrafficRouting</code></span></dt>
                                                                    <dd>
                                                                        <p>Gibt Ressourcen an, die für das Weiterleiten des Datenverkehrs verwendet werden.</p>
                                                                        <p><em>Erforderlich</em>: Ja</p>
                                                                        <div class="variablelist">
                                                                             
                                                                             
                                                                             
                                                                        <dl>
                                                                                <dt><span class="term"><code class="code">ProdTrafficRoute</code></span></dt>
                                                                                <dd>
                                                                                    <p>Der Listener, der von Ihrem Load Balancer verwendet wird, um Datenverkehr an Ihre Zielgruppen weiterzuleiten.</p>
                                                                                    <p><em>Erforderlich</em>: Ja</p>
                                                                                    <div class="variablelist">
                                                                                         
                                                                                         
                                                                                    <dl>
                                                                                            <dt><span class="term"><code class="code">Type</code></span></dt>
                                                                                            <dd>
                                                                                                <p>Der Ressourcentyp. <code class="code">AWS::ElasticLoadBalancingV2::Listener</code></p>
                                                                                                <p><em>Erforderlich</em>: Ja</p>
                                                                                            </dd>
                                                                                         
                                                                                            <dt><span class="term"><code class="code">LogicalID</code></span></dt>
                                                                                            <dd>
                                                                                                <p>Die logische ID der Ressource.</p>
                                                                                                <p><em>Erforderlich</em>: Ja</p>
                                                                                            </dd>
                                                                                        </dl></div>
                                                                                </dd>
                                                                             
                                                                                <dt><span class="term"><code class="code">TestTrafficRoute</code></span></dt>
                                                                                <dd>
                                                                                    <p>Der Listener, der von Ihrem Load Balancer verwendet wird, um Datenverkehr an Ihre Zielgruppen weiterzuleiten.</p>
                                                                                    <p><em>Erforderlich</em>: Ja</p>
                                                                                    <div class="variablelist">
                                                                                         
                                                                                         
                                                                                    <dl>
                                                                                            <dt><span class="term"><code class="code">Type</code></span></dt>
                                                                                            <dd>
                                                                                                <p>Der Ressourcentyp. <code class="code">AWS::ElasticLoadBalancingV2::Listener</code></p>
                                                                                                <p><em>Erforderlich</em>: Ja</p>
                                                                                            </dd>
                                                                                         
                                                                                            <dt><span class="term"><code class="code">LogicalID</code></span></dt>
                                                                                            <dd>
                                                                                                <p>Die logische ID der Ressource.</p>
                                                                                                <p><em>Required</em>: No</p>
                                                                                            </dd>
                                                                                        </dl></div>
                                                                                </dd>
                                                                             
                                                                                <dt><span class="term"><code class="code">TargetGroups</code></span></dt>
                                                                                <dd>
                                                                                    <p>Logische ID der Ressourcen, die als Zielgruppen verwendet werden sollen, um den Datenverkehr an das registrierte Ziel weiterzuleiten.</p>
                                                                                    <p><em>Erforderlich</em>: Ja</p>
                                                                                </dd>
                                                                            </dl></div>
                                                                    </dd>
                                                                </dl></div>
                                                        </dd>
                                                    </dl></div>
                                            </dd>
                                        </dl></div>
                                </dd>
                            </dl></div>
                    </dd>
                    
                 
                    <dt><span class="term"><code class="code">Type</code></span></dt>
                    <dd>
                        <p>Der Typ des Hooks. <code class="code">AWS::ElasticLoadBalancingV2::Listener</code></p>
                        <p><em>Erforderlich</em>: Ja</p>
                    </dd>
                </dl></div>
         
     
        <h2 id="blue-green-iam">Für Blau/Grün-Bereitstellungen erforderliche IAM-Berechtigungen</h2>
        <p>Damit die Blau/Grün-Bereitstellungen erfolgreich durchführen  CloudFormation kann, benötigen Sie die folgenden  CodeDeploy Berechtigungen:</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem"><p><code class="code">codedeploy:Get*</code></p></li><li class="listitem"><p><code class="code">codedeploy:CreateCloudFormationDeployment</code></p></li></ul></div>
        <p>Weitere Informationen finden Sie unter <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/list_awscodedeploy.html">Aktionen, Ressourcen und Bedingungsschlüssel für CodeDeploy</a> im <em>AWS Benutzerhandbuch für Identity and Access Management</em>.</p>
     
        <h2 id="blue-green-template-example">Vorlagenbeispiel</h2>
        <p>Im folgenden Beispiel wird eine ECS-Blau/Grün-Bereitstellung über  CodeDeploymit einem Datenverkehrs-Routing-Fortschritt von 15 Prozent pro Schritt mit einer Stabilisierungsdauer von 5 Minuten zwischen jedem Schritt eingerichtet. Das Erstellen eines Stacks mit der Vorlage würde die anfängliche Konfiguration der Bereitstellung einrichten.</p>
        <p>Wenn Sie dann Änderungen an Eigenschaften in der <code class="code">"BlueTaskSet"</code> Ressource vorgenommen haben, für die diese Ressource ersetzt werden muss,  CloudFormation initiiert eine grüne Bereitstellung als Teil der Stack-Aktualisierung.</p>
        <div id="JSON" name="JSON" class="section langfilter">
            <h3 id="blue-green-template-example.json">JSON</h3>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Parameters": <span>{</span>
        "Vpc": <span>{</span>
            "Type": "AWS::EC2::VPC::Id"
        },
        "Subnet1": <span>{</span>
            "Type": "AWS::EC2::Subnet::Id"
        },
        "Subnet2": <span>{</span>
            "Type": "AWS::EC2::Subnet::Id"
        }
    },
    "Transform": [
        "AWS::CodeDeployBlueGreen"
    ],
    "Hooks": <span>{</span>
        "CodeDeployBlueGreenHook": <span>{</span>
            "Properties": <span>{</span>
                "TrafficRoutingConfig": <span>{</span>
                    "Type": "TimeBasedCanary",
                    "TimeBasedCanary": <span>{</span>
                        "StepPercentage": 15,
                        "BakeTimeMins": 5
                    }
                },
                "Applications": [
                    <span>{</span>
                        "Target": <span>{</span>
                            "Type": "AWS::ECS::Service",
                            "LogicalID": "ECSDemoService"
                        },
                        "ECSAttributes": <span>{</span>
                            "TaskDefinitions": [
                                "BlueTaskDefinition",
                                "GreenTaskDefinition"
                            ],
                            "TaskSets": [
                                "BlueTaskSet",
                                "GreenTaskSet"
                            ],
                            "TrafficRouting": <span>{</span>
                                "ProdTrafficRoute": <span>{</span>
                                    "Type": "AWS::ElasticLoadBalancingV2::Listener",
                                    "LogicalID": "ALBListenerProdTraffic"
                                },
                                "TargetGroups": [
                                    "ALBTargetGroupBlue",
                                    "ALBTargetGroupGreen"
                                ]
                            }
                        }
                    }
                ]
            },
            "Type": "AWS::CodeDeploy::BlueGreen"
        }
    },
    "Resources": <span>{</span>
        "ExampleSecurityGroup": <span>{</span>
            "Type": "AWS::EC2::SecurityGroup",
            "Properties": <span>{</span>
                "GroupDescription": "Security group for ec2 access",
                "VpcId": <span>{</span>
                    "Ref": "Vpc"
                },
                "SecurityGroupIngress": [
                    <span>{</span>
                        "IpProtocol": "tcp",
                        "FromPort": 80,
                        "ToPort": 80,
                        "CidrIp": "0.0.0.0/0"
                    },
                    <span>{</span>
                        "IpProtocol": "tcp",
                        "FromPort": 8080,
                        "ToPort": 8080,
                        "CidrIp": "0.0.0.0/0"
                    },
                    <span>{</span>
                        "IpProtocol": "tcp",
                        "FromPort": 22,
                        "ToPort": 22,
                        "CidrIp": "0.0.0.0/0"
                    }
                ]
            }
        },
        "ALBTargetGroupBlue": <span>{</span>
            "Type": "AWS::ElasticLoadBalancingV2::TargetGroup",
            "Properties": <span>{</span>
                "HealthCheckIntervalSeconds": 5,
                "HealthCheckPath": "/",
                "HealthCheckPort": "80",
                "HealthCheckProtocol": "HTTP",
                "HealthCheckTimeoutSeconds": 2,
                "HealthyThresholdCount": 2,
                "Matcher": <span>{</span>
                    "HttpCode": "200"
                },
                "Port": 80,
                "Protocol": "HTTP",
                "Tags": [
                    <span>{</span>
                        "Key": "Group",
                        "Value": "Example"
                    }
                ],
                "TargetType": "ip",
                "UnhealthyThresholdCount": 4,
                "VpcId": <span>{</span>
                    "Ref": "Vpc"
                }
            }
        },
        "ALBTargetGroupGreen": <span>{</span>
            "Type": "AWS::ElasticLoadBalancingV2::TargetGroup",
            "Properties": <span>{</span>
                "HealthCheckIntervalSeconds": 5,
                "HealthCheckPath": "/",
                "HealthCheckPort": "80",
                "HealthCheckProtocol": "HTTP",
                "HealthCheckTimeoutSeconds": 2,
                "HealthyThresholdCount": 2,
                "Matcher": <span>{</span>
                    "HttpCode": "200"
                },
                "Port": 80,
                "Protocol": "HTTP",
                "Tags": [
                    <span>{</span>
                        "Key": "Group",
                        "Value": "Example"
                    }
                ],
                "TargetType": "ip",
                "UnhealthyThresholdCount": 4,
                "VpcId": <span>{</span>
                    "Ref": "Vpc"
                }
            }
        },
        "ExampleALB": <span>{</span>
            "Type": "AWS::ElasticLoadBalancingV2::LoadBalancer",
            "Properties": <span>{</span>
                "Scheme": "internet-facing",
                "SecurityGroups": [
                    <span>{</span>
                        "Ref": "ExampleSecurityGroup"
                    }
                ],
                "Subnets": [
                    <span>{</span>
                        "Ref": "Subnet1"
                    },
                    <span>{</span>
                        "Ref": "Subnet2"
                    }
                ],
                "Tags": [
                    <span>{</span>
                        "Key": "Group",
                        "Value": "Example"
                    }
                ],
                "Type": "application",
                "IpAddressType": "ipv4"
            }
        },
        "ALBListenerProdTraffic": <span>{</span>
            "Type": "AWS::ElasticLoadBalancingV2::Listener",
            "Properties": <span>{</span>
                "DefaultActions": [
                    <span>{</span>
                        "Type": "forward",
                        "ForwardConfig": <span>{</span>
                            "TargetGroups": [
                                <span>{</span>
                                    "TargetGroupArn": <span>{</span>
                                        "Ref": "ALBTargetGroupBlue"
                                    },
                                    "Weight": 1
                                }
                            ]
                        }
                    }
                ],
                "LoadBalancerArn": <span>{</span>
                    "Ref": "ExampleALB"
                },
                "Port": 80,
                "Protocol": "HTTP"
            }
        },
        "ALBListenerProdRule": <span>{</span>
            "Type": "AWS::ElasticLoadBalancingV2::ListenerRule",
            "Properties": <span>{</span>
                "Actions": [
                    <span>{</span>
                        "Type": "forward",
                        "ForwardConfig": <span>{</span>
                            "TargetGroups": [
                                <span>{</span>
                                    "TargetGroupArn": <span>{</span>
                                        "Ref": "ALBTargetGroupBlue"
                                    },
                                    "Weight": 1
                                }
                            ]
                        }
                    }
                ],
                "Conditions": [
                    <span>{</span>
                        "Field": "http-header",
                        "HttpHeaderConfig": <span>{</span>
                            "HttpHeaderName": "User-Agent",
                            "Values": [
                                "Mozilla"
                            ]
                        }
                    }
                ],
                "ListenerArn": <span>{</span>
                    "Ref": "ALBListenerProdTraffic"
                },
                "Priority": 1
            }
        },
        "ECSTaskExecutionRole": <span>{</span>
            "Type": "AWS::IAM::Role",
            "Properties": <span>{</span>
                "AssumeRolePolicyDocument": <span>{</span>
                    "Version": "2012-10-17",
                    "Statement": [
                        <span>{</span>
                            "Sid": "",
                            "Effect": "Allow",
                            "Principal": <span>{</span>
                                "Service": "ecs-tasks.amazonaws.com"
                            },
                            "Action": "sts:AssumeRole"
                        }
                    ]
                },
                "ManagedPolicyArns": [
                    "arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"
                ]
            }
        },
        "BlueTaskDefinition": <span>{</span>
            "Type": "AWS::ECS::TaskDefinition",
            "Properties": <span>{</span>
                "ExecutionRoleArn": <span>{</span>
                    "Fn::GetAtt": [
                        "ECSTaskExecutionRole",
                        "Arn"
                    ]
                },
                "ContainerDefinitions": [
                    <span>{</span>
                        "Name": "DemoApp",
                        "Image": "nginxdemos/hello:latest",
                        "Essential": true,
                        "PortMappings": [
                            <span>{</span>
                                "HostPort": 80,
                                "Protocol": "tcp",
                                "ContainerPort": 80
                            }
                        ]
                    }
                ],
                "RequiresCompatibilities": [
                    "FARGATE"
                ],
                "NetworkMode": "awsvpc",
                "Cpu": "256",
                "Memory": "512",
                "Family": "ecs-demo"
            }
        },
        "ECSDemoCluster": <span>{</span>
            "Type": "AWS::ECS::Cluster",
            "Properties": <span>{</span>}
        },
        "ECSDemoService": <span>{</span>
            "Type": "AWS::ECS::Service",
            "Properties": <span>{</span>
                "Cluster": <span>{</span>
                    "Ref": "ECSDemoCluster"
                },
                "DesiredCount": 1,
                "DeploymentController": <span>{</span>
                    "Type": "EXTERNAL"
                }
            }
        },
        "BlueTaskSet": <span>{</span>
            "Type": "AWS::ECS::TaskSet",
            "Properties": <span>{</span>
                "Cluster": <span>{</span>
                    "Ref": "ECSDemoCluster"
                },
                "LaunchType": "FARGATE",
                "NetworkConfiguration": <span>{</span>
                    "AwsVpcConfiguration": <span>{</span>
                        "AssignPublicIp": "ENABLED",
                        "SecurityGroups": [
                            <span>{</span>
                                "Ref": "ExampleSecurityGroup"
                            }
                        ],
                        "Subnets": [
                            <span>{</span>
                                "Ref": "Subnet1"
                            },
                            <span>{</span>
                                "Ref": "Subnet2"
                            }
                        ]
                    }
                },
                "PlatformVersion": "1.4.0",
                "Scale": <span>{</span>
                    "Unit": "PERCENT",
                    "Value": 100
                },
                "Service": <span>{</span>
                    "Ref": "ECSDemoService"
                },
                "TaskDefinition": <span>{</span>
                    "Ref": "BlueTaskDefinition"
                },
                "LoadBalancers": [
                    <span>{</span>
                        "ContainerName": "DemoApp",
                        "ContainerPort": 80,
                        "TargetGroupArn": <span>{</span>
                            "Ref": "ALBTargetGroupBlue"
                        }
                    }
                ]
            }
        },
        "PrimaryTaskSet": <span>{</span>
            "Type": "AWS::ECS::PrimaryTaskSet",
            "Properties": <span>{</span>
                "Cluster": <span>{</span>
                    "Ref": "ECSDemoCluster"
                },
                "Service": <span>{</span>
                    "Ref": "ECSDemoService"
                },
                "TaskSetId": <span>{</span>
                    "Fn::GetAtt": [
                        "BlueTaskSet",
                        "Id"
                    ]
                }
            }
        }
    }
}</code></pre>

        </div>
        <div id="YAML" name="YAML" class="section langfilter">
            <h3 id="blue-green-template-example.yaml">YAML</h3>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Parameters:
  Vpc:
    Type: 'AWS::EC2::VPC::Id'
  Subnet1:
    Type: 'AWS::EC2::Subnet::Id'
  Subnet2:
    Type: 'AWS::EC2::Subnet::Id'
Transform:
  - 'AWS::CodeDeployBlueGreen'
Hooks:
  CodeDeployBlueGreenHook:
    Properties:
      TrafficRoutingConfig:
        Type: TimeBasedCanary
        TimeBasedCanary:
          StepPercentage: 15
          BakeTimeMins: 5
      Applications:
        - Target:
            Type: 'AWS::ECS::Service'
            LogicalID: ECSDemoService
          ECSAttributes:
            TaskDefinitions:
              - BlueTaskDefinition
              - GreenTaskDefinition
            TaskSets:
              - BlueTaskSet
              - GreenTaskSet
            TrafficRouting:
              ProdTrafficRoute:
                Type: 'AWS::ElasticLoadBalancingV2::Listener'
                LogicalID: ALBListenerProdTraffic
              TargetGroups:
                - ALBTargetGroupBlue
                - ALBTargetGroupGreen
    Type: 'AWS::CodeDeploy::BlueGreen'
Resources:
  ExampleSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      GroupDescription: Security group for ec2 access
      VpcId: !Ref Vpc
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0
        - IpProtocol: tcp
          FromPort: 8080
          ToPort: 8080
          CidrIp: 0.0.0.0/0
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 0.0.0.0/0
  ALBTargetGroupBlue:
    Type: 'AWS::ElasticLoadBalancingV2::TargetGroup'
    Properties:
      HealthCheckIntervalSeconds: 5
      HealthCheckPath: /
      HealthCheckPort: '80'
      HealthCheckProtocol: HTTP
      HealthCheckTimeoutSeconds: 2
      HealthyThresholdCount: 2
      Matcher:
        HttpCode: '200'
      Port: 80
      Protocol: HTTP
      Tags:
        - Key: Group
          Value: Example
      TargetType: ip
      UnhealthyThresholdCount: 4
      VpcId: !Ref Vpc
  ALBTargetGroupGreen:
    Type: 'AWS::ElasticLoadBalancingV2::TargetGroup'
    Properties:
      HealthCheckIntervalSeconds: 5
      HealthCheckPath: /
      HealthCheckPort: '80'
      HealthCheckProtocol: HTTP
      HealthCheckTimeoutSeconds: 2
      HealthyThresholdCount: 2
      Matcher:
        HttpCode: '200'
      Port: 80
      Protocol: HTTP
      Tags:
        - Key: Group
          Value: Example
      TargetType: ip
      UnhealthyThresholdCount: 4
      VpcId: !Ref Vpc
  ExampleALB:
    Type: 'AWS::ElasticLoadBalancingV2::LoadBalancer'
    Properties:
      Scheme: internet-facing
      SecurityGroups:
        - !Ref ExampleSecurityGroup
      Subnets:
        - !Ref Subnet1
        - !Ref Subnet2
      Tags:
        - Key: Group
          Value: Example
      Type: application
      IpAddressType: ipv4
  ALBListenerProdTraffic:
    Type: 'AWS::ElasticLoadBalancingV2::Listener'
    Properties:
      DefaultActions:
        - Type: forward
          ForwardConfig:
            TargetGroups:
              - TargetGroupArn: !Ref ALBTargetGroupBlue
                Weight: 1
      LoadBalancerArn: !Ref ExampleALB
      Port: 80
      Protocol: HTTP
  ALBListenerProdRule:
    Type: 'AWS::ElasticLoadBalancingV2::ListenerRule'
    Properties:
      Actions:
        - Type: forward
          ForwardConfig:
            TargetGroups:
              - TargetGroupArn: !Ref ALBTargetGroupBlue
                Weight: 1
      Conditions:
        - Field: http-header
          HttpHeaderConfig:
            HttpHeaderName: User-Agent
            Values:
              - Mozilla
      ListenerArn: !Ref ALBListenerProdTraffic
      Priority: 1
  ECSTaskExecutionRole:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: ecs-tasks.amazonaws.com
            Action: 'sts:AssumeRole'
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy'
  BlueTaskDefinition:
    Type: 'AWS::ECS::TaskDefinition'
    Properties:
      ExecutionRoleArn: !GetAtt 
        - ECSTaskExecutionRole
        - Arn
      ContainerDefinitions:
        - Name: DemoApp
          Image: 'nginxdemos/hello:latest'
          Essential: true
          PortMappings:
            - HostPort: 80
              Protocol: tcp
              ContainerPort: 80
      RequiresCompatibilities:
        - FARGATE
      NetworkMode: awsvpc
      Cpu: '256'
      Memory: '512'
      Family: ecs-demo
  ECSDemoCluster:
    Type: 'AWS::ECS::Cluster'
    Properties: <span>{</span>}
  ECSDemoService:
    Type: 'AWS::ECS::Service'
    Properties:
      Cluster: !Ref ECSDemoCluster
      DesiredCount: 1
      DeploymentController:
        Type: EXTERNAL
  BlueTaskSet:
    Type: 'AWS::ECS::TaskSet'
    Properties:
      Cluster: !Ref ECSDemoCluster
      LaunchType: FARGATE
      NetworkConfiguration:
        AwsVpcConfiguration:
          AssignPublicIp: ENABLED
          SecurityGroups:
            - !Ref ExampleSecurityGroup
          Subnets:
            - !Ref Subnet1
            - !Ref Subnet2
      PlatformVersion: 1.4.0
      Scale:
        Unit: PERCENT
        Value: 100
      Service: !Ref ECSDemoService
      TaskDefinition: !Ref BlueTaskDefinition
      LoadBalancers:
        - ContainerName: DemoApp
          ContainerPort: 80
          TargetGroupArn: !Ref ALBTargetGroupBlue
  PrimaryTaskSet:
    Type: 'AWS::ECS::PrimaryTaskSet'
    Properties:
      Cluster: !Ref ECSDemoCluster
      Service: !Ref ECSDemoService
      TaskSetId: !GetAtt 
        - BlueTaskSet
        - Id</code></pre>
        </div>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warnung" /> <strong>JavaScript ist in Ihrem Browser nicht verfügbar oder deaktiviert.</strong></p><p>Zur Nutzung der AWS-Dokumentation muss JavaScript aktiviert sein. Weitere Informationen finden auf den Hilfe-Seiten Ihres Browsers.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Dokumentkonventionen</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./modules.html">Verwenden von Modulen</div><div id="next" class="next-link" accesskey="n" href="./cfn-regexes.html">Verwenden von regulären Ausdrücken</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Hat Ihnen diese Seite geholfen? – Ja</div><div class="content"><p>Vielen Dank, dass Sie uns mitgeteilt haben, dass wir gute Arbeit geleistet haben!</p><p>Würden Sie sich einen Moment Zeit nehmen, um uns mitzuteilen, was wir richtig gemacht haben, damit wir noch besser werden?</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/blue-green.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Hat Ihnen diese Seite geholfen? – Nein</div><div class="content"><p>Vielen Dank, dass Sie uns mitgeteilt haben, dass diese Seite überarbeitet werden muss. Es tut uns Leid, dass wir Ihnen nicht weiterhelfen konnten.</p><p>Würden Sie sich einen Moment Zeit nehmen, um uns mitzuteilen, wie wir die Dokumentation verbessern können?</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/blue-green.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>