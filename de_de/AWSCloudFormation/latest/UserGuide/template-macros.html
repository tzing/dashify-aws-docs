<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="de-DE"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Verwenden von AWS CloudFormation Makros zur benutzerdefinierten Verarbeitung von Vorlagen - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="template-macros" /><meta name="default_state" content="template-macros" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-macros.html" /><meta name="description" content="Verwenden Sie Makros, um eine benutzerdefinierte Verarbeitung von Vorlagen durchzuführen, von einfachen Aktionen wie find-and-replace Operationen bis hin zu umfangreichen Transformationen ganzer Vorlagen." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Leitfaden" /><meta name="abstract" content="Erstellen und verwalten Sie AWS Infrastrukturbereitstellungen vorhersehbar und wiederholt mithilfe von AWS CloudFormation mit diesem Benutzerhandbuch." /><meta name="guide-locale" content="de_de" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-macros.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-macros.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Leitfaden" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Leitfaden" /><meta id="panorama-serviceConsolePage" value="Verwenden von AWS CloudFormation Makros zur benutzerdefinierten Verarbeitung von Vorlagen" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Verwenden von AWS CloudFormation Makros zur benutzerdefinierten Verarbeitung von Vorlagen - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-macros.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-macros.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-macros.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,Ressourcenbereitstellung,Ressourcenkonfiguration,Infrastrukturverwaltung,CloudFormer,CloudFormation -Stack,CloudFormation Stackset,CloudFormation -Vorlage,Änderungssatz" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Leitfaden",
        "item" : "https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Arbeiten mit AWS CloudFormation-Vorlagen",
        "item" : "https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Verwenden von AWS CloudFormation Makros zur benutzerdefinierten Verarbeitung von Vorlagen",
        "item" : "https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-guide.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Dokumentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Leitfaden</a></div><div id="page-toc-src"><a href="#template-macros-overview">Funktionsweise von AWS CloudFormation Makros</a><a href="#template-macros-author">Erstellen einer - AWS CloudFormation Makrodefinition</a><a href="#template-macros-use">Verwenden von AWS CloudFormation Makros in Ihren Vorlagen</a><a href="#template-macros-examples-list">Makrobeispiele</a><a href="#template-macros-seealso">Weitere Informationen finden Sie auch unter</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Die vorliegende Übersetzung wurde maschinell erstellt. Im Falle eines Konflikts oder eines Widerspruchs zwischen dieser übersetzten Fassung und der englischen Fassung (einschließlich infolge von Verzögerungen bei der Übersetzung) ist die englische Fassung maßgeblich.</p></awsui-alert><h1 class="topictitle" id="template-macros">Verwenden von AWS CloudFormation Makros zur benutzerdefinierten Verarbeitung von Vorlagen</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Makros ermöglichen es Ihnen, eine benutzerdefinierte Verarbeitung von Vorlagen durchzuführen, von einfachen Aktionen wie  find-and-replace Operationen bis hin zu umfangreichen Transformationen ganzer Vorlagen.</p><p>Um sich ein Bild von der Bandbreite der Möglichkeiten zu machen, sollten Sie die <code class="code">AWS::Serverless</code> Transformationen <code class="code">AWS::Include</code> und in Betracht ziehen, bei denen es sich um Makros handelt, die von gehostet werden AWS CloudFormation:</p><div class="itemizedlist">
         
         
    <ul class="itemizedlist"><li class="listitem">
            <p><code class="code"><a href="./create-reusable-transform-function-snippets-and-add-to-your-template-with-aws-include-transform.html">AWS::Include-Transformation</a></code> ermöglicht es Ihnen, Ausschnitte aus Boilerplate Vorlagen in Ihre Vorlagen einzufügen.</p>
        </li><li class="listitem">
            <p><code class="code"><a href="./transform-aws-serverless.html">AWS::Serverless-Transformation</a></code> nimmt eine komplette Vorlage, die in der AWS Serverless Application Model (AWS SAM)-Syntax geschrieben ist, und transformiert und erweitert sie in eine konforme AWS CloudFormation Vorlage. (Weitere Informationen zu Serverless-Anwendungen und AWS SAM finden Sie unter <a href="https://docs.aws.amazon.com/lambda/latest/dg/deploying-lambda-apps.html">Bereitstellen von Lambda-basierten Anwendungen</a> im <em>Benutzerhandbuch fürAWS Lambda </em>.)</p>
        </li></ul></div><h2 id="template-macros-overview">Funktionsweise von AWS CloudFormation Makros</h2><p>Die Bearbeitung von Vorlagen mit Makros besteht aus zwei wesentlichen Schritten: <em>Erstellen</em> des Makros selbst und dann <em>Verwenden</em> des Makros, um die Verarbeitung Ihrer Vorlagen durchzuführen.</p><p>Um eine Makrodefinition zu erstellen, müssen Sie Folgendes erstellen:</p><div class="itemizedlist">
         
         
    <ul class="itemizedlist"><li class="listitem">
            <p>Eine - AWS Lambda Funktion zur Durchführung der Vorlagenverarbeitung. Diese Lambda-Funktion akzeptiert entweder einen Ausschnitt oder eine ganze Vorlage und alle zusätzlichen Parameter, die Sie definieren. Sie gibt den bearbeiteten Vorlagenausschnitt oder die gesamte Vorlage als Antwort zurück.</p>
        </li><li class="listitem">
            <p>Eine Ressource vom Typ <code class="code"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudformation-macro.html">AWS::CloudFormation::Macro</a></code>, die es Benutzern ermöglicht, die Lambda-Funktion aus AWS CloudFormation Vorlagen heraus aufzurufen. Diese Ressource spezifiziert den ARN der Lambda-Funktion, die für dieses Makro aufgerufen werden soll, und zusätzliche optionale Eigenschaften, die beim Debuggen helfen. Um diese Ressource innerhalb eines Kontos zu erstellen, erstellen Sie eine Vorlage, die eine -<code class="code"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudformation-macro.html">AWS::CloudFormation::Macro</a></code>Ressource enthält, und erstellen Sie dann entweder einen Stack oder ein Stack-Set mit selbstverwalteten Berechtigungen aus der Vorlage. AWS CloudFormation StackSets unterstützt derzeit nicht das Erstellen oder Aktualisieren von Stack-Sets mit serviceverwalteten Berechtigungen aus Vorlagen, die auf Makros verweisen.</p>
        </li></ul></div><p>Um ein Makro zu verwenden, referenzieren Sie das Makro in Ihrer Vorlage:</p><div class="itemizedlist">
         
         
    <ul class="itemizedlist"><li class="listitem">
            <p>Um einen Abschnitt oder <em>Ausschnitt</em> einer Vorlage zu bearbeiten, verweisen Sie in einer <code class="code"><a href="./intrinsic-function-reference-transform.html">Fn::Transform</a></code>-Funktion auf das Makro, das relativ zu dem zu transformierenden Vorlageninhalt angeordnet ist. Bei Verwendung von <code class="code">Fn::Transform</code> können Sie außerdem beliebige Parameter übergeben.</p>
        </li><li class="listitem">
            <p>Um eine gesamte Vorlage zu bearbeiten, referenzieren Sie das Makro im Abschnitt <a href="./transform-section-structure.html">Transform</a> der Vorlage.</p>
        </li></ul></div><p>Als Nächstes erstellen Sie normalerweise einen Änderungssatz und führen diesen aus. (Durch die Verarbeitung von Makros können mehrere Ressourcen hinzugefügt werden, die Ihnen möglicherweise nicht bekannt sind. Um sicherzustellen, dass Sie alle durch Makros eingeführten Änderungen kennen, wird dringend empfohlen, Änderungssätze zu verwenden.) AWS CloudFormation übergibt den angegebenen Vorlageninhalt zusammen mit allen zusätzlich angegebenen Parametern an die in der Makro-Ressource angegebene Lambda-Funktion. Die Lambda-Funktion gibt den bearbeiteten Vorlageninhalt zurück, sei es ein Ausschnitt oder eine ganze Vorlage.</p><p>Nachdem alle Makros in der Vorlage aufgerufen wurden, AWS CloudFormation generiert einen Änderungssatz, der den verarbeiteten Vorlageninhalt enthält. Nachdem Sie den Änderungssatz überprüft haben, führen Sie ihn aus, um die Änderungen anzuwenden.</p><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Wichtig</h6></div><div class="awsdocs-note-text"><p>Wenn Ihre Stack-Set-Vorlage auf ein oder mehrere Makros verweist, müssen Sie das Stack-Set direkt aus der verarbeiteten Vorlage erstellen, ohne vorher die resultierenden Änderungen in einem Änderungssatz zu überprüfen. Um das Stack-Set direkt zu erstellen oder zu aktualisieren, müssen Sie die <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_UpdateStackSet.html"><code class="code">UpdateStackSet</code></a> Aktion <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_CreateStackSet.html"><code class="code">CreateStackSet</code></a> oder verwenden und die <code class="code">CAPABILITY_AUTO_EXPAND</code> Funktion angeben. Bevor Sie einen Stack-Set aus einer Vorlage erstellen oder aktualisieren, die direkt auf Makros verweist, sollten Sie sicherstellen, dass Sie wissen, welche Verarbeitung die Makros ausführen.</p></div></div><div class="mediaobject">
         
            
            <img src="images/template-macro-use.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;            Verwenden Sie die Fn::Transform intrinsische -Funktion oder den -TransformAbschnitt der Vorlage, um den Vorlageninhalt und die zugehörigen Parameter an die dem Makro zugrunde liegende - Lambda Funktion zu übergeben, die den verarbeiteten Vorlageninhalt zurückgibt.&#xA;        " style="max-width:100%" />
         
         
    </div><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Anmerkung</h6></div><div class="awsdocs-note-text"><p>Wenn Ihnen die direkte Erstellung oder Aktualisierung eines Stacks von einer verarbeiteten Vorlage geläufig ist und Sie die vorgeschlagenen Änderungen nicht vorher in einem Änderungssatz überprüfen müssen, können Sie während einer <code class="code">CreateStack</code>- oder <code class="code">UpdateStack</code>-Anforderung die <code class="code">CAPABILITY_AUTO_EXPAND</code>-Funktion angeben. Sie sollten Stacks nur dann direkt aus einer Vorlage erstellen, die auf mit Makros verweist, wenn Sie wissen, welche Verarbeitungsschritte das Makro ausführt.</p><p>Weitere Informationen finden Sie unter <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_CreateStack.html">CreateStack</a> oder <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_UpdateStack.html">UpdateStack</a> in der API<em>AWS CloudFormation -Referenz zu </em>.</p></div></div><h2 id="template-macros-author">Erstellen einer - AWS CloudFormation Makrodefinition</h2>
        <p>Wenn Sie eine Makrodefinition erstellen, stellt die Makrodefinition die zugrunde liegende Lambda-Funktion im angegebenen Konto zur Verfügung, sodass sie zur Verarbeitung der Vorlagen AWS CloudFormation aufruft.</p>
        
        <h3 id="template-macros-lambda-interface">AWS CloudFormation -Makro-Funktionsschnittstelle</h3>
            <p>Bei Makros AWS CloudFormation ruft die zugrunde liegenden Lambda-Funktionen mit der folgenden Ereigniszuordnung auf. AWS CloudFormation sendet seine Anforderung im JSON-Format und erwartet, dass die Funktionsantwort auch als JSON formatiert wird.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "region" : "<code class="replaceable">us-east-1</code>",
    "accountId" : "<code class="replaceable">$ACCOUNT_ID</code>",
    "fragment" : <span>{</span> <code class="replaceable">...</code> },
    "transformId" : "<code class="replaceable">$TRANSFORM_ID</code>",
    "params" : <span>{</span> <code class="replaceable">...</code> },
    "requestId" : "<code class="replaceable">$REQUEST_ID</code>",
    "templateParameterValues" : <span>{</span> <code class="replaceable">...</code> }
}</code></pre>

            <div class="itemizedlist">
                 
                 
                 
                 
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem"><p><b>Region</b></p>
                    <p>Die Region, in der sich das Makro befindet.</p>
                </li><li class="listitem"><p><b>accountId</b></p>
                    <p>Die Konto-ID des Kontos, von dem aus das Makro die Lambda-Funktion aufruft.</p>
                </li><li class="listitem"><p><b>fragment</b></p>
                    <p>Der Vorlageninhalt, der für die benutzerdefinierte Verarbeitung zur Verfügung steht, im JSON-Format.</p>
                    <div class="itemizedlist">
                         
                         
                    <ul class="itemizedlist"><li class="listitem"><p>Bei Makros, die im Vorlagenabschnitt <code class="code">Transform</code> enthalten sind, ist dies die gesamte Vorlage mit Ausnahme des Abschnitts <code class="code">Transform</code>.</p></li><li class="listitem"><p>Bei Makros, die in einem intrinsischen <code class="code">Fn::Transform</code>-Funktionsaufruf enthalten sind, sind dies alle Geschwisterknoten (und ihre Unterknoten), basierend auf der Position der intrinsischen Funktion innerhalb der Vorlage, mit Ausnahme der <code class="code">Fn::Transform</code> Funktion. Weitere Informationen finden Sie unter <a href="#template-macros-scope">AWS CloudFormation Makrobereich</a>.</p></li></ul></div>
                </li><li class="listitem"><p><b>transformId</b></p>
                    <p>Der Name des Makros, das diese Funktion aufruft.</p>
                </li><li class="listitem"><p><b>params</b></p>
                    <p>Bei <code class="code">Fn::Transform</code> Funktionsaufrufen werten alle angegebenen Parameter für die Funktion aus. AWS CloudFormation wertet diese Parameter nicht aus, bevor sie an die Funktion übergeben werden.</p>
                    <p>Für Makros, die im Vorlagenabschnitt <code class="code">Transform</code> enthalten sind, ist dieser Abschnitt leer.</p>
                </li><li class="listitem"><p><b>requestId</b></p>
                    <p>Die ID der Anforderung, die diese Funktion aufruft.</p>
                </li><li class="listitem"><p><b>templateParameterValues</b></p>
                    <p>Alle Parameter, die im Abschnitt <a href="./parameters-section-structure.html">Parameter</a> der Vorlage angegeben sind. AWS CloudFormation wertet diese Parameter aus, bevor sie an die Funktion übergeben werden.</p>
                </li></ul></div>
            <p>AWS CloudFormation erwartet, dass die zugrunde liegende Funktion eine Antwort im folgenden JSON-Format zurückgibt:</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "requestId" : "<code class="replaceable">$REQUEST_ID</code>",
    "status" : "<code class="replaceable">$STATUS</code>",
    "fragment" : <span>{</span> <code class="replaceable">...</code> }
    "errorMessage": "optional error message for failures"
}</code></pre>
            <div class="itemizedlist">
                 
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem"><p><b>requestId</b></p>
                    <p>Die ID der Anforderung, die diese Funktion aufruft. Diese muss mit der Anforderungs-ID übereinstimmen, die von AWS CloudFormation beim Aufrufen der Funktion bereitgestellt wird.</p>
                </li><li class="listitem"><p><b>status</b></p>
                    <p>Der Status der Anforderung (Groß- und Kleinschreibung wird nicht berücksichtigt). Dieser sollte auf <code class="code">success</code> festgelegt werden. AWS CloudFormation behandelt jede andere Antwort als Fehler.</p>
                </li><li class="listitem"><p><b>fragment</b></p>
                    <p>Der Inhalt der verarbeiteten Vorlage für , der in die verarbeitete Vorlage aufgenommen werden AWS CloudFormation soll, einschließlich der Geschwister. AWS CloudFormation Ersetzt den Vorlageninhalt, der an die Lambda-Funktion übergeben wird, durch das Vorlagenfragment, das es in der Lambda-Antwort erhält.</p>
                    <p>Der Inhalt der verarbeiteten Vorlage muss gültiges JSON sein und seine Aufnahme in die verarbeitete Vorlage muss zu einer gültigen Vorlage führen.</p>
                    <p>Wenn Ihre Funktion den Vorlageninhalt, den an sie übergibt, AWS CloudFormation nicht ändert, Sie diesen Inhalt aber trotzdem in die verarbeitete Vorlage aufnehmen müssen, muss Ihre Funktion diesen Vorlageninhalt an AWS CloudFormation in ihrer Antwort zurückgeben.</p>
                </li><li class="listitem">
                    <p><b>errorMessage</b></p>
                    <p>Die Fehlermeldung, die erklärt, warum die Transformation fehlgeschlagen ist.  CloudFormation zeigt diese Fehlermeldung im Bereich <b>Ereignisse</b> der Seite <b>Stack-Details</b> für Ihren Stack an.</p>
                    <p>Beispiel: „Fehler beim Erstellen des Änderungssatzes: Transformation der <code class="replaceable">AWS-Konto
-Kontonummer</code>::<code class="replaceable">Makroname</code> ist fehlgeschlagen mit: <code class="replaceable">Fehlermeldungs-Zeichenfolge</code>“.</p>
                </li></ul></div>
            <p>Informationen zu weiteren Überlegungen bei der Erstellung von Makros finden Sie unter <a href="#template-macros-considerations">Überlegungen beim Erstellen von AWS CloudFormation Makrodefinitionen</a>.</p>
         
        
        <h3 id="template-macros-permissions">AWS CloudFormation Umfang und Berechtigungen des -Makrokontos</h3>
            <p>Makros können Sie nur in dem Konto verwenden, in dem sie als Ressource angelegt wurden. Der Name des Makros muss innerhalb eines bestimmten Kontos eindeutig sein. Sie können jedoch die gleiche Funktionalität in mehreren Konten zur Verfügung stellen, indem Sie den kontenübergreifenden Zugriff auf die zugrundeliegende Lambda-Funktion aktivieren und dann Makrodefinitionen erstellen, die sich in mehreren Konten auf diese Funktion beziehen. Im folgenden Beispiel enthalten drei Konten Makrodefinitionen, die jeweils auf dieselbe Lambda-Funktion verweisen.</p>
            <div class="mediaobject">
                 
                    <img src="images/template-macro-accounts.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                    Indem Sie den kontoübergreifenden Zugriff auf die Lambda Funktion zulassen, AWS können Sie Makros in mehreren Konten erstellen, die auf diese Funktion verweisen.&#xA;                " style="max-width:100%" />
                 
                 
            </div>
            <p>Weitere Informationen finden Sie unter <a href="https://docs.aws.amazon.com/lambda/latest/dg/access-control-overview.html">Übersicht über die Verwaltung von Zugriffsberechtigungen für Ihre AWS Lambda-Ressourcen</a> im <em>AWS Lambda -Entwicklerhandbuch</em>.</p>
            <p>Um eine Makrodefinition zu erstellen, muss der Benutzer die Berechtigung haben, einen Stack oder Stack-Set innerhalb des angegebenen Kontos zu erstellen.</p>
            <p>Damit ein in einer Vorlage enthaltenes Makro erfolgreich ausführen AWS CloudFormation kann, muss der Benutzer über <code class="code">Invoke</code> Berechtigungen für die zugrunde liegende Lambda-Funktion verfügen. Um eine mögliche Ausweitung der Berechtigungen zu verhindern, AWS CloudFormation übernimmt die Rolle des Benutzers während der Ausführung des Makros. Weitere Informationen finden Sie unter <a href="https://docs.aws.amazon.com/lambda/latest/dg/intro-permission-model.html">Lambda-Berechtigungsmodell</a> im <em>Entwicklerhandbuch fürAWS Lambda </em> und <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/list_lambda.html">Aktionen und Bedingungskontextschlüssel für AWS Lambda</a> im <em>IAM-Benutzerhandbuch</em>.</p>
            <p>Die <a href="./create-reusable-transform-function-snippets-and-add-to-your-template-with-aws-include-transform.html">AWS::Include-Transformation</a> Transformationen <a href="./transform-aws-serverless.html">AWS::Serverless-Transformation</a> und sind Makros, die von gehostet werden AWS CloudFormation. Es sind keine besonderen Berechtigungen erforderlich, um sie zu verwenden, und sie sind von jedem Konto in AWS CloudFormationaus verfügbar.</p>
          
        <h3 id="template-macros-debug">Debuggen von AWS CloudFormation Makros</h3>
            <p>Um das Debuggen zu erleichtern, können Sie beim Anlegen des Ressourcentyps <code class="code">LogGroupName</code> für Ihr Makro auch die Eigenschaften <code class="code">LogRoleArn</code> und <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudformation-macro.html">AWS::CloudFormation::Macro</a> angeben. Mit diesen Eigenschaften können Sie die  CloudWatch Protokollgruppe angeben, an die Fehlerprotokollierungsinformationen AWS CloudFormation sendet, wenn die dem Makro zugrunde liegende AWS Lambda Funktion aufgerufen wird, und die Rolle AWS CloudFormation sollte beim Senden von Protokolleinträgen an diese Protokolle übernehmen.</p>
          
        <h3 id="template-macros-billing">Fakturierung</h3>
            <p>Wenn ein Makro ausgeführt wird, werden dem Besitzer der Lambda-Funktion alle mit der Ausführung dieser Funktion verbundenen Kosten in Rechnung gestellt.</p>
            <p>Die <a href="./create-reusable-transform-function-snippets-and-add-to-your-template-with-aws-include-transform.html">AWS::Include-Transformation</a> Transformationen <a href="./transform-aws-serverless.html">AWS::Serverless-Transformation</a> und sind Makros, die von gehostet werden AWS CloudFormation. Ihre Nutzung ist kostenlos.</p>
         
        <h3 id="template-macros-considerations">Überlegungen beim Erstellen von AWS CloudFormation Makrodefinitionen</h3>
            <p>Beachten Sie bei der Erstellung von Makrodefinitionen Folgendes:</p>
            <div class="itemizedlist">
                 
                 
                 
                 
                
                 
                 
                 
                
                 
                 
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem"><p>Makros werden nur in unterstützt, in AWS-Regionen denen verfügbar AWS Lambda ist. Eine Liste der Regionen, in denen Lambda verfügbar ist, finden Sie unter <a href="https://docs.aws.amazon.com/general/latest/gr/lambda-service.html">AWS Lambda Endpunkte und Kontingente</a>.</p></li><li class="listitem"><p>Alle verarbeiteten Vorlagenausschnitte müssen gültiges -JSON sein.</p></li><li class="listitem"><p>Alle verarbeiteten Vorlagenausschnitte müssen Validierungsprüfungen für eine Stack-Erstellung, Stack-Aktualisierung, Stack-Set-Erstellung oder einen Stack-Set-Aktualisierungs-Vorgang durchlaufen.</p></li><li class="listitem"><p>AWS CloudFormation löst zuerst Makros auf und verarbeitet dann die Vorlage. Die resultierende Vorlage muss gültiger JSON-Code sein und darf nicht größer als das Vorlagengrößenlimit sein.</p></li><li class="listitem"><p>Aufgrund der Reihenfolge, in der Elemente in einer Vorlage  CloudFormation verarbeitet, kann ein Makro keine Module in den verarbeiteten Vorlageninhalt aufnehmen, den es an zurückgibt CloudFormation. Weitere Informationen zu Modulen finden Sie unter <a href="https://docs.aws.amazon.com/cloudformation-cli/latest/userguide/modules.html">Entwickeln von Modulen</a> im <em>CloudFormation CLI-Benutzerhandbuch.</em></p></li><li class="listitem"><p>Bei Verwendung der Update-Rollback-Funktion AWS CloudFormation verwendet eine Kopie der ursprünglichen Vorlage. Es wird ein Rollback auf die ursprüngliche Vorlage ausgeführt, selbst wenn der Codeausschnitt geändert wurde.</p></li><li class="listitem"><p>Die Einbindung von Makros in Makros funktioniert nicht, da wir Makros nicht iterativ verarbeiten.</p></li><li class="listitem"><p>Die intrinsische <code class="code">Fn::ImportValue</code>-Funktion wird derzeit in Makros nicht unterstützt.</p></li><li class="listitem"><p>Die in der Vorlage enthaltenen intrinsischen Funktionen werden nach allen Makros ausgewertet. Daher können die von Ihrem Makro zurückgegebenen verarbeiteten Vorlageninhalte Aufrufe von intrinsischen Funktionen beinhalten, die wie gewohnt ausgewertet werden.</p></li><li class="listitem"><p>StackSets unterstützt derzeit nicht das Erstellen oder Aktualisieren von Stack-Sets mit serviceverwalteten Berechtigungen aus Vorlagen, die auf AWS CloudFormation Makros verweisen.</p></li><li class="listitem"><p>Wenn Ihre Stack-Set-Vorlage auf ein oder mehrere Makros verweist, müssen Sie das Stack-Set direkt aus der verarbeiteten Vorlage erstellen oder aktualisieren, ohne vorher die resultierenden Änderungen in einem Änderungssatz zu überprüfen. Um das Stack-Set direkt zu erstellen oder zu aktualisieren, verwenden Sie die <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_UpdateStackSet.html"><code class="code">UpdateStackSet</code></a> Aktion <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_CreateStackSet.html"><code class="code">CreateStackSet</code></a> oder und geben Sie die <code class="code">CAPABILITY_AUTO_EXPAND</code> Funktion an. Verarbeitungsmakros können mehrere Ressourcen hinzufügen, die Ihnen möglicherweise nicht bekannt sind. Bevor Sie einen Stack-Set aus einer Vorlage erstellen oder aktualisieren, die direkt auf Makros verweist, sollten Sie sicherstellen, dass Sie wissen, welche Verarbeitung die Makros ausführen.</p></li><li class="listitem">
                    
                    <p>Änderungssätze unterstützen derzeit keine verschachtelten Stacks. Wenn Sie einen Stack mit einer Vorlage erstellen oder aktualisieren möchten, die auf Makros verweist <em>und</em> verschachtelte Stacks enthält, müssen Sie den Stack direkt erstellen oder aktualisieren. Verwenden Sie dazu die <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_UpdateStack.html"><code class="code">UpdateStack</code></a> Aktion <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_CreateStack.html"><code class="code">CreateStack</code></a> oder und geben Sie die <code class="code">CAPABILITY_AUTO_EXPAND</code> Funktion an.</p>
                </li></ul></div>
         
        <div class="procedure"><h6>So erstellen Sie eine - AWS CloudFormation Makrodefinition:</h6><ol><li>
                <p><a href="https://docs.aws.amazon.com/lambda/latest/dg/lambda-app.html"> Erstellen Sie eine - AWS Lambda Funktion</a>, die AWS CloudFormation Vorlagen verarbeitet.</p>
                <p>Die von Ihnen erstellte Lambda-Funktion übernimmt die Verarbeitung der Vorlageninhalte. Ihre Funktion kann jeden Teil einer Vorlage bis hin zur gesamten Vorlage bearbeiten. Informationen über die Ereigniszuordnung, an die sich Ihre Funktion halten muss, finden Sie unter <a href="#template-macros-lambda-interface">AWS CloudFormation -Makro-Funktionsschnittstelle</a>. Informationen zu weiteren Überlegungen bei der Erstellung von Makros finden Sie unter <a href="#template-macros-considerations">Überlegungen beim Erstellen von AWS CloudFormation Makrodefinitionen</a>.</p>
            </li><li>
                <p><a href="./template-guide.html">Erstellen Sie eine Vorlage</a> mit einem -<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudformation-macro.html">AWS::CloudFormation::Macro</a>Ressourcentyp.</p>
                <div class="itemizedlist">
                     
                     
                <ul class="itemizedlist"><li class="listitem"><p>Sie müssen die Eigenschaften <code class="code">Name</code> und <code class="code">FunctionName</code> angeben. Die -<code class="code">FunctionName</code>Eigenschaft gibt den ARN der Lambda-Funktion an, die aufgerufen werden soll, wenn das Makro AWS CloudFormation ausführt.</p></li><li class="listitem"><p>Um das Debugging zu erleichtern, können Sie zusätzlich die Eigenschaften <code class="code">LogGroupName</code> und <code class="code">LogRoleArn</code> angeben.</p></li></ul></div>
            </li><li>
                <p><a href="./cfn-console-create-stack.html">Erstellen Sie einen Stack</a> aus der Vorlage, die das Makro im gewünschten Konto enthält, oder <a href="./stacksets-getting-started-create.html#stacksets-getting-started-create-self-managed">erstellen Sie ein Stack-Set mit selbstverwalteten Berechtigungen</a> aus der Vorlage, die auf das Makro im Administratorkonto verweist, und erstellen Sie dann Stack-Instances in den gewünschten Zielkonten.</p>
                <p>Nachdem erfolgreich Stacks erstellt AWS CloudFormation hat, die die Makrodefinition enthalten, ist das Makro für die Verwendung innerhalb dieser Konten verfügbar.</p>
            </li></ol></div>


    <h2 id="template-macros-use">Verwenden von AWS CloudFormation Makros in Ihren Vorlagen</h2>
        <p>Nachdem die Stacks, die die Makrodefinition enthalten, erfolgreich erstellt AWS CloudFormation hat, ist das Makro für die Verwendung innerhalb dieser Konten verfügbar. Sie verwenden ein Makro, indem Sie es in einer Vorlage an der Stelle referenzieren, die für die zu bearbeitenden Vorlageninhalte relevant ist.</p>
        <h3 id="template-macros-order">AWS CloudFormation -Makro-Bewertungsreihenfolge</h3>
            <p>Sie können auf mehrere Makros in einer bestimmten Vorlage verweisen, einschließlich Transformationen, die von gehostet werden AWS CloudFormation, wie z. B. <a href="./create-reusable-transform-function-snippets-and-add-to-your-template-with-aws-include-transform.html">AWS::Include-Transformation</a> und <a href="./transform-aws-serverless.html">AWS::Serverless-Transformation</a>.</p>
            <p>Makros werden so ausgewertet, dass sie aufgrund ihrer Position in der Vorlage von den am tiefsten verschachtelten nach außen bis zu den allgemeinsten reichen. Makros an derselben Stelle in der Vorlage werden seriell anhand der Reihenfolge, in der sie aufgelistet sind, ausgewertet.</p>
            <p>Transformationen wie <code class="code">AWS::Include</code> und <code class="code">AWS::Transform</code> werden in Bezug auf die Reihenfolge und den Anwendungsbereich wie alle anderen Makros behandelt.</p>
            <p>Im folgenden Vorlagenbeispiel AWS CloudFormation wertet beispielsweise zuerst das <code class="code">PolicyAdder</code> Makro aus, da es das am tiefsten verschachtelte Makro in der template ist. AWS CloudFormation wertet <code class="code">MyMacro</code> vor aus, <code class="code">AWS::Serverless</code> da es <code class="code">AWS::Serverless</code> im <code class="code">Transform</code> Abschnitt vor aufgeführt ist.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWSTemplateFormatVersion: 2010-09-09
 Transform: [MyMacro, AWS::Serverless]
 Resources:
    WaitCondition:
      Type: AWS::CloudFormation::WaitCondition
    MyBucket:
      Type: 'AWS::S3::Bucket'
      Properties:
        BucketName: MyBucket
        Tags: [<span>{</span>"key":"value"}]
        'Fn::Transform':
          - Name: PolicyAdder
        CorsConfiguration:[]
    MyEc2Instance:
      Type: 'AWS::EC2::Instance'
      Properties:
        ImageID: "ami-123"</code></pre>
          
        
        <h3 id="template-macros-scope">AWS CloudFormation Makrobereich</h3>
            <p>Makros, die im Abschnitt <code class="code">Transform</code> einer Vorlage referenziert werden, können den gesamten Inhalt dieser Vorlage verarbeiten.</p>
            <p>Makros, die in einer <code class="code">Fn::Transform</code>-Funktion referenziert werden, können den Inhalt eines beliebigen der Geschwisterelemente (einschließlich untergeordneter) der <code class="code">Fn::Transform</code>-Funktion in der Vorlage verarbeiten.</p>
            <p>Beispielsweise kann <code class="code">AWS::Include</code> im untenstehenden Vorlagenbeispiel die <code class="code">MyBucket</code>-Eigenschaften verarbeiten, basierend auf der Position der <code class="code">Fn::Transform</code>-Funktion, die sie enthält. <code class="code">MyMacro</code> kann den Inhalt der gesamten Vorlage verarbeiten, da sie in den Abschnitt <code class="code">Transform</code> aufgenommen wurde.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Kopieren"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">
// Start of processable content for MyMacro
AWSTemplateFormatVersion: 2010-09-09 
 Transform: [MyMacro]
 Resources:
    WaitCondition:
      Type: AWS::CloudFormation::WaitCondition
    MyBucket:
      Type: 'AWS::S3::Bucket'  //Start of processable content for AWS::Include
      Properties:
        BucketName: MyBucket 
        Tags: [<span>{</span>"key":"value"}] 
        'Fn::Transform':
          - Name: 'AWS::Include'
              Parameters:
                Location: s3://<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/MyFileName.yaml
        CorsConfiguration:[]   //End of processable content for AWS::Include
    MyEc2Instance:
      Type: 'AWS::EC2::Instance' 
      Properties:
        ImageID: "ami-123"
// End of processable content for MyMacro         </code></pre>
          
        
         
         <h3 id="template-macros-change-sets">Änderungssätze und AWS CloudFormation Makros</h3>
            <p>Um einen Stack mit einer Vorlage zu erstellen oder zu aktualisieren, die auf Makros verweist, erstellen Sie normalerweise einen Änderungssatz und führen ihn dann aus. Ein Änderungssatz beschreibt die Aktionen, die  CloudFormation  basierend auf der verarbeiteten Vorlage ausführen wird. Verarbeitungsmakros können mehrere Ressourcen hinzufügen, die Ihnen möglicherweise nicht bekannt sind. Um sicherzustellen, dass Sie alle Änderungen kennen, die durch Makros eingeführt werden, wird dringend die Verwendung von Änderungssätzen empfohlen. Nachdem Sie den Änderungssatz überprüft haben, können Sie ihn ausführen, um die Änderungen tatsächlich anzuwenden.</p>
            <p>Ein Makro kann Ihrer Vorlage IAM-Ressourcen hinzufügen. Für diese Ressourcen erfordert AWS CloudFormation
, dass Sie <a href="./using-iam-template.html#using-iam-capabilities">ihre Funktionen angeben</a>. Da nicht wissen AWS CloudFormation kann, welche Ressourcen vor der Verarbeitung Ihrer Vorlage hinzugefügt werden, müssen Sie beim Erstellen des Änderungssatzes möglicherweise die IAM-Funktionen bestätigen, je nachdem, ob die referenzierten Makros IAM-Ressourcen enthalten. Auf diese Weise AWS CloudFormation verfügt beim Ausführen des Änderungssatzes über die erforderlichen Funktionen zum Erstellen von IAM-Ressourcen.</p>
            <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Wichtig</h6></div><div class="awsdocs-note-text"><p>Wenn Ihre Stack-Set-Vorlage auf ein oder mehrere Makros verweist, müssen Sie das Stack-Set direkt aus der verarbeiteten Vorlage erstellen, ohne vorher die resultierenden Änderungen in einem Änderungssatz zu überprüfen. Um das Stack-Set direkt zu erstellen oder zu aktualisieren, müssen Sie die <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_UpdateStackSet.html"><code class="code">UpdateStackSet</code></a> Aktion <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_CreateStackSet.html"><code class="code">CreateStackSet</code></a> oder verwenden und die <code class="code">CAPABILITY_AUTO_EXPAND</code> Funktion angeben. Bevor Sie einen Stack-Set aus einer Vorlage erstellen oder aktualisieren, die direkt auf Makros verweist, sollten Sie sicherstellen, dass Sie wissen, welche Verarbeitung die Makros ausführen.</p></div></div>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Anmerkung</h6></div><div class="awsdocs-note-text"><p>Wenn Ihnen die direkte Erstellung oder Aktualisierung eines Stacks von einer verarbeiteten Vorlage geläufig ist und Sie die vorgeschlagenen Änderungen nicht vorher in einem Änderungssatz überprüfen müssen, können Sie während einer <code class="code">CreateStack</code>- oder <code class="code">UpdateStack</code>-Anforderung die <code class="code">CAPABILITY_AUTO_EXPAND</code>-Funktion angeben. Sie sollten Stacks nur dann direkt von einer Stack-Vorlage mit Makros erstellen, wenn Sie wissen, welche Verarbeitungsschritte das Makro ausführt. Sie können Änderungssätze nicht mit Stack-Set-Makros verwenden; Sie müssen Ihr Stack-Set direkt aktualisieren.</p><p>Weitere Informationen finden Sie unter <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_CreateStack.html"><code class="code">CreateStack</code></a> oder <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_UpdateStack.html"><code class="code">UpdateStack</code></a> in der API<em>AWS CloudFormation -Referenz zu </em>.</p></div></div>
            <p>Wenn Sie die verwenden AWS CLI, können Sie die <code class="code">deploy</code> Befehle <code class="code">package</code> und verwenden, um die Anzahl der Schritte zum Starten von Stacks aus Vorlagen zu reduzieren, die auf Makros verweisen. Weitere Informationen finden Sie unter <a href="https://docs.aws.amazon.com/lambda/latest/dg/deploying-lambda-apps.html">Bereitstellen Lambda-basierter Anwendungen</a> im <em>Entwicklerhandbuch fürAWS Lambda </em>.</p>
         
   
        <h3 id="template-macros-template-stage">Vorlagenphase und  CloudFormation Makros</h3>
            <p>Die <em>Stufe</em> einer Vorlage gibt an, ob es sich bei der Vorlage um die ursprünglich vom Benutzer übermittelte Vorlage handelt oder um eine, in der die Makros verarbeitet AWS CloudFormation hat.</p>
            <div class="itemizedlist">
                 
                 
            <ul class="itemizedlist"><li class="listitem"><p><code class="code">Original</code>: Die Vorlage, die der Benutzer ursprünglich zur Erstellung oder Aktualisierung des Stacks oder Stack-Sets übermittelt hat.</p></li><li class="listitem"><p><code class="code">Processed</code>: Die Vorlage, die zum Erstellen oder Aktualisieren des Stacks oder Stack-Sets AWS CloudFormation verwendet wird, nachdem alle referenzierten Makros verarbeitet wurden. Die verarbeitete Vorlage wird als JSON formatiert, auch wenn die ursprüngliche Vorlage als YAML formatiert wurde.</p></li></ul></div>
            <p>Verwenden Sie die verarbeitete Vorlage, um Stack-Probleme zu beheben. Wenn eine Vorlage keine Makros referenziert, sind die ursprünglichen und verarbeiteten Vorlagen identisch.</p>
            <p>Sie können die AWS CloudFormation <a href="./cfn-console-view-stack-data-resources.html">-Konsole</a> oder verwenden<a href="./using-cfn-get-template.html">AWS CLI</a>, um die Phase einer Stack-Vorlage anzuzeigen.</p>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Anmerkung</h6></div><div class="awsdocs-note-text"><p>Die maximale Größe für eine verarbeitete Stack-Vorlage beträgt 51 200 Byte, falls sie direkt an eine <code class="code">CreateStack</code>-, <code class="code">UpdateStack</code>- oder <code class="code">ValidateTemplate</code>-Anforderung übergeben wird, oder 1 MB, wenn sie unter Verwendung einer Amazon-S3-Vorlagen-URL als S3-Objekt übergeben wird. Während der Verarbeitung  CloudFormation aktualisiert jedoch den temporären Status der Vorlage, während sie die in der Vorlage enthaltenen Makros seriell verarbeitet. Aus diesem Grund kann die Größe der Vorlage <em>während der Verarbeitung</em> vorübergehend die zulässige Größe einer vollständig verarbeiteten Vorlage überschreiten.  CloudFormation erlaubt einen gewissen Puffer für diese In-Process-Vorlagen. Allerdings sollten Sie beim Entwurf Ihrer Vorlagen und Makros immer die maximal zulässige Größe für eine verarbeitete Stack-Vorlage im Blick behalten.</p><p>Wenn bei der Verarbeitung Ihrer Vorlage einen <code class="code">Transformation data limit exceeded</code> Fehler  CloudFormation zurückgibt, hat Ihre Vorlage die maximal  CloudFormation zulässige Vorlagengröße während der Verarbeitung überschritten.</p><p>Sie können das Problem u. U. wie folgt beheben:</p><div class="itemizedlist">
                     
                     
                <ul class="itemizedlist"><li class="listitem"><p>Teilen Sie Ihre Vorlage in mehrere Vorlagen auf, um zu vermeiden, dass die maximale Vorlagengröße während der Verarbeitung überschritten wird. Beispiel:</p>
                        <div class="itemizedlist">
                             
                             
                        <ul class="itemizedlist"><li class="listitem"><p>Verwenden Sie verschachtelte Stack-Vorlagen, um Teile der Vorlage einzukapseln. Weitere Informationen finden Sie unter <a href="./using-cfn-nested-stacks.html">Arbeiten mit verschachtelten Stacks</a>.</p></li><li class="listitem"><p>Erstellen Sie mehrere Stacks und verwenden Sie Stack-übergreifende Referenzen, damit Informationen zwischen den Stacks ausgetauscht werden können. Weitere Informationen finden Sie unter <a href="./walkthrough-crossstackref.html">Walkthrough: Verweisen auf Ressourcenausgaben in einem anderen AWS CloudFormation-Stack</a>.</p></li></ul></div>
                    </li><li class="listitem"><p>Reduzieren Sie die Größe des Vorlagenfragments, das von einem bestimmten Makro zurückgegeben wird.  CloudFormation manipuliert den Inhalt von Fragmenten, die von Makros zurückgegeben werden, nicht.</p></li></ul></div></div></div>
         
        
        <div class="procedure"><h6>So verwenden Sie ein - AWS CloudFormation Makro in Ihrer Vorlage</h6><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Anmerkung</h6></div><div class="awsdocs-note-text"><p>Damit ein in einer Vorlage referenziertes Makro erfolgreich ausführen AWS CloudFormation kann, muss der Benutzer über <code class="code">Invoke</code> Berechtigungen für die zugrunde liegende Lambda-Funktion verfügen. Weitere Informationen finden Sie unter <a href="https://docs.aws.amazon.com/lambda/latest/dg/access-control-overview.html">Übersicht über die Verwaltung von Zugriffsberechtigungen für Ihre AWS Lambda-Ressourcen</a> im <em>AWS Lambda -Entwicklerhandbuch</em>.</p></div></div><ol><li>
                <p>Fügen Sie eine Referenz auf das Makro in die Vorlage ein.</p>
                <div class="itemizedlist">
                     
                      
                <ul class="itemizedlist"><li class="listitem">
                        <p>Um ein Vorlagenausschnitt zu bearbeiten, referenzieren Sie das Makro in einer <code class="code"><a href="./intrinsic-function-reference-transform.html">Fn::Transform</a></code>-Funktion, die sich relativ zu dem zu bearbeitenden Vorlageninhalt befindet.</p>
                    </li><li class="listitem">
                        <p>Um die gesamte Vorlage zu bearbeiten, referenzieren Sie das Makro im Abschnitt <a href="./transform-section-structure.html">Transform</a> der Vorlage.</p>
                    </li></ul></div>
            </li><li>
                <p><a href="./using-cfn-updating-stacks-changesets-create.html">Erstellen Sie einen Änderungssatz</a> anhand der Vorlage.</p>
                <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Wichtig</h6></div><div class="awsdocs-note-text"><p>Wenn Ihre Stack-Set-Vorlage auf ein oder mehrere Makros verweist, müssen Sie das Stack-Set direkt aus der verarbeiteten Vorlage erstellen, ohne vorher die resultierenden Änderungen in einem Änderungssatz zu überprüfen. Um das Stack-Set direkt zu erstellen oder zu aktualisieren, müssen Sie die <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_UpdateStackSet.html"><code class="code">UpdateStackSet</code></a> Aktion <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_CreateStackSet.html"><code class="code">CreateStackSet</code></a> oder verwenden und die <code class="code">CAPABILITY_AUTO_EXPAND</code> Funktion angeben. Bevor Sie einen Stack-Set aus einer Vorlage erstellen oder aktualisieren, die direkt auf Makros verweist, sollten Sie sicherstellen, dass Sie wissen, welche Verarbeitung die Makros ausführen.</p></div></div>
            </li><li>
                <p>Überprüfen Sie den Änderungssatz und <a href="./using-cfn-updating-stacks-changesets-execute.html">führen Sie ihn aus</a>.</p>
                <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Wichtig</h6></div><div class="awsdocs-note-text"><p>Wenn Ihre Stack-Set-Vorlage auf ein oder mehrere Makros verweist, müssen Sie das Stack-Set direkt aus der verarbeiteten Vorlage erstellen, ohne vorher die resultierenden Änderungen in einem Änderungssatz zu überprüfen. Um das Stack-Set direkt zu erstellen oder zu aktualisieren, müssen Sie die <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_UpdateStackSet.html"><code class="code">UpdateStackSet</code></a> Aktion <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_CreateStackSet.html"><code class="code">CreateStackSet</code></a> oder verwenden und die <code class="code">CAPABILITY_AUTO_EXPAND</code> Funktion angeben. Bevor Sie einen Stack-Set aus einer Vorlage erstellen oder aktualisieren, die direkt auf Makros verweist, sollten Sie sicherstellen, dass Sie wissen, welche Verarbeitung die Makros ausführen.</p></div></div>
            </li></ol></div>

     
        <h2 id="template-macros-examples-list">Makrobeispiele</h2>
        <p>Zusätzlich zur <a href="./macros-example.html">Makrobeispiel: Erstellen und Verwenden eines Makros</a> Anleitung in diesem Handbuch finden Sie Beispielmakros, einschließlich Quellcode und Vorlagen, im Abschnitt <a href="https://github.com/awslabs/aws-cloudformation-templates/tree/master/aws/services/CloudFormation/MacrosExamples/" rel="noopener noreferrer" target="_blank"><span>Makrobeispiele</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> des <a href="https://github.com/awslabs" rel="noopener noreferrer" target="_blank"><span>Amazon Web Services - Labs</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>-Repo auf  GitHub. Diese Beispiele werden "wie besehen" für Schulungszwecke zur Verfügung gestellt.</p>
    <h2 id="template-macros-seealso">Weitere Informationen finden Sie auch unter</h2>
        <p><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudformation-macro.html">AWS::CloudFormation::Macro</a></p>

        <p><a href="./transform-section-structure.html">Transform</a></p>
        <p><a href="./intrinsic-function-reference-transform.html">Fn::Transform</a></p>
        
        <p><a href="./transform-aws-serverless.html">AWS::Serverless-Transformation</a></p>
        <p><a href="./create-reusable-transform-function-snippets-and-add-to-your-template-with-aws-include-transform.html">AWS::Include-Transformation</a></p>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warnung" /> <strong>JavaScript ist in Ihrem Browser nicht verfügbar oder deaktiviert.</strong></p><p>Zur Nutzung der AWS-Dokumentation muss JavaScript aktiviert sein. Weitere Informationen finden auf den Hilfe-Seiten Ihres Browsers.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Dokumentkonventionen</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./crpg-ref-requesttypes-update.html">Aktualisierung</div><div id="next" class="next-link" accesskey="n" href="./macros-example.html">Makrobeispiel: Erstellen und Verwenden eines Makros</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Hat Ihnen diese Seite geholfen? – Ja</div><div class="content"><p>Vielen Dank, dass Sie uns mitgeteilt haben, dass wir gute Arbeit geleistet haben!</p><p>Würden Sie sich einen Moment Zeit nehmen, um uns mitzuteilen, was wir richtig gemacht haben, damit wir noch besser werden?</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-macros.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Hat Ihnen diese Seite geholfen? – Nein</div><div class="content"><p>Vielen Dank, dass Sie uns mitgeteilt haben, dass diese Seite überarbeitet werden muss. Es tut uns Leid, dass wir Ihnen nicht weiterhelfen konnten.</p><p>Würden Sie sich einen Moment Zeit nehmen, um uns mitzuteilen, wie wir die Dokumentation verbessern können?</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/template-macros.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>