<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="ko-KR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CREATE EXTERNAL FUNCTION - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_CREATE_EXTERNAL_FUNCTION" /><meta name="default_state" content="r_CREATE_EXTERNAL_FUNCTION" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" /><meta name="description" content="Amazon Redshift에 대해 AWS Lambda를 기반으로 스칼라 사용자 정의 함수(UDF)를 생성합니다." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="데이터베이스 개발자 안내서" /><meta name="abstract" content="페타바이트 규모의 엔터프라이즈급 완전관리형 데이터 웨어하우징 서비스인 Amazon Redshift로 데이터 웨어하우스를 생성하고 관리합니다." /><meta name="guide-locale" content="ko_kr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="데이터베이스 개발자 안내서" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="데이터베이스 개발자 안내서" /><meta id="panorama-serviceConsolePage" value="CREATE EXTERNAL FUNCTION" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>CREATE EXTERNAL FUNCTION - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_CREATE_EXTERNAL_FUNCTION" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,데이터 웨어하우스,샘플 데이터,데이터베이스,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "데이터베이스 개발자 안내서",
        "item" : "https://docs.aws.amazon.com/ko_kr/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "SQL 참조",
        "item" : "https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "SQL 명령",
        "item" : "https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "CREATE EXTERNAL FUNCTION",
        "item" : "https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_SQL_commands.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_CREATE_EXTERNAL_FUNCTION" target="_blank" rel="noopener noreferrer" title="pdf-tooltip"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">aws-documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">데이터베이스 개발자 안내서</a></div><div id="page-toc-src"><a href="#r_CREATE_EXTERNAL_FUNCTION-privileges">필수 권한</a><a href="#r_CREATE_EXTERNAL_FUNCTION-synopsis">명령문</a><a href="#r_CREATE_EXTERNAL_FUNCTION-parameters">파라미터</a><a href="#r_CREATE_FUNCTION-usage-notes">사용 노트</a><a href="#r_CREATE_FUNCTION-examples">예</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="r_CREATE_EXTERNAL_FUNCTION">CREATE EXTERNAL FUNCTION</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Amazon Redshift에 대해 AWS Lambda를 기반으로 스칼라 사용자 정의 함수(UDF)를 생성합니다. Lambda 사용자 정의 함수에 대한 자세한 내용은 <a href="./udf-creating-a-lambda-sql-udf.html">스칼라 Lambda UDF 생성</a> 섹션을 참조하세요.</p>
         <h2 id="r_CREATE_EXTERNAL_FUNCTION-privileges">필수 권한</h2>
         <p>CREATE EXTERNAL FUNCTION에 필요한 권한은 다음과 같습니다.</p>
         <div class="itemizedlist">
             
             
         <ul class="itemizedlist"><li class="listitem"><p>수퍼유저</p></li><li class="listitem"><p>CREATE [ OR REPLACE ] EXTERNAL FUNCTION 권한이 있는 사용자</p></li></ul></div>
       
         <h2 id="r_CREATE_EXTERNAL_FUNCTION-synopsis">명령문</h2>

         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">CREATE [ OR REPLACE ] EXTERNAL FUNCTION <em>external_fn_name</em> ( [<em>data_type</em>] [, ...] )
RETURNS <em>data_type</em>
<span>{</span> VOLATILE | STABLE }
LAMBDA <em>'lambda_fn_name'</em>
IAM_ROLE <span>{</span> default | ‘arn:aws:iam::<code class="replaceable">&lt;AWS 계정-id&gt;</code>:role/<code class="replaceable">&lt;role-name&gt;</code>’
RETRY_TIMEOUT <em>milliseconds</em>
MAX_BATCH_ROWS count
MAX_BATCH_SIZE size [ KB | MB ];</code></pre>

         
         
         <p>다음은 Amazon Redshift에서 기계 학습을 위한 구문입니다. 모델별 파라미터에 대한 자세한 내용은 <a href="./r_GRANT.html#r_GRANT-parameters">파라미터</a> 섹션을 참조하세요.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">CREATE [ OR REPLACE ] EXTERNAL FUNCTION <em>external_fn_name</em> ( [<em>data_type</em>] [, ...] )
RETURNS <em>data_type</em>
<span>{</span> VOLATILE | STABLE }
SAGEMAKER<em>'endpoint_name'</em>
IAM_ROLE <span>{</span> default | ‘arn:aws:iam::<code class="replaceable">&lt;AWS 계정-id&gt;</code>:role/<code class="replaceable">&lt;role-name&gt;</code>’ };</code></pre>


       
         <h2 id="r_CREATE_EXTERNAL_FUNCTION-parameters">파라미터</h2>


         <div class="variablelist">
             
             
             
             
            
             
          

             
            
         

             

             
             
          
         <dl>
               <dt><span class="term">OR REPLACE</span></dt>
               <dd>
                  <p>이름 및 입력 인수 데이터 형식이 같은 함수 또는 <em>서명</em>이 같은 함수인 경우 이런 함수가 이미 하나 존재하므로 기존 함수를 대체하도록 지정하는 절입니다. 함수는 똑같은 데이터 형식 집합을 정의하는 새 함수로만 바꿀 수 있습니다. 수퍼유저만이 함수를 바꿀 수 있습니다.</p>
                  <p>기존 함수와 이름은 같지만 서명이 다른 함수를 정의하면 새 함수가 생성됩니다. 즉, 함수 이름이 오버로드됩니다. 자세한 내용은 <a href="./udf-naming-udfs.html#udf-naming-overloading-function-names">함수 이름 오버로드</a> 단원을 참조하십시오.</p>
               </dd>
             
               <dt><span class="term"><em>external_fn_name</em></span></dt>
               <dd>
                  <p>외부 함수의 이름입니다. 스키마 이름을 지정하는 경우(예: myschema.myfunction) 함수는 지정된 스키마를 사용하여 생성됩니다. 그렇지 않으면, 함수가 현재 스키마로 생성됩니다. 유효한 이름에 대한 자세한 내용은 <a href="./r_names.html">이름 및 식별자</a> 섹션을 참조하세요.</p>
                  <p>모든 UDF 이름에 <code class="code">f_</code>를 접두사로 사용하는 것이 좋습니다. Amazon Redshift는 UDF 이름용으로 <code class="code">f_</code> 접두사를 예약합니다. <code class="code">f_</code> 접두사를 사용하면 UDF 이름이 현재 또는 미래에 Amazon Redshift의 기본 제공 SQL 함수 이름과 충돌하지 않도록 할 수 있습니다. 자세한 내용은 <a href="./udf-naming-udfs.html">UDF 이름 지정</a> 단원을 참조하십시오.</p>
               </dd>
             
               <dt><span class="term"><em>data_type</em></span></dt>
               <dd>
                  <p>입력 인수의 데이터 형식입니다. 자세한 내용은 <a href="./c_Supported_data_types.html">데이터 타입</a> 단원을 참조하십시오.</p>
               </dd>
             
               <dt><span class="term">RETURNS <em>data_type</em></span></dt>
               <dd>
                  <p>함수에 의해 반환되는 값의 데이터 형식입니다. RETURNS 데이터 형식은 임의의 표준 Amazon Redshift 데이터 형식일 수 있습니다. 자세한 내용은 <a href="./udf-data-types.html">Python UDF 데이터 형식</a> 단원을 참조하십시오.</p>
               </dd>
             
               <dt><span class="term">VOLATILE | STABLE</span></dt>
               <dd>
                  <p>쿼리 최적화 프로그램에 함수의 휘발성에 대해 알립니다.</p>
                  <p>최상으로 최적화하기 위해 함수에 대해 유효한 가장 엄격한 휘발성 범주로 함수에 레이블을 지정합니다. 가장 덜 엄격한 범주부터 시작해서 엄격성의 순으로 휘발성 범주를 나열하면 다음과 같습니다.</p>
                  <div class="itemizedlist">
                       
                      
                  <ul class="itemizedlist"><li class="listitem">
                        <p>VOLATILE</p>
                     </li><li class="listitem">
                        <p>STABLE</p>
                     </li></ul></div>
                  <p>VOLATILE</p>
                  <p>인수가 같을 경우, 함수는 단일 명령문의 행에 대해서도 연속적인 호출에 대해 상이한 결과를 반환할 수 있습니다. 쿼리 옵티마이저는 휘발성 함수의 동작에 대해 가정을 할 수 없습니다. 휘발성 함수를 사용하는 쿼리는 모든 입력에 대해 함수를 재평가해야 합니다.</p>
                  <p>STABLE</p>
                  <p>인수가 동일하면 함수는 단일 문 내에서 처리되는 연속적인 호출에서 동일한 결과를 반환하도록 보장됩니다. 이 함수는 서로 다른 명령문에서 호출될 경우 서로 다른 결과를 반환할 수 있습니다. 이 범주를 사용하면 옵티마이저가 단일 문 내에서 함수가 호출되는 횟수를 줄일 수 있습니다.</p>
                  <p>선택한 엄격도가 함수에 유효하지 않은 경우 옵티마이저가 이 엄격도에 따라 일부 호출을 건너뛸 수 있다는 점에 유의하세요. 이로 인해 잘못된 결과 집합이 생성될 수 있습니다.</p>
                  <p>IMMUTABLE 절은 현재 Lambda UDF에서 지원되지 않습니다.</p>
                  

               </dd>
             
               <dt><span class="term">LAMBDA <em>'lambda_fn_name'</em></span></dt>
               <dd>
                  <p> Amazon Redshift에서 호출하는 함수의 이름입니다.</p>
                  <p>AWS Lambda 함수를 생성하는 단계는 <em>AWS Lambda 개발자 안내서</em>의 <a href="https://docs.aws.amazon.com/lambda/latest/dg/getting-started-create-function.html">콘솔로 Lambda 함수 생성</a> 섹션을 참조하세요.</p>
                 <p>Lambda 함수에 필요한 권한에 대한 자세한 내용은 <em>AWS Lambda 개발자 안내서</em>의 <a href="https://docs.aws.amazon.com/lambda/latest/dg/lambda-permissions.html">AWS Lambda 권한</a> 섹션을 참조하세요.</p>

               </dd>
             
               <dt><span class="term">IAM_ROLE <span>{</span> default | ‘arn:aws:iam::<code class="replaceable">&lt;AWS 계정-id&gt;</code>:role/<code class="replaceable">&lt;role-name&gt;</code>’ </span></dt>
               <dd>
                  <p>기본 키워드를 사용하여 CREATE EXTERNAL FUNCTION 명령이 실행될 때 Amazon Redshift에서 기본값으로 설정되고 클러스터와 연결된 IAM 역할을 사용하도록 합니다.</p>
                  <p>클러스터가 인증 및 권한 부여에 사용하는 IAM 역할의 Amazon 리소스 이름(ARN)을 사용합니다. CREATE EXTERNAL FUNCTION 명령은 이 IAM 역할을 통해 Lambda 함수를 호출할 권한이 있습니다. 클러스터에 연결된 Lambda 함수를 호출할 수 있는 권한이 있는 기존 IAM 역할이 있는 경우 역할의 ARN을 대체할 수 있습니다. 자세한 내용은 <a href="./udf-creating-a-lambda-sql-udf.html#udf-lambda-authorization">Lambda UDF에 대한 권한 부여 파라미터 구성</a> 단원을 참조하십시오.</p>
                  <p>다음은 IAM_ROLE 파라미터에 대한 구문을 나타낸 것입니다.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">IAM_ROLE 'arn:aws:iam::<em>aws-account-id</em>:role/<em>role-name</em>'</code></pre>
               </dd>
             
               <dt><span class="term">RETRY_TIMEOUT <em>milliseconds</em> </span></dt>
               <dd>
                  <p>Amazon Redshift가 재시도 백오프 지연에 사용하는 총 시간(밀리초)입니다.</p>
                  <p>실패한 쿼리에 대해 즉시 재시도하는 대신 Amazon Redshift는 백오프를 수행하고 재시도 사이에 일정 시간 동안 기다립니다. 그런 다음 Amazon Redshift는 모든 지연의 합계가 지정한 RETRY_TIMEOUT 값과 같거나 초과할 때까지 실패한 쿼리를 다시 실행하도록 요청을 재시도합니다. 기본값은 20,000밀리초입니다.</p>
                  <p>Lambda 함수가 호출되면 Amazon Redshift는 <code class="code">TooManyRequestsException</code>, <code class="code">EC2ThrottledException</code>, <code class="code">ServiceException</code> 등의 오류를 수신하는 쿼리에 대해 재시도합니다.</p>
                  <p>RETRY_TIMEOUT 파라미터를 0밀리초로 설정하여 Lambda UDF에 대한 재시도를 방지할 수 있습니다.</p>
               </dd>
             
               <dt><span class="term">MAX_BATCH_ROWS count<em></em></span></dt>
               <dd>
                  <p> Amazon Redshift가 단일 람다 호출에 대한 단일 배치 요청으로 보내는 최대 행 수입니다.</p>
                  <p> 이 파라미터의 최소값은 1입니다. 최대값은 INT_MAX 또는 2,147,483,647입니다.</p>
                  <p> 이 파라미터는 선택 사항입니다. 기본값은 INT_MAX 또는 2,147,483,647입니다.</p>
               </dd>
             
            <dt><span class="term">MAX_BATCH_SIZE size<em></em>[KB|MB] </span></dt>
            <dd>
               <p> Amazon Redshift가 단일 람다 호출에 대한 단일 배치 요청으로 보내는 데이터 페이로드의 최대 크기입니다.</p>
               <p> 이 파라미터의 최소값은 1KB입니다. 최대값은 5MB입니다.</p>
               <p> 이 파라미터의 기본값은 5MB입니다.</p>
               <p> KB 및 MB는 선택 사항입니다. 측정 단위를 설정하지 않으면 Amazon Redshift는 기본적으로 KB를 사용합니다.</p>
            </dd>
         </dl></div>
       
         <h2 id="r_CREATE_FUNCTION-usage-notes">사용 노트</h2>
         <p>Lambda UDF를 생성할 때 다음 사항을 고려하세요.</p>
         <div class="itemizedlist">
             
             
         <ul class="itemizedlist"><li class="listitem"><p>입력 인수에 대한 Lambda 함수 호출 순서는 고정되거나 보장되지 않습니다. 클러스터 구성에 따라 쿼리를 실행하는 인스턴스마다 다를 수 있습니다.</p></li><li class="listitem"><p>함수는 각 입력 인수에 한 번만 적용된다는 보장이 없습니다. Amazon Redshift와 AWS Lambda 간의 상호 작용으로 인해 동일한 입력으로 반복적인 호출이 발생할 수 있습니다.</p></li></ul></div>
       
         <h2 id="r_CREATE_FUNCTION-examples">예</h2>
         <p>다음은 스칼라 Lambda 사용자 정의 함수(UDF)를 사용하는 예입니다.</p>
          
            <h3 id="r_CREATE_FUNCTION-lambda-example-node">Node.js Lambda 함수를 사용하는 스칼라 Lambda UDF 예</h3>
            <p>다음 예에서는 2개의 정수를 입력 인수로 사용하는 <code class="code">exfunc_sum</code>이라는 외부 함수를 생성합니다. 이 함수는 정수 출력으로 합계를 반환합니다. 호출할 Lambda 함수의 이름은 <code class="code">lambda_sum</code>입니다. 이 Lambda 함수에 사용되는 언어는 Node.js 12.x입니다. IAM 역할을 지정해야 합니다. 이 예에서는 <code class="code">'arn:aws:iam::123456789012:user/johndoe'</code>를 IAM 역할로 사용합니다.</p>
            
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE EXTERNAL FUNCTION exfunc_sum(INT,INT)
RETURNS INT
VOLATILE
LAMBDA 'lambda_sum'
IAM_ROLE 'arn:aws:iam::123456789012:role/Redshift-Exfunc-Test';</code></pre>
            <p>Lambda 함수는 요청 페이로드를 받아 각 행을 반복합니다. 단일 행의 모든 값은 응답 배열에 저장되는 해당 행의 합계를 계산하기 위해 추가됩니다. 결과 배열의 행 수는 요청 페이로드에서 수신된 행 수와 유사합니다.</p>
            <p>JSON 응답 페이로드는 'results' 필드에 결과 데이터가 있어야 외부 기능에서 인식됩니다. Lambda 함수로 전송된 요청의 arguments 필드에는 데이터 페이로드가 포함되어 있습니다. 배치 요청의 경우 데이터 페이로드에 여러 행이 있을 수 있습니다. 다음 Lambda 함수는 요청 데이터 페이로드의 모든 행을 반복합니다. 또한 단일 행 내의 모든 값을 개별적으로 반복합니다.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">exports.handler = async (event) =&gt; <span>{</span>
    // The 'arguments' field in the request sent to the Lambda function contains the data payload.
    var t1 = event['arguments'];

    // 'len(t1)' represents the number of rows in the request payload.
    // The number of results in the response payload should be the same as the number of rows received.
    const resp = new Array(t1.length);

    // Iterating over all the rows in the request payload.
    for (const [i, x] of t1.entries())
    <span>{</span>
        var sum = 0;
        // Iterating over all the values in a single row.
        for (const y of x) <span>{</span>
            sum = sum + y;
        }
        resp[i] = sum;
    }
    // The 'results' field should contain the results of the lambda call.
    const response = <span>{</span>
        results: resp
    };
    return JSON.stringify(response);
};</code></pre>
            <p>다음 예에서는 리터럴 값을 사용하여 외부 함수를 호출합니다.</p>
            
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select exfunc_sum(1,2);
exfunc_sum
------------
 3
(1 row)</code></pre>
            <p>다음 예에서는 정수 데이터 형식의 두 열 c1 및 c2가 있는 t_sum이라는 테이블을 생성하고 두 행의 데이터를 삽입합니다. 그런 다음 이 테이블의 열 이름을 전달하여 외부 함수를 호출합니다. 두 테이블 행은 단일 Lambda 호출로 요청 페이로드의 배치 요청으로 전송됩니다.</p>
            
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE t_sum(c1 int, c2 int);
INSERT INTO t_sum VALUES (4,5), (6,7);
SELECT exfunc_sum(c1,c2) FROM t_sum;
 exfunc_sum
---------------
 9
 13
(2 rows)</code></pre>
          

         
          
            <h3 id="r_CREATE_FUNCTION-lambda-example-retry">RETRY_TIMEOUT 속성을 사용하는 Scalar Lambda UDF 예</h3>
            <p>다음 섹션에서 Lambda UDF에서 RETRY_TIMEOUT 속성을 사용하는 방법의 예를 찾아볼 수 있습니다.</p>
            <p>AWS Lambda 함수에는 각 함수에 대해 설정할 수 있는 동시성 제한이 있습니다. 동시성 한도에 대한 자세한 내용은 <em>AWS Lambda개발자 가이드</em>의 <a href="https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html">Lambda 함수에 대한 동시성 관리</a> 및 AWS 컴퓨팅 블로그의 게시물 <a href="https://aws.amazon.com/blogs/compute/managing-aws-lambda-function-concurrency" rel="noopener noreferrer" target="_blank"><span>AWS Lambda 함수 동시성 관리</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>를 참조하세요.</p>
            <p>Lambda UDF에서 제공하는 요청 수가 동시성 제한을 초과하면 새 요청에서 <code class="code">TooManyRequestsException</code> 오류를 수신합니다. ambda UDF는 Lambda 함수로 전송된 요청 간의 모든 지연 합계가 설정한 RETRY_TIMEOUT 값과 같거나 초과할 때까지 이 오류에 대해 재시도합니다. 기본  RETRY_TIMEOUT 값은 20,000밀리초입니다.</p>
              <p>다음 예시에서는 <code class="code">exfunc_sleep_3</code>이라는 Lambda 함수를 생성합니다. 이 함수는 요청 페이로드를 받아 각 행을 반복하고 입력을 대문자로 변환합니다. 그런 다음 3초 동안 휴면하고 결과를 반환합니다. 이 Lambda 함수에 사용되는 언어는 Python 3.8입니다.</p>
            <p>결과 배열의 행 수는 요청 페이로드에서 수신된 행 수와 유사합니다. JSON 응답 페이로드는 <code class="code">results</code> 필드에 결과 데이터가 있어야 외부 기능에서 인식됩니다. Lambda 함수로 전송된 요청의 <code class="code">arguments</code> 필드에는 데이터 페이로드가 포함되어 있습니다. 배치 요청의 경우 데이터 페이로드에 여러 행이 나타날 수 있습니다.</p>
              <p>이 함수의 동시성 제한은 RETRY_TIMEOUT 속성의 사용을 보여주기 위해 예약된 동시성에서 특별히 1로 설정됩니다. 속성이 1로 설정되면 Lambda 함수는 한 번에 하나의 요청만 처리할 수 있습니다.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">import json
import time
def lambda_handler(event, context):
    t1 = event['arguments']
    # 'len(t1)' represents the number of rows in the request payload.
    # The number of results in the response payload should be the same as the number of rows received.
    resp = [None]*len(t1)

    # Iterating over all rows in the request payload.
    for i, x in enumerate(t1):
        # Iterating over all the values in a single row.
        for j, y in enumerate(x):
            resp[i] = y.upper()

    time.sleep(3)
    ret = dict()
    ret['results'] = resp
    ret_json = json.dumps(ret)
    return ret_json</code></pre>
            <p>다음 두 가지 추가 예에서는 RETRY_TIMEOUT 속성을 보여줍니다. 각 예에서 단일 Lambda UDF를 호출합니다. Lambda UDF를 호출하는 동안 각 예에서는 동일한 SQL 쿼리를 실행하여 동시에 2개의 동시 데이터베이스 세션에서 Lambda UDF를 호출합니다. Lambda UDF를 호출하는 첫 번째 쿼리가 UDF에 의해 제공되는 경우 두 번째 쿼리는 <code class="code">TooManyRequestsException</code> 오류를 수신합니다. 이 결과는 UDF에서 예약된 동시성을 1로 특별히 설정했기 때문에 발생합니다. Lambda 함수에 대해 예약된 동시성을 설정하는 방법에 대한 자세한 내용은 <a href="https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html#configuration-concurrency-reservedconfiguration-concurrency-reserved">예약된 동시성 구성</a> 섹션을 참조하세요.</p>


            

            <p>다음 첫 번째 예에서는 Lambda UDF의 RETRY_TIMEOUT 속성을 0밀리초로 설정합니다. Lambda 요청이 Lambda 함수에서 예외를 수신하면 Amazon Redshift는 재시도하지 않습니다. RETRY_TIMEOUT 특성이 0으로 설정되어 있기 때문에 이러한 결과가 발생합니다.</p>
            
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE OR REPLACE EXTERNAL FUNCTION exfunc_upper(varchar)
RETURNS varchar
VOLATILE
LAMBDA 'exfunc_sleep_3'
IAM_ROLE 'arn:aws:iam::123456789012:role/Redshift-Exfunc-Test'
RETRY_TIMEOUT 0;</code></pre>
            <p>RETRY_TIMEOUT을 0으로 설정하면 별도의 데이터베이스 세션에서 다음 두 쿼리를 실행하여 다른 결과를 볼 수 있습니다.</p>
            <p>Lambda UDF를 사용하는 첫 번째 SQL 쿼리가 성공적으로 실행됩니다.</p>
            
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select exfunc_upper('Varchar');
 exfunc_upper
 --------------
 VARCHAR
(1 row)</code></pre>
            <p>별도의 데이터베이스 세션에서 동시에 실행되는 두 번째 쿼리는 <code class="code">TooManyRequestsException</code> 오류를 수신합니다.</p>
                  
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select exfunc_upper('Varchar');
ERROR:  Rate Exceeded.; Exception: TooManyRequestsException; ShouldRetry: 1
DETAIL:
-----------------------------------------------
error:  Rate Exceeded.; Exception: TooManyRequestsException; ShouldRetry: 1
code:      32103
context:query:     0
location:  exfunc_client.cpp:102
process:   padbmaster [pid=26384]
-----------------------------------------------</code></pre>

                  <p>다음 두 번째 예에서는 Lambda UDF의 RETRY_TIMEOUT 속성을 3,000밀리초로 설정합니다. 두 번째 쿼리가 동시에 실행되더라도 총 지연 시간이 3,000밀리초가 될 때까지 Lambda UDF가 재시도합니다. 따라서 두 쿼리가 모두 성공적으로 실행됩니다.</p>
                  
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE OR REPLACE EXTERNAL FUNCTION exfunc_upper(varchar)
RETURNS varchar
VOLATILE
LAMBDA 'exfunc_sleep_3'
IAM_ROLE 'arn:aws:iam::123456789012:role/Redshift-Exfunc-Test'
RETRY_TIMEOUT 3000;</code></pre>
                  <p>RETRY_TIMEOUT을 3,000밀리초로 설정하면 별도의 데이터베이스 세션에서 다음 두 쿼리를 실행하여 같은 결과를 볼 수 있습니다.</p>
                  <p>Lambda UDF를 실행하는 첫 번째 SQL 쿼리가 성공적으로 실행됩니다.</p>
                  
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select exfunc_upper('Varchar');
 exfunc_upper
 --------------
 VARCHAR
(1 row)</code></pre>
                  <p>두 번째 쿼리가 동시에 실행되고 총 지연 시간이 3,000밀리초가 될 때까지 Lambda UDF가 재시도합니다.</p>
                  
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select exfunc_upper('Varchar');
 exfunc_upper
--------------
 VARCHAR
(1 row)</code></pre>

          

          
            <h3 id="r_CREATE_FUNCTION-lambda-example-python">Python Lambda 함수를 사용하는 스칼라 Lambda UDF 예</h3>
            <p>다음 예에서는 <code class="code">exfunc_multiplication</code>이라는 외부 함수를 생성하고 숫자를 곱하고 정수를 반환합니다. 이 예에서는 Lambda 응답에 성공 및 <code class="code">error_msg</code> 필드를 통합합니다. 곱셈 결과에 정수 오버플로가 있는 경우 성공 필드가 false로 설정되고 <code class="code">error_msg</code> 메시지가 <code class="code">Integer multiplication overflow</code>로 설정됩니다. <code class="code">exfunc_multiplication</code> 함수는 3개의 정수를 입력 인수로 사용하고 합계를 정수 출력으로 반환합니다.</p>
            <p>호출되는 Lambda 함수의 이름은 <code class="code">lambda_multiplication</code>입니다. 이 Lambda 함수에 사용되는 언어는 Python 3.8입니다. IAM 역할을 지정해야 합니다.</p>
            
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE EXTERNAL FUNCTION exfunc_multiplication(int, int, int)
RETURNS INT
VOLATILE
LAMBDA 'lambda_multiplication'
IAM_ROLE 'arn:aws:iam::123456789012:role/Redshift-Exfunc-Test'; </code></pre>
            <p>Lambda 함수는 요청 페이로드를 받아 각 행을 반복합니다. 단일 행의 모든 값을 곱하여 응답 목록에 저장되는 해당 행의 결과를 계산합니다. 이 예에서는 기본적으로 true로 설정된 부울 성공 값을 사용합니다. 행의 곱셈 결과에 정수 오버플로가 있으면 성공 값은 false로 설정됩니다. 그런 다음 반복 루프가 중단됩니다.</p>
            <p>응답 페이로드를 생성하는 동안 성공 값이 false인 경우 다음 Lambda 함수는 페이로드에 <code class="code">error_msg</code> 필드를 추가합니다. 또한 오류 메시지를 <code class="code">Integer multiplication overflow</code>로 설정합니다. 성공 값이 true이면 결과 필드에 결과 데이터가 추가됩니다. 결과 배열(있는 경우)의 행 수는 요청 페이로드에서 수신된 행 수와 유사합니다.</p>
            <p>Lambda 함수로 전송된 요청의 arguments 필드에는 데이터 페이로드가 포함되어 있습니다. 배치 요청의 경우 데이터 페이로드에 여러 행이 있을 수 있습니다. 다음 Lambda 함수는 요청 데이터 페이로드의 모든 행을 반복하고 단일 행 내의 모든 값을 개별적으로 반복합니다.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">import json
def lambda_handler(event, context):
    t1 = event['arguments']
    # 'len(t1)' represents the number of rows in the request payload.
    # The number of results in the response payload should be the same as the number of rows received.
    resp = [None]*len(t1)

    # By default success is set to 'True'.
    success = True
    # Iterating over all rows in the request payload.
    for i, x in enumerate(t1):
        mul = 1
        # Iterating over all the values in a single row.
        for j, y in enumerate(x):
            mul = mul*y

        # Check integer overflow.
        if (mul &gt;= 9223372036854775807 or mul &lt;= -9223372036854775808):
            success = False
            break
        else:
            resp[i] = mul
    ret = dict()
    ret['success'] = success
    if not success:
        ret['error_msg'] = "Integer multiplication overflow"
    else:
        ret['results'] = resp
    ret_json = json.dumps(ret)

    return ret_json</code></pre>

            <p>다음 예에서는 리터럴 값을 사용하여 외부 함수를 호출합니다.</p>
            
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT exfunc_multiplication(8, 9, 2);
  exfunc_multiplication
---------------------------
          144
(1 row)</code></pre>

            <p>다음 예에서는 3개(c1, c2, c3)의 정수 데이터 형식 열이 있는 t_multi라는 테이블을 생성합니다. 이 테이블의 열 이름을 전달하여 외부 함수를 호출합니다. 정수 오버플로가 오류 전파 방식을 표시하는 방식으로 데이터가 삽입됩니다.</p>
            
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE t_multi (c1 int, c2 int, c3 int);
INSERT INTO t_multi VALUES (2147483647, 2147483647, 4);
SELECT exfunc_multiplication(c1, c2, c3) FROM t_multi;
DETAIL:
  -----------------------------------------------
  error:  Integer multiplication overflow
  code:      32004context:
  context:
  query:     38
  location:  exfunc_data.cpp:276
  process:   query2_16_38 [pid=30494]
  -----------------------------------------------</code></pre>
          




         
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="주의" /> <strong>javascript가 브라우저에서 비활성화되거나 사용이 불가합니다.</strong></p><p>AWS 설명서를 사용하려면 Javascript가 활성화되어야 합니다. 지침을 보려면 브라우저의 도움말 페이지를 참조하십시오.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">문서 규칙</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_CREATE_DATASHARE.html">CREATE DATASHARE</div><div id="next" class="next-link" accesskey="n" href="./r_CREATE_EXTERNAL_SCHEMA.html">CREATE EXTERNAL SCHEMA</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">이 페이지의 내용이 도움이 되었습니까? - 예</div><div class="content"><p>칭찬해 주셔서 감사합니다!</p><p>잠깐 시간을 내어 좋았던 부분을 알려 주시면 더 열심히 만들어 보겠습니다.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="feedback-tell-us" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">이 페이지의 내용이 도움이 되었습니까? - 아니요</div><div class="content"><p>이 페이지에 작업이 필요하다는 점을 알려 주셔서 감사합니다. 실망시켜 드려 죄송합니다.</p><p>잠깐 시간을 내어 설명서를 향상시킬 수 있는 방법에 대해 말씀해 주십시오.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="feedback-tell-us" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_EXTERNAL_FUNCTION.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>