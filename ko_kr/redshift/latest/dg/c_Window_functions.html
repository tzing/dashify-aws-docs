<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="ko-KR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>윈도 함수 - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="c_Window_functions" /><meta name="default_state" content="c_Window_functions" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html" /><meta name="description" content="Amazon Redshift에서 지원하는 SQL의 윈도 함수를 사용하여 분석적 비즈니스 쿼리를 더욱 효율적으로 작성합니다." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="데이터베이스 개발자 안내서" /><meta name="abstract" content="페타바이트 규모의 엔터프라이즈급 완전관리형 데이터 웨어하우징 서비스인 Amazon Redshift로 데이터 웨어하우스를 생성하고 관리합니다." /><meta name="guide-locale" content="ko_kr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c_Window_functions.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c_Window_functions.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c_Window_functions.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c_Window_functions.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c_Window_functions.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c_Window_functions.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_Window_functions.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_Window_functions.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c_Window_functions.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c_Window_functions.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/c_Window_functions.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/c_Window_functions.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="데이터베이스 개발자 안내서" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="데이터베이스 개발자 안내서" /><meta id="panorama-serviceConsolePage" value="윈도 함수" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>윈도 함수 - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#c_Window_functions" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,데이터 웨어하우스,샘플 데이터,데이터베이스,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "데이터베이스 개발자 안내서",
        "item" : "https://docs.aws.amazon.com/ko_kr/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "SQL 참조",
        "item" : "https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "SQL 함수 참조",
        "item" : "https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_SQL_functions.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "윈도 함수",
        "item" : "https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_SQL_functions.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#c_Window_functions" target="_blank" rel="noopener noreferrer" title="pdf-tooltip"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">aws-documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">데이터베이스 개발자 안내서</a></div><div id="page-toc-src"><a href="#r_Window_function_synopsis">창 함수 구문 요약</a><a href="#r_Examples_order_by_WF">창 함수 데이터에 대한 고유 순서 지정</a><a href="#r_Window_function_supported">지원되는 함수</a><a href="#r_Window_function_example">창 함수 예제를 위한 샘플 테이블 </a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="c_Window_functions">윈도 함수</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>창 함수를 사용하면 사용자가 분석 비즈니스 쿼리를 보다 효율적으로 생성할 수 있습니다. 창 함수는 결과 집합의 파티션, 즉 "창"에서 실행되어 해당 창에 속하는 모든 행에 대한 값을 반환합니다. 이와는 반대로 창이 없는 함수는 결과 집합의 모든 행에 대해 계산을 실행합니다. 그 밖에도 결과 행을 집계하는 그룹 함수와 달리 창 함수에서는 테이블 표현식의 모든 행이 그대로 유지됩니다.</p><p> 반환 값은 해당 창에 속한 행 집합의 값을 사용하여 계산됩니다. 창은 테이블의 각 행마다 추가 속성을 계산하는 데 사용되는 행 집합을 정의합니다. 창은 창 명세(OVER 절)를 사용하여 정의되며, 다음과 같이 세 가지 주요 개념을 근거로 합니다.</p><div class="itemizedlist">
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p> <em>창 파티션</em> - 행 그룹을 형성합니다(PARTITION 절).</p>
         </li><li class="listitem">
            <p> <em>창 순서 지정</em> - 각 파티션의 행 순서 또는 시퀀스를 정의합니다(ORDER BY 절).</p>
         </li><li class="listitem">
            <p> <em>창 프레임</em> - 행 집합을 제한하기 위해 각 행마다 정의됩니다(ROWS 명세).</p>
         </li></ul></div><p>창 함수는 최종 ORDER BY 절을 제외하고 쿼리에서 실행되는 마지막 연산 집합입니다. 창 함수를 처리할 때는 그 전에 모든 조인을 비롯한 WHERE, GROUP BY 및 HAVING 절까지 모두 완료됩니다. 따라서 창 함수는 선택 목록 또는 ORDER BY 절에만 나타날 수 있습니다. 다른 프레임 절이 있는 단일 쿼리 내에서 여러 윈도 함수를 사용할 수 있습니다. CASE 등의 다른 스칼라 표현식에서 윈도 함수를 사용할 수도 있습니다.</p>
         <h2 id="r_Window_function_synopsis">창 함수 구문 요약</h2>
         
         
         <p>Window 함수는 다음과 같은 표준 구문을 따릅니다.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><em>function</em> (<em>expression</em>) OVER (
[ PARTITION BY <em>expr_list</em> ]
[ ORDER BY <em>order_list</em> [ <em>frame_clause</em> ] ] )</code></pre>
         <p> 여기서 <em>함수</em>는 이 섹션에서 설명하는 함수 중 하나입니다.</p> 
         <p><em>expr_list</em>는 다음과 같습니다.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><em>expression</em> | <em>column_name</em> [, <em>expr_list</em> ]</code></pre>
         <p> <em>order_list</em>는 다음과 같습니다.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><em>expression</em> | <em>column_name</em> [ ASC | DESC ] 
[ NULLS FIRST | NULLS LAST ]
[, <em>order_list</em> ]</code></pre>
         <p> <em>frame_clause</em>는 다음과 같습니다.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">ROWS
<span>{</span> UNBOUNDED PRECEDING | <em>unsigned_value</em> PRECEDING | CURRENT ROW } |

<span>{</span> BETWEEN
<span>{</span> UNBOUNDED PRECEDING | <em>unsigned_value</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW}
AND
<span>{</span> UNBOUNDED FOLLOWING | <em>unsigned_value</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW }}</code></pre>
          
            <h3 id="r_Window_function_synopsis-arguments">인수</h3>
            
            
            <div class="variablelist">
                
                
                
                
                
                
                
                
                
            <dl>
                  <dt><span class="term"> <em>함수</em> </span></dt>
                  <dd>
                     <p>창 함수 자세한 내용은 각 함수에 대한 설명을 참조하십시오.</p>
                  </dd>
                
                  <dt><span class="term">OVER </span></dt>
                  <dd>
                     <p>창 명세를 정의하는 절입니다. OVER 절은 창 함수에서 필수 인수로서 창 함수와 다른 SQL 함수를 구분하는 역할을 합니다.</p>
                  </dd>
                
                  <dt><span class="term">PARTITION BY <em>expr_list</em> </span></dt>
                  <dd>
                     <p>(옵션) PARTITION BY 절은 결과 집합을 여러 파티션으로 분할한다는 점에서 GROUP BY 절과 매우 유사합니다. 파티션 절이 존재하는 경우에는 함수가 각 파티션의 행에 대해 계산됩니다. 반대로 파티션 절을 지정하지 않으면 전체 테이블이 단일 파티션으로 구성되어 함수가 해당하는 전체 테이블에 대해서 계산됩니다.</p>
                     <p>DENSE_RANK, NTILE, RANK, ROW_NUMBER 같은 순위 함수에서는 결과 집합의 모든 행을 전역적으로 비교해야 합니다. 이때 PARTITION BY 절을 사용하면 쿼리 옵티마이저가 워크로드를 파티션에 따라 다수의 조각으로 분산시키기 때문에 각 집계를 병렬 방식으로 실행할 수 있습니다. PARTITION BY 절을 사용하지 않으면 단일 조각에서 직렬 방식으로 집계를 실행해야 하기 때문에 특히 대용량의 클러스터에서는 성능에 매우 부정적인 영향을 끼치게 됩니다.</p>
                     <p>Amazon Redshift는 PARTITION BY 절에서 문자열 리터럴을 지원하지 않습니다.</p>
                  </dd>
                
                  <dt><span class="term">ORDER BY <em>order_list</em> </span></dt>
                  <dd>
                     <p>(옵션) 윈도 함수는 ORDER BY의 순서 명세에 따라 정렬된 각 파티션의 행에 적용됩니다. 이 ORDER BY 절은 <em>frame_clause</em>의 ORDER BY 절과 구분되어 전혀 관련이 없습니다. 이러한 ORDER BY 절은 PARTITION BY 절 없이도 사용할 수 있습니다.</p>
                     <p>순위 함수에서는 ORDER BY 절이 순위 값의 기준을 식별하는 역할을 합니다. 집계 함수에서는 각 프레임에 대한 집계 함수 계산 이전에 파티션 행의 순서를 지정해야 합니다. 윈도 함수 형식에 대한 자세한 내용은 <a href="./c_Window_functions.html">윈도 함수</a> 섹션을 참조하세요.</p>
                     <p>order list에는 열 식별자, 또는 열 식별자로 평가되는 표현식이 필요합니다. 열 이름 대신에 상수나 상수 표현식을 사용할 수도 없습니다.</p>
                     <p>NULLS 값은 자체 그룹으로 처리되어 NULLS FIRST 또는 NULLS LAST 옵션에 따라 정렬 후 순위가 결정됩니다. 기본적으로 NULL 값은 ASC 순서에서는 마지막에 정렬 후 순위가 결정되며, DESC 순서에서는 처음에 정렬 후 순위가 결정됩니다.</p>
                     <p>Amazon Redshift는 ORDER BY 절에서 문자열 리터럴을 지원하지 않습니다.</p>
                     <p> ORDER BY 절을 생략하면 행의 순서는 비확정적입니다.</p>
                     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>참고</h6></div><div class="awsdocs-note-text"><p>Amazon Redshift와 같은 병렬 시스템에서는 ORDER BY 절이 데이터의 전체 순서를 고유하게 지정하지 않으면 행의 순서는 비확정적입니다. 다시 말해 ORDER BY 표현식에서 중복 값이 산출되면(부분 순서 지정) Amazon Redshift를 실행할 때마다 해당하는 행의 반환 순서가 달라질 수 있습니다. 그러면 창 함수 역시 예상하지 못하거나 일관적이지 못한 결과를 반환하게 됩니다. 자세한 내용은 <a href="#r_Examples_order_by_WF">창 함수 데이터에 대한 고유 순서 지정</a> 섹션을 참조하세요.</p></div></div>
                  </dd>
                
                  <dt><span class="term"> <em>column_name</em> </span></dt>
                  <dd>
                     <p>파티션으로 분할하거나 순서를 지정할 때 기준이 되는 열의 이름입니다.</p>
                  </dd>
                
                  <dt><span class="term">ASC | DESC </span></dt>
                  <dd>
                     <p>표현식의 정렬 순서를 정의하는 옵션으로서 각각 다음과 같은 의미를 갖습니다.</p>
                     <div class="itemizedlist">
                         
                         
                     <ul class="itemizedlist"><li class="listitem">
                           <p>ASC: 오름차순(예: 숫자 값의 경우 낮은 값에서 높은 값 순, 문자열의 경우 'A'에서 'Z'의 순. 지정된 옵션이 없는 경우에는 데이터가 기본적으로 오름차순으로 정렬됩니다.</p>
                        </li><li class="listitem">
                           <p>DESC: 내림차순(숫자 값의 경우 높은 값에서 낮은 값 순, 문자열의 경우 'Z'에서 'A'의 순).</p>
                        </li></ul></div>
                  </dd>
                
                  <dt><span class="term">NULLS FIRST | NULLS LAST</span></dt>
                  <dd>
                     <p>NULLS의 순서를 NULL 값 이외의 값 이전에 결정할지, 혹은 이후에 결정할지 지정하는 옵션입니다. 기본적으로 ASC 순서에서는 마지막에 정렬 후 순위가 결정되며, DESC 순서에서는 처음에 정렬 후 순위가 결정됩니다.</p>
                  </dd>
                
                  <dt><span class="term"> <em>frame_clause</em> </span></dt>
                  <dd>
                     
                     <p>집계 함수에서 프레임 절은 ORDER BY를 사용하여 함수의 창에 포함되는 행 집합을 추가적으로 정제하는 역할을 합니다. 이를 통해 순서가 지정된 결과 내에 행 집합을 추가하거나 제거할 수 있습니다. ROWS 키워드와 관련 지정자로 구성됩니다.</p>
                     <p>프레임 절은 순위 함수에 적용되지 않습니다. 또한 집계 함수의 OVER 절에 ORDER BY 절이 사용되지 않는 경우 프레임 절이 필요하지 않습니다. 집계 함수에서 ORDER BY 절이 사용되면 명시적인 프레임 절이 필요합니다.</p>
                     <p>ORDER BY 절을 지정하지 않으면 묵시적 프레임이 무제한이기 때문에 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING과 다름 없습니다.</p>
                  </dd>
                
                  <dt><span class="term">ROWS</span></dt>
                  <dd>
                     <p>이 절은 현재 행에서 물리적 오프셋을 지정하여 창 프레임을 정의합니다.</p>
                     <p>이 절은 현재 창 또는 파티션에서 현재 행의 값이 결합되는 행을 지정합니다. 행의 위치는 인수를 사용하여 지정하며, 현재 행 앞 또는 뒤가 될 수 있습니다. 모든 창 프레임에서 기준점은 현재 행입니다. 각 행은 창 프레임이 파티션에서 밀려 앞으로 이동하면서 번갈아 현재 행이 됩니다.</p>
                     <p>프레임은 다음과 같이 현재 행까지 포함하여 단일 행 집합이 되거나,</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>UNBOUNDED PRECEDING | <em>offset</em> PRECEDING | CURRENT ROW}</code></pre>
                     <p>혹은 다음과 같이 두 경계 사이의 행 집합이 될 수도 있습니다.</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">BETWEEN
<span>{</span> UNBOUNDED PRECEDING | <em>offset</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW }
AND
<span>{</span> UNBOUNDED FOLLOWING | <em>offset</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW }</code></pre>
                     <p>UNBOUNDED PRECEDING은 파티션의 첫 행에서 창이 시작된다는 것을 나타내고, <em>offset</em> PRECEDING은 오프셋 값에 해당하는 행의 수만큼 현재 행 앞에서 창이 시작된다는 것을 나타냅니다. 기본값은 UNBOUNDED PRECEDING입니다.</p>
                     <p>CURRENT ROW는 창이 현재 행에서 시작하거나 끝난다는 것을 나타냅니다.</p>
                     <p>UNBOUNDED FOLLOWING은 파티션의 마지막 행에서 창이 끝나는 것을 나타내고, <em>offset</em> FOLLOWING은 오프셋 값에 해당하는 행의 수만큼 현재 행 뒤에서 창이 끝난다는 것을 나타냅니다.</p>
                     <p><em>offset</em>은 현재 행 앞 또는 뒤로 물리적인 행의 수를 의미합니다. 이 경우에는 <em>offset</em>이 양의 숫자 값으로 평가되는 상수여야 합니다. 예를 들어 5 FOLLOWING일 때는 현재 행 뒤로 5개 행을 지나 프레임이 종료됩니다.</p>
                     
                     <p>BETWEEN을 지정하지 않으면 묵시적이지만 프레임 경계가 현재 행으로 결정됩니다. 예를 들어 <code class="code">ROWS 5 PRECEDING</code>은 <code class="code">ROWS BETWEEN 5 PRECEDING AND CURRENT ROW</code>와 같습니다. 또한 <code class="code">ROWS
                           UNBOUNDED FOLLOWING</code>은 <code class="code">ROWS BETWEEN CURRENT ROW AND
                              UNBOUNDED FOLLOWING</code>과 같습니다.</p>
                     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>참고</h6></div><div class="awsdocs-note-text"><p>시작 경계가 종료 경계보다 크게 프레임을 지정할 수는 없습니다. 예를 들어 다음과 같은 프레임은 지정할 수 없습니다.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">between 5 following and 5 preceding
between current row and 2 preceding
between 3 following and current row</code></pre></div></div>
                  </dd>
               </dl></div>
          
         
       
         <h2 id="r_Examples_order_by_WF">창 함수 데이터에 대한 고유 순서 지정</h2>
         
         
         <p>윈도 함수의 ORDER BY 절이 데이터의 전체 순서를 고유하게 지정하지 않으면 행의 순서는 비확정적입니다. 다시 말해 ORDER BY 표현식에서 중복 값이 산출되면(부분 순서 지정) 여러 차례 실행할 때마다 해당 행의 반환 순서가 달라질 수 있습니다. 이 경우 윈도 함수 역시 예상하지 못하거나 일관적이지 못한 결과를 반환하게 됩니다.</p>
         <p>예를 들어 다음 쿼리는 여러 실행에 대해 다른 결과를 반환합니다. 이러한 다른 결과는 <code class="code">order by dateid</code>가 SUM 윈도 함수 데이터의 고유한 순서를 생성하지 않기 때문에 발생합니다.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select dateid, pricepaid,
sum(pricepaid) over(order by dateid rows unbounded preceding) as sumpaid
from sales
group by dateid, pricepaid;

dateid | pricepaid |   sumpaid
--------+-----------+-------------
1827 |   1730.00 |     1730.00
1827 |    708.00 |     2438.00
1827 |    234.00 |     2672.00
...

select dateid, pricepaid,
sum(pricepaid) over(order by dateid rows unbounded preceding) as sumpaid
from sales
group by dateid, pricepaid;

dateid | pricepaid |   sumpaid
--------+-----------+-------------
1827 |    234.00 |      234.00
1827 |    472.00 |      706.00
1827 |    347.00 |     1053.00
...</code></pre>
         <p> 이 경우에는 두 번째 ORDER BY 열을 윈도 함수에 추가하여 문제를 해결할 수 있습니다.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select dateid, pricepaid,
sum(pricepaid) over(order by dateid, pricepaid rows unbounded preceding) as sumpaid
from sales
group by dateid, pricepaid;

dateid | pricepaid | sumpaid
--------+-----------+---------
1827 |    234.00 |  234.00
1827 |    337.00 |  571.00
1827 |    347.00 |  918.00
...</code></pre>
       
         <h2 id="r_Window_function_supported">지원되는 함수</h2>
      <p>Amazon Redshift는 집계와 순위, 두 가지 형식의 윈도 함수를 지원합니다.</p>
      <p>다음은 지원되는 집계 함수입니다.</p>
      <div class="itemizedlist">
          
          
          
          
          
          
          
          
               
          
          
          
          
          
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><a href="./r_WF_AVG.html">AVG 창 함수</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_COUNT.html">COUNT 창 함수</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_CUME_DIST.html">CUME_DIST 창 함수</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_DENSE_RANK.html">DENSE_RANK 창 함수</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_first_value.html">FIRST_VALUE 창 함수</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_LAG.html">LAG 창 함수</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_last_value.html">LAST_VALUE 창 함수</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_LEAD.html">LEAD 창 함수</a> </p>
         </li><li class="listitem">
               <p><a href="./r_WF_LISTAGG.html">LISTAGG 창 함수</a> </p>
            </li><li class="listitem">
            <p><a href="./r_WF_MAX.html">MAX 창 함수</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_MEDIAN.html">MEDIAN 창 함수</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_MIN.html">MIN 창 함수</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_NTH.html">NTH_VALUE 창 함수</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_PERCENTILE_CONT.html">PERCENTILE_CONT 창 함수</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_PERCENTILE_DISC.html">PERCENTILE_DISC 창 함수</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_RATIO_TO_REPORT.html">RATIO_TO_REPORT 창 함수</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_STDDEV.html">STDDEV_SAMP 및 STDDEV_POP 창 함수</a>(STDDEV_SAMP 및 STDDEV는 동의어) </p>
         </li><li class="listitem">
            <p><a href="./r_WF_SUM.html">SUM 창 함수</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_VARIANCE.html">VAR_SAMP 및 VAR_POP 창 함수</a>(VAR_SAMP와 VARIANCE는 동의어)</p>
         </li></ul></div>
      <p>다음은 지원되는 순위 함수입니다.</p>
      <div class="itemizedlist">
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><a href="./r_WF_DENSE_RANK.html">DENSE_RANK 창 함수</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_NTILE.html">NTILE 창 함수</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_PERCENT_RANK.html">PERCENT_RANK 창 함수</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_RANK.html">RANK 창 함수</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_ROW_NUMBER.html">ROW_NUMBER 창 함수</a></p>
         </li></ul></div>
       
         <h2 id="r_Window_function_example">창 함수 예제를 위한 샘플 테이블</h2>
         
         <p>각 함수 설명과 함께 특정 창 함수 예제를 찾을 수도 있습니다. 일부 예는 다음과 같은 11개의 행이 포함된 WINSALES라는 테이블을 사용합니다.</p>
         <div class="table-container"><div class="table-contents"><table id="w319aac47c11c45c17b5"><thead>
                  <tr>
                     <th>SALESID </th>
                     <th>DATEID </th>
                     <th>SELLERID </th>
                     <th>BUYERID </th>
                     <th>QTY </th>
                     <th>QTY_SHIPPED </th>
                  </tr>
               </thead>
                  <tr>
                     <td tabindex="-1"> 30001 </td>
                     <td tabindex="-1"> 30001 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1">10 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 10001 </td>
                     <td tabindex="-1"> 10001 </td>
                     <td tabindex="-1"> 1 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1">10 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 10005 </td>
                     <td tabindex="-1"> 10005 </td>
                     <td tabindex="-1"> 1 </td>
                     <td tabindex="-1"> A </td>
                     <td tabindex="-1"> 30 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 40001 </td>
                     <td tabindex="-1"> 40001 </td>
                     <td tabindex="-1"> 4 </td>
                     <td tabindex="-1"> A </td>
                     <td tabindex="-1"> 40 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 10006 </td>
                     <td tabindex="-1"> 10006 </td>
                     <td tabindex="-1"> 1 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 20001 </td>
                     <td tabindex="-1"> 20001 </td>
                     <td tabindex="-1"> 2 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 20 </td>
                     <td tabindex="-1">20 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 40005 </td>
                     <td tabindex="-1"> 40005 </td>
                     <td tabindex="-1"> 4 </td>
                     <td tabindex="-1"> A </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1">10 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 20002 </td>
                     <td tabindex="-1"> 20002 </td>
                     <td tabindex="-1"> 2 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 20 </td>
                     <td tabindex="-1">20 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 30003 </td>
                     <td tabindex="-1"> 30003 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 15 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 30004 </td>
                     <td tabindex="-1"> 30004 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 20 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 30007 </td>
                     <td tabindex="-1"> 30007 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 30 </td>
                     <td tabindex="-1"> </td>
                  </tr>
               </table></div></div>
         <p>다음은 WINSALES 샘플 테이블을 생성하여 채우는 스크립트입니다.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE winsales(
  salesid int,
  dateid date,
  sellerid int,
  buyerid char(10),
  qty int,
  qty_shipped int);

INSERT INTO winsales VALUES
  (30001, '8/2/2003', 3, 'b', 10, 10),
  (10001, '12/24/2003', 1, 'c', 10, 10),
  (10005, '12/24/2003', 1, 'a', 30, null),	
  (40001, '1/9/2004', 4, 'a', 40, null),	
  (10006, '1/18/2004', 1, 'c', 10, null),	
  (20001, '2/12/2004', 2, 'b', 20, 20),
  (40005, '2/12/2004', 4, 'a', 10, 10),
  (20002, '2/16/2004', 2, 'c', 20, 20),
  (30003, '4/18/2004', 3, 'b', 15, null),
  (30004, '4/18/2004', 3, 'b', 20, null),	
  (30007, '9/7/2004', 3, 'c', 30, null);	 
</code></pre>
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="주의" /> <strong>javascript가 브라우저에서 비활성화되거나 사용이 불가합니다.</strong></p><p>AWS 설명서를 사용하려면 Javascript가 활성화되어야 합니다. 지침을 보려면 브라우저의 도움말 페이지를 참조하십시오.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">문서 규칙</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_TO_VARBYTE.html">TO_VARBYTE</div><div id="next" class="next-link" accesskey="n" href="./r_WF_AVG.html">AVG</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">이 페이지의 내용이 도움이 되었습니까? - 예</div><div class="content"><p>칭찬해 주셔서 감사합니다!</p><p>잠깐 시간을 내어 좋았던 부분을 알려 주시면 더 열심히 만들어 보겠습니다.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="feedback-tell-us" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">이 페이지의 내용이 도움이 되었습니까? - 아니요</div><div class="content"><p>이 페이지에 작업이 필요하다는 점을 알려 주셔서 감사합니다. 실망시켜 드려 죄송합니다.</p><p>잠깐 시간을 내어 설명서를 향상시킬 수 있는 방법에 대해 말씀해 주십시오.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="feedback-tell-us" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>