<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="ko-KR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>MERGE - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_MERGE" /><meta name="default_state" content="r_MERGE" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" /><meta name="description" content="소스 테이블의 값을 기반으로 테이블의 값을 삽입, 업데이트 및 삭제합니다." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="데이터베이스 개발자 안내서" /><meta name="abstract" content="페타바이트 규모의 엔터프라이즈급 완전관리형 데이터 웨어하우징 서비스인 Amazon Redshift로 데이터 웨어하우스를 생성하고 관리합니다." /><meta name="guide-locale" content="ko_kr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_MERGE.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_MERGE.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_MERGE.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_MERGE.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_MERGE.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_MERGE.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_MERGE.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_MERGE.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="데이터베이스 개발자 안내서" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="데이터베이스 개발자 안내서" /><meta id="panorama-serviceConsolePage" value="MERGE" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>MERGE - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_MERGE" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,데이터 웨어하우스,샘플 데이터,데이터베이스,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "데이터베이스 개발자 안내서",
        "item" : "https://docs.aws.amazon.com/ko_kr/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "SQL 참조",
        "item" : "https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "SQL 명령",
        "item" : "https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "MERGE",
        "item" : "https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_SQL_commands.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_MERGE" target="_blank" rel="noopener noreferrer" title="pdf-tooltip"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">aws-documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">데이터베이스 개발자 안내서</a></div><div id="page-toc-src"><a href="#r_MERGE-synopsis">명령문</a><a href="#r_MERGE-parameters">파라미터</a><a href="#r_MERGE_usage_notes">사용 노트</a><a href="#sub-examples-merge">예</a><a href="#r_MERGE-see-also">다음 사항도 참조하십시오.</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="r_MERGE">MERGE</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>소스 테이블의 행을 대상 테이블에 조건부로 병합합니다. 기존에 이는 여러 삽입, 업데이트 또는 삭제 문을 개별적으로 사용해야만 달성할 수 있습니다. MERGE를 통해 결합할 수 있는 작업에 대한 자세한 내용은 <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_UPDATE.html">UPDATE</a>, <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_DELETE.html">DELETE</a> 및 <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_INSERT_30.html">INSERT</a>를 참조하세요.</p>
         <h2 id="r_MERGE-synopsis">명령문</h2>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">MERGE INTO <em>target_table</em> 
USING <em>source_table</em> [ [ AS ] <em>alias</em> ] 
ON <em>match_condition</em> 
[ WHEN MATCHED THEN <span>{</span> UPDATE SET <em>col_name</em> = <span>{</span> <em>expr</em> } [,...] | DELETE }
WHEN NOT MATCHED THEN INSERT [ ( <em>col_name</em> [,...] ) ] VALUES ( <span>{</span> <em>expr</em> } [, ...] ) |
REMOVE DUPLICATES ]</code></pre>

       
         <h2 id="r_MERGE-parameters">파라미터</h2>
         <div class="variablelist">
             
             
             
             
            
             
             
             

             
             
             
             
             
         <dl>
               <dt><span class="term"> <em>target_table</em></span></dt>
               <dd>
                  <p>MERGE 문이 병합되는 임시 또는 영구 테이블입니다.</p>
               </dd>
             
               <dt><span class="term"> <em>source_table</em></span></dt>
               <dd>
                  <p><em>target_table</em>에 병합할 행을 제공하는 임시 또는 영구 테이블입니다. <em>source_table</em>은 스펙트럼 테이블일 수도 있습니다. <em>source_table</em>은 뷰 또는 하위 쿼리가 될 수 없습니다.</p>
               </dd>
             
               <dt><span class="term"> <em>별칭</em></span></dt>
               <dd>
                  <p><em>source_table</em>의 임시 대체 이름입니다.</p>
                  <p>이 파라미터는 선택 사항입니다. AS로 시작하는 <em>별칭</em>도 선택 사항입니다.</p>
               </dd>
             
               <dt><span class="term"> <em>match_condition</em></span></dt>
               <dd>
                  <p><em>source_table</em>의 행이 <em>target_table</em>의 행과 일치할 수 있는지 여부를 결정하는 데 사용되는 소스 테이블 열과 대상 테이블 열 사이에 동일한 술어를 지정합니다. 조건이 충족되면 MERGE는 해당 행에 대해 <em>matching_clause</em>를 실행합니다 그렇지 않으면 MERGE는 해당 행에 대해 <em>not_matched_clause</em>를 실행합니다.</p>
               </dd>
             
               <dt><span class="term">WHEN MATCHED</span></dt>
               <dd>
                  <p> 소스 행과 대상 행 간의 일치 조건이 참으로 평가될 때 실행할 작업을 지정합니다. UPDATE 조치 또는 DELETE 조치를 지정할 수 있습니다.</p>
               </dd>
             
               <dt><span class="term">UPDATE</span></dt>
               <dd><p> <em>target_table</em>에서 일치하는 행을 업데이트합니다. 지정한 <em>col_name</em>의 값만 업데이트됩니다.</p></dd>
             
               <dt><span class="term">DELETE</span></dt>
               <dd><p> <em>target_table</em>에서 일치하는 행을 삭제합니다.</p></dd>
             
               <dt><span class="term">WHEN NOT MATCHED</span></dt>
               <dd>
                  <p> 일치 조건이 거짓 또는 알 수 없음으로 평가될 때 실행할 작업을 지정합니다. 이 절에 대한 INSERT 삽입 조치만 지정할 수 있습니다.</p>
               </dd>
             
               <dt><span class="term">INSERT</span></dt>
               <dd><p> <em>target_table</em>에 하나의 행을 삽입합니다. 임의의 순서대로 대상 <em>col_name</em>을 나열할 수 있습니다. <em>col_name</em> 값을 제공하지 않으면 기본 순서는 선언된 순서의 모든 테이블 열입니다.</p></dd>
             
               <dt><span class="term"> <em>col_name</em></span></dt>
               <dd>
                  <p>수정하려는 하나 이상의 열 이름입니다. 대상 열을 지정할 때 테이블 이름을 포함하지 마세요.</p>
               </dd>
             
               <dt><span class="term"> <em>expr</em></span></dt>
               <dd>
                  <p><em>col_name</em>의 새 값을 정의하는 표현식입니다.</p>
               </dd>
             
               <dt><span class="term"> REMOVE DUPLICATES</span></dt>
               <dd>
                  <p>MERGE 명령이 단순 모드에서 실행되도록 지정합니다. 단순 모드의 요구 사항은 다음과 같습니다.</p>
                  <div class="itemizedlist">
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem"><p> <em>target_table</em>과 <em>source_table</em>은 열 수와 호환 가능한 열 유형이 같아야 합니다.</p></li><li class="listitem"><p> MERGE 명령에서 WHEN 절과 UPDATE 및 INSERT 절을 생략해야 합니다.</p></li><li class="listitem"><p> MERGE 명령에서 REMOVE DUPLICATES 절을 사용해야 합니다.</p></li></ul></div>
                  <p>단순 모드에서 MERGE는 다음 작업을 수행합니다.</p>
                  <div class="itemizedlist">
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem"><p> <em>target_table</em>에서 <em>source_table</em>과 일치하는 행이 있으면 <em>source_table</em>의 값과 일치하도록 업데이트됩니다.</p></li><li class="listitem"><p> <em>source_table</em>에서 <em>target_table</em>과 일치하지 않는 행은 <em>target_table</em>에 삽입됩니다.</p></li><li class="listitem"><p> <em>target_table</em>의 여러 행이 <em>source_table</em>의 동일한 행과 일치하면 중복된 행이 제거됩니다. Amazon Redshift는 한 행을 유지하고 업데이트합니다. <em>source_table</em>의 행과 일치하지 않는 중복된 행은 변경되 않습니다.</p></li></ul></div>
                  <p>REMOVE DUPLICATES를 사용하면 WHEN MATCHED와 WHEN NOT MATCHED를 사용하는 것보다 성능이 향상됩니다. <em>target_table</em>과 <em>source_table</em>이 호환되고 <em>target_table</em>에 중복된 행을 보존할 필요가 없는 경우에는 REMOVE DUPLICATES를 사용하는 것이 좋습니다.</p>
               </dd>
            </dl></div>
       
         <h2 id="r_MERGE_usage_notes">사용 노트</h2>
         <div class="itemizedlist">
             
             
             
             
             
             
            
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>MERGE 문을 실행하려면 <em>source_table</em> 및 <em>target_table</em>의 소유자이거나 해당 테이블에 대한 SELECT 권한이 있어야 합니다. 또한 MERGE 문에 포함된 작업에 따라 <em>target_table</em>에 대한 UPDATE, DELETE 및 INSERT 권한이 있어야 합니다.</p>
            </li><li class="listitem">
               <p> <em>target_table</em>은 시스템 테이블, 카탈로그 테이블 또는 외부 테이블일 수 없습니다.</p>
            </li><li class="listitem">
               <p> <em>source_table</em> 및 <em>target_table</em>은 동일한 테이블일 수 없습니다.</p>
            </li><li class="listitem">
               <p> MERGE 문에는 WITH 절을 사용할 수 없습니다.</p>
            </li><li class="listitem">
               <p> <em>target_table</em>의 행은 <em>source_table</em>의 여러 행과 일치할 수 없습니다.</p>
               <p>다음 예제를 검토하십시오.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (1, 'Bob'), (2, 'John');
INSERT INTO source VALUES (1, 'Tony'), (1, 'Alice'), (3, 'Bill');

MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN UPDATE SET id = source.id, name = source.name
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);
ERROR: Found multiple matches to update the same tuple.

MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN DELETE
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);
ERROR: Found multiple matches to update the same tuple.</code></pre>
               <p><code class="code">source</code> 테이블에 ID 값이 <code class="code">1</code>인 행이 여러 개 있기 때문에 두 MERGE 문 모두에서 작업이 실패합니다.</p>
            </li><li class="listitem">
               <p> <em>match_condition</em> 및 <em>expr</em>은 SUPER 형식 열을 부분적으로 참조할 수 없습니다. 예를 들어 <em>SUPER 형식 객체가 배열이나 구조체인 경우 <em>match_condition</em> 또는 expr에</em> 해당 열의 개별 요소를 사용할 수 없지만 전체 열을 사용할 수는 있습니다.</p>
               <p>다음 예제를 검토하십시오.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE IF NOT EXISTS target (key INT, value SUPER);
CREATE TABLE IF NOT EXISTS source (key INT, value SUPER);

INSERT INTO target VALUES (1, JSON_PARSE('<span>{</span>"key": 88}'));
INSERT INTO source VALUES (1, ARRAY(1, 'John')), (2, ARRAY(2, 'Bill'));

MERGE INTO target USING source ON target.key = source.key
WHEN matched THEN UPDATE SET value = source.value[0]
WHEN NOT matched THEN INSERT VALUES (source.key, source.value[0]);
ERROR: Partial reference of SUPER column is not supported in MERGE statement.</code></pre>
               <p>SUPER 유형형식에 대한 자세한 내용은 <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SUPER_type.html">SUPER 형식</a>을 참조하세요.</p>
            </li><li class="listitem">
               <p><em>source_table</em>이 큰 경우 <em>target_table</em>과 <em>source_table</em> 모두의 조인 열을 분산 키로 정의하면 성능이 향상될 수 있습니다.</p>
            </li><li class="listitem">
               <p>REMOVE DUPLICATES 절을 사용하려면 <em>target_table</em>에 대한 SELECT, INSERT, DELETE 권한이 필요합니다.</p>
            </li></ul></div>
       
         <h2 id="sub-examples-merge">예</h2>
         <p>다음 예에서는 두 개의 테이블을 만든 다음 테이블에서 MERGE 작업을 실행하여 대상 테이블에서 일치하는 행을 업데이트하고 일치하지 않는 행을 삽입합니다. 그런 다음 소스 테이블에 다른 값을 삽입하고 다른 MERGE 작업을 실행합니다. 이번에는 일치하는 행을 삭제하고 소스 테이블에서 새 행을 삽입합니다.</p>
         <p>먼저 소스 및 대상 테이블을 만들고 채웁니다.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (101, 'Bob'), (102, 'John'), (103, 'Susan');
INSERT INTO source VALUES (102, 'Tony'), (103, 'Alice'), (104, 'Bill');

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 102 | John
 103 | Susan
(3 rows)

SELECT * FROM source;
 id  |    name
-----+------------
 102 | Tony
 103 | Alice
 104 | Bill
(3 rows)</code></pre>
         <p>그런 다음 소스 테이블을 대상 테이블에 병합하여 대상 테이블을 일치하는 행으로 업데이트하고 일치하는 행이 없는 소스 테이블의 행을 삽입합니다.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN UPDATE SET id = source.id, name = source.name
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 102 | Tony
 103 | Alice
 104 | Bill
(4 rows)</code></pre>
         <p>id 값이 102 및 103인 행은 대상 테이블의 name 값과 일치하도록 업데이트됩니다. 또한 id 값이 104이고 name 값이 Bill인 새 행이 대상 테이블에 삽입됩니다.</p>
         <p>그런 다음 소스 테이블에 새 행을 삽입합니다.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">INSERT INTO source VALUES (105, 'David');

SELECT * FROM source;
 id  |    name
-----+------------
 102 | Tony
 103 | Alice
 104 | Bill
 105 | David
(4 rows)</code></pre>
         <p>마지막으로 대상 테이블에서 일치하는 행을 삭제하고 일치하지 않는 행을 삽입하는 병합 작업을 실행합니다.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN DELETE
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 105 | David
(2 rows)</code></pre>
         <p>id 값이 102, 103 및 104인 행이 대상 테이블에서 삭제되고 id 값이 105이고 name 값이 David인 새 행이 대상 테이블에 삽입됩니다.</p>
         <p>다음 예는 REMOVE DUPLICATES 절을 사용하는 MERGE 명령을 보여줍니다.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (30, 'Tony'), (11, 'Alice'), (23, 'Bill');
INSERT INTO source VALUES (23, 'David'), (22, 'Clarence');

MERGE INTO target USING source ON target.id = source.id REMOVE DUPLICATES;

SELECT * FROM target;
id | name
---+------------
30 | Tony
11 | Alice
23 | David
22 | Clarence
(4 rows)</code></pre>
         <p>다음 예제에서는 REMOVE DUPLICATES 절을 사용하여 <em>source_table</em>과 일치하는 행이 있는 경우 <em>target_table</em>에서 중복 행을 제거하는 MERGE 명령을 보여 줍니다.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (30, 'Tony'), (30, 'Daisy'), (11, 'Alice'), (23, 'Bill'), (23, 'Nikki');
INSERT INTO source VALUES (23, 'David'), (22, 'Clarence');

MERGE INTO target USING source ON target.id = source.id REMOVE DUPLICATES;

SELECT * FROM target;
id | name
---+------------
30 | Tony
30 | Daisy
11 | Alice
23 | David
22 | Clarence
(5 rows)</code></pre>
         <p>MERGE가 실행된 후에는 <em>target_table</em>에서 ID 값이 23인 행이 하나뿐입니다. <em>source_table</em>에 ID 값이 30인 행이 없었기 때문에 ID 값이 30인 두 개의 중복된 행은 <em>target_table</em>에 그대로 남아 있습니다.</p>
       
         <h2 id="r_MERGE-see-also">다음 사항도 참조하십시오.</h2>
         <p>
            <a href="./r_INSERT_30.html">INSERT</a>, <a href="./r_UPDATE.html">UPDATE</a>,
            <a href="./r_DELETE.html">DELETE</a>
         </p>
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="주의" /> <strong>javascript가 브라우저에서 비활성화되거나 사용이 불가합니다.</strong></p><p>AWS 설명서를 사용하려면 Javascript가 활성화되어야 합니다. 지침을 보려면 브라우저의 도움말 페이지를 참조하십시오.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">문서 규칙</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_LOCK.html">LOCK</div><div id="next" class="next-link" accesskey="n" href="./r_PREPARE.html">PREPARE</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">이 페이지의 내용이 도움이 되었습니까? - 예</div><div class="content"><p>칭찬해 주셔서 감사합니다!</p><p>잠깐 시간을 내어 좋았던 부분을 알려 주시면 더 열심히 만들어 보겠습니다.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="feedback-tell-us" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">이 페이지의 내용이 도움이 되었습니까? - 아니요</div><div class="content"><p>이 페이지에 작업이 필요하다는 점을 알려 주셔서 감사합니다. 실망시켜 드려 죄송합니다.</p><p>잠깐 시간을 내어 설명서를 향상시킬 수 있는 방법에 대해 말씀해 주십시오.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="feedback-tell-us" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>