<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS::Config::AggregationAuthorization - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="aws-resource-config-aggregationauthorization" /><meta name="default_state" content="aws-resource-config-aggregationauthorization" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" /><meta name="description" content="An object that represents the authorizations granted to aggregator accounts and regions." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json;toc-AWS_Config.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" hreflang="x-default" /><meta name="feedback-item" content="AWS Config" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="AWS::Config::AggregationAuthorization" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS::Config::AggregationAuthorization - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS%20Config&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "AWS Config resource type reference",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Config.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "AWS::Config::AggregationAuthorization",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Config.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="AWS_Config.html">User Guide</a></div><div id="page-toc-src"><a href="#aws-resource-config-aggregationauthorization-syntax">Syntax</a><a href="#aws-resource-config-aggregationauthorization-properties">Properties</a><a href="#aws-resource-config-aggregationauthorization-return-values">Return values</a><a href="#aws-resource-config-aggregationauthorization--examples">Examples</a></div><div id="page-filters" style="display:none"><filter label="All" id="All"></filter><filter label="JSON" id="JSON"></filter><filter label="YAML" id="YAML"></filter></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="aws-resource-config-aggregationauthorization">AWS::Config::AggregationAuthorization</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>An object that represents the authorizations granted to
			aggregator accounts and regions.</p><h2 id="aws-resource-config-aggregationauthorization-syntax">Syntax</h2><p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p><div id="JSON" name="JSON" class="section langfilter"><h3 id="aws-resource-config-aggregationauthorization-syntax.json">JSON</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Type" : "AWS::Config::AggregationAuthorization",
  "Properties" : <span>{</span>
      "<a href="#cfn-config-aggregationauthorization-authorizedaccountid">AuthorizedAccountId</a>" : <code class="replaceable">String</code>,
      "<a href="#cfn-config-aggregationauthorization-authorizedawsregion">AuthorizedAwsRegion</a>" : <code class="replaceable">String</code>,
      "<a href="#cfn-config-aggregationauthorization-tags">Tags</a>" : <code class="replaceable">[ <a href="./aws-properties-config-aggregationauthorization-tag.html">Tag</a>, ... ]</code>
    }
}
</code></pre></div><div id="YAML" name="YAML" class="section langfilter"><h3 id="aws-resource-config-aggregationauthorization-syntax.yaml">YAML</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Type: AWS::Config::AggregationAuthorization
Properties:
  <a href="#cfn-config-aggregationauthorization-authorizedaccountid">AuthorizedAccountId</a>: <code class="replaceable">String</code>
  <a href="#cfn-config-aggregationauthorization-authorizedawsregion">AuthorizedAwsRegion</a>: <code class="replaceable">String</code>
  <a href="#cfn-config-aggregationauthorization-tags">Tags</a>: <code class="replaceable">
    - <a href="./aws-properties-config-aggregationauthorization-tag.html">Tag</a></code>
</code></pre></div><h2 id="aws-resource-config-aggregationauthorization-properties">Properties</h2><div class="variablelist"><dl><dt id="cfn-config-aggregationauthorization-authorizedaccountid"><span class="term"><code class="code">AuthorizedAccountId</code></span></dt><dd>
         <p>The 12-digit account ID of the account authorized to aggregate
			data.</p>
      <p><em>Required</em>: Yes</p><p><em>Type</em>: String</p><p><em>Pattern</em>: <code class="code">^\d<span>{</span>12}$</code></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p></dd><dt id="cfn-config-aggregationauthorization-authorizedawsregion"><span class="term"><code class="code">AuthorizedAwsRegion</code></span></dt><dd>
         <p>The region authorized to collect aggregated data.</p>
      <p><em>Required</em>: Yes</p><p><em>Type</em>: String</p><p><em>Minimum</em>: <code class="code">1</code></p><p><em>Maximum</em>: <code class="code">64</code></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p></dd><dt id="cfn-config-aggregationauthorization-tags"><span class="term"><code class="code">Tags</code></span></dt><dd>
         <p>An array of tag object.</p>
      <p><em>Required</em>: No</p><p><em>Type</em>: Array of <a href="./aws-properties-config-aggregationauthorization-tag.html">Tag</a></p><p><em>Maximum</em>: <code class="code">50</code></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd></dl></div><h2 id="aws-resource-config-aggregationauthorization-return-values">Return values</h2><h3 id="aws-resource-config-aggregationauthorization-return-values-ref">Ref</h3><p>
            When you pass the logical ID of this resource to the intrinsic <code class="code">Ref</code> function, <code class="code">Ref</code> returns the ARN of the AggregationAuthorization, such as <code class="code">arn:aws:config:us-east-1:123456789012:aggregation-authorization/987654321012/us-west-2</code>.</p><p>For more information about using the <code class="code">Ref</code> function, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html"><code class="code">Ref</code></a>.</p><h3 id="aws-resource-config-aggregationauthorization-return-values-fn--getatt">Fn::GetAtt</h3><h4 id="aws-resource-config-aggregationauthorization-return-values-fn--getatt-fn--getatt"></h4><div class="variablelist"><dl><dt id="AggregationAuthorizationArn-fn::getatt"><span class="term"><code class="code">AggregationAuthorizationArn</code></span></dt><dd>
        <p>The Amazon Resource Name (ARN) of the aggregation object.</p>
    </dd></dl></div><h2 id="aws-resource-config-aggregationauthorization--examples">Examples</h2><p></p><div class="highlights" id="inline-topiclist"><h6> </h6><ul><li><a href="#aws-resource-config-aggregationauthorization--examples--Authorize_Another_Account">Authorize Another Account</a></li><li><a href="#aws-resource-config-aggregationauthorization--examples--Aggregation_Authorization">Aggregation Authorization</a></li></ul></div><h3 id="aws-resource-config-aggregationauthorization--examples--Authorize_Another_Account">Authorize Another Account</h3><p>The following example creates an AggregationAuthorization that authorizes another account to aggregate your AWS Config data into a specific region. </p><div id="JSON" name="JSON" class="section langfilter"><h4 id="aws-resource-config-aggregationauthorization--examples--Authorize_Another_Account--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"AggregationAuthorization": <span>{</span>
    "Type": "AWS::Config::AggregationAuthorization",
    "Properties": <span>{</span>
        "AuthorizedAccountId": 123456789012,
        "AuthorizedAwsRegion": "us-west-2"
    }
}</code></pre></div><div id="YAML" name="YAML" class="section langfilter"><h4 id="aws-resource-config-aggregationauthorization--examples--Authorize_Another_Account--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AggregationAuthorization: 
  Type: "AWS::Config::AggregationAuthorization"
  Properties: 
    AuthorizedAccountId: 123456789012
    AuthorizedAwsRegion: us-west-2</code></pre></div><h3 id="aws-resource-config-aggregationauthorization--examples--Aggregation_Authorization">Aggregation Authorization</h3><p>The following example enables AWS Config and creates an AWS Config rule, an
                    aggregator, and an authorization.</p><div id="JSON" name="JSON" class="section langfilter"><h4 id="aws-resource-config-aggregationauthorization--examples--Aggregation_Authorization--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Enable Config",
    "Metadata": <span>{</span>
        "AWS::CloudFormation::Interface": <span>{</span>
            "ParameterGroups": [
                <span>{</span>
                    "Label": <span>{</span>
                        "default": "Configuration Recorder Configuration"
                    },
                    "Parameters": [
                        "GlobalResourceTypesRegion"
                    ]
                },
                <span>{</span>
                    "Label": <span>{</span>
                        "default": "Configuration Aggregator Configuration"
                    },
                    "Parameters": [
                        "AggregatorAccount",
                        "AggregatorRegion",
                        "SourceAccounts",
                        "SourceRegions"
                    ]
                }
            ],
            "ParameterLabels": <span>{</span>
                "GlobalResourceTypesRegion": <span>{</span>
                    "default": "Global resource types region"
                },
                "AggregatorAccount": <span>{</span>
                    "default": "Aggregator account"
                },
                "AggregatorRegion": <span>{</span>
                    "default": "Aggregator region"
                },
                "SourceAccounts": <span>{</span>
                    "default": "Source accounts"
                },
                "SourceRegions": <span>{</span>
                    "default": "Source regions"
                }
            }
        }
    },
    "Parameters": <span>{</span>
        "GlobalResourceTypesRegion": <span>{</span>
            "Type": "String",
            "Default": "us-east-1",
            "Description": "AWS region used to record global resources types"
        },
        "AggregatorAccount": <span>{</span>
            "Type": "String",
            "Description": "Account ID of the aggregator"
        },
        "AggregatorRegion": <span>{</span>
            "Type": "String",
            "Default": "us-east-1",
            "Description": "AWS region of the aggregator"
        },
        "SourceAccounts": <span>{</span>
            "Type": "CommaDelimitedList",
            "Description": "List of source accounts to aggregate"
        },
        "SourceRegions": <span>{</span>
            "Type": "CommaDelimitedList",
            "Description": "List of regions to aggregate"
        }
    },
    "Conditions": <span>{</span>
        "IncludeGlobalResourceTypes": <span>{</span>
            "Fn::Equals": [
                <span>{</span>
                    "Ref": "GlobalResourceTypesRegion"
                },
                <span>{</span>
                    "Ref": "AWS::Region"
                }
            ]
        },
        "CreateAggregator": <span>{</span>
            "Fn::And": [
                <span>{</span>
                    "Fn::Equals": [
                        <span>{</span>
                            "Ref": "AggregatorAccount"
                        },
                        <span>{</span>
                            "Ref": "AWS::AccountId"
                        }
                    ]
                },
                <span>{</span>
                    "Fn::Equals": [
                        <span>{</span>
                            "Ref": "AggregatorRegion"
                        },
                        <span>{</span>
                            "Ref": "AWS::Region"
                        }
                    ]
                }
            ]
        },
        "CreateAuthorization": <span>{</span>
            "Fn::Not": [
                <span>{</span>
                    "Fn::Equals": [
                        <span>{</span>
                            "Ref": "AggregatorAccount"
                        },
                        <span>{</span>
                            "Ref": "AWS::AccountId"
                        }
                    ]
                }
            ]
        }
    },
    "Resources": <span>{</span>
        "ConfigBucket": <span>{</span>
            "DeletionPolicy": "Retain",
            "Type": "AWS::S3::Bucket"
        },
        "ConfigBucketPolicy": <span>{</span>
            "Type": "AWS::S3::BucketPolicy",
            "Properties": <span>{</span>
                "Bucket": <span>{</span>
                    "Ref": "ConfigBucket"
                },
                "PolicyDocument": <span>{</span>
                    "Version": "2012-10-17",
                    "Statement": [
                        <span>{</span>
                            "Sid": "AWSConfigBucketPermissionsCheck",
                            "Effect": "Allow",
                            "Principal": <span>{</span>
                                "Service": [
                                    "config.amazonaws.com"
                                ]
                            },
                            "Action": "s3:GetBucketAcl",
                            "Resource": [
                                <span>{</span>
                                    "Fn::Sub": "arn:aws:s3:::$<span>{</span>ConfigBucket}"
                                }
                            ]
                        },
                        <span>{</span>
                            "Sid": "AWSConfigBucketDelivery",
                            "Effect": "Allow",
                            "Principal": <span>{</span>
                                "Service": [
                                    "config.amazonaws.com"
                                ]
                            },
                            "Action": "s3:PutObject",
                            "Resource": [
                                <span>{</span>
                                    "Fn::Sub": "arn:aws:s3:::$<span>{</span>ConfigBucket}/AWSLogs/$<span>{</span>AWS::AccountId}/*"
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "ConfigRecorderRole": <span>{</span>
            "Type": "AWS::IAM::Role",
            "Properties": <span>{</span>
                "AssumeRolePolicyDocument": <span>{</span>
                    "Version": "2012-10-17",
                    "Statement": [
                        <span>{</span>
                            "Effect": "Allow",
                            "Principal": <span>{</span>
                                "Service": [
                                    "config.amazonaws.com"
                                ]
                            },
                            "Action": [
                                "sts:AssumeRole"
                            ]
                        }
                    ]
                },
                "Path": "/",
                "ManagedPolicyArns": [
                    "arn:aws:iam::aws:policy/service-role/AWSConfigRole"
                ]
            }
        },
        "ConfigRecorder": <span>{</span>
            "Type": "AWS::Config::ConfigurationRecorder",
            "DependsOn": [
                "ConfigRecorderRole",
                "ConfigBucketPolicy"
            ],
            "Properties": <span>{</span>
                "RoleARN": <span>{</span>
                    "Fn::GetAtt": [
                        "ConfigRecorderRole",
                        "Arn"
                    ]
                },
                "RecordingGroup": <span>{</span>
                    "AllSupported": true,
                    "IncludeGlobalResourceTypes": <span>{</span>
                        "Fn::If": [
                            "IncludeGlobalResourceTypes",
                            true,
                            false
                        ]
                    }
                }
            }
        },
        "DeliveryChannel": <span>{</span>
            "Type": "AWS::Config::DeliveryChannel",
            "DependsOn": [
                "ConfigBucketPolicy"
            ],
            "Properties": <span>{</span>
                "Name": "default",
                "S3BucketName": <span>{</span>
                    "Ref": "ConfigBucket"
                }
            }
        },
        "S3BucketPublicReadRule": <span>{</span>
            "Type": "AWS::Config::ConfigRule",
            "DependsOn": [
                "ConfigRecorder"
            ],
            "Properties": <span>{</span>
                "ConfigRuleName": "stackset-s3-bucket-public-read-prohibited",
                "Description": "s3-bucket-public-read-prohibited from stackset",
                "Scope": <span>{</span>
                    "ComplianceResourceTypes": [
                        "AWS::S3::Bucket"
                    ]
                },
                "Source": <span>{</span>
                    "Owner": "AWS",
                    "SourceIdentifier": "S3_BUCKET_PUBLIC_READ_PROHIBITED"
                }
            }
        },
        "ConfigAggregator": <span>{</span>
            "Type": "AWS::Config::ConfigurationAggregator",
            "Condition": "CreateAggregator",
            "Properties": <span>{</span>
                "Name": "name",
                "AccountAggregationSources": [
                    <span>{</span>
                        "AccountIds": <span>{</span>
                            "Ref": "SourceAccounts"
                        },
                        "AwsRegions": <span>{</span>
                            "Ref": "SourceRegions"
                        }
                    }
                ]
            }
        },
        "AggregationAuthorization": <span>{</span>
            "Type": "AWS::Config::AggregationAuthorization",
            "Condition": "CreateAuthorization",
            "Properties": <span>{</span>
                "AuthorizedAccountId": <span>{</span>
                    "Ref": "AggregatorAccount"
                },
                "AuthorizedAwsRegion": <span>{</span>
                    "Ref": "AggregatorRegion"
                }
            }
        }
    }
}</code></pre></div><div id="YAML" name="YAML" class="section langfilter"><h4 id="aws-resource-config-aggregationauthorization--examples--Aggregation_Authorization--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWSTemplateFormatVersion: 2010-09-09
Description: Enable Config

Metadata:
  AWS::CloudFormation::Interface:
    ParameterGroups:
      - Label:
          default: Configuration Recorder Configuration
        Parameters:
          - GlobalResourceTypesRegion
      - Label:
          default: Configuration Aggregator Configuration
        Parameters:
          - AggregatorAccount
          - AggregatorRegion
          - SourceAccounts
          - SourceRegions
    ParameterLabels:
      GlobalResourceTypesRegion:
        default: Global resource types region
      AggregatorAccount:
        default: Aggregator account
      AggregatorRegion:
        default: Aggregator region
      SourceAccounts:
        default: Source accounts
      SourceRegions:
        default: Source regions

Parameters:
  GlobalResourceTypesRegion:
    Type: String
    Default: us-east-1
    Description: AWS region used to record global resources types
  AggregatorAccount:
    Type: String
    Description: Account ID of the aggregator
  AggregatorRegion:
    Type: String
    Default: us-east-1
    Description: AWS region of the aggregator
  SourceAccounts:
    Type: CommaDelimitedList
    Description: List of source accounts to aggregate
  SourceRegions:
    Type: CommaDelimitedList
    Description: List of regions to aggregate

Conditions:
  IncludeGlobalResourceTypes: !Equals
    - !Ref GlobalResourceTypesRegion
    - !Ref AWS::Region
  CreateAggregator: !And
    - !Equals
      - !Ref AggregatorAccount
      - !Ref AWS::AccountId
    - !Equals
      - !Ref AggregatorRegion
      - !Ref AWS::Region
  CreateAuthorization: !Not
    - !Equals
      - !Ref AggregatorAccount
      - !Ref AWS::AccountId

Resources:

  ConfigBucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket

  ConfigBucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: !Ref ConfigBucket
      PolicyDocument:
        Version: 2012-10-17
        Statement:
          - Sid: AWSConfigBucketPermissionsCheck
            Effect: Allow
            Principal:
              Service:
                - config.amazonaws.com
            Action: s3:GetBucketAcl
            Resource:
              - !Sub "arn:aws:s3:::$<span>{</span>ConfigBucket}"
          - Sid: AWSConfigBucketDelivery
            Effect: Allow
            Principal:
              Service:
                - config.amazonaws.com
            Action: s3:PutObject
            Resource:
              - !Sub "arn:aws:s3:::$<span>{</span>ConfigBucket}/AWSLogs/$<span>{</span>AWS::AccountId}/*"

  ConfigRecorderRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement:
          - Effect: Allow
            Principal:
              Service:
                - config.amazonaws.com
            Action:
              - sts:AssumeRole
      Path: /
      ManagedPolicyArns:
        - arn:aws:iam::aws:policy/service-role/AWSConfigRole

  ConfigRecorder:
    Type: AWS::Config::ConfigurationRecorder
    DependsOn:
      - ConfigRecorderRole
      - ConfigBucketPolicy
    Properties:
      RoleARN: !GetAtt ConfigRecorderRole.Arn
      RecordingGroup:
        AllSupported: True
        IncludeGlobalResourceTypes: !If
          - IncludeGlobalResourceTypes
          - True
          - False

  DeliveryChannel:
    Type: AWS::Config::DeliveryChannel
    DependsOn:
      - ConfigBucketPolicy
    Properties:
      Name: default
      S3BucketName: !Ref ConfigBucket

  S3BucketPublicReadRule:
    Type: AWS::Config::ConfigRule
    DependsOn:
      - ConfigRecorder
    Properties:
      ConfigRuleName: stackset-s3-bucket-public-read-prohibited
      Description: s3-bucket-public-read-prohibited from stackset
      Scope:
        ComplianceResourceTypes:
          - AWS::S3::Bucket
      Source:
        Owner: AWS
        SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED

  ConfigAggregator:
    Type: AWS::Config::ConfigurationAggregator
    Condition: CreateAggregator
    Properties:
    ConfigurationAggregatorName: name
      AccountAggregationSources:
        - AccountIds: !Ref SourceAccounts
          AwsRegions: !Ref SourceRegions

  AggregationAuthorization:
    Type: AWS::Config::AggregationAuthorization
    Condition: CreateAuthorization
    Properties:
      AuthorizedAccountId: !Ref AggregatorAccount
      AuthorizedAwsRegion: !Ref AggregatorRegion</code></pre></div><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./AWS_Config.html">AWS Config</div><div id="next" class="next-link" accesskey="n" href="./aws-properties-config-aggregationauthorization-tag.html">Tag</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS Config&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS Config&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-config-aggregationauthorization.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>