<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="es-ES"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Plan de consulta - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="c-the-query-plan" /><meta name="default_state" content="c-the-query-plan" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-the-query-plan.html" /><meta name="description" content="Describe cómo interpretar un plan de consulta." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guía para desarrolladores de bases de datos" /><meta name="abstract" content="Cree y administre un almacenamiento de datos con Amazon Redshift, un servicio de almacenamiento de datos completamente administrado a escala de petabytes de nivel empresarial." /><meta name="guide-locale" content="es_es" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-the-query-plan.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c-the-query-plan.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c-the-query-plan.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c-the-query-plan.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c-the-query-plan.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-the-query-plan.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-the-query-plan.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-the-query-plan.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-the-query-plan.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-the-query-plan.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-the-query-plan.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-the-query-plan.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-the-query-plan.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c-the-query-plan.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c-the-query-plan.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c-the-query-plan.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c-the-query-plan.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-the-query-plan.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-the-query-plan.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/c-the-query-plan.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/c-the-query-plan.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-the-query-plan.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guía para desarrolladores de bases de datos" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guía para desarrolladores de bases de datos" /><meta id="panorama-serviceConsolePage" value="Plan de consulta" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Plan de consulta - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#c-the-query-plan" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-the-query-plan.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-the-query-plan.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-the-query-plan.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,Clúster,almacenamiento de datos,desarrollador,datos de ejemplo,base de datos,desarrollador de base de datos,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guía para desarrolladores de bases de datos",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "‎‎‎‎Ajuste del rendimiento de las consul‎tas‎",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-optimizing-query-performance.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Procesamiento de consultas",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-query-processing.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Plan de consulta",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-query-processing.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#c-the-query-plan" target="_blank" rel="noopener noreferrer" title="Abrir PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentación</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guía para desarrolladores de bases de datos</a></div><div id="page-toc-src"><a href="#EXPLAIN-operators">Operadores EXPLAIN</a><a href="#joins-in-EXPLAIN">Combinaciones con EXPLAIN</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="c-the-query-plan">Plan de consulta</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Puede utilizar el plan de consulta para obtener información sobre las operaciones individuales necesarias para ejecutar una consulta. Antes de trabajar con un plan de consulta, le recomendamos que primero comprenda cómo Amazon Redshift administra el procesamiento de las consultas y la creación de planes de consultas. Para obtener más información, consulte <a href="./c-query-planning.html">Flujo de trabajo de planificación y ejecución de consultas</a>.</p><p>Para crear un plan de consulta, ejecute el comando <a href="./r_EXPLAIN.html">EXPLAIN</a> seguido del texto real de la consulta. En el plan de consulta, se proporciona la siguiente información:</p><div class="itemizedlist">
             
             
             
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>Las operaciones que realizará el motor de ejecución, leyendo los resultados de abajo arriba.</p>
            </li><li class="listitem">
               <p>El tipo de paso que realiza cada operación.</p>
            </li><li class="listitem">
               <p>Las tablas y las columnas que se utilizan en cada operación.</p>
            </li><li class="listitem">
               <p>La cantidad de datos que se procesa en cada operación, en cuanto a la cantidad de filas y al ancho de datos en bytes.</p>
            </li><li class="listitem">
               <p>El costo relativo de la operación. El <em>costo</em> es una medida que compara los tiempos relativos de ejecución de los pasos de un plan. El costo no proporciona información precisa acerca de los tiempo de ejecución reales ni sobre el consumo de memoria, como tampoco proporciona una comparación significativa entre los planes de ejecución. El costo le da una idea de cuáles son las operaciones de una consulta que están consumiendo la mayor cantidad de recursos.</p>
            </li></ul></div><p>El comando EXPLAIN no ejecuta propiamente la consulta. Solo muestra el plan que ejecuta Amazon Redshift si la consulta se lleva a cabo en las condiciones operativas actuales. Si cambia el esquema o los datos de una tabla y ejecuta nuevamente el comando <a href="./r_ANALYZE.html">ANALYZE</a> para actualizar los metadatos estadísticos, el plan de consulta podría ser diferente.</p><p>La salida del plan de consulta que genera el comando EXPLAIN es una vista general simplificada de la ejecución de consultas. No muestra los detalles del procesamiento en paralelo de las consultas. Para ver información detallada, ejecute la consulta en cuestión y, luego, obtenga información resumida de la consulta desde la vista SVL_QUERY_SUMMARY o SVL_QUERY_REPORT. Para obtener más información acerca de cómo usar estas vistas, consulte <a href="./c-analyzing-the-query-summary.html">Análisis del resumen de consultas</a>.</p><p>En el siguiente ejemplo, se muestra una salida del comando EXPLAIN para una consulta simple GROUP BY sobre la tabla EVENT:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">explain select eventname, count(*) from event group by eventname;

                            QUERY PLAN
-------------------------------------------------------------------
XN HashAggregate  (cost=131.97..133.41 rows=576 width=17)
  -&gt;  XN Seq Scan on event  (cost=0.00..87.98 rows=8798 width=17)</code></pre><p>EXPLAIN devuelve las siguientes métricas para cada operación:</p><div class="variablelist">
             
             
             
         <dl>
               <dt><b><span class="term">Coste</span></b></dt>
               <dd>
                  <p>Un valor relativo que es útil para comparar operaciones dentro de un plan. El costo se compone de dos valores decimales separados por dos puntos, por ejemplo <code class="code">cost=131.97..133.41</code>. El primer valor, en este caso 131.97, proporciona el costo relativo del retorno de la primera fila de esta operación. El segundo valor, en este caso 133.41, proporciona el costo relativo de completar la operación. Los costos del plan de consulta se van acumulando a medida que estudia el plan, por lo que el costo HashAggregate de este ejemplo (131.97..133.41) incluye el costo del examen secuencial que está debajo (0.00..87.98).</p>
               </dd>
            
               <dt><b><span class="term">Filas</span></b></dt>
               <dd>
                  <p>La cantidad estimada de filas que se devuelven. En este ejemplo, se espera que el examen devuelva 8798 filas. Se espera que el operador HashAggregate por sí solo devuelva 576 filas (después de descartar los nombres de eventos duplicados del conjunto de resultados).</p>
                  <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>El cálculo de filas se basa en las estadísticas disponibles que genera el comando ANALYZE. Si ANALYZE no se ejecutó recientemente, el cálculo será menos fiable.</p></div></div>
               </dd>
            
               <dt><b><span class="term">Ancho</span></b></dt>
               <dd>
                  <p>El ancho estimado de la fila promedio, medido en bytes. En este ejemplo, se espera que la fila promedio sea de 17 bytes de ancho.</p>
               </dd>
            </dl></div><h2 id="EXPLAIN-operators">Operadores EXPLAIN</h2>
            
            <p>En esta sección, se describen brevemente los operadores que ven con mayor frecuencia en la salida del comando EXPLAIN. Para obtener una lista completa de los operadores, consulte <a href="./r_EXPLAIN.html">EXPLAIN</a> en la sección sobre comandos SQL.</p>
            <h3 id="scan-operator">Operador de examen secuencial</h3>
               
               <p>El operador de examen secuencial (Seq Scan) indica el examen de una tabla. Seq Scan examina cada columna de la tabla de manera secuencial, de principio a fin, y evalúa las restricciones de la consulta (en la cláusula WHERE) para cada una de las filas.</p>
             
            <h3 id="join-operators">Operadores de combinación</h3>
               
               <p>Amazon Redshift selecciona los operadores de combinación en función del diseño físico de las tablas que se combinarán, la ubicación de los datos que se necesitan para la combinación y los requisitos específicos de la propia consulta.</p>
               <div class="itemizedlist">
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><span class="topcom">Bucle anidado</span></p>
                     <p>La combinación menos óptima es el bucle anidado, que se utiliza principalmente para las combinaciones cruzadas (productos cartesianos) y para algunas combinaciones de desigualdades.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Operadores hash join y hash</span></p>
                     <p>Se utilizan los operadores hash join y hash, por lo general más rápidos que la combinación de bucle anidado, para las combinaciones internas y las combinaciones externas izquierda y derecha. Estos operadores se utilizan para combinar tablas en las que las columnas de combinación no son claves de distribución <em>ni</em> claves de ordenación al mismo tiempo. El operador hash crea una tabla hash para la tabla interna de la combinación; el operador hash join lee la tabla exterior, aplica la función hash a la columna de combinación y encuentra coincidencias en la tabla hash interna.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Merge Join</span></p>
                     <p>Se utiliza el operador merge join, que, por lo general, es el operador más rápido, para las combinaciones internas y externas. Merge join no se utiliza para las combinaciones totales. Este operador se utiliza para combinar tablas en las que las columnas de combinación son claves de distribución <em>y</em> claves de ordenación al mismo tiempo, y cuando menos del 20 por ciento de las tablas de combinación está desordenado. Lee dos tablas ordenadas en orden y encuentra las filas que coinciden. Para ver el porcentaje de filas desordenadas, consulta la tabla de sistema <a href="./r_SVV_TABLE_INFO.html">SVV_TABLE_INFO</a>.</p>
                  </li><li class="listitem"> 
                     <p><span class="topcom">Unión espacial</span></p>
                     <p>Suele ser una unión rápida basada en la proximidad de los datos espaciales, que se utiliza para los tipos de datos <code class="code">GEOMETRY</code> y <code class="code">GEOGRAPHY</code>.</p>
                  </li></ul></div>
             
            <h3 id="aggregate-operators">Operadores de agregación</h3>
               
               <p>El plan de consulta utiliza los siguientes operadores en las consultas que implican funciones de agregación y operaciones GROUP BY.</p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><span class="topcom">Aggregate</span></p>
                     <p>Operador para las funciones de agregación escalar, como AVG y SUM.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">HashAggregate</span></p>
                     <p>Operador para las funciones de agregación agrupadas desordenadas.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">GroupAggregate</span></p>
                     <p>Operador para las funciones de agregación agrupadas ordenadas.</p>
                  </li></ul></div>
             
            <h3 id="sort-operators">Operadores de ordenación</h3>
               
               <p>El plan de consulta utiliza los siguientes operadores cuando las consultas tienen que ordenar o fusionar conjuntos de resultados.</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><span class="topcom">Sort</span></p>
                     <p>Evalúa la cláusula ORDER BY y otras operaciones de ordenación, como las que se necesitan en las consultas y combinaciones UNION, en las consultas SELECT DISTINCT y en las funciones de ventana.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Merge</span></p>
                     <p>Produce resultados ordenados finales conforme a los resultados intermedios ordenados que se derivan de las operaciones en paralelo.</p>
                  </li></ul></div>
             
            <h3 id="UNION-INTERSECT-and-EXCEPT-operators">Operadores UNION, INTERSECT y EXCEPT</h3>
               
               <p>El plan de consulta utiliza los siguientes operadores en las consultas que implican operaciones de conjunto con los operadores UNION, INTERSECT y EXCEPT.</p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><span class="topcom">Operador subquery</span></p>
                     <p>Se utiliza para ejecutar consultas UNION.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Hash Intersect Distinct </span></p>
                     <p>Se utiliza para ejecutar consultas INTERSECT .</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Operador SetOp Except</span></p>
                     <p>Se utiliza para ejecutar consultas EXCEPT (o MINUS).</p>
                  </li></ul></div>
             
            <h3 id="other-operators">Otros operadores</h3>
               
               <p>Los siguientes operadores también aparecen con frecuencia en la salida EXPLAIN para las consultas rutinarias.</p>
               <div class="itemizedlist">
                   
                   
                   
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><span class="topcom">Unique</span></p>
                     <p>Elimina los duplicados de las consultas SELECT DISTINCT y UNION.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Límite</span></p>
                     <p>Procesa la cláusula LIMIT.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Window</span></p>
                     <p>Ejecuta las funciones de ventana.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Resultado</span></p>
                     <p>Ejecuta las funciones escalares que no implican obtener acceso a ninguna tabla.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Subplan</span></p>
                     <p>Se utiliza para algunas subconsultas.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Red</span></p>
                     <p>Envía los resultados intermedios al nodo principal para seguir trabajando con ellos.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Materialize</span></p>
                     <p>Guarda las filas para entradas de combinaciones de bucle anidado y en algunas de combinaciones de fusión.</p>
                  </li></ul></div>
             
         <h2 id="joins-in-EXPLAIN">Combinaciones con EXPLAIN</h2>
            
            <p>El optimizador de consultas utiliza diferentes tipos de combinaciones para recuperar datos de tablas, en función de la estructura de la consulta y de las tablas subyacentes. La salida EXPLAIN indica el tipo de combinación, las tablas utilizadas y la manera en la que se distribuyen los datos de la tabla en todo el clúster para describir cómo se procesa la consulta.</p>

            <h3 id="join-types">Ejemplos de tipos de combinación</h3>
               
               <p>En los siguientes ejemplos, se muestran los distintos tipos de combinación que puede utilizar el optimizador de consultas. El tipo de combinación que se utiliza en el plan de consulta depende del diseño físico de las tablas implicadas.</p>
               <h4 id="hash-join-two-tables">Ejemplo: Combinación de dos tablas mediante el operador hash</h4>
                  
                  <p>La siguiente consulta combina EVENT y CATEGORY en la columna CATID. CATID es la clave de distribución y ordenación para CATEGORY, pero no para EVENT. Se realiza una combinación hash con EVENT como la tabla externa y CATEGORY como la tabla interna. Como CATEGORY es la tabla más pequeña, el planificador difunde una copia de esta en los nodos de computación durante el procesamiento de la consulta mediante el comando DS_BCAST_INNER. El costo de combinación en este ejemplo contempla la mayor parte del costo acumulado del plan.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">explain select * from category, event where category.catid=event.catid;

                               QUERY PLAN
-------------------------------------------------------------------------
 XN Hash Join DS_BCAST_INNER  (cost=0.14..6600286.07 rows=8798 width=84)
   Hash Cond: ("outer".catid = "inner".catid)
   -&gt;  XN Seq Scan on event  (cost=0.00..87.98 rows=8798 width=35)
   -&gt;  XN Hash  (cost=0.11..0.11 rows=11 width=49)
         -&gt;  XN Seq Scan on category  (cost=0.00..0.11 rows=11 width=49)</code></pre>
                  <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Las sangrías alineadas de los operadores en la salida EXPLAIN, a menudo, indican que esas operaciones no dependen unas de otras y que pueden comenzar en paralelo. En el ejemplo anterior, si bien el examen de la tabla EVENT y la operación hash están alineados, el examen EVENT debe esperar hasta que la operación hash haya terminado por completo.</p></div></div>
                
               <h4 id="merge-join-two-tables">Ejemplo: Combinación de dos tablas mediante el operador merge</h4>
                  
                  <p>La siguiente consulta también usa el operador SELECT*, pero combina SALES y LISTING en la columna LISTID, donde LISTID está configurada como la clave de distribución y de ordenación para ambas tablas. Se elige una combinación de fusión y no se necesita redistribuir datos para la combinación (DS_DIST_NONE).</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">explain select * from sales, listing where sales.listid = listing.listid;
QUERY PLAN
-----------------------------------------------------------------------------
XN Merge Join DS_DIST_NONE  (cost=0.00..6285.93 rows=172456 width=97)
  Merge Cond: ("outer".listid = "inner".listid)
  -&gt;  XN Seq Scan on listing  (cost=0.00..1924.97 rows=192497 width=44)
  -&gt;  XN Seq Scan on sales  (cost=0.00..1724.56 rows=172456 width=53)</code></pre>
                  <p>En el siguiente ejemplo, se demuestran los distintos tipos de combinación dentro de la misma consulta. Como en el ejemplo anterior, SALES y LISTING están combinadas por fusión, pero la tercera tabla, EVENT, debe estar combinada por hash con los resultados de la combinación de fusión. Una vez más, la combinación hash implica un costo de difusión.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">explain select * from sales, listing, event
where sales.listid = listing.listid and sales.eventid = event.eventid;
                                  QUERY PLAN
----------------------------------------------------------------------------
XN Hash Join DS_BCAST_INNER  (cost=109.98..3871130276.17 rows=172456 width=132)
  Hash Cond: ("outer".eventid = "inner".eventid)
  -&gt;  XN Merge Join DS_DIST_NONE  (cost=0.00..6285.93 rows=172456 width=97)
        Merge Cond: ("outer".listid = "inner".listid)
        -&gt;  XN Seq Scan on listing  (cost=0.00..1924.97 rows=192497 width=44)
        -&gt;  XN Seq Scan on sales  (cost=0.00..1724.56 rows=172456 width=53)
  -&gt;  XN Hash  (cost=87.98..87.98 rows=8798 width=35)
        -&gt;  XN Seq Scan on event  (cost=0.00..87.98 rows=8798 width=35)</code></pre>
                
               <h4 id="join-aggregate-and-sort-example">Ejemplo: Operadores join, aggregate y sort</h4>
                  
                  <p>La siguiente consulta ejecuta una unión hash de las tablas SALES y EVENT, seguida de las operaciones de agregación y ordenación para justificar la función agrupada SUM y la cláusula ORDER BY. El operador inicial sort se ejecuta en paralelo en los nodos de computación. Luego, el operador network envía los resultados al nodo principal, donde el operador merge produce resultados finales ordenados.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">explain select eventname, sum(pricepaid) from sales, event 
where sales.eventid=event.eventid group by eventname
order by 2 desc;
                                           QUERY PLAN
---------------------------------------------------------------------------------
 XN Merge  (cost=1002815366604.92..1002815366606.36 rows=576 width=27)
  Merge Key: sum(sales.pricepaid)
  -&gt;  XN Network  (cost=1002815366604.92..1002815366606.36 rows=576 width=27)
        Send to leader
        -&gt;  XN Sort  (cost=1002815366604.92..1002815366606.36 rows=576 width=27)
              Sort Key: sum(sales.pricepaid)
              -&gt;  XN HashAggregate  (cost=2815366577.07..2815366578.51 rows=576 width=27)
                    -&gt;  XN Hash Join DS_BCAST_INNER  (cost=109.98..2815365714.80 rows=172456 width=27)
                          Hash Cond: ("outer".eventid = "inner".eventid)
                          -&gt;  XN Seq Scan on sales  (cost=0.00..1724.56 rows=172456 width=14)
                          -&gt;  XN Hash  (cost=87.98..87.98 rows=8798 width=21)
                                -&gt;  XN Seq Scan on event  (cost=0.00..87.98 rows=8798 width=21)</code></pre>
                
             
            <h3 id="data-redistribution">Redistribución de datos</h3>
               
               <p>La salida EXPLAIN para las combinaciones también especifica un método con el cual los datos se mueven en torno a un clúster para facilitar la combinación. Este movimiento de datos puede ser una difusión o bien una redistribución. En una difusión, los valores de los datos de un lado de la combinación se copian desde cada nodo de computación a los demás nodos de computación de manera que cada nodo de computación tenga una copia completa de los datos. En una redistribución, se envían los valores de los datos participantes desde el sector donde están hacia un nuevo sector (posiblemente en un nodo diferente). Los datos, por lo general, se redistribuyen para coincidir con la clave de distribución de la otra tabla participante de la combinación si esa clave de distribución es una de las columnas que se está combinando. Si ninguna de las tablas tiene claves de distribución en las columnas que se están combinando, se distribuyen ambas tablas, o bien se difunde la tabla interna en cada uno de los nodos.</p>
               <p>La salida EXPLAIN también hace referencia a las tablas internas y externas. Primero se examina la tabla interna; esta aparece cerca de la parte inferior del plan de consulta. La tabla interna es la tabla en la que se buscan coincidencias. Por lo general, se almacena en la memora y suele ser la tabla origen de algoritmos hash y, de ser posible, la tabla más pequeña de las dos que se están combinando. La tabla externa es el origen de las filas en las que se busca coincidencias con la tabla interna. Por lo general, se lee del disco. El optimizador de consultas selecciona la tabla interna y externa en función de las estadísticas de la base de datos extraídas de la última ejecución del comando ANALYZE. El orden de las tablas en la cláusula FROM de una consulta no determina cuál es la tabla interna y cuál es la externa.</p>
               <p>Utilice los siguientes atributos en los planes de consulta para identificar cómo se mueven los datos y, así, facilitar una consulta:</p>
               <div class="itemizedlist">
                   
                   
                   
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><span class="topcom">DS_BCAST_INNER</span></p>
                     <p>Se difunde una copia de toda la tabla interna a todos los nodos de computación.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">DS_DIST_ALL_NONE</span></p>
                     <p>No es necesario redistribuir, porque ya se distribuyó la tabla interna a cada nodo con el atributo DISTSTYLE ALL.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">DS_DIST_NONE</span></p>
                     <p>No se redistribuye ninguna tabla. Es posible que haya combinaciones colocadas porque se combinan los sectores correspondientes sin mover los datos entre los nodos.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">DS_DIST_INNER</span></p>
                     <p>Se redistribuye la tabla interna.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">DS_DIST_OUTER</span></p>
                     <p>Se redistribuye la tabla externa.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">DS_DIST_ALL_INNER</span></p>
                     <p>Se redistribuye toda la tabla interna a un único sector porque la tabla externa utiliza el atributo DISTSTYLE ALL.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">DS_DIST_BOTH</span></p>
                     <p>Ambas tablas se redistribuyen.</p>
                  </li></ul></div>
             
         <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Aviso" /> <strong>JavaScript está desactivado o no está disponible en su navegador.</strong></p><p>Para utilizar la documentación de AWS, debe estar habilitado JavaScript. Para obtener más información, consulte las páginas de ayuda de su navegador.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenciones del documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./c-query-planning.html">Flujo de trabajo de planificación y ejecución de consultas</div><div id="next" class="next-link" accesskey="n" href="./reviewing-query-plan-steps.html">Revisión de los pasos del plan de consulta</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">¿Le ha servido de ayuda esta página? - Sí</div><div class="content"><p>Gracias por hacernos saber que estamos haciendo un buen trabajo.</p><p>Si tiene un momento, díganos qué es lo que le ha gustado para que podamos seguir trabajando en esa línea.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Comentarios" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-the-query-plan.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">¿Le ha servido de ayuda esta página? - No</div><div class="content"><p>Gracias por informarnos de que debemos trabajar en esta página. Lamentamos haberle defraudado.</p><p>Si tiene un momento, díganos cómo podemos mejorar la documentación.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Comentarios" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-the-query-plan.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>