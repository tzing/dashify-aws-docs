<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="es-ES"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Mejora del rendimiento de las consultas en Amazon Redshift Spectrum - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="c-spectrum-external-performance" /><meta name="default_state" content="c-spectrum-external-performance" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-spectrum-external-performance.html" /><meta name="description" content="Observe el plan de consulta para saber qué pasos se han enviado a la capa de Amazon Redshift Spectrum." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guía para desarrolladores de bases de datos" /><meta name="abstract" content="Cree y administre un almacenamiento de datos con Amazon Redshift, un servicio de almacenamiento de datos completamente administrado a escala de petabytes de nivel empresarial." /><meta name="guide-locale" content="es_es" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-spectrum-external-performance.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-spectrum-external-performance.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guía para desarrolladores de bases de datos" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guía para desarrolladores de bases de datos" /><meta id="panorama-serviceConsolePage" value="Mejora del rendimiento de las consultas en Amazon Redshift Spectrum" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Mejora del rendimiento de las consultas en Amazon Redshift Spectrum - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#c-spectrum-external-performance" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-spectrum-external-performance.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-spectrum-external-performance.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-spectrum-external-performance.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,Clúster,almacenamiento de datos,desarrollador,datos de ejemplo,base de datos,desarrollador de base de datos,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guía para desarrolladores de bases de datos",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Consulta de datos externos mediante Amazon Redshift Spectrum",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-using-spectrum.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Mejora del rendimiento de las consultas en Amazon Redshift Spectrum",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-using-spectrum.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#c-spectrum-external-performance" target="_blank" rel="noopener noreferrer" title="Abrir PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentación</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guía para desarrolladores de bases de datos</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="c-spectrum-external-performance">Mejora del rendimiento de las consultas en Amazon Redshift Spectrum</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Observe el plan de consulta para saber qué pasos se han enviado a la capa de Amazon Redshift Spectrum. </p><p>Los siguientes pasos se relacionan con las consultas en Redshift Spectrum:</p><div class="itemizedlist">
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>S3 Seq Scan </p>
         </li><li class="listitem">
            <p>S3 HashAggregate </p>
         </li><li class="listitem">
            <p>S3 Query Scan</p>
         </li><li class="listitem">
            <p>Seq Scan PartitionInfo</p>
         </li><li class="listitem">
            <p>Partition Loop </p>
         </li></ul></div><p>En el siguiente ejemplo, se muestra el plan de consulta para una consulta que combina una tabla externa con una tabla local. Tenga en cuenta los pasos S3 Seq Scan y S3 HashAggregate que se ejecutaron sobre los datos en Amazon S3.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">explain
select top 10 spectrum.sales.eventid, sum(spectrum.sales.pricepaid) 
from spectrum.sales, event
where spectrum.sales.eventid = event.eventid
and spectrum.sales.pricepaid &gt; 30
group by spectrum.sales.eventid
order by 2 desc;</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
QUERY PLAN                                                                                                                                                                                
-----------------------------------------------------------------------------
XN Limit  (cost=1001055770628.63..1001055770628.65 rows=10 width=31)                                                                                                                      
  -&gt;  XN Merge  (cost=1001055770628.63..1001055770629.13 rows=200 width=31)                                                                                                               
        Merge Key: sum(sales.derived_col2)                                                                                                                                                
        -&gt;  XN Network  (cost=1001055770628.63..1001055770629.13 rows=200 width=31)                                                                                                       
              Send to leader                                                                                                                                                              
              -&gt;  XN Sort  (cost=1001055770628.63..1001055770629.13 rows=200 width=31)                                                                                                    
                    Sort Key: sum(sales.derived_col2)                                                                                                                                     
                    -&gt;  XN HashAggregate  (cost=1055770620.49..1055770620.99 rows=200 width=31)                                                                                           
                          -&gt;  XN Hash Join DS_BCAST_INNER  (cost=3119.97..1055769620.49 rows=200000 width=31)                                                                             
                                Hash Cond: ("outer".derived_col1 = "inner".eventid)                                                                                                       
                                -&gt;  XN S3 Query Scan sales  (cost=3010.00..5010.50 rows=200000 width=31)                                                                                  
                                      -&gt;  S3 HashAggregate  (cost=3010.00..3010.50 rows=200000 width=16)                                                                                  
                                            -&gt;  S3 Seq Scan spectrum.sales location:"s3://redshift-downloads/tickit/spectrum/sales" format:TEXT  (cost=0.00..2150.00 rows=172000 width=16)
                                                  Filter: (pricepaid &gt; 30.00)                                                                                                             
                                -&gt;  XN Hash  (cost=87.98..87.98 rows=8798 width=4)                                                                                                        
                                      -&gt;  XN Seq Scan on event  (cost=0.00..87.98 rows=8798 width=4)</code></pre><p>Tenga en cuenta los siguientes elementos en el plan de consulta:</p><div class="itemizedlist">
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>El nodo <code class="code">S3 Seq Scan</code> muestra que el filtro <code class="code">pricepaid &gt;
                  30.00</code> se procesó en la capa de Redshift Spectrum.</p>
            <p>Un nodo de filtro bajo el nodo <code class="code">XN S3 Query Scan</code> indica el procesamiento de predicados en Amazon Redshift sobre los datos devueltos desde la capa de Redshift Spectrum.</p>
         </li><li class="listitem">
            <p>El nodo <code class="code">S3 HashAggregate</code> indica agregación en la capa de Redshift Spectrum para el grupo por cláusula (<code class="code">group by
               spectrum.sales.eventid</code>).</p>
         </li></ul></div><p>A continuación, se muestran maneras de mejorar el rendimiento de Redshift Spectrum:</p><div class="itemizedlist">
          
          
          
          
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>Utilice archivos de datos con formato Apache Parquet. Parquet almacena datos en un formato de columnas, para que Redshift Spectrum pueda eliminar las columnas no necesarias para el examen. Cuando los datos están en formato de archivo de texto, Redshift Spectrum necesita examinar el archivo completo.</p>
         </li><li class="listitem"> 
            <p>Utilice distintos archivos para optimizar el procesamiento en paralelo. Asegúrese de que los archivos tienen un tamaño superior a 64 MB. Evite sesgos de tamaños de datos al mantener todos los archivos con, aproximadamente, el mismo tamaño. Para obtener información sobre los archivos de Apache Parquet y las recomendaciones de configuración, consulte <a href="https://parquet.apache.org/docs/file-format/configurations/" rel="noopener noreferrer" target="_blank"><span>File Format: Configurations</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> en la <em>Documentación de Apache Parquet</em>.</p>
         </li><li class="listitem">
            <p>Utilice la menor cantidad posible de columnas en las consultas.</p>
         </li><li class="listitem">
            <p>Guarde las tablas de hechos grandes en Amazon S3 y mantenga las tablas de dimensiones más pequeñas y de uso frecuente en la base de datos local de Amazon Redshift.</p>
         </li><li class="listitem">
            <p>Actualice las estadísticas de la tabla externa al configurar el parámetro numRows del comando TABLE PROPERTIES. Utilice <a href="./r_CREATE_EXTERNAL_TABLE.html">CREATE EXTERNAL TABLE</a> o <a href="./r_ALTER_TABLE.html">ALTER TABLE</a> para establecer el parámetro numRows de TABLE PROPERTIES de manera que refleje la cantidad de filas en la tabla. Amazon Redshift no analiza las tablas externas para generar las estadísticas de las tablas que el optimizador de consultas emplea a la hora de crear un plan de consulta. Si no se establecen las estadísticas de la tabla que corresponden a una tabla externa, Amazon Redshift crea un plan de ejecución de consultas. Amazon Redshift genera este plan a partir de la suposición de que las tablas externas son las más grandes, mientras que las tablas locales son las más pequeñas.</p>
         </li><li class="listitem">
            <p>El planificador de consultas de Amazon Redshift envía predicados y agrupaciones a la capa de consultas de Redshift Spectrum siempre que sea posible. Cuando se devuelven grandes cantidades de datos de Amazon S3, el procesamiento se ve limitado por los recursos del clúster. Redshift Spectrum escala automáticamente para procesar solicitudes grandes. Por lo tanto, el rendimiento general mejora siempre que pueda enviar el procesamiento a la capa de Redshift Spectrum. </p>
         </li><li class="listitem">
            <p>Escriba las consultas para utilizar filtros y agregaciones que sean legibles y que se puedan enviar a la capa de Redshift Spectrum.</p>
            <p>Los siguientes son ejemplos de algunas operaciones que se pueden enviar a la capa de Redshift Spectrum:</p>
            <div class="itemizedlist">
                
                
                

                
            <ul class="itemizedlist"><li class="listitem">
                  <p>cláusulas GROUP BY</p>
               </li><li class="listitem">
                  <p>Condiciones de comparación y condiciones de coincidencia de patrones, como LIKE.</p>
               </li><li class="listitem">
                  <p>Funciones de agregación, como COUNT, SUM, AVG, MIN y MAX.</p>
               </li><li class="listitem">
                  <p>Funciones de cadena.</p>
               </li></ul></div>
            <p>Entre las operaciones que no se pueden enviar a la capa de Redshift Spectrum se incluyen DISTINCT y ORDER BY.</p>
         </li><li class="listitem">
            <p>Use particiones para limitar los datos por examinar. Particione los datos según los predicados más frecuentes de las consultas y, luego, depure las particiones al filtrar las columnas de partición. Para obtener más información, consulte <a href="./c-spectrum-external-tables.html#c-spectrum-external-tables-partitioning">Partición de tablas externas de Redshift Spectrum</a>.</p>
            <p>Consulte <a href="./r_SVL_S3PARTITION.html">SVL_S3PARTITION</a> para ver las particiones totales y las particiones calificadas.</p>
         </li><li class="listitem">
            <p> Utilice el generador de estadísticas de AWS Glue para calcular las estadísticas en el nivel de columna para las tablas de AWS Glue Data Catalog. Una vez que AWS Glue genera las estadísticas para las tablas del catálogo de datos, Amazon Redshift Spectrum las utiliza automáticamente para optimizar el plan de consultas. Para obtener más información sobre la computación de estadísticas en el nivel de columna mediante AWS Glue, consulte <a href="https://docs.aws.amazon.com/glue/latest/dg/column-statistics.html">Trabajar con las estadísticas de las columnas</a> en la <em>Guía para desarrolladores de AWS Glue</em>. </p>
         </li></ul></div><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Aviso" /> <strong>JavaScript está desactivado o no está disponible en su navegador.</strong></p><p>Para utilizar la documentación de AWS, debe estar habilitado JavaScript. Para obtener más información, consulte las páginas de ayuda de su navegador.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenciones del documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./querying-iceberg-supported-data-types.html">Tipos de datos  admitidos</div><div id="next" class="next-link" accesskey="n" href="./t_setting-data-handling-options.html">Configuración de opciones de control de datos</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">¿Le ha servido de ayuda esta página? - Sí</div><div class="content"><p>Gracias por hacernos saber que estamos haciendo un buen trabajo.</p><p>Si tiene un momento, díganos qué es lo que le ha gustado para que podamos seguir trabajando en esa línea.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Comentarios" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-spectrum-external-performance.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">¿Le ha servido de ayuda esta página? - No</div><div class="content"><p>Gracias por informarnos de que debemos trabajar en esta página. Lamentamos haberle defraudado.</p><p>Si tiene un momento, díganos cómo podemos mejorar la documentación.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Comentarios" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-spectrum-external-performance.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>