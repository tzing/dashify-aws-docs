<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="es-ES"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CREATE PROCEDURE - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_CREATE_PROCEDURE" /><meta name="default_state" content="r_CREATE_PROCEDURE" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><meta name="description" content="Crea un procedimiento almacenado nuevo o sustituye un procedimiento existente para la actual base de datos." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guía para desarrolladores de bases de datos" /><meta name="abstract" content="Cree y administre un almacenamiento de datos con Amazon Redshift, un servicio de almacenamiento de datos completamente administrado a escala de petabytes de nivel empresarial." /><meta name="guide-locale" content="es_es" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guía para desarrolladores de bases de datos" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guía para desarrolladores de bases de datos" /><meta id="panorama-serviceConsolePage" value="CREATE PROCEDURE" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>CREATE PROCEDURE - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_CREATE_PROCEDURE" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,Clúster,almacenamiento de datos,desarrollador,datos de ejemplo,base de datos,desarrollador de base de datos,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guía para desarrolladores de bases de datos",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Referencia de SQL",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Comandos SQL",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "CREATE PROCEDURE",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg/c_SQL_commands.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_CREATE_PROCEDURE" target="_blank" rel="noopener noreferrer" title="Abrir PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentación</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guía para desarrolladores de bases de datos</a></div><div id="page-toc-src"><a href="#r_CREATE_PROCEDURE-privileges">Privilegios necesarios</a><a href="#r_CREATE_PROCEDURE-synopsis">Sintaxis</a><a href="#r_CREATE_PROCEDURE-parameters">Parámetros</a><a href="#r_CREATE_PROCEDURE-usage">Notas de uso</a><a href="#r_CREATE_PROCEDURE-examples">Ejemplos</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="r_CREATE_PROCEDURE">CREATE PROCEDURE</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Crea un procedimiento almacenado nuevo o sustituye un procedimiento existente para la actual base de datos.</p><p>Para obtener más información y ejemplos, consulte <a href="./stored-procedure-overview.html">Creación de procedimientos almacenados en Amazon Redshift</a>.</p>
         <h2 id="r_CREATE_PROCEDURE-privileges">Privilegios necesarios</h2>
         <p>Los siguientes privilegios son necesarios para CREATE PROCEDURE:</p>
         <div class="itemizedlist">
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>Para CREATE PROCEDURE:</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p>Superusuario</p>
                  </li><li class="listitem">
                     <p>Usuarios con el privilegio CREATE [ OR REPLACE ] PROCEDURE</p>
                  </li></ul></div>
            </li><li class="listitem">
               <p>Para REPLACE PROCEDURE:</p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p>Superusuario</p>
                  </li><li class="listitem">
                     <p>Usuarios con el privilegio CREATE [ OR REPLACE ] PROCEDURE</p>
                  </li><li class="listitem">
                     <p>Propietario del procedimiento</p>
                  </li></ul></div>
            </li></ul></div>
       
         <h2 id="r_CREATE_PROCEDURE-synopsis">Sintaxis</h2>

         
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">CREATE [ OR REPLACE ] PROCEDURE sp_procedure_name  
  ( [ [ argname ] [ argmode ] argtype [, ...] ] )
[ NONATOMIC ]
AS $$
  procedure_body
$$ LANGUAGE plpgsql
[ <span>{</span> SECURITY INVOKER | SECURITY DEFINER } ]
[ SET configuration_parameter <span>{</span> TO value | = value } ]
</code></pre>
       
         <h2 id="r_CREATE_PROCEDURE-parameters">Parámetros</h2>
         <div class="variablelist">
             
             
             
             
             
             
             
             
             
         <dl>
               <dt><span class="term"> OR REPLACE </span></dt>
               <dd>
                  <p>Una cláusula que especifica que si ya existe un procedimiento con el mismo nombre y los mismos tipos de datos de argumento de entrada o firma que este, debe reemplazarse el procedimiento existente. Solo puede reemplazar un procedimiento por un nuevo procedimiento que defina un conjunto idéntico de tipos de datos. Debe ser un superusuario para reemplazar un procedimiento.</p>
                  <p>Si define un procedimiento con el mismo nombre que un procedimiento existente, pero con una firma diferente, creará un nuevo procedimiento. En otras palabras, se sobrecarga el nombre del procedimiento. Para obtener más información, consulte <a href="./stored-procedure-naming.html#stored-procedure-overloading-name">Sobrecarga de nombres de procedimientos</a>. </p>
               </dd>
             
               <dt><span class="term"> <em>sp_procedure_name</em> </span></dt>
               <dd>
                  <p>El nombre del procedimiento. Si especifica un nombre de esquema (como <code class="userinput">myschema.myprocedure</code>), se crea el procedimiento en el esquema especificado. De lo contrario, el procedimiento se crea en el esquema actual. Para obtener más información acerca de los nombres válidos, consulte <a href="./r_names.html">Nombres e identificadores</a>. </p>
                  <p>Se recomienda que agregue el prefijo <code class="code">sp_</code> a todos los nombres de procedimientos almacenados. Amazon Redshift reserva el prefijo <code class="code">sp_</code> para los nombres de procedimientos almacenados. Con el uso del prefijo <code class="code">sp_</code>, se asegura de que el nombre del procedimiento almacenado no entre en conflicto con el nombre de una función o un procedimiento almacenado integrado de Amazon Redshift existente o futuro. Para obtener más información, consulte <a href="./stored-procedure-naming.html">Nomenclatura de los procedimientos almacenados</a>.</p>
                  <p>Puede definir más de un procedimiento con el mismo nombre si los tipos de datos para los argumentos de entrada, o firmas, son diferentes. En otras palabras, en este caso se sobrecarga el nombre del procedimiento. Para obtener más información, consulte <a href="./stored-procedure-naming.html#stored-procedure-overloading-name">Sobrecarga de nombres de procedimientos</a></p>
               </dd>
             
               <dt><span class="term"><em>[argname] [ argmode] argtype</em> </span></dt>
               <dd>
                  <p>Una lista de nombres de argumento, modos de argumento y tipos de datos. Solo se necesita el tipo de datos. El nombre y el modo son opcionales y es posible cambiar su posición.</p>
                  <p>El modo del argumento puede ser IN, OUT O INOUT. El valor predeterminado es IN.</p>
                  <p>Puede utilizar argumentos OU e INOUT para devolver uno o más valores de una llamada de procedimientos. Cuando hay argumentos o INOUT, la llamada de procedimientos devuelve una fila de resultados que contiene <em>n</em> columnas, done <em>n</em> es el número total de argumentos OUT o INOUT.</p>
                  <p>Los argumentos INOUT son argumentos de entrada y salida al mismo tiempo. Los <em>argumentos de entrada</em> incluyen argumentos IN e INOUT, y los <em>argumentos de salida </em> incluyen argumentos OUT e INOUT.</p>
                  
                  <p>Los argumentos OUT no se especifican como parte de la instrucción CALL. Especifique argumentos INOUT en la declaración CALL de procedimientos almacenada. Los argumentos INOUT pueden ser útiles al pasar y devolver valores de una llamada anidada y también al devolver un <code class="code">refcursor</code>. Para obtener más información sobre los tipos <code class="code">refcursor</code>, consulte <a href="./c_PLpgSQL-statements.html#r_PLpgSQL-cursors">Cursores</a>.</p>
                  <p>Los tipos de datos de argumentos pueden ser cualquier tipo de datos estándar de Amazon Redshift. Además, un tipo de datos de argumentos puede ser <code class="code">refcursor</code>.</p>
                  <p>Puede especificar un máximo de 32 argumentos de entrada y 32 argumentos de salida. </p>
               </dd>
             
               <dt><span class="term">AS $$ <em>procedure_body</em> $$ </span></dt>
               <dd>
                  <p>Se trata de una construcción que contiene el procedimiento que se ejecutará. Las palabras claves literales $$ y $$ son obligatorias.</p>
                  <p>Amazon Redshift exige que se incluya la instrucción en el procedimiento mediante un formato llamado entrecomillado con símbolo de dólar. Cualquier elemento que se encuentre dentro de los signos se transmite exactamente como es. No necesita incluir en una secuencia de escape los caracteres especiales porque el contenido de la cadena se escribe literalmente.</p>
                  <p>Con el <em>entrecomillado de dólar, </em>se utilizan un par de signos de dólar ($$) para representar el inicio y el final de la instrucción que se va a ejecutar, tal y como se muestra en el siguiente ejemplo.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">$$ my statement $$</code></pre>
                  <p>De manera opcional, entre los signos de dólar de cada par, puede especificar una cadena para ayudar a identificar la instrucción. La cadena que usa debe ser la misma en el inicio y en el final de los pares de signos. La cadena distingue entre mayúsculas y minúsculas, y sigue las mismas restricciones que un identificador sin comillas, excepto que no puede contener signos de dólar. En el siguiente ejemplo, se usa la prueba de cadena.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">$test$ my statement $test$</code></pre>
                  <p>Esta sintaxis también es útil para el entrecomillado de dólar anidado. Para obtener más información acerca de los signos de dólar, consulte"Dollar-quoted String Constants" bajo <a href="https://www.postgresql.org/docs/9.0/sql-syntax-lexical.html" rel="noopener noreferrer" target="_blank"><span>Lexical Structure</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> en la documentación de PostgreSQL.</p>
               </dd>
             
               <dt><span class="term"> <em>procedure_body</em> </span></dt>
               <dd>
                  <p>Un conjunto de instrucciones PL/pgSQL válidas. Las instrucciones PL/pgSQL aumentan los comandos SQL con construcciones de procedimiento, entre las que se incluyen expresiones condicionales y bucles, para controlar el flujo lógico. Se pueden usar la mayoría de los comandos SQL en el cuerpo del procedimiento, incluidos lenguajes de modificación de datos (DML) como COPY, UNLOAD e INSERT y lenguajes de definición de datos (DDL) como CREATE TABLE. Para obtener más información, consulte <a href="./c_pl_pgSQL_reference.html">Referencia del lenguaje PL/pgSQL</a>. </p>
               </dd>
             
               <dt><span class="term">LANGUAGE <em>plpgsql</em></span></dt>
               <dd>
                  <p>Un valor del lenguaje. Especifique <code class="code">plpgsql</code>. Debe tener permiso para usar el lenguaje para utilizar <code class="code">plpgsql</code>. Para obtener más información, consulte <a href="./r_GRANT.html">GRANT</a>. </p>
               </dd>
             
                            
               <dt><span class="term">NONATOMIC</span></dt>
               <dd>
                  
                  <p>Crea el procedimiento almacenado en un modo de transacción no atómico. El modo NONATOMIC confirma automáticamente las instrucciones que incluye el procedimiento. Además, cuando se produce un error en el procedimiento NONATOMIC, el error no se vuelve a generar si se gestiona mediante un bloque de excepciones. Para más información, consulte <a href="./stored-procedure-transaction-management.html">Administración de transacciones</a> y <a href="./c_PLpgSQL-statements.html#r_PLpgSQL-messages-errors">RAISE</a>.</p>
                  <p>Cuando defina un procedimiento almacenado como <code class="code">NONATOMIC</code>, tenga en cuenta lo siguiente:</p>
                  <div class="itemizedlist">
                      
                      
                     
                      
                     
                  <ul class="itemizedlist"><li class="listitem"><p>Cuando anide llamadas a procedimientos almacenados, todos deben crearse en el mismo modo de transacción.</p></li><li class="listitem"><p>Las opciones <code class="code">SECURITY DEFINER</code> y <code class="code">SET configuration_parameter</code> no se admiten cuando se crea un procedimiento en modo NONATOMIC.</p></li><li class="listitem"><p>Cualquier cursor que esté abierto (explícita o implícitamente) se cierra automáticamente cuando se procesa una confirmación implícita. Por lo tanto, debe abrir una transacción explícita antes de iniciar un bucle de cursor para asegurarse de que ninguna instrucción SQL en la iteración del bucle se confirme de forma implícita.</p></li></ul></div>
               </dd>
               
             
               <dt><span class="term">SECURITY INVOKER | SECURITY DEFINER</span></dt>
               <dd>
                  <p>La opción <code class="code">SECURITY DEFINER</code> no se admite cuando se especifica <code class="code">NONATOMIC</code>.</p>
                  <p>El modo de seguridad para el procedimiento determina los privilegios de acceso del procedimiento en el tiempo de ejecución. El procedimiento tiene que tener permiso para acceder a los objetos subyacentes de la base de datos. </p>
                  <p>Para el modo SECURITY INVOKER, el procedimiento usa los privilegios del usuario que llama al procedimiento. El usuario tiene que tener permisos explícitos sobre los objetos subyacentes de la base de datos. El valor predeterminado es SECURITY INVOKER.</p>
                  <p>Para el modo SECURITY DEFINER, el procedimiento usa los privilegios del propietario del procedimiento. El propietario del procedimiento se define como el usuario propietario del procedimiento en tiempo de ejecución, no necesariamente el usuario que definió inicialmente el procedimiento. El usuario que llama al procedimiento necesita privilegio de ejecución en el procedimiento pero no necesita ningún privilegio en los objetos subyacentes. </p>
               </dd>
             
               <dt><span class="term">SET configuration_parameter <span>{</span> TO value | = value }</span></dt>
               <dd>
                  <p>Estas opciones no se admiten cuando se especifica <code class="code">NONATOMIC</code>.</p>
                  <p>La cláusula SET causa que el parámetro <code class="code">configuration_parameter</code> especificado se establezca en el valor especificado cuando se especifica el procedimiento. Esta cláusula restaura a continuación <code class="code">configuration_parameter</code> a su valor anterior cuando el procedimiento existe. </p>
               </dd>
            </dl></div>
       
         <h2 id="r_CREATE_PROCEDURE-usage">Notas de uso</h2>
         <p>Si se creó un procedimiento almacenado mediante la opción SECURITY DEFINER, al invocar la función CURRENT_USER desde el procedimiento almacenado, Amazon Redshift devuelve el nombre de usuario del propietario del procedimiento almacenado.</p>
       
         <h2 id="r_CREATE_PROCEDURE-examples">Ejemplos</h2>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Si al ejecutar estos ejemplos se produce un error similar a:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">ERROR: 42601: [Amazon](500310) unterminated dollar-quoted string at or near "$$</code></pre><p>Consulte <a href="./stored-procedure-create.html">Información general de procedimientos almacenados en Amazon Redshift</a>. </p></div></div>
         <p>El siguiente ejemplo crea un procedimiento con dos parámetros de entrada.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE OR REPLACE PROCEDURE test_sp1(f1 int, f2 varchar(20))
AS $$
DECLARE
  min_val int;
BEGIN
  DROP TABLE IF EXISTS tmp_tbl;
  CREATE TEMP TABLE tmp_tbl(id int);
  INSERT INTO tmp_tbl values (f1),(10001),(10002);
  SELECT INTO min_val MIN(id) FROM tmp_tbl;
  RAISE INFO 'min_val = %, f2 = %', min_val, f2;
END;
$$ LANGUAGE plpgsql;
</code></pre>
         
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p> Al escribir procedimientos almacenados, sugerimos una práctica recomendada para proteger los valores confidenciales: </p><p> No codifique ninguna información confidencial en la lógica de procedimientos almacenada. Por ejemplo, no asigne una contraseña de usuario en una instrucción CREATE USER del cuerpo de un procedimiento almacenado. Esto supone un riesgo de seguridad, porque los valores codificados de forma rígida se pueden registrar como metadatos de esquema en las tablas del catálogo. En cambio, pase valores confidenciales, como las contraseñas, como argumentos al procedimiento almacenado, mediante parámetros. </p><p>Para obtener más información acerca de los procedimientos almacenados, consulte<a href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_PROCEDURE.html">PROCEDIMIENTO DE CREACIÓN</a>y<a href="https://docs.aws.amazon.com/redshift/latest/dg/stored-procedure-overview.html">Creación de procedimientos almacenados en Amazon Redshift</a>. Para obtener más información acerca de las tablas de catálogos, consulte <a href="https://docs.aws.amazon.com/redshift/latest/dg/c_intro_catalog_views.html">Tablas de catálogos de sistema</a>.</p></div></div>

         <p>El siguiente ejemplo crea un procedimiento con un parámetro IN, un parámetro OUT y un parámetro INOUT.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE OR REPLACE PROCEDURE test_sp2(f1 IN int, f2 INOUT varchar(256), out_var OUT varchar(256))
AS $$
DECLARE
  loop_var int;
BEGIN
  IF f1 is null OR f2 is null THEN
    RAISE EXCEPTION 'input cannot be null';
  END IF;
  DROP TABLE if exists my_etl;
  CREATE TEMP TABLE my_etl(a int, b varchar);
    FOR loop_var IN 1..f1 LOOP
        insert into my_etl values (loop_var, f2);
        f2 := f2 || '+' || f2;
    END LOOP;
  SELECT INTO out_var count(*) from my_etl;
END;
$$ LANGUAGE plpgsql;
</code></pre>
         
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Aviso" /> <strong>JavaScript está desactivado o no está disponible en su navegador.</strong></p><p>Para utilizar la documentación de AWS, debe estar habilitado JavaScript. Para obtener más información, consulte las páginas de ayuda de su navegador.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenciones del documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_create_model_use_cases.html">Casos de uso</div><div id="next" class="next-link" accesskey="n" href="./r_CREATE_RLS_POLICY.html">CREATE RLS POLICY</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">¿Le ha servido de ayuda esta página? - Sí</div><div class="content"><p>Gracias por hacernos saber que estamos haciendo un buen trabajo.</p><p>Si tiene un momento, díganos qué es lo que le ha gustado para que podamos seguir trabajando en esa línea.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Comentarios" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_PROCEDURE.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">¿Le ha servido de ayuda esta página? - No</div><div class="content"><p>Gracias por informarnos de que debemos trabajar en esta página. Lamentamos haberle defraudado.</p><p>Si tiene un momento, díganos cómo podemos mejorar la documentación.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Comentarios" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_PROCEDURE.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>