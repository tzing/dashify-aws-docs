<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="es-ES"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tutorial: Uso de funciones SQL espaciales con Amazon Redshift - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="spatial-tutorial" /><meta name="default_state" content="spatial-tutorial" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/spatial-tutorial.html" /><meta name="description" content="Utilice este tutorial para obtener información acerca de cómo utilizar funciones SQL espaciales con Amazon Redshift." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guía para desarrolladores de bases de datos" /><meta name="abstract" content="Cree y administre un almacenamiento de datos con Amazon Redshift, un servicio de almacenamiento de datos completamente administrado a escala de petabytes de nivel empresarial." /><meta name="guide-locale" content="es_es" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/spatial-tutorial.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/spatial-tutorial.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/spatial-tutorial.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/spatial-tutorial.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/spatial-tutorial.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/spatial-tutorial.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/spatial-tutorial.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/spatial-tutorial.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/spatial-tutorial.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/spatial-tutorial.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/spatial-tutorial.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/spatial-tutorial.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/spatial-tutorial.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/spatial-tutorial.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/spatial-tutorial.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/spatial-tutorial.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/spatial-tutorial.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/spatial-tutorial.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/spatial-tutorial.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/spatial-tutorial.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/spatial-tutorial.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/spatial-tutorial.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guía para desarrolladores de bases de datos" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guía para desarrolladores de bases de datos" /><meta id="panorama-serviceConsolePage" value="Tutorial: Uso de funciones SQL espaciales con Amazon Redshift" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Tutorial: Uso de funciones SQL espaciales con Amazon Redshift - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#spatial-tutorial" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/spatial-tutorial.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/spatial-tutorial.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/spatial-tutorial.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,Clúster,almacenamiento de datos,desarrollador,datos de ejemplo,base de datos,desarrollador de base de datos,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guía para desarrolladores de bases de datos",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Consulta de datos espaciales en Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg/geospatial-overview.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Tutorial: Uso de funciones SQL espaciales con Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/es_es/redshift/latest/dg/geospatial-overview.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#spatial-tutorial" target="_blank" rel="noopener noreferrer" title="Abrir PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentación</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guía para desarrolladores de bases de datos</a></div><div id="page-toc-src"><a href="#spatial-tutorial-prerequisites">Requisitos previos</a><a href="#spatial-tutorial-test-data">Paso 1: Crear tablas y cargar datos de prueba</a><a href="#spatial-tutorial-query">Paso 2: Consultar los datos espaciales</a><a href="#spatial-tutorial-clean-up">Paso 3: Eliminar los recursos</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="spatial-tutorial">Tutorial: Uso de funciones SQL espaciales con Amazon Redshift</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>En este tutorial, se muestra cómo utilizar algunas de las funciones SQL espaciales con Amazon Redshift. </p><p>Para ello, debe consultar dos tablas utilizando funciones SQL espaciales. En el tutorial, se utilizan datos de conjuntos de datos públicos que relacionan los datos de ubicación de los alojamientos de alquiler con los códigos postales en Berlín, Alemania. </p><div class="highlights" id="inline-topiclist"><h6>Temas</h6><ul><li><a href="#spatial-tutorial-prerequisites">Requisitos previos</a></li><li><a href="#spatial-tutorial-test-data">Paso 1: Crear tablas y cargar datos de prueba</a></li><li><a href="#spatial-tutorial-query">Paso 2: Consultar los datos espaciales</a></li><li><a href="#spatial-tutorial-clean-up">Paso 3: Eliminar los recursos</a></li></ul></div>
        <h2 id="spatial-tutorial-prerequisites">Requisitos previos</h2>
           
        <p>Para este tutorial, necesita los siguientes recursos:</p>
           
        <div class="itemizedlist">
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                        <p>Un clúster y una base de datos de Amazon Redshift existentes a los que pueda acceder y actualizar. En el clúster existente, puede crear tablas, cargar datos de muestra y ejecutar consultas SQL para mostrar las funciones espaciales. El clúster debe tener dos nodos como mínimo. Para obtener información acerca de cómo crear un clúster, siga los pasos que se indican en la <a href="https://docs.aws.amazon.com/redshift/latest/gsg/">Guía de introducción a Amazon Redshift</a>. </p>
            </li><li class="listitem">
                        <p>Para utilizar el editor de consultas de Amazon Redshift, asegúrese de que el clúster se encuentra en una región de AWS que sea compatible con el editor de consultas. Para obtener más información, consulte <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/query-editor.html">Consulta de una base de datos mediante el editor de consultas</a> en la <em>Guía de administración de Amazon Redshift</em>. </p>
            </li><li class="listitem">
                        <p>Credenciales de AWS para su clúster de Amazon Redshift que le permiten cargar datos de prueba desde Amazon S3. Para obtener información sobre cómo acceder a otros servicios de AWS, como Amazon S3, consulte <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/authorizing-redshift-service.html">Autorización a Amazon Redshift para obtener acceso a los servicios de AWS</a>.</p>
            </li><li class="listitem">
                        <p>El rol de AWS Identity and Access Management (IAM) denominado <code class="code">mySpatialDemoRole</code>, que tiene la política administrada <code class="code">AmazonS3ReadOnlyAccess</code> adjuntada para leer los datos de Amazon S3. Para crear un rol que tenga permiso para cargar datos de un bucket de Amazon S3, consulte <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/copy-unload-iam-role.html">Autorización de las operaciones COPY, UNLOAD y CREATE EXTERNAL SCHEMA mediante los roles de IAM</a> en la <em>Guía de administración de Amazon Redshift</em>. </p>
            </li><li class="listitem"><p>Después de crear el rol de IAM <code class="code">mySpatialDemoRole</code>, este necesita asociarse con su clúster de Amazon Redshift. Para obtener más información acerca de cómo crear esa asociación, consulte <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/copy-unload-iam-role.html">Autorización de las operaciones COPY, UNLOAD y CREATE EXTERNAL SCHEMA mediante los roles de IAM</a> en la <em>Guía de administración de Amazon Redshift</em>. </p>    
            </li></ul></div>   

        
        <h2 id="spatial-tutorial-test-data">Paso 1: Crear tablas y cargar datos de prueba</h2>
            
            
             
            <p>Los datos de origen que se utilizaron en este se encuentran en archivos denominados <code>accommodations.csv</code> y <code>zipcodes.csv</code>. </p>
        <p>El archivo <code>accommodations.csv</code> consiste en datos de código abierto de insideairbnb.com. El archivo <code>zipcodes.csv</code> proporciona códigos postales que son datos de código abierto del Instituto Nacional de Estadística de Berlín-Brandeburgo en Alemania (Amt für Statistik Berlín-Brandenburg). Ambos orígenes de datos se proporcionan bajo una licencia de Creative Commons. Los datos se limitan a la región de Berlín, Alemania. Estos archivos se encuentran en un bucket público de Amazon S3 para utilizarse en este tutorial. </p>
            
            <p>De manera opcional, puede descargar los datos de origen desde los siguientes enlaces de Amazon S3:</p> 
            <div class="itemizedlist">
                 
                 
            <ul class="itemizedlist"><li class="listitem"><p><a href="https://s3.amazonaws.com/redshift-downloads/spatial-data/accommodations.csv" rel="noopener noreferrer" target="_blank"><span> Datos de origen para la tabla <code class="code">accommodations</code></span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. </p></li><li class="listitem"><p><a href="https://s3.amazonaws.com/redshift-downloads/spatial-data/zipcode.csv" rel="noopener noreferrer" target="_blank"><span> Datos de origen para la tabla <code class="code">zipcode</code></span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. </p></li></ul></div>
            
           <p>Utilice el siguiente procedimiento para crear tablas y cargar datos de prueba. </p>

            <div class="procedure"><h6>Para crear tablas y cargar datos de prueba</h6><ol><li>
                    <p>Abra el editor de consultas de Amazon Redshift. Para obtener más información acerca de cómo trabajar con el editor de consultas, visite <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/query-editor.html">Consulta de una base de datos mediante el editor de consultas</a> en la <em>Guía de administración de Amazon Redshift</em>. </p> 
                </li><li>
                    <p>Elimine todas las tablas utilizadas en este tutorial si ya existen en la base de datos. Para obtener más información, consulte <a href="#spatial-tutorial-clean-up">Paso 3: Eliminar los recursos</a>. </p>
                </li><li>
                    <p>Cree la tabla <code class="code">accommodations</code> para almacenar la ubicación geográfica de cada alojamiento (longitud y latitud), el nombre del listado y otros datos comerciales. </p>
                <p>En este tutorial, se analiza el alquiler de habitaciones en Berlín, Alemania. En la columna <code class="code">shape</code>, se almacenan los puntos geográficos de la ubicación de los alojamientos. Las otras columnas contienen información sobre el alquiler. </p>
                    <p>Para crear la tabla <code class="code">accommodations</code>, ejecute la siguiente instrucción SQL en el editor de consultas de Amazon Redshift. </p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE TABLE public.accommodations (
  id INTEGER PRIMARY KEY,
  shape GEOMETRY,
  name VARCHAR(100),
  host_name VARCHAR(100),
  neighbourhood_group VARCHAR(100),
  neighbourhood VARCHAR(100),
  room_type VARCHAR(100),
  price SMALLINT,
  minimum_nights SMALLINT,
  number_of_reviews SMALLINT,
  last_review DATE,
  reviews_per_month NUMERIC(8,2),
  calculated_host_listings_count SMALLINT, 
  availability_365 SMALLINT
);</code></pre>
               </li><li>
                    <p>Cree la tabla <code class="code">zipcode</code> en el editor de consultas para almacenar los códigos postales de Berlín. </p>
                <p>Un <em>código postal</em> se define como un polígono en la columna <code class="code">wkb_geometry</code>. En el resto de las columnas, se describen metadatos espaciales adicionales sobre el código postal. </p>
                <p>Para crear la tabla <code class="code">zipcode</code>, ejecute la siguiente instrucción SQL en el editor de consultas de Amazon Redshift. </p>
                    
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE TABLE public.zipcode (
  ogc_field INTEGER PRIMARY KEY NOT NULL,
  wkb_geometry GEOMETRY,
  gml_id VARCHAR(256),
  spatial_name VARCHAR(256),
  spatial_alias VARCHAR(256),
  spatial_type VARCHAR(256)
 );</code></pre>
                    
                </li><li>
                    <p>Cargue las tablas con datos de muestra. </p>
                <p>Los datos de muestra para este tutorial se encuentran en un bucket de Amazon S3 que permite el acceso de lectura a todos los usuarios de AWS autenticados. Asegúrese de proporcionar credenciales de AWS válidas que permiten el acceso a Amazon S3. </p>
                <p>Para cargar datos de prueba en las tablas, ejecute los siguientes comandos COPY. Sustituya <code class="replaceable"><code class="code">account-number</code></code> por su número de cuenta de AWS. El segmento de la cadena de credenciales que está delimitado entre comillas simples no debe contener espacios ni saltos de línea. </p>
                    
                    
  
                                                         
                            
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">COPY public.accommodations 
FROM 's3://redshift-downloads/spatial-data/accommodations.csv' 
DELIMITER ';' 
IGNOREHEADER 1 REGION 'us-east-1'
CREDENTIALS 'aws_iam_role=arn:aws:iam::<code class="replaceable">account-number</code>:role/mySpatialDemoRole';
</code></pre>
                            
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">COPY public.zipcode 
FROM 's3://redshift-downloads/spatial-data/zipcode.csv' 
DELIMITER ';' 
IGNOREHEADER 1 REGION 'us-east-1'
CREDENTIALS 'aws_iam_role=arn:aws:iam::<code class="replaceable">account-number</code>:role/mySpatialDemoRole';
</code></pre>  
 
 
                            
                            
                             
                            
                </li><li>
                    <p>Ejecute los siguientes comandos para comprobar que cada tabla se haya cargado de forma correcta. </p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">select count(*) from accommodations;</code></pre>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">select count(*) from zipcode;</code></pre>
                    <p>Los siguientes resultados muestran la cantidad de filas en cada tabla de los datos de prueba.</p>
                    <div class="table-container"><div class="table-contents"><table id="w319aac25c67c11c13c12b9"><thead>
                                <tr>
                                    <th>Nombre de la tabla</th>
                                    <th>Filas</th>
                                </tr>
                            </thead>
                                <tr>
                                    <td tabindex="-1">accomodations</td>
                                    <td tabindex="-1">22 248</td>
                                </tr>
                                <tr>
                                    <td tabindex="-1">zipcode</td>
                                    <td tabindex="-1">190</td>
                                </tr>
                            </table></div></div>
                </li></ol></div>                       
     
        <h2 id="spatial-tutorial-query">Paso 2: Consultar los datos espaciales</h2>

        <p>Después de crear y cargar las tablas, puede consultarlas mediante las instrucciones SQL SELECT. Las siguientes consultas muestran parte de la información que se puede recuperar. Puede escribir muchas otras consultas que utilizan funciones espaciales para satisfacer sus necesidades. </p>
        <div class="procedure"><h6>Para consultar los datos espaciales</h6><ol><li>
                <p>Realice una consulta para obtener el recuento de la cantidad total de listados almacenados en la tabla <code class="code">accommodations</code>, como se muestra a continuación. El sistema de referencia espacial es el sistema geodésico mundial (WGS) 84, que tiene el identificador de referencia espacial único 4326.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT count(*) FROM public.accommodations WHERE ST_SRID(shape) = 4326;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
 count
-------
 22248</code></pre>                
            </li><li>
                <p>Recupere los objetos de geometría en formato de texto conocido (WKT) con algunos atributos adicionales. Además, puede comprobar si estos datos de código postal también se almacenan con el sistema geodésico mundial (WGS) 84, que utiliza el ID de referencia espacial (SRID) 4326. Los datos espaciales deben almacenarse en el mismo sistema de referencia espacial para que sean interoperables. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT ogc_field, spatial_name, spatial_type, ST_SRID(wkb_geometry), ST_AsText(wkb_geometry) 
FROM public.zipcode 
ORDER BY spatial_name;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
ogc_field  spatial_name  spatial_type  st_srid  st_astext
---------------------------------------------------------------
0           10115        Polygon        4326     POLYGON((...))
4           10117        Polygon        4326     POLYGON((...))
8           10119        Polygon        4326     POLYGON((...))
...
(190 rows returned)</code></pre>
                
            </li><li>
                <p>Seleccione el polígono de Berlin-Mitte (10117), un distrito de Berlín, en formato GeoJSON, su dimensión y la cantidad de puntos en este polígono. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT ogc_field, spatial_name, ST_AsGeoJSON(wkb_geometry), ST_Dimension(wkb_geometry), ST_NPoints(wkb_geometry)
FROM public.zipcode 
WHERE spatial_name='10117';</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
ogc_field  spatial_name  spatial_type                                   st_dimension  st_npoint
-----------------------------------------------------------------------------------------------
4           10117         <span>{</span>"type":"Polygon", "coordinates":[[[...]]]}    2             331
</code></pre>
                
            </li><li>
                <p>Ejecute el siguiente comando SQL para ver cuántos alojamientos hay a menos de 500 metros de la Puerta de Brandenburgo. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT count(*) 
FROM public.accommodations 
WHERE ST_DistanceSphere(shape, ST_GeomFromText('POINT(13.377704 52.516431)', 4326)) &lt; 500;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
count
------
  29
</code></pre>
                             
            </li><li>
                <p>Obtenga la ubicación aproximada de la Puerta de Brandenburgo a partir de los datos almacenados en los alojamientos que se mencionan como cercanos mediante la ejecución de la siguiente consulta.</p>
                <p>Esta consulta requiere una subselección. Esto implica un recuento diferente, ya que la ubicación solicitada no es la misma que la consulta anterior porque está más cerca de los alojamientos. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">WITH poi(loc) as (
  SELECT st_astext(shape) FROM accommodations WHERE name LIKE '%brandenburg gate%'
)
SELECT count(*) 
FROM accommodations a, poi p
WHERE ST_DistanceSphere(a.shape, ST_GeomFromText(p.loc, 4326)) &lt; 500;</code></pre>                
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
count
------
  60
</code></pre>  
                
              
            </li><li>
                <p>Ejecute la siguiente consulta para mostrar los detalles de todos los alojamientos en los alrededores de la Puerta de Brandenburgo, ordenados por precio en orden descendente. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT name, price, ST_AsText(shape) 
FROM public.accommodations
WHERE ST_DistanceSphere(shape, ST_GeomFromText('POINT(13.377704 52.516431)', 4326)) &lt; 500
ORDER BY price DESC;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
name                                                   price  st_astext
-------------------------------------------------------------------------------------------------------
DUPLEX APARTMENT/PENTHOUSE in 5* LOCATION! 7583        300    POINT(13.3826510209548 52.5159819722552)
DUPLEX-PENTHOUSE IN FIRST LOCATION! 7582               300    POINT(13.3799997083855 52.5135918444834)
... 
(29 rows returned)
</code></pre> 
                
                             
            </li><li>
                <p>Ejecute la siguiente consulta para recuperar el alojamiento más costoso con su código postal. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT 
  a.price, a.name, ST_AsText(a.shape), 
  z.spatial_name, ST_AsText(z.wkb_geometry) 
FROM accommodations a, zipcode z 
WHERE price = 9000 AND ST_Within(a.shape, z.wkb_geometry);</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
price   name                                 st_astext                                  spatial_name      st_astext
-------------------------------------------------------------------------------------------------------------------------------------------------
9000    Ueber den Dächern Berlins Zentrum    POINT(13.334436985013 52.4979779501538)    10777             POLYGON((13.3318284987227 52.4956021172799,...
</code></pre>               
            </li><li>
                <p>Calcule el precio máximo, mínimo o medio de los alojamientos con una subconsulta. </p>
                <p>Con la siguiente consulta, se muestra el precio medio de los alojamientos por código postal. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT 
  a.price, a.name, ST_AsText(a.shape), 
  z.spatial_name, ST_AsText(z.wkb_geometry) 
FROM accommodations a, zipcode z 
WHERE 
  ST_Within(a.shape, z.wkb_geometry) AND 
  price = (SELECT median(price) FROM accommodations)
ORDER BY a.price;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
price name                            st_astext                                   spatial_name   st_astext
---------------------------------------------------------------------------------------------------------------------------------------------                    
45    "Cozy room Berlin-Mitte"        POINT(13.3864349535358 52.5292016386514)    10115          POLYGON((13.3658598465795 52.535659581048,...
...
(723 rows returned)
</code></pre> 
                
            </li><li>
                <p>Ejecute la siguiente consulta para recuperar la cantidad de alojamientos que se muestran para Berlín. Los puntos calientes se agrupan por código postal y se ordenan por la cantidad de suministro, por lo que pueden encontrarse de esta manera. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT z.spatial_name as zip, count(*) as numAccommodations 
FROM public.accommodations a, public.zipcode z
WHERE ST_Within(a.shape, z.wkb_geometry)
GROUP BY zip 
ORDER BY numAccommodations DESC;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
zip  	numaccommodations
----------------------------
10245	872
10247	832
10437	733
10115	664
...
(187 rows returned)
</code></pre>
            </li></ol></div>




     
           <h2 id="spatial-tutorial-clean-up">Paso 3: Eliminar los recursos</h2>
           
           
           <p>El clúster seguirá acumulando cargos mientras esté en ejecución. Una vez que haya completado este tutorial, puede eliminar el clúster de muestra. </p>
           <p>Si desea mantener el clúster, pero quiere recuperar el almacenamiento utilizado por las tablas de datos de prueba, ejecute los siguientes comandos para eliminar las tablas. </p>
           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">drop table public.accommodations cascade;</code></pre>
           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">drop table public.zipcode cascade;</code></pre>
           
       <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Aviso" /> <strong>JavaScript está desactivado o no está disponible en su navegador.</strong></p><p>Para utilizar la documentación de AWS, debe estar habilitado JavaScript. Para obtener más información, consulte las páginas de ayuda de su navegador.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenciones del documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./geospatial-overview.html">Consulta de datos espaciales</div><div id="next" class="next-link" accesskey="n" href="./spatial-copy-shapefile.html">Carga de un shapefile</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">¿Le ha servido de ayuda esta página? - Sí</div><div class="content"><p>Gracias por hacernos saber que estamos haciendo un buen trabajo.</p><p>Si tiene un momento, díganos qué es lo que le ha gustado para que podamos seguir trabajando en esa línea.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Comentarios" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/spatial-tutorial.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">¿Le ha servido de ayuda esta página? - No</div><div class="content"><p>Gracias por informarnos de que debemos trabajar en esta página. Lamentamos haberle defraudado.</p><p>Si tiene un momento, díganos cómo podemos mejorar la documentación.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Comentarios" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/es_es/redshift/latest/dg/spatial-tutorial.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>