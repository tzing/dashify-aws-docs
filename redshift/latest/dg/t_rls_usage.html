<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Considerations using RLS policies - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="t_rls_usage" /><meta name="default_state" content="t_rls_usage" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/t_rls_usage.html" /><meta name="description" content="Describes RLS policy considerations." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Database Developer Guide" /><meta name="abstract" content="Create and manage a data warehouse with Amazon Redshift, an enterprise-level, petabyte scale, fully managed data warehousing service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/t_rls_usage.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/t_rls_usage.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/t_rls_usage.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/t_rls_usage.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/t_rls_usage.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/t_rls_usage.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/t_rls_usage.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/t_rls_usage.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/t_rls_usage.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/t_rls_usage.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/t_rls_usage.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/t_rls_usage.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/t_rls_usage.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/t_rls_usage.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/t_rls_usage.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/t_rls_usage.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/t_rls_usage.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/t_rls_usage.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/t_rls_usage.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/t_rls_usage.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/t_rls_usage.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/t_rls_usage.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Database Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Database Developer Guide" /><meta id="panorama-serviceConsolePage" value="Considerations using RLS policies" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Considerations using RLS policies - Amazon Redshift</title><meta name="pdf" content="/pdfs/redshift/latest/dg/redshift-dg.pdf#t_rls_usage" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/t_rls_usage.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/t_rls_usage.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/t_rls_usage.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,developer,sample data,database,database developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Database Developer Guide",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Managing database security",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/r_Database_objects.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Row-level security",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/t_rls.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Considerations using RLS policies",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/t_rls.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/redshift/latest/dg/redshift-dg.pdf#t_rls_usage" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Database Developer Guide</a></div><div id="page-toc-src"><a href="#t_rls_limitations">Limitations</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="t_rls_usage">Considerations using RLS policies</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Following are considerations for working with RLS policies:</p><div class="itemizedlist">
            
      
        
      
            
   
           
           
            
 

         


            
           
            
            
            
            
            
            
            
        <ul class="itemizedlist"><li class="listitem"><p>Amazon Redshift applies RLS policies to SELECT, UPDATE, or DELETE statements.</p></li><li class="listitem"><p>Amazon Redshift doesn't apply RLS policies to INSERT, COPY, ALTER TABLE APPEND statements.</p></li><li class="listitem"><p>Row-level security works with column-level security to protect your data.</p></li><li class="listitem"><p>When your Amazon Redshift cluster was on the latest generally available version that supports RLS, but is
                  downgraded to an earlier version, Amazon Redshift returns an error when you run a query
                  on base tables with RLS policies attached. The sys:secadmin can revoke access from users that were granted restricted policies, turn off RLS on
                  tables, and drop the policies.</p></li><li class="listitem"><p>When RLS is turned on for the source relation, Amazon Redshift supports the ALTER TABLE APPEND
                  statement for superusers, users that have been explicitly granted the system
                  permission IGNORE RLS, or the sys:secadmin role. In this case, you can run the ALTER TABLE
                  APPEND statement to append rows to a target table by moving data from an existing
                  source table. Amazon Redshift moves all tuples from the source relation into the target
                  relation. The RLS status of the target relation doesn't affect the ALTER TABLE
                  APPEND statement.</p></li><li class="listitem"><p>To facilitate migration from other data warehouse systems, you can set and retrieve customized session context variables for a connection by specifying the variable name and value.</p>
              <p>The following example sets session context variables for a row-level security (RLS) policy.</p>
              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">-- Set a customized context variable.
SELECT set_config(‘app.category’, ‘Concerts’, FALSE);

-- Create a RLS policy using current_setting() to get the value of a customized context variable.
CREATE RLS POLICY policy_categories
WITH (catgroup VARCHAR(10)) 
USING (catgroup = current_setting('app.category', FALSE));

-- Set correct roles and attach the policy on the target table to one or more roles.
ATTACH RLS POLICY policy_categories ON tickit_category_redshift TO ROLE analyst, ROLE dbadmin;</code></pre>
              <p>For details on how to set and retrieve customized session context variables, see <a href="./r_SET.html">SET</a>, <a href="./r_SET_CONFIG.html">SET_CONFIG</a>, <a href="./r_SHOW.html">SHOW</a>, <a href="./r_CURRENT_SETTING.html">CURRENT_SETTING</a>, and <a href="./r_RESET.html">RESET</a>.</p>
           </li><li class="listitem"><p>Changing session user using SET SESSION AUTHORIZATION between DECLARE and FETCH or between subsequent FETCH statements won't refresh the already prepared plan based on the user policies at DECLARE time. Avoid changing session user when cursors are used with RLS-protected tables.</p></li><li class="listitem"><p>When the base objects inside a view object are RLS-protected, policies attached to the user
                  running the query are applied on the respective base objects. This is different
                  from object-level permission checks,
                  where the view owner's permissions are checked against the view base objects.
                  You can view the RLS-protected relations of a
                  query in its EXPLAIN plan output.</p></li><li class="listitem"><p>When a user-defined function (UDF) is referenced in a RLS policy of a relation attached to a user, the user must have the EXECUTE permission over the UDF to query the relation.</p></li><li class="listitem"><p>
              Row-level security might limit query optimization. We recommend carefully evaluating query performance before
              deploying RLS-protected views on large datasets. 
           </p></li><li class="listitem"><p>
              Row-level security policies applied to late-binding views might be pushed into federated tables. These RLS policies might be visible in external processing engine logs. 
           </p></li></ul></div>
           <h2 id="t_rls_limitations">Limitations</h2>
           <p>Following are the limitations when working with RLS policies:</p>
           <div class="itemizedlist">
              
              
              
              
              
               
               
               
              
              
              
               
               
               
              
               
               
               
               
               
                             
               
           <ul class="itemizedlist"><li class="listitem"><p>Amazon Redshift supports SELECT statements for certain RLS policies with lookups that have complex
                 joins, but doesn't support UPDATE or DELETE statements. In cases with UPDATE
                 or DELETE statements, Amazon Redshift returns the following error:</p>
                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">ERROR: One of the RLS policies on target relation is not supported in UPDATE/DELETE.</code></pre></li><li class="listitem">
                 <p>Whenever a user-defined function (UDF) is referenced in a RLS policy of a
                    relation attached to a user, the user must have the EXECUTE permission over the
                    UDF to query the relation.</p>
              </li><li class="listitem"><p>Correlated subqueries aren't supported. Amazon Redshift returns the following error:</p>
                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">ERROR: RLS policy could not be rewritten.</code></pre></li><li class="listitem"><p>RLS policies can't be attached to external tables and materialized views.</p></li><li class="listitem"><p>Amazon Redshift doesn't support datasharing with RLS. If a relation doesn't have RLS turned off for
                 datashares, the query fails on the consumer cluster with the following
                 error:</p>
                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">RLS-protected relation "rls_protected_table" cannot be accessed via datasharing query.</code></pre></li><li class="listitem"><p>In cross-database queries, Amazon Redshift blocks reads to RLS-protected relations. Users with the IGNORE RLS permission can access the protected relation using cross-database queries. When a user without the IGNORE RLS permission accesses RLS-protected relation through a cross-database query, the following error appears:</p>
                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">RLS-protected relation "rls_protected_table" cannot be accessed via cross-database query.</code></pre></li><li class="listitem"><p>ALTER RLS POLICY only supports modifying a RLS policy using the USING ( using_predicate_exp )
                     clause. You can't modify a RLS policy with a WITH clause when running
                     ALTER RLS POLICY.</p></li><li class="listitem">
                 <p>You can't query relations that have row-level security turned on 
                    if the values for any of the following configuration options don't 
                    match the default value of the session:</p>
                 <div class="itemizedlist">
                     
                     
                     
                 <ul class="itemizedlist"><li class="listitem"><p>
                       <code class="code">enable_case_sensitive_super_attribute</code>
                    </p></li><li class="listitem"><p>
                       <code class="code">enable_case_sensitive_identifier</code>
                    </p></li><li class="listitem"><p>                     
                       <code class="code">downcase_delimited_identifier</code>
                    </p></li></ul></div>
                 <p>Consider resetting your session’s configuration options if you attempt to query a relation with row-level security on
                    and see the message "RLS protected relation does not support session level config on case sensitivity being different from its default value."</p>
              </li><li class="listitem"><p>
                 When your provisioned cluster or serverless namespace has any row-level security policies,
                 the following commands are blocked for regular users:
              </p>
                 <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">ALTER &lt;current_user&gt; SET enable_case_sensitive_super_attribute/enable_case_sensitive_identifier/downcase_delimited_identifier</code></pre>
                 <p>When you create RLS policies, we recommend that you change the default
                     configuration option settings for regular users to match the session’s
                     configuration option settings at the time the policy was created. Superusers
                     and users with the ALTER USER privilege can do this by using parameter group
                     settings or the ALTER USER command. For information about parameter groups, see
                        <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-parameter-groups.html">Amazon Redshift
                        parameter groups</a> in the <em>Amazon Redshift Management Guide</em>. For
                     information about the ALTER USER command, see <a href="./r_ALTER_USER.html">ALTER USER</a>.</p></li><li class="listitem">
                 <p>
                    Views and late-binding views with row-level security policies can't be replaced by regular 
                    users using the <a href="./r_CREATE_VIEW.html">CREATE VIEW</a> command.
                    To replace views or LBVs with RLS policies, first detach any RLS policies attached to them, 
                    replace the views or LBVs, and reattach the policies. Superusers and users with the 
                    <code class="code">sys:secadmin permission</code> can use CREATE VIEW on views or LBVs with 
                    RLS policies without detaching the policies. 
                 </p>
              </li><li class="listitem">
                 <p>
                    Views with row-level security policies can't reference system tables and system views. 
                 </p>
              </li><li class="listitem">
                 <p>
                    A late-binding view that's referenced by a regular view can't be RLS protected. 
                 </p>
              </li><li class="listitem">
                 <p>
                 RLS-protected relations and nested data from data lakes can't be accessed in the same query. 
              </p>
              </li></ul></div>
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./t_rls_object_dependency.html">Policy-dependent objects and principles</div><div id="next" class="next-link" accesskey="n" href="./t_rls_performance.html">Best practices for RLS performance</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/t_rls_usage.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/t_rls_usage.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>