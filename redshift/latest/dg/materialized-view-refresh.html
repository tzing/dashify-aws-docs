<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Refreshing a materialized view - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="materialized-view-refresh" /><meta name="default_state" content="materialized-view-refresh" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-refresh.html" /><meta name="description" content="Update the data in a materialized view by using REFRESH." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Database Developer Guide" /><meta name="abstract" content="Create and manage a data warehouse with Amazon Redshift, an enterprise-level, petabyte scale, fully managed data warehousing service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-refresh.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/materialized-view-refresh.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/materialized-view-refresh.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/materialized-view-refresh.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/materialized-view-refresh.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-refresh.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-refresh.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/materialized-view-refresh.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/materialized-view-refresh.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-refresh.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-refresh.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/materialized-view-refresh.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/materialized-view-refresh.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/materialized-view-refresh.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/materialized-view-refresh.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/materialized-view-refresh.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/materialized-view-refresh.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-refresh.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-refresh.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/materialized-view-refresh.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/materialized-view-refresh.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-refresh.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Database Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Database Developer Guide" /><meta id="panorama-serviceConsolePage" value="Refreshing a materialized view" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Refreshing a materialized view - Amazon Redshift</title><meta name="pdf" content="/pdfs/redshift/latest/dg/redshift-dg.pdf#materialized-view-refresh" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/materialized-view-refresh.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/materialized-view-refresh.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/materialized-view-refresh.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,developer,sample data,database,database developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Database Developer Guide",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Creating materialized views in Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-overview.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Refreshing a materialized view",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-overview.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/redshift/latest/dg/redshift-dg.pdf#materialized-view-refresh" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Database Developer Guide</a></div><div id="page-toc-src"><a href="#materialized-view-auto-refresh">Autorefreshing a materialized
                    view</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="materialized-view-refresh">Refreshing a materialized view</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>When you create a materialized view, its contents reflect the state of the underlying
            database table or tables at that time. The data in the materialized view remains
            unchanged, even when applications change the data in the underlying tables. To update the data in the materialized view, you can
            use the <code class="code">REFRESH MATERIALIZED VIEW</code> statement at any time to manually refresh
            materialized views. When you use this statement, Amazon Redshift identifies changes that have taken
            place in the base table or tables and applies those changes to the materialized
            view.</p><p>Amazon Redshift has two strategies for
            refreshing a materialized view: </p><div class="itemizedlist">
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>In many cases, Amazon Redshift can perform an incremental refresh. In an <em>incremental refresh</em>, Amazon Redshift quickly identifies the
                    changes to the data in the base tables since the last refresh and updates the
                    data in the materialized view. Incremental refresh is supported on the following
                    SQL constructs used in the query when defining the materialized view:</p>
                <div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Constructs that contain the clauses SELECT, FROM, [INNER] JOIN, WHERE,
                            GROUP BY, or HAVING.</p>
                    </li><li class="listitem">
                        <p>Constructs that contain aggregations, such as SUM, MIN, MAX, AVG, and COUNT.</p>
                    </li><li class="listitem">
                        <p>Most built-in SQL functions, specifically the ones that are immutable,
                            given that these have the same input arguments and always produce the
                            same output. </p>
                    </li></ul></div>
                <p>Incremental refresh is also supported for a materialized view that's based on a datashare table.</p>
            </li><li class="listitem">
                <p>If an incremental refresh isn't possible, then Amazon Redshift performs a full
                    refresh. A <em>full refresh</em> reruns the underlying
                    SQL statement, replacing all of the data in the materialized view.</p>
            </li><li class="listitem">
                <p>Amazon Redshift automatically chooses the refresh method for a materialized view depending
                    on the SELECT query used to define the materialized view. </p>
            </li></ul></div><p>Refreshing a materialized view on a materialized view isn't a cascading process. In
            other words, suppose that you have a materialized view A that depends on materialized
            view B. In this case, when the REFRESH MATERIALIZED VIEW A is invoked, A is refreshed
            using the current version of B, even when B is out-of-date. To bring A fully up to date,
            before refreshing A, first refresh B in a separate transaction.</p><p>The following example shows how you can create a full refresh plan for a materialized
            view programmatically. To refresh the materialized view v, first refresh materialized
            view u. To refresh materialized view w, first refresh materialized view u and then
            materialized view v.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE t(a INT);
CREATE MATERIALIZED VIEW u AS SELECT * FROM t;
CREATE MATERIALIZED VIEW v AS SELECT * FROM u;
CREATE MATERIALIZED VIEW w AS SELECT * FROM v;

WITH RECURSIVE recursive_deps (mv_tgt, lvl, mv_dep) AS
( SELECT trim(name) as mv_tgt, 0 as lvl, trim(ref_name) as mv_dep
  FROM stv_mv_deps
  UNION ALL
  SELECT R.mv_tgt, R.lvl+1 as lvl, trim(S.ref_name) as mv_dep
  FROM stv_mv_deps S, recursive_deps R
  WHERE R.mv_dep = S.name
)

SELECT mv_tgt, mv_dep from recursive_deps
ORDER BY mv_tgt, lvl DESC;

 mv_tgt | mv_dep
--------+--------
 v      | u
 w      | u
 w      | v
(3 rows)</code></pre><p>The following example shows an informative message when you run REFRESH
            MATERIALIZED VIEW on a materialized view that depends on an out-of-date materialized
            view.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create table a(a int);</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create materialized view b as select * from a;</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create materialized view c as select * from b;</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">insert into a values (1);</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">refresh materialized view c;

INFO:  Materialized view c is already up to date.  However, it depends on another materialized view that is not up to date.</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">REFRESH MATERIALIZED VIEW b;
INFO:  Materialized view b was incrementally updated successfully.</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">REFRESH MATERIALIZED VIEW c;
INFO:  Materialized view c was incrementally updated successfully.</code></pre><p>Amazon Redshift currently has the following limitations for incremental refresh for
            materialized views. </p><p>Amazon Redshift doesn't support incremental refresh for materialized views that are defined with
            a query using the following SQL elements:</p><div class="itemizedlist">
                 
                 
                 
                 
                
                 
                 

                 

                 
                
            <ul class="itemizedlist"><li class="listitem">
                    <p>OUTER JOIN (RIGHT, LEFT, or FULL).</p></li><li class="listitem">
                    <p>The set operations UNION, INTERSECT, EXCEPT, and MINUS.</p></li><li class="listitem">
                    <p>The aggregate functions MEDIAN, PERCENTILE_CONT, LISTAGG,
                    STDDEV_SAMP, STDDEV_POP, APPROXIMATE COUNT, APPROXIMATE PERCENTILE, and bitwise
                    aggregate functions.</p>
                    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The COUNT, SUM, and AVG aggregate functions are supported.</p></div></div>
                </li><li class="listitem">
                    <p>DISTINCT aggregate functions, such as DISTINCT COUNT, DISTINCT
                        SUM, and so on.</p></li><li class="listitem"><p>Window functions.</p></li><li class="listitem"><p>A query that uses temporary tables for query optimization, such as optimizing common subexpressions.</p></li><li class="listitem"><p>Subqueries.</p></li><li class="listitem">
                    <p>External tables referencing the following formats in the query that defines the materialized view.
                    </p>
                    <div class="itemizedlist">
                         
                         
                    <ul class="itemizedlist"><li class="listitem">
                            <p>
                                Delta Lake
                            </p>
                        </li><li class="listitem">
                            <p>
                                Hudi
                            </p>
                        </li></ul></div>
                    <p>Incremental refresh is supported on the preview track for materialized views defined using 
                        formats other than those listed above. For more information about
                        setting up Preview clusters, see <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-console.html#cluster-preview">Creating a 
                            preview cluster</a> in the <em>Amazon Redshift Management Guide</em>.
                        For information about setting up Preview workgroups, see <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/serverless-workgroup-preview.html">Creating a 
                            preview workgroup</a> in the <em>Amazon Redshift Management Guide</em>.
                    </p>
                </li></ul></div>
            <h2 id="materialized-view-auto-refresh">Autorefreshing a materialized
                    view</h2>
        <p>Amazon Redshift can automatically refresh materialized views with up-to-date data from its
                base tables when materialized views are created with or altered to have the
                autorefresh option. Amazon Redshift autorefreshes materialized views as soon as possible
                after base tables changes.</p>
            <p>To complete refresh of the most important materialized views with minimal impact
                to active workloads in your cluster, Amazon Redshift considers multiple factors. These
                factors include current system load, the resources needed for refresh, available
                cluster resources, and how often the materialized views are used. </p>
            <p>Amazon Redshift prioritizes your workloads over autorefresh and might stop autorefresh to
                preserve the performance of user workload. This approach might delay refresh of some
                materialized views. In some cases, you might need more deterministic refresh
                behavior for your materialized views. If so, consider using manual refresh as
                described in <a href="./materialized-view-refresh-sql-command.html">REFRESH MATERIALIZED VIEW</a> or scheduled refresh
                using the Amazon Redshift scheduler API operations or the console.</p>
        <p>You can set autorefresh for materialized views using CREATE MATERIALIZED VIEW. You can
                also use the AUTO REFRESH clause to refresh materialized views automatically. For
                more information about creating materialized views, see <a href="./materialized-view-create-sql-command.html">CREATE MATERIALIZED VIEW</a>. You can turn on
                autorefresh for a current materialized view by using <a href="./r_ALTER_MATERIALIZED_VIEW.html">ALTER MATERIALIZED VIEW</a>.</p>
      
            <p>Consider the following when you refresh materialized views:</p>
            <div class="itemizedlist">
                 

             
             
                 
            <ul class="itemizedlist"><li class="listitem"><p>You can still refresh a materialized view explicitly using REFRESH MATERIALIZED VIEW command
                        even if you haven't enabled autorefresh for the materialized
                        view.</p></li><li class="listitem"><p>Amazon Redshift doesn't autorefresh materialized views defined on external tables.</p></li><li class="listitem"><p>For refresh status, you can check SVL_MV_REFRESH_STATUS, which records queries that were
                        user-initiated or autorefreshed.
            </p></li><li class="listitem"><p>To run REFRESH on recompute-only materialized views, make sure that you have the CREATE 
                    permission on schemas. For more information, see <a href="./r_GRANT.html">GRANT</a>.</p></li></ul></div>
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./materialized-view-auto-rewrite.html">Automatic query rewriting to use
                materialized views</div><div id="next" class="next-link" accesskey="n" href="./materialized-view-auto-mv.html">Automated materialized views</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/materialized-view-refresh.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/materialized-view-refresh.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>