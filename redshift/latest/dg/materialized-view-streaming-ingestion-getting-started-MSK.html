<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Getting started with streaming ingestion from Amazon Managed Streaming for Apache Kafka - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="materialized-view-streaming-ingestion-getting-started-MSK" /><meta name="default_state" content="materialized-view-streaming-ingestion-getting-started-MSK" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" /><meta name="description" content="Learn how to set up streaming ingestion from Amazon Managed Streaming for Apache Kafka." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Database Developer Guide" /><meta name="abstract" content="Create and manage a data warehouse with Amazon Redshift, an enterprise-level, petabyte scale, fully managed data warehousing service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Database Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Database Developer Guide" /><meta id="panorama-serviceConsolePage" value="Getting started with streaming ingestion from Amazon Managed Streaming for Apache Kafka" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Getting started with streaming ingestion from Amazon Managed Streaming for Apache Kafka - Amazon Redshift</title><meta name="pdf" content="/pdfs/redshift/latest/dg/redshift-dg.pdf#materialized-view-streaming-ingestion-getting-started-MSK" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,developer,sample data,database,database developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Database Developer Guide",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Creating materialized views in Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-overview.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Streaming ingestion",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-streaming-ingestion.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Getting started with streaming ingestion from Amazon Managed Streaming for Apache Kafka",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-streaming-ingestion.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/redshift/latest/dg/redshift-dg.pdf#materialized-view-streaming-ingestion-getting-started-MSK" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Database Developer Guide</a></div><div id="page-toc-src"><a href="#materialized-view-streaming-ingestion-getting-started-MSK-setup">Setting up IAM and performing streaming ingestion from Kafka</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="materialized-view-streaming-ingestion-getting-started-MSK">Getting started with streaming ingestion from Amazon Managed Streaming for Apache Kafka</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p> The purpose of Amazon Redshift streaming ingestion is to simplify the process for
                directly ingesting stream data from a streaming service into Amazon Redshift or Amazon Redshift Serverless. This works with Amazon MSK and Amazon MSK Serverless,
                and
                with Kinesis. Amazon Redshift streaming ingestion
                removes
                the need to stage a Kinesis Data Streams stream or an Amazon MSK topic in Amazon S3 before ingesting the
                stream data into Redshift.</p><p>
                        On a technical level, streaming ingestion, both from Amazon Kinesis Data Streams and Amazon Managed Streaming for Apache Kafka, provides low-latency, high-speed ingestion of 
                        stream or topic data into an Amazon Redshift materialized view. Following setup, using materialized view refresh, you can take in large data volumes.
                    </p><p>Set up Amazon Redshift streaming ingestion for Amazon MSK by performing the following steps:</p><div class="orderedlist">
                         
                         
                    <ol><li><p>Create an external schema that maps to the streaming data source.</p></li><li><p>Create a materialized view that references the external schema.</p></li></ol></div><p>You
                must
                have an Amazon MSK source available,
                before
                configuring Amazon Redshift streaming ingestion. If you do not have a source, follow the
                instructions at <a href="https://docs.aws.amazon.com/msk/latest/developerguide/getting-started.html">Getting Started Using
                    Amazon MSK</a>.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p><em>Streaming ingestion and Amazon Redshift Serverless</em> - The configuration steps in this topic apply
                        both to provisioned Amazon Redshift clusters and to Amazon Redshift Serverless. For more information, see <a href="./materialized-view-streaming-ingestion.html#materialized-view-streaming-ingestion-considerations">Streaming ingestion considerations</a>.</p></div></div>
                        <h2 id="materialized-view-streaming-ingestion-getting-started-MSK-setup">Setting up IAM and performing streaming ingestion from Kafka</h2>
                        <p>Assuming you have an Amazon MSK cluster available, the first step is to define a schema in Redshift 
                            with <code class="code">CREATE EXTERNAL SCHEMA</code> and to reference the Kafka topic as the data source. Following that, to 
                            access data in the topic, define the <code class="code">STREAM</code> in a materialized view. You can store records from your 
                            topic in the semi-structured <code class="code">SUPER</code> format, or define a schema that results in data converted to Amazon Redshift data types. When 
                            you query the materialized view, the returned records are a point-in-time view of the topic.</p>
                        <div class="procedure"><ol><li><p>Create an IAM role with a trust policy that allows your Amazon Redshift cluster or Amazon Redshift Serverless to assume the role. For information 
                                about how to configure the trust policy for the IAM role, see <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/authorizing-redshift-service.html">Authorizing Amazon Redshift 
                                    to access other AWS services on 
                                    your behalf</a>. After it's created, the role should have the following IAM policy, which provides permission for 
                                communication with the Amazon MSK cluster. The policy you need depends on the authentication method used on your cluster, if you use Amazon MSK. 
                                See <a href="https://docs.aws.amazon.com/msk/latest/developerguide/kafka_apis_iam.html">Authentication and Authorization for Apache Kafka APIs</a> for authentication 
                                methods available in Amazon MSK.</p>
                                <p>An IAM policy for Amazon MSK using unauthenticated access:</p>
                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "VisualEditor0",
            "Effect": "Allow",
            "Action": [
                "kafka:GetBootstrapBrokers"
            ],
            "Resource": "*"
        }
    ]
}</code></pre>
                                <p>An IAM policy for Amazon MSK when using IAM authentication:</p>
                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "MSKIAMpolicy",
            "Effect": "Allow",
            "Action": [
                "kafka-cluster:ReadData",
                "kafka-cluster:DescribeTopic",
                "kafka-cluster:Connect"
            ],
            "Resource": [
                "arn:aws:kafka:*:0123456789:cluster/*/*",
                "arn:aws:kafka:*:0123456789:topic/*/*/*"
            ]
        },
        <span>{</span>
            "Sid": "MSKPolicy",
            "Effect": "Allow",
            "Action": [
                "kafka:GetBootstrapBrokers"
            ],
            "Resource": "*"
        }
    ]
}</code></pre>
                            </li><li><p> Check your VPC and
                            verify
                            that your Amazon Redshift cluster or Amazon Redshift Serverless has a route to get to your Amazon MSK cluster. The
                            inbound security group rules for your Amazon MSK cluster should allow your
                            Amazon Redshift cluster's or your Amazon Redshift Serverless workgroup's security group. The ports you specify depend on the
                            authentication method used for your cluster, when you use Amazon MSK. For more
                            information, see <a href="https://docs.aws.amazon.com/msk/latest/developerguide/port-info.html">Port
                                information</a> and <a href="https://docs.aws.amazon.com/msk/latest/developerguide/aws-access.html">Access from within AWS but outside the VPC</a>.</p>
                                
                                <p>Note that client authentication with mTLS isn't supported for streaming ingestion. For more 
                                    information, see <a href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-streaming-ingestion.html#materialized-view-streaming-ingestion-limitations">Limitations</a>.</p>
                            <p>The following table shows complimentary configuration options to set for streaming ingestion from Amazon MSK:</p>
                                <div class="table-container"><div class="table-contents"><table id="w323aac38c55c15c15b5b3b6"><thead>
                                            <tr>
                                                <th>Amazon Redshift configuration</th>
                                                <th>Amazon MSK configuration</th>
                                                <th>Port to open between Redshift and Amazon MSK</th>
                                            </tr>
                                        </thead>
                                            <tr>
                                                <td tabindex="-1">
                                                    AUTHENTICATION NONE
                                                </td>
                                                <td tabindex="-1">
                                                    TLS transport disabled
                                                </td>
                                                <td tabindex="-1">9092</td>
                                            </tr>
                                            <tr>
                                                <td tabindex="-1">
                                                    AUTHENTICATION NONE
                                                </td>
                                                <td tabindex="-1">
                                                    TLS transport enabled
                                                </td>
                                                <td tabindex="-1">9094</td>
                                            </tr>
                                            <tr>
                                                <td tabindex="-1">
                                                    AUTHENTICATION IAM
                                                </td>
                                                <td tabindex="-1">
                                                    IAM
                                                </td>
                                                <td tabindex="-1">9098/9198</td>
                                            </tr>
                                        </table></div></div>
                                <p>Amazon Redshift authentication is set in the CREATE EXTERNAL SCHEMA statement.</p>
                                <p>In a case where the Amazon MSK cluster has Mutual Transport Layer Security (mTLS) authentication enabled, configuring Amazon Redshift to use AUTHENTICATION NONE 
                                    directs it to use port 9094 for unauthenticated access. However, this will fail because the port is being used by mTLS authentication. Because of this, we 
                                    recommend that you switch to AUTHENTICATION IAM when you use mTLS.</p>    
                            </li><li><p>Enable enhanced VPC routing on your Amazon Redshift cluster or Amazon Redshift Serverless workgroup. For more information, 
                                see <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/enhanced-vpc-enabling-cluster.html">Enabling enhanced VPC routing</a>.</p>
                                <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>In order to retrieve the Amazon MSK bootstrap brokers URL, Amazon Redshift makes a <a href="https://docs.aws.amazon.com/msk/1.0/apireference/clusters-clusterarn-bootstrap-brokers.html#GetBootstrapBrokers">GetBootstrapBrokers</a> API call, using 
                                    permissions provided by the attached IAM role. Note that in order for this request to succeed when enhanced VPC routing is enabled, the 
                                    subnet for your Amazon Redshift provisioned cluster or Amazon Redshift Serverless workgroup must have a NAT gateway or internet gateway. Your network ACLs and security-group 
                                    outbound rules for the aforementioned subnet must also allow access to the Amazon MSK API service endpoints. For more information, 
                                    see <a href="https://docs.aws.amazon.com/general/latest/gr/msk.html">Amazon Managed Streaming for Apache Kafka endpoints and quotas</a>.</p></div></div>
                            </li><li><p>In Amazon Redshift, create an external schema to map to the Amazon MSK cluster. </p>
                                
                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE EXTERNAL SCHEMA MySchema
FROM MSK
IAM_ROLE <span>{</span> default | 'iam-role-arn' }
AUTHENTICATION <span>{</span> none | iam }
CLUSTER_ARN 'msk-cluster-arn';</code></pre>
                                
                                <p>In the <code class="code">FROM</code> clause, Amazon MSK denotes that
                            the schema maps data from Managed Kafka Services. 
                            </p> 
                                    <p>
                                        Streaming ingestion for Amazon MSK provides the following authentication types, when you create the external schema:
                                    </p>
                                    <div class="itemizedlist">
                                         
                                         
                                    <ul class="itemizedlist"><li class="listitem"><p><b>none</b> – Specifies that there is no authentication step.</p></li><li class="listitem"><p><b>iam</b> – Specifies IAM authentication. When you choose this, make sure 
                                            that the IAM role has permissions for IAM authentication. </p></li></ul></div>
                                <p>Additional Amazon MSK authentication methods, such as TLS authentication or a username and password, aren't supported for streaming ingestion.
                                    </p>
                                <p> <code class="code">CLUSTER_ARN</code> specifies the Amazon MSK cluster
                                    that
                                    you’re streaming from.</p>       
                            </li><li>
                                <p>Create a materialized view to consume the data from the topic.
                            The following example defines a materialized view with JSON source data.
                            Note that the following view
                            validates
                            that the data is valid JSON and utf8. Kafka topic names are case sensitive 
                                    and can contain both uppercase and lowercase letters. To ingest from topics with uppercase names, you can set the 
                                    configuration <code class="code">enable_case_sensitive_identifier</code> to <code class="code">true</code> at the database level. For more 
                                    information, see <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_names.html">Names and identifiers</a> 
                                    and <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_enable_case_sensitive_identifier.html">enable_case_sensitive_identifier</a>.</p>
                                
                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE MATERIALIZED VIEW MyView AUTO REFRESH YES AS
SELECT kafka_partition, 
 kafka_offset, 
 kafka_timestamp_type, 
 kafka_timestamp, 
 kafka_key, 
 JSON_PARSE(kafka_value) as Data, 
 kafka_headers
FROM MySchema."mytopic"
WHERE CAN_JSON_PARSE(kafka_value);</code></pre>
                    <p>To turn on auto refresh, use <code class="code">AUTO REFRESH YES</code>. The default behavior is manual refresh.
                    </p>
                                <p>Metadata columns include the following:</p>
                                <div class="table-container"><div class="table-contents"><table id="w323aac38c55c15c15b5b9b9"><thead>
                                            <tr>
                                                <th>Metadata column</th>
                                                <th>Data type</th>
                                                <th>Description</th>
                                            </tr>
                                        </thead>
                                            <tr>
                                                <td tabindex="-1">
                                                    kafka_partition
                                                </td>
                                                <td tabindex="-1">
                                                    bigint
                                                </td>
                                                <td tabindex="-1"> Partition id of the record from the
                                            Kafka
                                            topic </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1">
                                                    kafka_offset
                                                </td>
                                                <td tabindex="-1">
                                                    bigint
                                                </td>
                                                <td tabindex="-1"> Offset of the record in the
                                            Kafka
                                            topic for a given partition </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1">
                                                    kafka_timestamp_type
                                                </td>
                                                <td tabindex="-1">
                                                    char(1)
                                                </td>
                                                <td tabindex="-1">
                                                    <p>Type of timestamp used in the Kafka record:</p> 
                                                    <div class="itemizedlist">
                                                         
                                                         
                                                         
                                                    <ul class="itemizedlist"><li class="listitem"><p><em>C</em> – Record creation time (CREATE_TIME) on the client side</p></li><li class="listitem"><p><em>L</em> – Record append time (LOG_APPEND_TIME) on the Kafka server side </p></li><li class="listitem"><p><em>U</em> – Record creation time is not available (NO_TIMESTAMP_TYPE)</p></li></ul></div>
                                                </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1">
                                                    kafka_timestamp
                                                </td>
                                                <td tabindex="-1">
                                                    timestamp without time zone
                                                </td>
                                                <td tabindex="-1">
                                                    The timestamp value for the record
                                                </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1">
                                                    kafka_key
                                                </td>
                                                <td tabindex="-1">
                                                    varbyte
                                                </td>
                                                <td tabindex="-1">
                                                    The key of the Kafka record
                                                </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1">
                                                    kafka_value
                                                </td>
                                                <td tabindex="-1">
                                                    varbyte
                                                </td>
                                                <td tabindex="-1">
                                                    The record received from Kafka
                                                </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1">
                                                    kafka_headers
                                                </td>
                                                <td tabindex="-1">
                                                    super
                                                </td>
                                                <td tabindex="-1">
                                                    The header of the record received from Kafka
                                                </td>
                                                
                                            </tr>
                                            <tr>
                                                <td tabindex="-1">
                                                    refresh_time
                                                </td>
                                                <td tabindex="-1">
                                                    timestamp without time zone
                                                </td>
                                                <td tabindex="-1">
                                                    The time the refresh started
                                                </td>
                                            </tr>
                                        </table></div></div>
                                
                                <p>It's important to note if you have business logic in your materialized view definition that parsing errors can cause streaming 
                                    ingestion to be blocked in some cases. This might lead to where you have to drop and re-create the materialized view. To avoid this, we 
                                    recommend that you keep your parsing logic as simple as possible and perform most of your business-logic checks on the data 
                                    following ingestion. The following example shows how you can 
                                    use <a href="./CAN_JSON_PARSE.html">CAN_JSON_PARSE function</a> to guard against errors 
                                    and more successfully ingest data.</p>
                                
                            </li><li><p>Refresh the view, which invokes Amazon Redshift to read from the topic and load data 
                                into the materialized view.</p>
                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">REFRESH MATERIALIZED VIEW MyView;</code></pre>
                            </li><li><p>Query data in the materialized view.</p>
                                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select * from MyView;</code></pre>
                                <p>The materialized view is updated directly from the topic when
                                <code class="code">REFRESH</code> is run. You create a materialized view that
                            maps to the Kafka topic data source. You can perform filtering and
                            aggregations on the data as part of the materialized
                            view
                            definition. Your streaming ingestion materialized view (base
                            materialized view) can reference only one Kafka topic, but you can
                            create additional materialized views that join with the base
                            materialized view and with other materialized views or tables.</p>
                            </li></ol></div>
                        <p>For more information about limitations for streaming ingestion, see <a href="./materialized-view-streaming-ingestion.html#materialized-view-streaming-ingestion-limitations">Limitations</a>.</p>
                    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./materialized-view-streaming-ingestion-getting-started.html">Getting started with streaming ingestion from Amazon Kinesis Data Streams</div><div id="next" class="next-link" accesskey="n" href="./materialized-view-streaming-ingestion-example-station-data.html">Electric vehicle station-data streaming ingestion tutorial, using Kinesis</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/materialized-view-streaming-ingestion-getting-started-MSK.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>