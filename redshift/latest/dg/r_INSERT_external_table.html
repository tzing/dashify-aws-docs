<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>INSERT (external table) - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_INSERT_external_table" /><meta name="default_state" content="r_INSERT_external_table" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/r_INSERT_external_table.html" /><meta name="description" content="Inserts the results of a SELECT query into existing partitioned or non-partitioned external tables." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Database Developer Guide" /><meta name="abstract" content="Create and manage a data warehouse with Amazon Redshift, an enterprise-level, petabyte scale, fully managed data warehousing service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/r_INSERT_external_table.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_INSERT_external_table.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_INSERT_external_table.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_INSERT_external_table.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_INSERT_external_table.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_INSERT_external_table.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_INSERT_external_table.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_INSERT_external_table.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_INSERT_external_table.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_INSERT_external_table.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_INSERT_external_table.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_INSERT_external_table.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_INSERT_external_table.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_INSERT_external_table.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_INSERT_external_table.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_INSERT_external_table.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_INSERT_external_table.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_INSERT_external_table.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_INSERT_external_table.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_INSERT_external_table.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_INSERT_external_table.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_INSERT_external_table.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Database Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Database Developer Guide" /><meta id="panorama-serviceConsolePage" value="INSERT (external table)" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>INSERT (external table) - Amazon Redshift</title><meta name="pdf" content="/pdfs/redshift/latest/dg/redshift-dg.pdf#r_INSERT_external_table" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_INSERT_external_table.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_INSERT_external_table.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_INSERT_external_table.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,developer,sample data,database,database developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Database Developer Guide",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "SQL reference",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "SQL commands",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "INSERT (external table)",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/c_SQL_commands.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/redshift/latest/dg/redshift-dg.pdf#r_INSERT_external_table" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Database Developer Guide</a></div><div id="page-toc-src"><a href="#r_INSERT_external_table-synopsis">Syntax</a><a href="#r_INSERT_external_table-parameters">Parameters</a><a href="#r_INSERT_external_table_usage_notes">Usage notes</a><a href="#c_Examples_of_INSERT_external_table">INSERT (external table) examples</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="r_INSERT_external_table">INSERT (external table)</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Inserts the results of a SELECT query into existing external tables on external catalog
         such as for AWS Glue, AWS Lake Formation, or an Apache Hive metastore. Use the same AWS Identity and Access Management (IAM) role
         used for the CREATE EXTERNAL SCHEMA command to interact with external catalogs and
         Amazon S3.</p><p>For nonpartitioned tables, the INSERT (external table) command writes data to the Amazon S3
         location defined in the table, based on the specified table properties and file
         format.</p><p>For partitioned tables, INSERT (external table) writes data to the Amazon S3 location
         according to the partition key specified in the table. It also automatically registers new
         partitions in the external catalog after the INSERT operation completes.</p><p>You can't run INSERT (external table) within a transaction block (BEGIN ... END).
         For more information about transactions, see <a href="./c_serial_isolation.html">Serializable isolation</a>. </p>
         <h2 id="r_INSERT_external_table-synopsis">Syntax</h2>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">INSERT INTO <em>external_schema.table_name</em>
<em><span>{</span> select_statement }</em></code></pre>
       
         <h2 id="r_INSERT_external_table-parameters">Parameters</h2>
         <div class="variablelist">
             
             
         <dl>
               <dt><span class="term">
                  <em>external_schema.table_name</em>
               </span></dt>
               <dd>
                  <p>The name of an existing external schema and a target external table to
                     insert into.</p>
               </dd>
             
               <dt><span class="term">
                  <em>select_statement</em>
               </span></dt>
               <dd>
                  <p>A statement that inserts one or more rows into the external table by
                     defining any query. All of the rows that the query produces are written to Amazon S3
                     in either text or Parquet format based on the table definition. The query must
                     return a column list that is compatible with the column data types in the
                     external table. However, the column names don't have to match.</p>
               </dd>
            </dl></div>
       
         <h2 id="r_INSERT_external_table_usage_notes">Usage notes</h2>
         <p>The number of columns in the SELECT query must be the same as the sum of data columns
            and partition columns. The location and the data type of each data column must match
            that of the external table. The location of partition columns must be at the end of the
            SELECT query, in the same order they were defined in CREATE EXTERNAL TABLE command. The
            column names don't have to match.</p>
         <p>In some cases, you might want to run the INSERT (external table) command on an AWS Glue
            Data Catalog or a Hive metastore. In the case of AWS Glue, the IAM role used to create the
            external schema must have both read and write permissions on Amazon S3 and AWS Glue. If you use
            an AWS Lake Formation catalog, this IAM role becomes the owner of the new Lake Formation table. This IAM
            role must at least have the following permissions: </p>
         <div class="itemizedlist">
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>SELECT, INSERT, UPDATE permission on the external table</p>
            </li><li class="listitem">
               <p>Data location permission on the Amazon S3 path of the external table</p>
            </li></ul></div>
         <p>To ensure that file names are unique, Amazon Redshift uses the following format for the name of
            each file uploaded to Amazon S3 by default. </p>
         <p><code class="code"><code class="replaceable">&lt;date&gt;</code>_<code class="replaceable">&lt;time&gt;</code>_<code class="replaceable">&lt;microseconds&gt;</code>_<code class="replaceable">&lt;query_id&gt;</code>_<code class="replaceable">&lt;slice-number&gt;</code>_part_<code class="replaceable">&lt;part-number&gt;</code>.<code class="replaceable">&lt;format&gt;</code></code>.</p>
         <p>An example is <code class="code">20200303_004509_810669_1007_0001_part_00.parquet</code>.</p>
         <p>Consider the following when running the INSERT (external table) command:</p>
         <div class="itemizedlist">
             
             
             
             
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>External tables that have a format other than PARQUET or TEXTFILE aren't
                  supported.</p>
            </li><li class="listitem">
               <p>This command supports existing table properties such as
                  'write.parallel', 'write.maxfilesize.mb',
                  'compression_type’, and 'serialization.null.format'. To update
                  those values, run the ALTER TABLE SET TABLE PROPERTIES command.</p>
            </li><li class="listitem">
               <p>The 'numRows’ table property is automatically updated toward the end of
                  the INSERT operation. The table property must be defined or added to the table
                  already if it wasn't created by CREATE EXTERNAL TABLE AS operation.</p>
            </li><li class="listitem">
               <p>The LIMIT clause isn't supported in the outer SELECT query. Instead, use a
                  nested LIMIT clause.</p>
            </li><li class="listitem">
               <p>You can use the <a href="./r_STL_UNLOAD_LOG.html">STL_UNLOAD_LOG</a> table to track the files that got written to
                  Amazon S3 by each INSERT (external table) operation.</p>
            </li><li class="listitem"><p>Amazon Redshift supports only Amazon S3 standard encryption for INSERT (external table).</p></li></ul></div>
       
         <h2 id="c_Examples_of_INSERT_external_table">INSERT (external table)
               examples</h2>
         <p>The following example inserts the results of the SELECT statement into the external
            table.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">INSERT INTO spectrum.lineitem
SELECT * FROM local_lineitem;
</code></pre>
         <p>The following example inserts the results of the SELECT statement into a partitioned
            external table using static partitioning. The partition columns are hardcoded in the
            SELECT statement. The partition columns must be at the end of the query.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">INSERT INTO spectrum.customer
SELECT name, age, gender, 'May', 28 FROM local_customer;</code></pre>
         <p>The following example inserts the results of the SELECT statement into a partitioned
            external table using dynamic partitioning. The partition columns aren't hardcoded.
            Data is automatically added to the existing partition folders, or to new folders if a
            new partition is added.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">INSERT INTO spectrum.customer
SELECT name, age, gender, month, day FROM local_customer;</code></pre>
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./c_Examples_of_INSERT_30.html">INSERT examples</div><div id="next" class="next-link" accesskey="n" href="./r_LOCK.html">LOCK</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_INSERT_external_table.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_INSERT_external_table.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>