<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Getting started using federated queries to PostgreSQL with AWS CloudFormation - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="getting-started-federated-CF" /><meta name="default_state" content="getting-started-federated-CF" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/getting-started-federated-CF.html" /><meta name="description" content="Automate federated query setup in Amazon Redshift by using an AWS CloudFormation stack." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Database Developer Guide" /><meta name="abstract" content="Create and manage a data warehouse with Amazon Redshift, an enterprise-level, petabyte scale, fully managed data warehousing service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/getting-started-federated-CF.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/getting-started-federated-CF.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/getting-started-federated-CF.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/getting-started-federated-CF.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/getting-started-federated-CF.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/getting-started-federated-CF.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/getting-started-federated-CF.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/getting-started-federated-CF.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/getting-started-federated-CF.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/getting-started-federated-CF.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/getting-started-federated-CF.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/getting-started-federated-CF.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/getting-started-federated-CF.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/getting-started-federated-CF.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/getting-started-federated-CF.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/getting-started-federated-CF.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/getting-started-federated-CF.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/getting-started-federated-CF.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/getting-started-federated-CF.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/getting-started-federated-CF.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/getting-started-federated-CF.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/getting-started-federated-CF.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Database Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Database Developer Guide" /><meta id="panorama-serviceConsolePage" value="Getting started using federated queries to PostgreSQL with AWS CloudFormation" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Getting started using federated queries to PostgreSQL with AWS CloudFormation - Amazon Redshift</title><meta name="pdf" content="/pdfs/redshift/latest/dg/redshift-dg.pdf#getting-started-federated-CF" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/getting-started-federated-CF.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/getting-started-federated-CF.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/getting-started-federated-CF.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,developer,sample data,database,database developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Database Developer Guide",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Querying data with federated queries in Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/federated-overview.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Getting started using federated queries to PostgreSQL with AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/federated-overview.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/redshift/latest/dg/redshift-dg.pdf#getting-started-federated-CF" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Database Developer Guide</a></div><div id="page-toc-src"><a href="#getting-started-federated-CF-stack">Launching a CloudFormation stack for
               Redshift federated queries</a><a href="#getting-started-federated-CF-stack-query">Querying data from the external schema</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="getting-started-federated-CF">Getting started using federated queries to
            PostgreSQL with AWS CloudFormation</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>You can use federated queries to query across operational databases. In this
         getting-started guide, you can automate setup by using a sample AWS CloudFormation stack to enable a
         federated query from an Amazon Redshift cluster to an Aurora PostgreSQL serverless database. You can get
         up and running quickly without having to run SQL statements to provision your
         resources.</p><p>The stack creates an external schema, referencing your Aurora PostgreSQL instance, which includes tables with sample data. You can query 
         tables in the external schema from your Redshift cluster.</p><p>If instead you want to get started with federated queries by running SQL statements to set up an external schema, without using CloudFormation, 
         see <a href="./getting-started-federated.html">Getting started with using federated queries to
            PostgreSQL</a>.</p><p>Before running the CloudFormation stack for federated queries, make sure that you have an
         Amazon Aurora PostgreSQL-Compatible Edition serverless database with the Data API turned on. You can turn on the
         Data API in the database properties. If you can't find the setting, double-check that you
         are running a serverless instance of Aurora PostgreSQL. Also make sure that you have a Amazon Redshift
         cluster that uses RA3 nodes. We recommend that both the Redshift cluster and serverless
         Aurora PostgreSQL instance are in the same virtual private cloud (VPC) and subnet group. This
         way, you can add the security group for the Amazon Redshift cluster to the inbound rules of the
         security group for your Aurora PostgreSQL database instance.</p><p>For more information about getting started setting up an Amazon Redshift 
         cluster, see <a href="https://docs.aws.amazon.com/redshift/latest/gsg/getting-started.html">Getting started with Amazon Redshift</a>. For more information 
         about setting up resources with CloudFormation, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/Welcome.html">What is AWS CloudFormation?</a>. For more information 
         about setting up an Aurora database, see <a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/aurora-serverless.create.html">Creating an Aurora Serverless v1 DB cluster</a>.</p>
         <h2 id="getting-started-federated-CF-stack">Launching a CloudFormation stack for
               Redshift federated queries</h2>
         <p>Use the following procedure to launch your CloudFormation stack for Amazon Redshift to enable federated queries.
            Before doing so, make sure you have your Amazon Redshift cluster and your serverless Aurora PostgreSQL instance set up.</p>
         
         
         <div class="procedure"><h6>To launch your CloudFormation stack for federated queries</h6><ol><li><p>Click <a href="https://console.aws.amazon.com/cloudformation/home?#/stacks/new?stackName=FederatedQuery&amp;templateURL=https://s3.amazonaws.com/redshift-downloads/docs-downloads/FederatedQuery.yml" rel="noopener noreferrer" target="_blank"><span><b>Launch CFN stack</b></span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> here to launch the CloudFormation
                  service in the AWS Management Console.
                  
               </p>
               <p>If you are prompted, sign in.</p>
               <p>The stack creation process starts, referencing a CloudFormation template file,
                  which is stored in Amazon S3. A CloudFormation <em>template</em>
                  is a text file in JSON format that declares AWS resources that make up a stack. </p></li><li><p>Choose <b>Next</b> to enter the stack details.</p></li><li>
               <p>Under <b>Parameters</b>, for the cluster, enter the following:</p>
               
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p>The Amazon Redshift cluster name, for example
                        <code class="userinput">ra3-consumer-cluster</code></p>
                  </li><li class="listitem">
                     <p>A specific database name, for example <code class="userinput">dev</code></p>
                  </li><li class="listitem">
                     <p>The name of a database user, for example
                        <code class="userinput">consumeruser</code></p>
                  </li></ul></div>
               <p>Also enter the parameters 
                  for the Aurora database, including the user, database name, port, and endpoint. We recommend using a test cluster and test serverless database, because 
                  the stack creates several database objects.</p>
               <p>Choose <b>Next</b>. </p>
               <p>The stack options appear. </p></li><li><p>Choose <b>Next</b> to accept the default settings.</p></li><li><p>Under <b>Capabilities</b>, choose <b>I acknowledge that AWS CloudFormation might create IAM resources.</b></p></li><li><p>Choose <b>Create stack</b>. </p></li></ol></div>

         <p>Choose <b>Create stack</b>. CloudFormation provisions the template
            resources, which takes about 10 minutes, and creates an external schema.</p>
         
         
         <p>If an error occurs while the stack is created, do the following:</p>
         <div class="itemizedlist">
             
             
             
             
         <ul class="itemizedlist"><li class="listitem"><p>View the CloudFormation <b>Events</b> tab for information that can help you resolve the error.</p></li><li class="listitem"><p>Make sure that you entered the correct name, 
               database name, and database user name for the Redshift cluster. Also check the parameters for the Aurora PostgreSQL instance.</p></li><li class="listitem"><p>Make sure that your cluster has RA3 nodes.</p></li><li class="listitem"><p>Make sure that your database and Redshift cluster 
               are in the same subnet and security group.</p></li></ul></div>
       
         <h2 id="getting-started-federated-CF-stack-query">Querying data from the external schema</h2>
     
         <p>To use the following procedure, make sure that you have the required permissions
            for running queries on the cluster and the database described.</p>
         
         <div class="procedure"><h6>To query an external database with federated query</h6><ol><li><p>Connect to the Redshift database that you entered when you created the stack, using a client
                  tool such as the Redshift query editor. </p></li><li><p>Query 
               for the external schema created by the stack.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select * from svv_external_schemas;</code></pre>
               <p>The <a href="./r_SVV_EXTERNAL_SCHEMAS.html">SVV_EXTERNAL_SCHEMAS</a> view returns information about
                  available external schemas. In this case, the external schema created by the stack
                  is returned, <code class="code">myfederated_schema</code>. You might also have other external
                  schemas returned, if you have any set up. The view also returns the schema's
                  associated database. The database is the Aurora database that you entered when you
                  created the stack. The stack adds a table to the Aurora database, called
                     <code class="code">category</code>, and another table called <code class="code">sales</code>.</p>
            </li><li>
               <p>Run SQL queries on tables in the external schema that references your
                  Aurora PostgreSQL database. The following example shows a query.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT count(*) FROM myfederated_schema.category;</code></pre>
               <p>The <code class="code">category</code> table returns several records. You can also return records from the <code class="code">sales</code> table.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT count(*) FROM myfederated_schema.sales;</code></pre>
               <p>For more examples, see <a href="./federated_query_example.html">Examples of using a federated query</a>.</p>
            </li></ol></div>
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./getting-started-federated.html">Getting started with using federated queries to PostgreSQL</div><div id="next" class="next-link" accesskey="n" href="./getting-started-federated-mysql.html">Getting started with using federated queries to MySQL</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/getting-started-federated-CF.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/getting-started-federated-CF.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>