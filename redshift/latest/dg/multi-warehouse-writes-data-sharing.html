<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Sharing both read and write data within an AWS account or across accounts (preview) - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="multi-warehouse-writes-data-sharing" /><meta name="default_state" content="multi-warehouse-writes-data-sharing" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" /><meta name="description" content="For more information about setting up preview track, see either of the following:" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Database Developer Guide" /><meta name="abstract" content="Create and manage a data warehouse with Amazon Redshift, an enterprise-level, petabyte scale, fully managed data warehousing service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Database Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Database Developer Guide" /><meta id="panorama-serviceConsolePage" value="Sharing both read and write data within an AWS account or across accounts (preview)" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Sharing both read and write data within an AWS account or across accounts (preview) - Amazon Redshift</title><meta name="pdf" content="/pdfs/redshift/latest/dg/redshift-dg.pdf#multi-warehouse-writes-data-sharing" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,developer,sample data,database,database developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Database Developer Guide",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Sharing data across clusters in Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/datashare-overview.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Managing data sharing tasks",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/getting-started-datashare.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Sharing both read and write data within an AWS account or across accounts (preview)",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/getting-started-datashare.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/redshift/latest/dg/redshift-dg.pdf#multi-warehouse-writes-data-sharing" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Database Developer Guide</a></div><div id="page-toc-src"><a href="#within-account-writes-context">Read-only data sharing vs. data sharing for reads and writes</a><a href="#within-account-writes-share-prereqs">Prerequisites and usage notes</a><a href="#within-account-writes-share-producer">Sharing database objects for read and write access in a datashare as the 
                  producer database administrator</a><a href="#within-account-writes-share-grants-available">Permissions you can grant to datashares</a><a href="#within-account-writes-share-consumer-create-database">Enabling clusters or Serverless workgroups to query the datashare</a><a href="#within-account-writes-share-consumer-transactions">Writing to objects within a datashare</a><a href="#across-account-read-write-req">Requirements and limitations for datasharing in preview</a><a href="#within-account-writes-share-sql-statements">SQL statements supported</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="multi-warehouse-writes-data-sharing">Sharing both read and write data within an AWS account or across accounts (preview)</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><div class="table-container"><div class="table-contents"><table id="w323aac54c19c17b3">
      <tr>
        <td tabindex="-1"><em><b>This is prerelease documentation for the multi-data warehouse writes through data sharing feature for 
        Amazon Redshift, which is available in public preview in the PREVIEW_2023 track. The documentation and the feature are both subject to change. We recommend that you use this feature 
        only with test clusters, and not in production environments.
        For preview terms and conditions, see <em>Beta Service Participation</em> in <a href="https://aws.amazon.com/service-terms/" rel="noopener noreferrer" target="_blank"><span>AWS Service Terms</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.
        </b></em>
        </td>
      </tr>
    </table></div></div><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Multi-warehouse writes through data sharing is not currently available on ra3.xlplus clusters. To use this feature, create 
                 ra3.4xl clusters, ra3.16xl clusters, or Amazon Redshift Serverless workgroups with the preview track.</p></div></div><p>For more information about setting up preview track, see either of the following:</p><div class="itemizedlist">
                          
                          
                      <ul class="itemizedlist"><li class="listitem"><p>For Amazon Redshift Serverless preview: <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/serverless-workgroup-preview.html">Creating a preview workgroup</a></p></li><li class="listitem"><p>For Amazon Redshift provisioned clusters preview: <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-console.html#cluster-preview">Creating a preview cluster</a></p></li></ul></div><p>You can share database objects for both reads and writes across different Amazon Redshift clusters or Amazon Redshift Serverless workgroups within the 
               same AWS account, or from one AWS account to another. You can write data across regions as well. The procedures in this topic show how to set up data sharing. You can grant permissions such as 
               SELECT, INSERT, and UPDATE for different tables and USAGE and CREATE for different schemas. The data is live and available to all warehouses as soon as a write 
               transaction is committed. When sharing data across accounts, producer account administrators can choose whether or not these accounts get read-only access to the data. Additionally, producer 
               account administrators can determine whether or not specific namespaces or regions get read-only, read-and-write, or any access to the data. </p><p>The sections that follow show how to configure data sharing. The procedures assume you're working in a database in a provisioned 
               cluster or Amazon Redshift Serverless workgroup.</p>
               <h2 id="within-account-writes-context">Read-only data sharing vs. data sharing for reads and writes</h2>   
               <p>Previously, objects in datashares were read only in all circumstances. Writing to an object in a datashare is a new feature. Objects in datashares are only write-enabled when a producer 
                  specifically grants write privileges like INSERT or CREATE on objects to the datashare. Details follow in subsequent sections in this topic.</p>
               <p>If you're looking for the existing documentation for read-only datashares, that's available at <a href="https://docs.aws.amazon.com/redshift/latest/dg/datashare-overview.html">Sharing data across clusters in Amazon Redshift</a>.</p>
             
               <h2 id="within-account-writes-share-prereqs">Prerequisites and usage notes</h2> 
               <p><em>Isolation settings</em> – <b>Your database must be set to snapshot isolation.</b>  Databases created in the PREVIEW_2023 track are snapshot isolation by default. Isolation settings can be changed by using the ISOLATION keyword in 
                  the <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_DATABASE.html">CREATE DATABASE</a> or <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_ALTER_DATABASE.html">ALTER DATABASE</a> statements.</p>

            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Multi-warehouse writes through data sharing is not currently available on ra3.xlplus clusters. To use this feature, create 
                  ra3.4xl clusters, ra3.16xl clusters, or Amazon Redshift Serverless workgroups with the preview track.</p></div></div> 
             
               <h2 id="within-account-writes-share-producer">Sharing database objects for read and write access in a datashare as the 
                  producer database administrator</h2> 
               <p>To start data sharing, the administrator on the producer creates a datashare and adds objects to it:</p>
               <div class="procedure"><ol><li><p>The producer database owner or <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_superusers.html">superuser</a> creates a datashare. A datashare is a logical container of database objects, permissions, and consumers. (Consumers are clusters or Amazon Redshift Serverless namespaces in 
                     your account and other accounts.) Each datashare is associated with 
                     the database it's created in and only objects from that 
                     database can be added. The following command creates a datashare:</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE DATASHARE my_datashare [PUBLICACCESSIBLE = TRUE];</code></pre>
                     <p>Setting PUBLICACCESSIBLE = TRUE allows consumers to query your datashare from publicly accessible clusters and provisioned workgroups. Leave this out or explicitly 
                        set it to false if you do not want to allow it.</p>
                     <p>The datashare owner must grant USAGE on the schemas they want to add to the datashare. The GRANT command is new. It's used to grant various actions on the schema, including 
                        CREATE and USAGE. The schemas hold shared objects:</p>
                  
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE SCHEMA myshared_schema1;
CREATE SCHEMA myshared_schema2;
 
GRANT USAGE ON SCHEMA myshared_schema1 TO DATASHARE my_datashare;
GRANT CREATE, USAGE ON SCHEMA myshared_schema2 TO DATASHARE my_datashare;</code></pre> 
                     <p>Alternatively, the administrator can continue to run ALTER commands to add a schema to the datashare. Only USAGE permissions are granted when a 
                        schema is added this way.</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">ALTER DATASHARE my_datashare ADD SCHEMA myshared_schema1;</code></pre>
                  </li><li>
                     <p>After the administrator adds schemas, they can grant datashare permissions on objects in the schema. These can be both read and write permissions. The GRANT ALL sample shows how to grant all permissions.</p>
                     
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">GRANT SELECT, INSERT ON TABLE myshared_schema1.table1, myshared_schema1.table2, myshared_schema2.table1
TO DATASHARE my_datashare;
                     
GRANT ALL ON TABLE myshared_schema1.table4 TO DATASHARE my_datashare;</code></pre> 
                     <p>You can continue to run commands like ALTER DATASHARE to add tables. When 
                        you do, only SELECT permissions are granted on the objects added.</p>
               
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">ALTER DATASHARE my_datashare ADD TABLE myshared_schema1.table1, myshared_schema1.table2, myshared_schema2.table1;</code></pre>
            
                  </li><li><p>The administrator grants usage on the datashare to a specific namespace in the account. You can find the namespace ID as part of the ARN in the cluster details page, in the Amazon Redshift Serverless namespace details page, or by 
                     running the command <code class="code">SELECT current_namespace;</code>. For more information, see <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_CURRENT_NAMESPACE.html">CURRENT_NAMESPACE</a>.</p>
             
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">GRANT USAGE ON DATASHARE my_datashare TO NAMESPACE '86b5169f-012a-234b-9fbb-e2e24359e9a8';</code></pre>
    
                  </li></ol></div>
                
                  <h3 id="within-account-writes-share-producer-cross">Authorizing a datashare to be shared with another account</h3> 
                  <p>After creating a datashare on the producer and adding objects to it, you might want to share it with another AWS account. Authorizing a datashare for 
                     another account to use is a secondary security process that must be performed on the producer by a data-security administrator. It authorizes a datashare for 
                     consumption by the consumer account. You can authorize a datashare to another account for read-only purposes or for reads and writes. If authorized for writes, the 
                     account is allowed the write privileges granted to the datashare. If not, only the read privileges granted to the datashare are available. For more information on 
                     how to do this, see <a href="./within-account-writes-share-producer-authorize.html">Authorizing datashares for writes as the producer security administrator (preview)</a>.</p>
                
               
                
                  <h3 id="within-account-writes-share-consumer-cross">Associating a datashare from another account as the consumer</h3> 
                  <p>
                     If the datashare is sourced from another account, you must associated it with specific clusters or namespaces in your account before it can be used with those 
                     clusters or namespaces.  You can associate it with all namespaces in an account, all namespaces in specific regions in the account, or specific namespaces in the 
                     account.  You can choose whether or not a namespace is allowed read-only access or allowed read and write access. If associated for writes, the associated clusters 
                     and Serverless namespaces are allowed the write privileges granted to the datashare.  If not, only the read privileges granted to the datashare are available. 
                     For more information on how to do this, see <a href="within-account-writes-share-consumer-associate.html" rel="noopener noreferrer" target="_blank">Associating shared data as the consumer data security administrator (preview)</a>.</p>
                
               
             
               <h2 id="within-account-writes-share-grants-available">Permissions you can grant to datashares</h2> 
               <p>Different object types and various permissions you can grant to them in a data sharing context.</p>
               <p>Schemas:</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem"><p>USAGE</p></li><li class="listitem"><p>CREATE</p></li></ul></div>
               <p>Tables:</p>
               <div class="itemizedlist">
                   
                   
                   
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem"><p>SELECT</p></li><li class="listitem"><p>INSERT</p></li><li class="listitem"><p>UPDATE</p></li><li class="listitem"><p>DELETE</p></li><li class="listitem"><p>TRUNCATE</p></li><li class="listitem"><p>DROP</p></li><li class="listitem"><p>REFERENCES</p></li></ul></div>
               <p>Functions:</p>
               <div class="itemizedlist">
                   
               <ul class="itemizedlist"><li class="listitem"><p>EXECUTE</p></li></ul></div>
               
            
             
               <h2 id="within-account-writes-share-consumer-create-database">Enabling clusters or Serverless workgroups to query the datashare</h2> 
               <p>This step assumes the datashare is originating from another cluster or Amazon Redshift Serverless namespace in your account, or it is coming from another account and has 
                  been associated with the namespace you are using.</p>
               <div class="procedure"><ol><li><p>The consumer database administrator can create a database from the datashare.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE DATABASE my_ds_db [WITH PERMISSIONS] FROM DATASHARE my_datashare OF NAMESPACE 'abc123def';</code></pre>
                     <p>If you create a database WITH PERMISSIONS you can grant granular permissions on datashare objects to different users and roles. Without this, all users and roles 
                        granted USAGE permission on the datashare database are granted all permissions on all objects within the datashare database.</p>
                     
                  </li><li><p>The following shows how to grant permissions to a Redshift database user or role. You must be connected to a local database to run these 
                     statements. You cannot run these statements if you execute a USE command on the datashare database before running the grant statements.</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">GRANT USAGE ON DATABASE my_ds_db TO ROLE data_eng;
GRANT CREATE, USAGE ON SCHEMA my_ds_db.my_shared_schema TO ROLE data_eng;
GRANT ALL ON ALL TABLES IN SCHEMA my_ds_db.my_shared_schema TO ROLE data_eng;
 
GRANT USAGE ON DATABASE my_ds_db TO bi_user;
GRANT USAGE ON SCHEMA my_ds_db.my_shared_schema TO bi_user;
GRANT SELECT ON my_ds_db.my_shared_schema.table1 TO bi_user;</code></pre>
       </li></ol></div>
     
             
                  <h2 id="within-account-writes-share-consumer-transactions">Writing to objects within a datashare</h2> 
                  <p>There are two ways to write to objects within a datashare.</p>
                  <p><b>With the USE command, connecting to the local database</b></p>
                  <p>With this command, you can query a datashare's objects with two-part notation and run multi-statement transactions. You can only run multi-statement 
                     transactions within a single database.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">USE database_name;</code></pre>
                  <p>You can go back to using the database you’re connected to by running the RESET USE command.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">RESET USE;</code></pre>
                  
                  <p>Once you USE a database you can BEGIN a transaction in that database. You can't write to multiple databases within a 
                     single transaction.</p>
                  
                  <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>
                     If you run a USE command without first committing or ending the current transaction, the data warehouse will restart. Make sure to end or 
                     commit open transactions prior to running a USE statement.</p></div></div>
                  
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">USE database_name;    --set the context to the datashare database
 
INSERT INTO datashare_schema.table1 VALUES (1);
 
BEGIN; --start a transaction
 
INSERT INTO datashare_schema.table2 VALUES (1);
INSERT INTO datashare_schema.table3 VALUES (1);
 
COMMIT;  --end transaction; you can also use the END command.</code></pre>
                  <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You can't copy data from a parquet and ORC files to a datashare table.</p></div></div>
                  
                  <p><b>Connect to the datashares database directly via a Redshift JDBC, ODBC, or Python driver</b></p>
                  <p>If you connect to a datashare database directly, you can query the tables using two-part notation and run multi-statement transactions in the 
                     datashare database right away.</p>
                  
 
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">--connect to the datashare database via JDBC, ODBC, or the Python Driver
 
INSERT INTO datashare_schema.table1 VALUES (1);
 
BEGIN; --start a transaction
 
INSERT INTO datashare_schema.table2 VALUES (1);
INSERT INTO datashare_schema.table3 VALUES (1);
 
COMMIT;  -- end transaction; can also use the END command.</code></pre>
   
                  <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Running an INSERT INTO SELECT statement is supported, but to do so you must have INSERT permissions on all 
                     tables referenced in the query.</p></div></div>    
                  <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Support for connecting to datashare databases via the Data API is coming soon.</p></div></div>      
                 
                
               <h2 id="across-account-read-write-req">Requirements and limitations for datasharing in preview</h2>
              <p></p>
               <div class="itemizedlist">
                   
                   
                   
                   
       
    
   
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem"><p>You must be connected directly to a datashare database or run the USE command to write to datashares. However, we will soon enable the 
                     ability to do this with three-part notation.
                  </p></li><li class="listitem"><p>You must use Serverless workgroups, ra3.4xl clusters, or ra3.16xl clusters to use this feature. Support for ra3.xlplus clusters is planned.</p></li><li class="listitem"><p><em>Metadata Discovery</em> – When you're a consumer connected directly to a datashare database through the Redshift JDBC, ODBC, or Python 
                     drivers, you can view catalog data in the following ways:
                  </p>
                     <div class="itemizedlist">
                  
                         
                         
                         
                     <ul class="itemizedlist"><li class="listitem"><p>SQL <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SHOW.html">SHOW</a> commands.</p></li><li class="listitem"><p>Querying information_schema tables and views.</p></li><li class="listitem"><p>Querying <a href="https://docs.aws.amazon.com/redshift/latest/dg/svv_views.html">SVV metadata views</a>.</p></li></ul></div>
                  </li><li class="listitem"><p>You cannot connect to datashare databases via the Data API. Support for this will be coming soon.</p></li><li class="listitem"><p>Consumers cannot see the permissions granted to the datashares. We will be adding this soon.</p></li><li class="listitem"><p>For cross-account data sharing, both the producer and consumer cluster must be
                     encrypted.</p></li><li class="listitem"><p>Your database’s isolation level must be snapshot isolation in order to allow other Serverless workgroups and clusters to write to it.</p></li><li class="listitem"><p>Consumers writing to datashare objects will not trigger an auto analyze operation. As a result, the producer must manually run analyze after data is inserted into 
                     the table to have table statistics updated. Without this, query plans may not be optimal. </p></li></ul></div>
             
               <h2 id="within-account-writes-share-sql-statements">SQL statements supported</h2> 
               <p>These statements are supported for the public preview release of data sharing with writes:</p>
               <div class="itemizedlist">
                   
                   
                   
                   
                   
                   
                   
                   
                   
              
                   
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem"><p>BEGIN | START TRANSACTION</p></li><li class="listitem"><p>END | COMMIT | ROLLBACK</p></li><li class="listitem"><p>COPY without COMPUPDATE</p></li><li class="listitem"><p><span>{</span> CREATE | DROP }  SCHEMA</p></li><li class="listitem"><p><span>{</span>  CREATE | DROP | SHOW }  TABLE</p></li><li class="listitem"><p>CREATE  TABLE table_name AS</p></li><li class="listitem"><p>DELETE</p></li><li class="listitem"><p><span>{</span> GRANT | REVOKE } privilege_name  ON OBJECT_TYPE object_name TO consumer_user </p></li><li class="listitem"><p>INSERT</p></li><li class="listitem"><p>SELECT</p></li><li class="listitem"><p>INSERT INTO SELECT</p></li><li class="listitem"><p>TRUNCATE</p></li><li class="listitem"><p>UPDATE</p></li><li class="listitem"><p>Super data type columns</p></li></ul></div>
               
         
               <p><em>Unsupported statement types</em> – The following aren't supported:</p>
               <div class="itemizedlist">
                   
                   
                   
                   
                   
                   
        
               <ul class="itemizedlist"><li class="listitem"><p>Multi-statement queries to consumer warehouses when writing to producers.</p></li><li class="listitem"><p>Concurrency scaling queries writing from consumers to producers.</p></li><li class="listitem"><p>Auto-copy jobs writing from consumers to producers.</p></li><li class="listitem"><p>Streaming jobs writing from consumers to producers.</p></li><li class="listitem"><p>Consumers creating zero-ETL integration tables on producer clusters. For more information about zero-ETL integrations, 
                     see <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/zero-etl-using.html">Working with zero-ETL integrations</a>.</p></li><li class="listitem"><p>Writing to a table with an interleaved sort key.</p></li></ul></div>
               
            <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./data-sharing-within-account-CF.html">Managing data sharing with CloudFormation</div><div id="next" class="next-link" accesskey="n" href="./within-account-writes-share-producer-authorize.html">Authorizing datashares for writes as the producer security administrator (preview)</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/multi-warehouse-writes-data-sharing.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/multi-warehouse-writes-data-sharing.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>