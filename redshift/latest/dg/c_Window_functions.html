<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Window functions - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="c_Window_functions" /><meta name="default_state" content="c_Window_functions" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" /><meta name="description" content="Create analytic business queries more efficiently using the window functions for SQL that Amazon Redshift supports." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Database Developer Guide" /><meta name="abstract" content="Create and manage a data warehouse with Amazon Redshift, an enterprise-level, petabyte scale, fully managed data warehousing service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c_Window_functions.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c_Window_functions.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c_Window_functions.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c_Window_functions.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c_Window_functions.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c_Window_functions.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_Window_functions.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_Window_functions.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c_Window_functions.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c_Window_functions.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/c_Window_functions.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/c_Window_functions.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Database Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Database Developer Guide" /><meta id="panorama-serviceConsolePage" value="Window functions" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Window functions - Amazon Redshift</title><meta name="pdf" content="/pdfs/redshift/latest/dg/redshift-dg.pdf#c_Window_functions" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/c_Window_functions.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/c_Window_functions.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/c_Window_functions.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,developer,sample data,database,database developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Database Developer Guide",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "SQL reference",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "SQL functions reference",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/c_SQL_functions.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Window functions",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/c_SQL_functions.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/redshift/latest/dg/redshift-dg.pdf#c_Window_functions" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Database Developer Guide</a></div><div id="page-toc-src"><a href="#r_Window_function_synopsis">Window function syntax summary</a><a href="#r_Examples_order_by_WF">Unique ordering of data for window functions</a><a href="#r_Window_function_supported">Supported functions</a><a href="#r_Window_function_example">Sample table for window function examples
               </a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="c_Window_functions">Window functions</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>By using window functions, you can create analytic business queries
         more efficiently. Window functions operate on a partition or "window" of a result set, and
         return a value for every row in that window. In contrast, non-windowed functions perform
         their calculations with respect to every row in the result set. Unlike group functions that
         aggregate result rows, window functions retain all rows in the table expression. </p><p> The values returned are calculated by using values from the sets of rows in that
         window. For each row in the table, the window defines a set of rows that is used to compute
         additional attributes. A window is defined using a window specification (the OVER clause),
         and is based on three main concepts: </p><div class="itemizedlist">
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>
               <em>Window partitioning,</em> which forms groups of rows (PARTITION
               clause) </p>
         </li><li class="listitem">
            <p>
               <em>Window ordering</em>, which defines an order or sequence of rows
               within each partition (ORDER BY clause) </p>
         </li><li class="listitem">
            <p>
               <em>Window frames</em>, which are defined relative to each row to further
               restrict the set of rows (ROWS specification) </p>
         </li></ul></div><p>Window functions are the last set of operations performed in a query except for the
         final ORDER BY clause. All joins and all WHERE, GROUP BY, and HAVING clauses are completed
         before the window functions are processed. Therefore, window functions can appear only in
         the select list or ORDER BY clause. You can use multiple window functions within a single
         query with different frame clauses. You can also use window functions in other scalar
         expressions, such as CASE. </p>
         <h2 id="r_Window_function_synopsis">Window function syntax summary</h2>
         
         
         <p>Window functions follow a standard syntax, which is as follows.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><em>function</em> (<em>expression</em>) OVER (
[ PARTITION BY <em>expr_list</em> ]
[ ORDER BY <em>order_list</em> [ <em>frame_clause</em> ] ] )</code></pre>
         <p> Here, <em>function</em> is one of the functions described in this
            section.</p> 
         <p>The <em>expr_list</em> is as follows.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><em>expression</em> | <em>column_name</em> [, <em>expr_list</em> ]</code></pre>
         <p> The <em>order_list</em> is as follows. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><em>expression</em> | <em>column_name</em> [ ASC | DESC ] 
[ NULLS FIRST | NULLS LAST ]
[, <em>order_list</em> ]</code></pre>
         <p> The <em>frame_clause</em> is as follows. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">ROWS
<span>{</span> UNBOUNDED PRECEDING | <em>unsigned_value</em> PRECEDING | CURRENT ROW } |

<span>{</span> BETWEEN
<span>{</span> UNBOUNDED PRECEDING | <em>unsigned_value</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW}
AND
<span>{</span> UNBOUNDED FOLLOWING | <em>unsigned_value</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW }}</code></pre>
          
            <h3 id="r_Window_function_synopsis-arguments">Arguments</h3>
            
            
            <div class="variablelist">
                
                
                
                
                
                
                
                
                
            <dl>
                  <dt><span class="term">
                     <em>function</em>
                  </span></dt>
                  <dd>
                     <p>The window function. For details, see the individual function descriptions. </p>
                  </dd>
                
                  <dt><span class="term">OVER </span></dt>
                  <dd>
                     <p>The clause that defines the window specification. The OVER clause is
                        mandatory for window functions, and differentiates window functions from
                        other SQL functions. </p>
                  </dd>
                
                  <dt><span class="term">PARTITION BY <em>expr_list</em>
                  </span></dt>
                  <dd>
                     <p>(Optional) The PARTITION BY clause subdivides the result set into
                        partitions, much like the GROUP BY clause. If a partition clause is present,
                        the function is calculated for the rows in each partition. If no partition
                        clause is specified, a single partition contains the entire table, and the
                        function is computed for that complete table. </p>
                     <p>The ranking functions DENSE_RANK, NTILE, RANK, and ROW_NUMBER require a
                        global comparison of all the rows in the result set. When a PARTITION BY
                        clause is used, the query optimizer can run each aggregation in parallel by
                        spreading the workload across multiple slices according to the partitions.
                        If the PARTITION BY clause is not present, the aggregation step must be run serially on a single slice, which can have a significant negative
                        impact on performance, especially for large clusters.</p>
                     <p>Amazon Redshift doesn't support string literals in PARTITION BY clauses.</p>
                  </dd>
                
                  <dt><span class="term">ORDER BY <em>order_list</em>
                  </span></dt>
                  <dd>
                     <p>(Optional) The window function is applied to the rows within each
                        partition sorted according to the order specification in ORDER BY. This
                        ORDER BY clause is distinct from and completely unrelated to ORDER BY
                        clauses in the <em>frame_clause</em>. The ORDER BY
                        clause can be used without the PARTITION BY clause. </p>
                     <p>For ranking functions, the ORDER BY clause identifies the measures
                        for the ranking values. For aggregation functions, the partitioned rows must
                        be ordered before the aggregate function is computed for each frame. For
                        more about window function types, see <a href="./c_Window_functions.html">Window functions</a>.</p>
                     <p>Column identifiers or expressions that evaluate to column identifiers are
                        required in the order list. Neither constants nor constant expressions can
                        be used as substitutes for column names. </p>
                     <p>NULLS values are treated as their own group, sorted and ranked according
                        to the NULLS FIRST or NULLS LAST option. By default, NULL values are sorted
                        and ranked last in ASC ordering, and sorted and ranked first in DESC
                        ordering.</p>
                     <p>Amazon Redshift doesn't support string literals in ORDER BY clauses.</p>
                     <p> If the ORDER BY clause is omitted, the order of the rows is
                        nondeterministic. </p>
                     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>In any parallel system such as Amazon Redshift, when an ORDER BY clause
                           doesn't produce a unique and total ordering of the data, the order
                           of the rows is nondeterministic. That is, if the ORDER BY expression
                           produces duplicate values (a partial ordering), the return order of those
                           rows might vary from one run of Amazon Redshift to the next. In turn, window
                           functions might return unexpected or inconsistent results. For more
                           information, see <a href="#r_Examples_order_by_WF">Unique ordering of data for window
               functions</a>. </p></div></div>
                  </dd>
                
                  <dt><span class="term">
                     <em>column_name</em>
                  </span></dt>
                  <dd>
                     <p>Name of a column to be partitioned by or ordered by. </p>
                  </dd>
                
                  <dt><span class="term">ASC | DESC </span></dt>
                  <dd>
                     <p>Option that defines the sort order for the expression, as follows: </p>
                     <div class="itemizedlist">
                         
                         
                     <ul class="itemizedlist"><li class="listitem">
                           <p>ASC: ascending (for example, low to high for numeric values and 'A'
                              to 'Z' for character strings). If no option is specified, data is
                              sorted in ascending order by default.</p>
                        </li><li class="listitem">
                           <p>DESC: descending (high to low for numeric values; 'Z' to 'A' for
                              strings). </p>
                        </li></ul></div>
                  </dd>
                
                  <dt><span class="term">NULLS FIRST | NULLS LAST</span></dt>
                  <dd>
                     <p>Option that specifies whether NULLS should be ordered first, before
                        non-null values, or last, after non-null values. By default, NULLS are
                        sorted and ranked last in ASC ordering, and sorted and ranked first in DESC
                        ordering.</p>
                  </dd>
                
                  <dt><span class="term">
                     <em>frame_clause</em>
                  </span></dt>
                  <dd>
                     
                     <p>For aggregate functions, the frame clause further refines the set of rows
                        in a function's window when using ORDER BY. It enables you to include or
                        exclude sets of rows within the ordered result. The frame clause consists of
                        the ROWS keyword and associated
                        specifiers.</p>
                     <p>The frame clause doesn't apply to ranking functions. Also, the frame
                        clause isn't required when no ORDER BY clause is used in the OVER clause for
                        an aggregate function. If an ORDER BY clause is used for an aggregate
                        function, an explicit frame clause is required.</p>
                     <p>When no ORDER BY clause is specified, the implied frame is unbounded,
                        equivalent to ROWS BETWEEN UNBOUNDED PRECEDING AND
                        UNBOUNDED FOLLOWING. </p>
                  </dd>
                
                  <dt><span class="term">ROWS</span></dt>
                  <dd>
                     <p>This clause defines the window frame by specifying a
                        physical offset from the current
                        row.</p>
                     <p>This clause specifies the rows in the current window or partition that
                        the value in the current row is to be combined with. It uses arguments that
                        specify row position, which can be before or after the current row. The
                        reference point for all window frames is the current row. Each row becomes
                        the current row in turn as the window frame slides forward in the
                        partition.</p>
                     <p>The frame can be a simple set of rows up to and including the current
                        row.</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>UNBOUNDED PRECEDING | <em>offset</em> PRECEDING | CURRENT ROW}</code></pre>
                     <p>Or it can be a set of rows between two boundaries.</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">BETWEEN
<span>{</span> UNBOUNDED PRECEDING | <em>offset</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW }
AND
<span>{</span> UNBOUNDED FOLLOWING | <em>offset</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW }</code></pre>
                     <p>UNBOUNDED PRECEDING indicates that the window starts at the first row of
                        the partition; <em>offset</em> PRECEDING indicates that the
                        window starts a number of rows equivalent to the value of offset before the
                        current row. UNBOUNDED PRECEDING is the default.</p>
                     <p>CURRENT ROW indicates the window begins or ends at the current row. </p>
                     <p>UNBOUNDED FOLLOWING indicates that the window ends at the last row of the
                        partition; <em>offset</em> FOLLOWING indicates that the window
                        ends a number of rows equivalent to the value of offset after the current
                        row.</p>
                     <p><em>offset</em> identifies a physical
                        number of rows before or after the current row. In this case,
                        <em>offset</em> must be a constant that evaluates to a
                        positive numeric value. For example, 5 FOLLOWING ends the frame five rows
                        after the current row.</p>
                     
                     <p>Where BETWEEN is not specified, the frame is implicitly bounded by the
                        current row. For example, <code class="code">ROWS 5 PRECEDING</code> is equal to
                        <code class="code">ROWS BETWEEN 5 PRECEDING AND CURRENT ROW</code>. Also, <code class="code">ROWS
                           UNBOUNDED FOLLOWING</code> is equal to <code class="code">ROWS BETWEEN CURRENT ROW AND
                              UNBOUNDED FOLLOWING</code>.</p>
                     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You can't specify a frame in which the starting boundary is
                           greater than the ending boundary. For example, you can't specify any of
                           the following frames. </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">between 5 following and 5 preceding
between current row and 2 preceding
between 3 following and current row</code></pre></div></div>
                  </dd>
               </dl></div>
          
         
       
         <h2 id="r_Examples_order_by_WF">Unique ordering of data for window
               functions</h2>
         
         
         <p>If an ORDER BY clause for a window function doesn't produce a unique and
            total ordering of the data, the order of the rows is nondeterministic. If the ORDER BY
            expression produces duplicate values (a partial ordering), the return order of those
            rows can vary in multiple runs. In this case, window functions can also return
            unexpected or inconsistent results. </p>
         <p>For example, the following query returns different results over multiple runs.
            These different results occur because <code class="code">order by dateid</code> doesn't produce
            a unique ordering of the data for the SUM window function. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select dateid, pricepaid,
sum(pricepaid) over(order by dateid rows unbounded preceding) as sumpaid
from sales
group by dateid, pricepaid;

dateid | pricepaid |   sumpaid
--------+-----------+-------------
1827 |   1730.00 |     1730.00
1827 |    708.00 |     2438.00
1827 |    234.00 |     2672.00
...

select dateid, pricepaid,
sum(pricepaid) over(order by dateid rows unbounded preceding) as sumpaid
from sales
group by dateid, pricepaid;

dateid | pricepaid |   sumpaid
--------+-----------+-------------
1827 |    234.00 |      234.00
1827 |    472.00 |      706.00
1827 |    347.00 |     1053.00
...</code></pre>
         <p> In this case, adding a second ORDER BY column to the window function can solve
            the problem. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select dateid, pricepaid,
sum(pricepaid) over(order by dateid, pricepaid rows unbounded preceding) as sumpaid
from sales
group by dateid, pricepaid;

dateid | pricepaid | sumpaid
--------+-----------+---------
1827 |    234.00 |  234.00
1827 |    337.00 |  571.00
1827 |    347.00 |  918.00
...</code></pre>
       
         <h2 id="r_Window_function_supported">Supported functions</h2>
      <p>Amazon Redshift supports two types of window functions: aggregate and ranking.</p>
      <p>Following are the supported aggregate functions: </p>
      <div class="itemizedlist">
          
          
          
          
          
          
          
          
               
          
          
          
          
          
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><a href="./r_WF_AVG.html">AVG window function</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_COUNT.html">COUNT window function</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_CUME_DIST.html">CUME_DIST window function</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_DENSE_RANK.html">DENSE_RANK window function</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_first_value.html">FIRST_VALUE window function</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_LAG.html">LAG window function</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_last_value.html">LAST_VALUE window function</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_LEAD.html">LEAD window function</a> </p>
         </li><li class="listitem">
               <p><a href="./r_WF_LISTAGG.html">LISTAGG window function</a> </p>
            </li><li class="listitem">
            <p><a href="./r_WF_MAX.html">MAX window function</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_MEDIAN.html">MEDIAN window function</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_MIN.html">MIN window function</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_NTH.html">NTH_VALUE window function</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_PERCENTILE_CONT.html">PERCENTILE_CONT window function</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_PERCENTILE_DISC.html">PERCENTILE_DISC window function</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_RATIO_TO_REPORT.html">RATIO_TO_REPORT window function</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_STDDEV.html">STDDEV_SAMP and STDDEV_POP window functions</a> (STDDEV_SAMP and STDDEV are synonyms) </p>
         </li><li class="listitem">
            <p><a href="./r_WF_SUM.html">SUM window function</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_VARIANCE.html">VAR_SAMP and VAR_POP window functions</a> (VAR_SAMP and VARIANCE are synonyms)</p>
         </li></ul></div>
      <p>Following are the supported ranking functions: </p>
      <div class="itemizedlist">
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><a href="./r_WF_DENSE_RANK.html">DENSE_RANK window function</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_NTILE.html">NTILE window function</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_PERCENT_RANK.html">PERCENT_RANK window function</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_RANK.html">RANK window function</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_ROW_NUMBER.html">ROW_NUMBER window function</a></p>
         </li></ul></div>
       
         <h2 id="r_Window_function_example">Sample table for window function examples</h2>
         
         <p>You can find specific window function examples with each function
            description. Some of the examples use a table named WINSALES, which contains 11
            rows, as shown following.</p>
         <div class="table-container"><div class="table-contents"><table id="w323aac67c13c59c17b5"><thead>
                  <tr>
                     <th>SALESID </th>
                     <th>DATEID </th>
                     <th>SELLERID </th>
                     <th>BUYERID </th>
                     <th>QTY </th>
                     <th>QTY_SHIPPED </th>
                  </tr>
               </thead>
                  <tr>
                     <td tabindex="-1"> 30001 </td>
                     <td tabindex="-1"> 8/2/2003 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1">10 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 10001 </td>
                     <td tabindex="-1"> 12/24/2003 </td>
                     <td tabindex="-1"> 1 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1">10 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 10005 </td>
                     <td tabindex="-1"> 12/24/2003 </td>
                     <td tabindex="-1"> 1 </td>
                     <td tabindex="-1"> A </td>
                     <td tabindex="-1"> 30 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 40001 </td>
                     <td tabindex="-1"> 1/9/2004 </td>
                     <td tabindex="-1"> 4 </td>
                     <td tabindex="-1"> A </td>
                     <td tabindex="-1"> 40 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 10006 </td>
                     <td tabindex="-1"> 1/18/2004 </td>
                     <td tabindex="-1"> 1 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 20001 </td>
                     <td tabindex="-1"> 2/12/2004 </td>
                     <td tabindex="-1"> 2 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 20 </td>
                     <td tabindex="-1">20 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 40005 </td>
                     <td tabindex="-1"> 2/12/2004 </td>
                     <td tabindex="-1"> 4 </td>
                     <td tabindex="-1"> A </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1">10 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 20002 </td>
                     <td tabindex="-1"> 2/16/2004 </td>
                     <td tabindex="-1"> 2 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 20 </td>
                     <td tabindex="-1">20 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 30003 </td>
                     <td tabindex="-1"> 4/18/2004 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 15 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 30004 </td>
                     <td tabindex="-1"> 4/18/2004 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 20 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 30007 </td>
                     <td tabindex="-1"> 9/7/2004 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 30 </td>
                     <td tabindex="-1"> </td>
                  </tr>
               </table></div></div>
         <p>The following script creates and populates the sample WINSALES table.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE winsales(
  salesid int,
  dateid date,
  sellerid int,
  buyerid char(10),
  qty int,
  qty_shipped int);

INSERT INTO winsales VALUES
  (30001, '8/2/2003', 3, 'b', 10, 10),
  (10001, '12/24/2003', 1, 'c', 10, 10),
  (10005, '12/24/2003', 1, 'a', 30, null),	
  (40001, '1/9/2004', 4, 'a', 40, null),	
  (10006, '1/18/2004', 1, 'c', 10, null),	
  (20001, '2/12/2004', 2, 'b', 20, 20),
  (40005, '2/12/2004', 4, 'a', 10, 10),
  (20002, '2/16/2004', 2, 'c', 20, 20),
  (30003, '4/18/2004', 3, 'b', 15, null),
  (30004, '4/18/2004', 3, 'b', 20, null),	
  (30007, '9/7/2004', 3, 'c', 30, null);	 
</code></pre>
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_TO_VARBYTE.html">TO_VARBYTE</div><div id="next" class="next-link" accesskey="n" href="./r_WF_AVG.html">AVG</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/c_Window_functions.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/c_Window_functions.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>