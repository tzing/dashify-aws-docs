<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CREATE FUNCTION - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_CREATE_FUNCTION" /><meta name="default_state" content="r_CREATE_FUNCTION" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_FUNCTION.html" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Database Developer Guide" /><meta name="abstract" content="Create and manage a data warehouse with Amazon Redshift, an enterprise-level, petabyte scale, fully managed data warehousing service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_FUNCTION.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_FUNCTION.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Database Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Database Developer Guide" /><meta id="panorama-serviceConsolePage" value="CREATE FUNCTION" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>CREATE FUNCTION - Amazon Redshift</title><meta name="pdf" content="/pdfs/redshift/latest/dg/redshift-dg.pdf#r_CREATE_FUNCTION" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_CREATE_FUNCTION.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_CREATE_FUNCTION.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_CREATE_FUNCTION.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,developer,sample data,database,database developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Database Developer Guide",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "SQL reference",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "SQL commands",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "CREATE FUNCTION",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/c_SQL_commands.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/redshift/latest/dg/redshift-dg.pdf#r_CREATE_FUNCTION" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Database Developer Guide</a></div><div id="page-toc-src"><a href="#r_CREATE_FUNCTION-privileges">Required privileges</a><a href="#r_CREATE_FUNCTION-synopsis">Syntax</a><a href="#r_CREATE_FUNCTION-parameters">Parameters</a><a href="#r_CREATE_FUNCTION-usage-notes">Usage notes</a><a href="#r_CREATE_FUNCTION-examples">Examples</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="r_CREATE_FUNCTION">CREATE FUNCTION</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p> </p><p>Creates a new scalar user-defined function (UDF) using either a SQL SELECT clause or a
         Python program.</p><p>For more information and examples, see <a href="./user-defined-functions.html">Creating user-defined functions</a>.</p>
         <h2 id="r_CREATE_FUNCTION-privileges">Required privileges</h2>
         <p>Following are required privileges for CREATE FUNCTION:</p>
         <div class="itemizedlist">
             
             
         <ul class="itemizedlist"><li class="listitem"><p>For CREATE FUNCTION:</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem"><p>Superuser can use both trusted and untrusted languages to create functions.</p></li><li class="listitem"><p>Users with the CREATE [ OR REPLACE ] FUNCTION privilege can create functions with trusted languages.</p></li></ul></div>
            </li><li class="listitem"><p>For REPLACE FUNCTION:</p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem"><p>Superuser</p></li><li class="listitem"><p>Users with the CREATE [ OR REPLACE ] FUNCTION privilege</p></li><li class="listitem"><p>Function owner</p></li></ul></div>
            </li></ul></div>
       
         <h2 id="r_CREATE_FUNCTION-synopsis">Syntax</h2>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">CREATE [ OR REPLACE ] FUNCTION <em>f_function_name</em>
( <span>{</span> [<em>py_arg_name</em> <em> py_arg_data_type</em> |
<em>sql_arg_data_type</em> } [ , ... ] ] )
RETURNS <em>data_type</em>
<span>{</span> VOLATILE | STABLE | IMMUTABLE }
AS $$
  <span>{</span> <em>python_program</em> | <em>SELECT_clause</em> }
$$ LANGUAGE <span>{</span> plpythonu | sql }</code></pre>
       
         <h2 id="r_CREATE_FUNCTION-parameters">Parameters</h2>
         <div class="variablelist">
             
             
             
             
             
             
             
             
             
         <dl>
               <dt><span class="term">OR REPLACE</span></dt>
               <dd>
                  <p>Specifies that if a function with the same name and input argument data
                     types, or <em>signature</em>, as this one already exists, the
                     existing function is replaced. You can only replace a function with a new
                     function that defines an identical set of data types. You must be a superuser
                     to replace a function.</p>
                  <p>If you define a function with the same name as an existing function but a
                     different signature, you create a new function. In other words, the function
                     name is overloaded. For more information, see <a href="./udf-naming-udfs.html#udf-naming-overloading-function-names">Overloading function
               names</a>.</p>
               </dd>
             
               <dt><span class="term">
                  <em>f_function_name</em>
               </span></dt>
               <dd>
                  <p>The name of the function. If you specify a schema name (such as
                        <code class="code">myschema.myfunction</code>), the function is created using the
                     specified schema. Otherwise, the function is created in the current schema. For
                     more information about valid names, see <a href="./r_names.html">Names and identifiers</a>.</p>
                  <p>We recommend that you prefix all UDF names with <code class="code">f_</code>. Amazon Redshift
                     reserves the <code class="code">f_</code> prefix for UDF names, so by using the
                        <code class="code">f_</code> prefix, you ensure that your UDF name will not conflict with
                     any existing or future Amazon Redshift built-in SQL function names. For more
                     information, see <a href="./udf-naming-udfs.html">Naming UDFs</a>.</p>
                  <p>You can define more than one function with the same function name if the
                     data types for the input arguments are different. In other words, the function
                     name is overloaded. For more information, see <a href="./udf-naming-udfs.html#udf-naming-overloading-function-names">Overloading function
               names</a>.</p>
               </dd>
             
               <dt><span class="term">
                  <em>py_arg_name py_arg_data_type | sql_arg_data type</em>
               </span></dt>
               <dd>
                  <p>For a Python UDF, a list of input argument names and data types. For a SQL
                     UDF, a list of data types, without argument names. In a Python UDF, refer to
                     arguments using the argument names. In a SQL UDF, refer to arguments using $1,
                     $2, and so on, based on the order of the arguments in the argument list. </p>
                  <p>For a SQL UDF, the input and return data types can be any standard Amazon
                     Redshift data type. For a Python UDF, the input and return data types can be
                     SMALLINT, INTEGER, BIGINT, DECIMAL, REAL, DOUBLE PRECISION, BOOLEAN, CHAR,
                     VARCHAR, DATE, or TIMESTAMP.
                     
                     In addition, Python user-defined functions (UDFs) support a data type of ANYELEMENT. This is automatically
                     converted to a standard data type based on the data type of the corresponding
                     argument supplied at runtime. If multiple arguments use ANYELEMENT, they
                     all resolve to the same data type at runtime, based on the first ANYELEMENT
                     argument in the list. For more information, see <a href="./udf-data-types.html">Python UDF data types</a> and <a href="./c_Supported_data_types.html">Data types</a>.</p>

                  <p>You can specify a maximum of 32 arguments.</p>
               </dd>
             
               <dt><span class="term"> RETURNS <em>data_type</em>
               </span></dt>
               <dd>
                  <p>The data type of the value returned by the function. The RETURNS data type
                     can be any standard Amazon Redshift data type. In addition, Python UDFs can use a data
                     type of ANYELEMENT, which is automatically converted to a standard data type
                     based on the argument supplied at runtime. If you specify ANYELEMENT for the
                     return data type, at least one argument must use ANYELEMENT. The actual return
                     data type matches the data type supplied for the ANYELEMENT argument when the
                     function is called. For more information, see <a href="./udf-data-types.html">Python UDF data types</a>.</p>
               </dd>
             
               <dt><span class="term"> VOLATILE | STABLE | IMMUTABLE </span></dt>
               <dd>
                  <p>Informs the query optimizer about the volatility of the function. </p>
                  <p>You will get the best optimization if you label your function with the
                     strictest volatility category that is valid for it. However, if the category is
                     too strict, there is a risk that the optimizer will erroneously skip some
                     calls, resulting in an incorrect result set. In order of strictness, beginning
                     with the least strict, the volatility categories are as follows:</p>
                  <div class="itemizedlist">
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem">
                        <p>VOLATILE</p>
                     </li><li class="listitem">
                        <p>STABLE</p>
                     </li><li class="listitem">
                        <p>IMMUTABLE</p>
                     </li></ul></div>
                  
                  <p>VOLATILE</p>
                  <p>Given the same arguments, the function can return different results on
                     successive calls, even for the rows in a single statement. The query optimizer
                     can't make any assumptions about the behavior of a volatile function, so a
                     query that uses a volatile function must reevaluate the function for every
                     input row.</p>
                  <p>STABLE</p>
                  <p>Given the same arguments, the function is guaranteed to return the same
                     results for all rows processed within a single statement. The function can
                     return different results when called in different statements. This category
                     allows the optimizer to optimize multiple calls of the function within a single
                     statement to a single call for the statement. </p>
                  <p>IMMUTABLE</p>
                  <p>Given the same arguments, the function always returns the same result,
                     forever. When a query calls an <code class="code">IMMUTABLE</code> function with constant
                     arguments, the optimizer pre-evaluates the function.</p>
               </dd>
             
               <dt><span class="term">AS $$ <em>statement</em> $$</span></dt>
               <dd>
                  <p> A construct that encloses the statement to be run. The literal keywords
                        <code class="code">AS $$</code> and <code class="code">$$</code> are required. </p>
                  <p>Amazon Redshift requires you to enclose the statement in your function by using a
                     format called dollar quoting. Anything within the enclosure is passed exactly
                     as is. You don't need to escape any special characters because the
                     contents of the string are written literally. </p>
                  <p> With <em>dollar quoting, </em>you use a pair of
                     dollar signs ($$) to signify the start and the end of the
                     statement to run, as shown in the following example. </p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">$$ <code class="replaceable">my statement</code> $$</code></pre>
                  <p> Optionally, between the dollar signs in each pair, you can specify a string
                     to help identify the statement. The string that you use must be the same in
                     both the start and the end of the enclosure pairs. This string is
                     case-sensitive, and it follows the same constraints as an unquoted identifier
                     except that it can't contain dollar signs. The following example uses the
                     string <code class="code">test</code>. </p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">$test$ <code class="replaceable">my statement</code> $test$</code></pre>

                  <p>For more information about dollar quoting, see "Dollar-quoted String
                     Constants" under <a href="https://www.postgresql.org/docs/9.4/static/sql-syntax-lexical.html" rel="noopener noreferrer" target="_blank"><span>
                        Lexical Structure</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> in the PostgreSQL documentation. </p>
               </dd>
             
               <dt><span class="term"><em>python_program</em>
               </span></dt>
               <dd>
                  <p>A valid executable Python program that returns a value. The statement that
                     you pass in with the function must conform to indentation requirements as
                     specified in the <a href="https://www.python.org/dev/peps/pep-0008/#indentation" rel="noopener noreferrer" target="_blank"><span>Style Guide for
                        Python Code</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> on the Python website. For more information, see <a href="./udf-python-language-support.html">Python language support for UDFs</a>.</p>
               </dd>
             
               <dt><span class="term"><em>SQL_clause</em>
               </span></dt>
               <dd>
                  <p>A SQL SELECT clause.</p>
                  <p>The SELECT clause can't include any of the following types of
                     clauses:</p>
                  <div class="itemizedlist">
                      
                      
                      
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem">
                        <p>FROM</p>
                     </li><li class="listitem">
                        <p>INTO</p>
                     </li><li class="listitem">
                        <p>WHERE</p>
                     </li><li class="listitem">
                        <p>GROUP BY</p>
                     </li><li class="listitem">
                        <p>ORDER BY</p>
                     </li><li class="listitem">
                        <p>LIMIT</p>
                     </li></ul></div>
               </dd>
             
               <dt><span class="term">LANGUAGE <span>{</span> plpythonu | sql } </span></dt>
               <dd>
                  <p>For Python, specify <code class="code">plpythonu</code>. For SQL, specify
                        <code class="code">sql</code>. You must have permission for usage on language for SQL or
                     plpythonu. For more information, see <a href="./udf-security-and-privileges.html">UDF security and privileges</a>.</p>
               </dd>
            </dl></div>
       
         <h2 id="r_CREATE_FUNCTION-usage-notes">Usage notes</h2>
          
            <h3 id="r_CREATE_FUNCTION-usage-notes-nested-functions">Nested
                  functions</h3>
            <p>You can call another SQL user-defined function (UDF) from within a SQL UDF. The
               nested function must exist when you run the CREATE FUNCTION command. Amazon Redshift
               doesn't track dependencies for UDFs, so if you drop the nested function, Amazon Redshift
               doesn't return an error. However, the UDF will fail if the nested function
               doesn't exist. For example, the following function calls the <code class="code">f_sql_greater
               </code>function in the SELECT clause.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create function f_sql_commission (float, float )
  returns float
stable
as $$
  select f_sql_greater ($1, $2)
$$ language sql;</code></pre>
          
          
            <h3 id="r_CREATE_FUNCTION-usage-notes-security-and-privileges">UDF security
                  and privileges</h3>
            <p>To create a UDF, you must have permission for usage on language for SQL or
               plpythonu (Python). By default, USAGE ON LANGUAGE SQL is granted to PUBLIC. However,
               you must explicitly grant USAGE ON LANGUAGE PLPYTHONU to specific users or groups. </p>
            <p>To revoke usage for SQL, first revoke usage from PUBLIC. Then grant usage on SQL
               only to the specific users or groups permitted to create SQL UDFs. The following
               example revokes usage on SQL from PUBLIC then grants usage to the user group
                  <code class="code">udf_devs</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">revoke usage on language sql from PUBLIC;
grant usage on language sql to group udf_devs;</code></pre>
            <p>To run a UDF, you must have execute permission for each function. By default,
               execute permission for new UDFs is granted to PUBLIC. To restrict usage, revoke
               execute permission from PUBLIC for the function. Then grant the privilege to specific
               individuals or groups. </p>
            <p>The following example revokes execute permission on function
                  <code class="code">f_py_greater</code> from PUBLIC then grants usage to the user group
                  <code class="code">udf_devs</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">revoke execute on function f_py_greater(a float, b float) from PUBLIC;
grant execute on function f_py_greater(a float, b float) to group udf_devs;</code></pre>
            <p>Superusers have all privileges by default. </p>
            <p>For more information, see <a href="./r_GRANT.html">GRANT</a> and
                  <a href="./r_REVOKE.html">REVOKE</a>.</p>
          
       
         <h2 id="r_CREATE_FUNCTION-examples">Examples</h2>
          
            <h3 id="r_CREATE_FUNCTION-python-example">Scalar Python UDF example</h3>
            <p>The following example creates a Python UDF that compares two integers and returns
               the larger value.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create function f_py_greater (a float, b float)
  returns float
stable
as $$
  if a &gt; b:
    return a
  return b
$$ language plpythonu;</code></pre>
            <p>The following example queries the SALES table and calls the new
                  <code class="code">f_py_greater</code> function to return either COMMISSION or 20 percent of
               PRICEPAID, whichever is greater.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select f_py_greater (commission, pricepaid*0.20) from sales;</code></pre>
          
          
            <h3 id="r_CREATE_FUNCTION-sql-example">Scalar SQL UDF example</h3>
            <p>The following example creates a function that compares two numbers and returns the
               larger value. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create function f_sql_greater (float, float)
  returns float
stable
as $$
  select case when $1 &gt; $2 then $1
    else $2
  end
$$ language sql;</code></pre>
            <p>The following query calls the new <code class="code">f_sql_greater</code> function to query the
               SALES table and returns either COMMISSION or 20 percent of PRICEPAID, whichever is
               greater.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select f_sql_greater (commission, pricepaid*0.20) from sales;</code></pre>
          
         
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_CREATE_EXTERNAL_VIEW.html">CREATE EXTERNAL VIEW (preview)</div><div id="next" class="next-link" accesskey="n" href="./r_CREATE_GROUP.html">CREATE GROUP</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_CREATE_FUNCTION.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_CREATE_FUNCTION.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>