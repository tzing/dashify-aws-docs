<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>PERCENTILE_CONT function - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_PERCENTILE_CONT" /><meta name="default_state" content="r_PERCENTILE_CONT" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/r_PERCENTILE_CONT.html" /><meta name="description" content="An inverse distribution function that assumes a continuous distribution model. It takes a percentile value and a sort specification, and returns an interpolated value that would fall into that the given percentile value with respect to the sort specification." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Database Developer Guide" /><meta name="abstract" content="Create and manage a data warehouse with Amazon Redshift, an enterprise-level, petabyte scale, fully managed data warehousing service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/r_PERCENTILE_CONT.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_PERCENTILE_CONT.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Database Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Database Developer Guide" /><meta id="panorama-serviceConsolePage" value="PERCENTILE_CONT function" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>PERCENTILE_CONT function - Amazon Redshift</title><meta name="pdf" content="/pdfs/redshift/latest/dg/redshift-dg.pdf#r_PERCENTILE_CONT" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_PERCENTILE_CONT.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_PERCENTILE_CONT.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_PERCENTILE_CONT.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,developer,sample data,database,database developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Database Developer Guide",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "SQL reference",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "SQL functions reference",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/c_SQL_functions.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Aggregate functions",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/c_Aggregate_Functions.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "PERCENTILE_CONT function",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/c_Aggregate_Functions.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/redshift/latest/dg/redshift-dg.pdf#r_PERCENTILE_CONT" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Database Developer Guide</a></div><div id="page-toc-src"><a href="#r_PERCENTILE_CONT-synopsis">Syntax</a><a href="#r_PERCENTILE_CONT-arguments">Arguments</a><a href="#r_PERCENTILE_CONT-returns">Returns</a><a href="#r_PERCENTILE_CONT-usage-notes">Usage notes</a><a href="#r_PERCENTILE_CONT-examples">Examples</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="r_PERCENTILE_CONT">PERCENTILE_CONT function</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>PERCENTILE_CONT is an inverse distribution function that assumes a continuous
            distribution model. It takes a percentile value and a sort specification, and returns an
            interpolated value that would fall into the given percentile value with respect to the
            sort specification. </p><p>PERCENTILE_CONT computes a linear interpolation between values after ordering them.
            Using the percentile value <code class="code">(P)</code> and the number of not null rows
               <code class="code">(N)</code> in the aggregation group, the function computes the row number after
            ordering the rows according to the sort specification. This row number <code class="code">(RN)</code>
            is computed according to the formula <code class="code">RN = (1+ (P*(N-1))</code>. The final result
            of the aggregate function is computed by linear interpolation between the values from
            rows at row numbers <code class="code">CRN = CEILING(RN)</code> and <code class="code">FRN = FLOOR(RN)</code>. </p><p>The final result will be as follows.</p><p>If <code class="code">(CRN = FRN = RN)</code> then the result is <code class="code">(value of expression from
               row at RN)</code>
         </p><p>Otherwise the result is as follows:</p><p><code class="code">(CRN - RN) * (value of expression for row at FRN) + (RN - FRN) * (value of
               expression for row at CRN)</code>.</p><p>PERCENTILE_CONT is a compute-node only function. The
            function returns an error if the query doesn't reference a user-defined table or Amazon Redshift system
            table.</p>
            <h2 id="r_PERCENTILE_CONT-synopsis">Syntax</h2>


            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">PERCENTILE_CONT(<em>percentile</em>)
WITHIN GROUP(ORDER BY <em>expr</em>)</code></pre>
          
            <h2 id="r_PERCENTILE_CONT-arguments">Arguments</h2>


            <div class="variablelist">
                
                


            <dl>
                  <dt><span class="term">
                     <em>percentile</em>
                  </span></dt>
                  <dd>
                     <p>Numeric constant between 0 and 1. <code class="code">NULL</code> values are ignored in the
                        calculation.</p>
                  </dd>
                
                  <dt><span class="term"><em>expr</em></span></dt>
                  <dd>
                     <p>Specifies numeric or date/time values to sort and compute the percentile
                        over. </p>
                  </dd>
               </dl></div>
          
            <h2 id="r_PERCENTILE_CONT-returns">Returns</h2>

            <p>The return type is determined by the data type of the ORDER BY expression in the
               WITHIN GROUP clause. The following table shows the return type for each ORDER BY
               expression data type.</p>
            <div class="table-container"><div class="table-contents"><table id="w323aac67c13c13c35c21b5"><thead>
                     <tr>
                        <th>Input type</th>
                        <th>Return type</th>
                     </tr>
                  </thead>
                     <tr>
                        <td tabindex="-1"><code class="code">INT2</code>, <code class="code">INT4</code>, <code class="code">INT8</code>, <code class="code">NUMERIC</code>, <code class="code">DECIMAL</code></td>
                        <td tabindex="-1"><code class="code">DECIMAL</code></td>
                     </tr>
                     <tr>
                        <td tabindex="-1"><code class="code">FLOAT</code>, <code class="code">DOUBLE</code></td>
                        <td tabindex="-1"><code class="code">DOUBLE</code></td>
                     </tr>
                     <tr>
                        <td tabindex="-1"><code class="code">DATE</code></td>
                        <td tabindex="-1"><code class="code">DATE</code></td>
                     </tr>
                     <tr>
                        <td tabindex="-1"><code class="code">TIMESTAMP</code></td>
                        <td tabindex="-1"><code class="code">TIMESTAMP</code></td>
                     </tr>
                     <tr>
                        <td tabindex="-1"><code class="code">TIMESTAMPTZ</code></td>
                        <td tabindex="-1"><code class="code">TIMESTAMPTZ</code></td>
                     </tr>
                  </table></div></div>
          
               <h2 id="r_PERCENTILE_CONT-usage-notes">Usage notes</h2>

            <p>If the ORDER BY expression is a DECIMAL data type defined with the maximum
               precision of 38 digits, it is possible that PERCENTILE_CONT will return either an
               inaccurate result or an error. If the return value of the PERCENTILE_CONT function
               exceeds 38 digits, the result is truncated to fit, which causes a loss of precision..
               If, during interpolation, an intermediate result exceeds the maximum precision, a
               numeric overflow occurs and the function returns an error. To avoid these conditions,
               we recommend either using a data type with lower precision or casting the ORDER BY
               expression to a lower precision.</p>
            <p>If a statement includes multiple calls to sort-based aggregate functions (LISTAGG,
               PERCENTILE_CONT, or MEDIAN), they must all use the same ORDER BY values. Note that
               MEDIAN applies an implicit order by on the expression value. </p>
            <p>For example, the following statement returns an error. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql "><code class="userinput">SELECT TOP 10 salesid, SUM(pricepaid), 
PERCENTILE_CONT(0.6) WITHIN GROUP(ORDER BY salesid),
MEDIAN(pricepaid)
FROM sales 
GROUP BY salesid, pricepaid;</code>

<code class="computeroutput" copy="false">An error occurred when executing the SQL command:
SELECT TOP 10 salesid, SUM(pricepaid), 
PERCENTILE_CONT(0.6) WITHIN GROUP(ORDER BY salesid),
MEDIAN(pricepaid)
FROM sales 
GROUP BY salesid, pricepaid;

ERROR: within group ORDER BY clauses for aggregate functions must be the same</code></code></pre>
               <p>The following statement runs successfully. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql "><code class="userinput">SELECT TOP 10 salesid, SUM(pricepaid), 
PERCENTILE_CONT(0.6) WITHIN GROUP(ORDER BY salesid),
MEDIAN(salesid)
FROM sales 
GROUP BY salesid, pricepaid;</code></code></pre>
          
            <h2 id="r_PERCENTILE_CONT-examples">Examples</h2>
<p>The following examples use the TICKIT sample database. For more information, see <a href="./c_sampledb.html">Sample database</a>.</p>
            <p>The following example shows that PERCENTILE_CONT(0.5) produces the same results as MEDIAN. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql "><code class="userinput">SELECT TOP 10 DISTINCT sellerid, qtysold, 
PERCENTILE_CONT(0.5) WITHIN GROUP(ORDER BY qtysold),
MEDIAN(qtysold) 
FROM sales
GROUP BY sellerid, qtysold;</code>

<code class="computeroutput" copy="false">+----------+---------+-----------------+--------+
| sellerid | qtysold | percentile_cont | median |
+----------+---------+-----------------+--------+
|        2 |       2 |               2 |      2 |
|       26 |       1 |               1 |      1 |
|       33 |       1 |               1 |      1 |
|       38 |       1 |               1 |      1 |
|       43 |       1 |               1 |      1 |
|       48 |       2 |               2 |      2 |
|       48 |       3 |               3 |      3 |
|       77 |       4 |               4 |      4 |
|       85 |       4 |               4 |      4 |
|       95 |       2 |               2 |      2 |
+----------+---------+-----------------+--------+</code></code></pre>
<p>The following example finds PERCENTILE_CONT(0.5) and PERCENTILE_CONT(0.75) for the quantity sold for each sellerid in the SALES table.</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql "><code class="userinput">SELECT sellerid, 
PERCENTILE_CONT(0.5) WITHIN GROUP(ORDER BY qtysold) as pct_05,
PERCENTILE_CONT(0.75) WITHIN GROUP(ORDER BY qtysold) as pct_075
FROM sales
GROUP BY sellerid
ORDER BY sellerid
LIMIT 10;</code>

<code class="computeroutput" copy="false">+----------+--------+---------+
| sellerid | pct_05 | pct_075 |
+----------+--------+---------+
|        1 |    1.5 |    1.75 |
|        2 |      2 |    2.25 |
|        3 |      2 |       3 |
|        4 |      2 |       2 |
|        5 |      1 |     1.5 |
|        6 |      1 |       1 |
|        7 |    1.5 |    1.75 |
|        8 |      1 |       1 |
|        9 |      4 |       4 |
|       12 |      2 |    3.25 |
+----------+--------+---------+</code></code></pre>
<p>To verify the results of the previous query for the first sellerid, use the following example.</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql "><code class="userinput">SELECT qtysold 
FROM sales 
WHERE sellerid=1;</code>

<code class="computeroutput" copy="false">+---------+
| qtysold |
+---------+
|       2 |
|       1 |
+---------+</code></code></pre>
         <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_MIN.html">MIN</div><div id="next" class="next-link" accesskey="n" href="./r_STDDEV_functions.html">STDDEV_SAMP and STDDEV_POP </div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_PERCENTILE_CONT.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_PERCENTILE_CONT.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>