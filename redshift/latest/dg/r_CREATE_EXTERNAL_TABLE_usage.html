<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Usage notes - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_CREATE_EXTERNAL_TABLE_usage" /><meta name="default_state" content="r_CREATE_EXTERNAL_TABLE_usage" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" /><meta name="description" content="This topic contains usage notes for . You can't view details for Amazon Redshift Spectrum tables using the same resources that you use for standard Amazon Redshift tables, such as , , PG_CLASS, or information_schema. If your business intelligence or analytics tool doesn't recognize Redshift Spectrum external tables, configure your application to query" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Database Developer Guide" /><meta name="abstract" content="Create and manage a data warehouse with Amazon Redshift, an enterprise-level, petabyte scale, fully managed data warehousing service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Database Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Database Developer Guide" /><meta id="panorama-serviceConsolePage" value="Usage notes" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Usage notes - Amazon Redshift</title><meta name="pdf" content="/pdfs/redshift/latest/dg/redshift-dg.pdf#r_CREATE_EXTERNAL_TABLE_usage" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,developer,sample data,database,database developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Database Developer Guide",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "SQL reference",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "SQL commands",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "CREATE EXTERNAL TABLE",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Usage notes",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/redshift/latest/dg/redshift-dg.pdf#r_CREATE_EXTERNAL_TABLE_usage" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Database Developer Guide</a></div><div id="page-toc-src"><a href="#r_CETAS">CREATE EXTERNAL TABLE AS</a><a href="#r_CREATE_EXTERNAL_TABLE_usage-permissions">Permissions to create and
                  query external tables</a><a href="#r_CREATE_EXTERNAL_TABLE_usage-pseudocolumns">Pseudocolumns </a><a href="#r_CREATE_EXTERNAL_TABLE_usage-data-handling">Setting data handling options </a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="r_CREATE_EXTERNAL_TABLE_usage">Usage notes</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>This topic contains usage notes for <a href="./r_CREATE_EXTERNAL_TABLE.html">CREATE EXTERNAL TABLE</a>. You can't view 
            details for Amazon Redshift Spectrum tables using the same resources that you use for
            standard Amazon Redshift tables, such as <a href="./r_PG_TABLE_DEF.html">PG_TABLE_DEF</a>, 
            <a href="./r_STV_TBL_PERM.html">STV_TBL_PERM</a>, PG_CLASS, or information_schema. If your business
            intelligence or analytics tool doesn't recognize Redshift Spectrum external tables,
            configure your application to query <a href="./r_SVV_EXTERNAL_TABLES.html">SVV_EXTERNAL_TABLES</a> 
            and <a href="./r_SVV_EXTERNAL_COLUMNS.html">SVV_EXTERNAL_COLUMNS</a>.</p>
            <h2 id="r_CETAS">CREATE EXTERNAL TABLE AS</h2>
            <p>In some cases, you might run the CREATE EXTERNAL TABLE AS command on an AWS Glue Data
               Catalog, AWS Lake Formation external catalog, or Apache Hive metastore. In such cases, you use
               an AWS Identity and Access Management (IAM) role to create the external schema. This IAM role must have both
               read and write permissions on Amazon S3. </p>
            <p>If you use a Lake Formation catalog, the IAM role must have the permission to create table
               in the catalog. In this case, it must also have the data lake location permission on
               the target Amazon S3 path. This IAM role becomes the owner of the new AWS Lake Formation
               table.</p>
            <p>To ensure that file names are unique, Amazon Redshift uses the following format for the name
               of each file uploaded to Amazon S3 by default.</p>
            <p><code class="code"><code class="replaceable">&lt;date&gt;</code>_<code class="replaceable">&lt;time&gt;</code>_<code class="replaceable">&lt;microseconds&gt;</code>_<code class="replaceable">&lt;query_id&gt;</code>_<code class="replaceable">&lt;slice-number&gt;</code>_part_<code class="replaceable">&lt;part-number&gt;</code>.<code class="replaceable">&lt;format&gt;</code></code>.</p>
            <p> An example is
               <code class="code">20200303_004509_810669_1007_0001_part_00.parquet</code>.</p>
            <p>Consider the following when running the CREATE EXTERNAL TABLE AS command:</p>
            <div class="itemizedlist">
                
                
                
                
                
                
                
                
                
                
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>The Amazon S3 location must be empty.</p>
               </li><li class="listitem">
                  <p>Amazon Redshift only supports PARQUET and TEXTFILE formats when using the STORED AS
                     clause.</p>
               </li><li class="listitem">
                  <p>You don't need to define a column definition list. Column names and
                     column data types of the new external table are derived directly from the
                     SELECT query.</p>
               </li><li class="listitem">
                  <p>You don't need to define the data type of the partition column in the
                     PARTITIONED BY clause. If you specify a partition key, the name of this column
                     must exist in the SELECT query result. When having multiple partition columns,
                     their order in the SELECT query doesn't matter. Amazon Redshift uses their order
                     defined in the PARTITIONED BY clause to create the external table.</p>
               </li><li class="listitem">
                  <p>Amazon Redshift automatically partitions output files into partition folders based on
                     the partition key values. By default, Amazon Redshift removes partition columns from the
                     output files.</p>
               </li><li class="listitem">
                  <p>The LINES TERMINATED BY 'delimiter' clause isn't supported.</p>
               </li><li class="listitem">
                  <p>The ROW FORMAT SERDE 'serde_name' clause isn't supported.</p>
               </li><li class="listitem">
                  <p>The use of manifest files isn't supported. Thus, you can't define
                     the LOCATION clause to a manifest file on Amazon S3.</p>
               </li><li class="listitem">
                  <p>Amazon Redshift automatically updates the 'numRows' table property at the end
                     of the command.</p>
               </li><li class="listitem">
                  <p>The 'compression_type' table property only accepts
                     'none' or 'snappy' for the PARQUET file format.</p>
               </li><li class="listitem">
                  <p>Amazon Redshift doesn't allow the LIMIT clause in the outer SELECT query. Instead,
                     you can use a nested LIMIT clause.</p>
               </li><li class="listitem">
                  <p>You can use STL_UNLOAD_LOG to track the files that are written to Amazon S3 by
                     each CREATE EXTERNAL TABLE AS operation.</p>
               </li></ul></div>
          
            <h2 id="r_CREATE_EXTERNAL_TABLE_usage-permissions">Permissions to create and
                  query external tables</h2>
            <p>To create external tables, make sure that you're the owner of the external
               schema or a superuser. To transfer ownership of an external schema, use <a href="./r_ALTER_SCHEMA.html">ALTER SCHEMA</a>. The following example
               changes the owner of the <code class="code">spectrum_schema</code> schema to
               <code class="code">newowner</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">alter schema spectrum_schema owner to newowner;</code></pre>
            <p>To run a Redshift Spectrum query, you need the following permissions:</p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>Usage permission on the schema </p>
               </li><li class="listitem">
                  <p>Permission to create temporary tables in the current database </p>
               </li></ul></div>
            <p>The following example grants usage permission on the schema
                  <code class="code">spectrum_schema</code> to the <code class="code">spectrumusers</code> user group.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">grant usage on schema spectrum_schema to group spectrumusers;</code></pre>
            <p>The following example grants temporary permission on the database
                  <code class="code">spectrumdb</code> to the <code class="code">spectrumusers</code> user group. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">grant temp on database spectrumdb to group spectrumusers;</code></pre>
          
            <h2 id="r_CREATE_EXTERNAL_TABLE_usage-pseudocolumns">Pseudocolumns </h2>
            <p>By default, Amazon Redshift creates external tables with the pseudocolumns
                  <em>$path</em> and <em>$size</em>. Select these columns to
               view the path to the data files on Amazon S3 and the size of the data files for each
               row returned by a query. The <em>$path</em> and
                  <em>$size</em> column names must be delimited with double quotation
               marks. A <em>SELECT *</em> clause doesn't return the pseudocolumns .
               You must explicitly include the <em>$path</em> and
                  <em>$size</em> column names in your query, as the following example
               shows.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select "$path", "$size"
from spectrum.sales_part
where saledate = '2008-12-01';</code></pre>
            <p>You can disable creation of pseudocolumns for a session by setting the
                  <em>spectrum_enable_pseudo_columns</em> configuration parameter to
                  <em>false</em>. </p>
            <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Selecting <em>$size</em> or <em>$path</em> incurs
                  charges because Redshift Spectrum scans the data files in Amazon S3 to determine
                  the size of the result set. For more information, see
                  <a href="https://aws.amazon.com/redshift/pricing/" rel="noopener noreferrer" target="_blank"><span>Amazon Redshift Pricing</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></div></div>
          
            <h2 id="r_CREATE_EXTERNAL_TABLE_usage-data-handling">Setting data handling options </h2>
            <p>You can set table parameters to specify input handling for data being queried in external tables, including: </p>
            <div class="itemizedlist">
                
                
                
                
                

            <ul class="itemizedlist"><li class="listitem">
                  <p>Surplus characters in columns containing VARCHAR, CHAR, and string data. For more information, see the external table property <code class="code">surplus_char_handling</code>.</p>
               </li><li class="listitem">
                  <p>Invalid characters in columns containing VARCHAR, CHAR, and string data.
                     For more information, see the external table property <code class="code">invalid_char_handling</code>.</p>
               </li><li class="listitem">
                  <p>Replacement character to use when you specify REPLACE for the external table property <code class="code">invalid_char_handling</code>.</p>
               </li><li class="listitem">
                  <p>Cast overflow handling in columns containing integer and decimal data.
                     For more information, see the external table property <code class="code">numeric_overflow_handling</code>.</p>
               </li><li class="listitem">
                  
                  <p>Surplus_bytes_handling to specify input handling for surplus bytes in columns containing varbyte data.
                     For more information, see the external table property <code class="code">surplus_bytes_handling</code>.</p>
               </li></ul></div>

         <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_CREATE_EXTERNAL_TABLE.html">CREATE EXTERNAL TABLE</div><div id="next" class="next-link" accesskey="n" href="./r_CREATE_EXTERNAL_TABLE_examples.html">Examples</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_CREATE_EXTERNAL_TABLE_usage.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>