<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Vacuuming tables - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="t_Reclaiming_storage_space202" /><meta name="default_state" content="t_Reclaiming_storage_space202" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/t_Reclaiming_storage_space202.html" /><meta name="description" content="Vacuum tables whenever you have performed a significant number of deletes or updates." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Database Developer Guide" /><meta name="abstract" content="Create and manage a data warehouse with Amazon Redshift, an enterprise-level, petabyte scale, fully managed data warehousing service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/t_Reclaiming_storage_space202.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/t_Reclaiming_storage_space202.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Database Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Database Developer Guide" /><meta id="panorama-serviceConsolePage" value="Vacuuming tables" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Vacuuming tables - Amazon Redshift</title><meta name="pdf" content="/pdfs/redshift/latest/dg/redshift-dg.pdf#t_Reclaiming_storage_space202" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/t_Reclaiming_storage_space202.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/t_Reclaiming_storage_space202.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/t_Reclaiming_storage_space202.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,developer,sample data,database,database developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Database Developer Guide",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Loading data",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/t_Loading_data.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Vacuuming tables",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/t_Loading_data.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/redshift/latest/dg/redshift-dg.pdf#t_Reclaiming_storage_space202" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Database Developer Guide</a></div><div id="page-toc-src"><a href="#automatic-table-sort">Automatic table sort</a><a href="#automatic-table-delete">Automatic vacuum delete</a><a href="#vacuum-frequency">VACUUM frequency</a><a href="#vacuum-stages">Sort stage and merge stage</a><a href="#vacuum-sort-threshold">Vacuum threshold</a><a href="#vacuum-types">Vacuum types</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="t_Reclaiming_storage_space202">Vacuuming tables</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Amazon Redshift can automatically sort and perform a VACUUM DELETE operation on tables in the
         background. To clean up tables after a load or a series of incremental updates, you can
         also run the <a href="./r_VACUUM_command.html">VACUUM</a> command,
         either against the entire database or against individual tables.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Only users with the necessary table permissions can effectively vacuum a table. 
            If VACUUM is run
            without the necessary table permissions, the operation completes successfully but has no
            effect. For a list of valid table permissions to effectively run VACUUM, see
            <a href="./r_VACUUM_command.html">VACUUM</a>.</p><p>For this reason, we recommend vacuuming individual tables as needed. We also
            recommend this approach because vacuuming the entire database is potentially an
            expensive operation.</p></div></div>
         <h2 id="automatic-table-sort">Automatic table sort</h2>
      
      <p>Amazon Redshift automatically sorts data in the background to maintain table data in the order of
            its sort key. Amazon Redshift keeps track of your scan queries to determine which sections of the
            table will benefit from sorting. </p>
         <p>Depending on the load on the system, Amazon Redshift automatically initiates the sort. This
            automatic sort lessens the need to run the VACUUM command to keep data in sort key
            order. If you need data fully sorted in sort key order, for example after a large data load, then you
            can still manually run the VACUUM command. To determine whether your table will benefit by
            running VACUUM SORT, monitor the <code class="code">vacuum_sort_benefit</code> column in <a href="./r_SVV_TABLE_INFO.html">SVV_TABLE_INFO</a>. </p>
         <p>Amazon Redshift tracks scan queries that use the sort key on each table. Amazon Redshift estimates
            the maximum percentage of improvement in scanning and filtering of data for each table
            (if the table was fully sorted). This estimate is visible in the
               <code class="code">vacuum_sort_benefit</code> column in <a href="./r_SVV_TABLE_INFO.html">SVV_TABLE_INFO</a>. You can use this column, along with the
               <code class="code">unsorted</code> column, to determine when queries can benefit from manually
            running VACUUM SORT on a table. 
            The <code class="code">unsorted</code> column reflects the physical sort order of a table.

            
             The <code class="code">vacuum_sort_benefit</code> column specifies the impact of sorting a table by manually running VACUUM SORT.</p>
         <p>For example, consider the following query:</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">select "table", unsorted,vacuum_sort_benefit from svv_table_info order by 1;</code></pre>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">
 table | unsorted | vacuum_sort_benefit 
-------+----------+---------------------
 sales |    85.71 |                5.00
 event |    45.24 |               67.00
</code></pre>
         
         <p>For the table “sales”, even though the table is ~86% physically unsorted, the query performance impact from the table being 86% unsorted is only 5%.  
            This might be either because only a small portion of the table is accessed by queries, or very few queries accessed the table. 
            For the table “event”, the table is ~45% physically unsorted. But the query performance impact of 67% indicates that either a larger portion of the table was accessed by queries,
            or the number of queries accessing the table was large. The table "event" can potentially benefit from running VACUUM SORT.</p>
         
     
       
         <h2 id="automatic-table-delete">Automatic vacuum delete</h2>
      <p>When you perform a delete, the rows are marked for deletion, but not removed. Amazon Redshift
         automatically runs a VACUUM DELETE operation in the background based on the number of
         deleted rows in database tables. Amazon Redshift schedules the VACUUM DELETE to run during periods of
         reduced load and pauses the operation during periods of high load. </p>
      <div class="highlights"><h6>Topics</h6><ul><li><a href="#vacuum-frequency">VACUUM frequency</a></li><li><a href="#vacuum-stages">Sort stage and merge stage</a></li><li><a href="#vacuum-sort-threshold">Vacuum threshold</a></li><li><a href="#vacuum-types">Vacuum types</a></li><li><a href="./vacuum-managing-vacuum-times.html">Managing vacuum times</a></li></ul></div>
         <h2 id="vacuum-frequency">VACUUM frequency</h2>

         <p>You should vacuum as often as necessary to maintain consistent query performance.
            Consider these factors when determining how often to run your VACUUM command:</p>
         <div class="itemizedlist">
          
             
             
             
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>Run VACUUM during time periods when you expect minimal activity on the cluster,
                  such as evenings or during designated database administration windows. </p>
            </li><li class="listitem">
               <p>Run VACUUM commands outside of maintenance windows. For more information, 
                  see <a href="https://docs.aws.amazon.com/redshift/latest/dg/c_best-practices-avoid-maintenance.html">Schedule around maintenance windows</a>.</p>
            </li><li class="listitem">
               <p>A large unsorted region results in longer vacuum times. If you delay vacuuming,
                  the vacuum will take longer because more data has to be reorganized. </p>
            </li><li class="listitem">
               <p>VACUUM is an I/O intensive operation, so the longer it takes for your vacuum to
                  complete, the more impact it will have on concurrent queries and other database
                  operations running on your cluster. </p>
            </li><li class="listitem">
               <p>VACUUM takes longer for tables that use interleaved sorting. To evaluate
                  whether interleaved tables must be re-sorted, query the <a href="./r_SVV_INTERLEAVED_COLUMNS.html">SVV_INTERLEAVED_COLUMNS</a>
                  view.</p>
            </li></ul></div>
       
         <h2 id="vacuum-stages">Sort stage and merge stage</h2>

         <p>Amazon Redshift performs a vacuum operation in two stages: first, it sorts the rows in the
            unsorted region, then, if necessary, it merges the newly sorted rows at the end of the
            table with the existing rows. When vacuuming a large table, the vacuum operation
            proceeds in a series of steps consisting of incremental sorts followed by merges. If the
            operation fails or if Amazon Redshift goes offline during the vacuum, the partially vacuumed
            table or database will be in a consistent state, but you must manually restart the
            vacuum operation. Incremental sorts are lost, but merged rows that were committed before
            the failure do not need to be vacuumed again. If the unsorted region is large, the lost
            time might be significant. For more information about the sort and merge stages, see
               <a href="./vacuum-managing-volume-of-unmerged-rows.html">Managing the volume of
                  merged rows</a>.</p>
         <p>Users can access tables while they are being vacuumed. You can perform queries and
            write operations while a table is being vacuumed, but when DML and a vacuum run
            concurrently, both might take longer. If you run UPDATE and DELETE statements during
            a vacuum, system performance might be reduced. Incremental merges temporarily block
            concurrent UPDATE and DELETE operations, and UPDATE and DELETE operations in turn
            temporarily block incremental merge steps on the affected tables. DDL operations, such
            as ALTER TABLE, are blocked until the vacuum operation finishes with the table.</p>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Various modifiers to VACUUM control the way that it works. You can use them to tailor the
               vacuum operation for the current need. For example, using VACUUM RECLUSTER shortens
               the vacuum operation by not performing a full merge operation. For more information,
               see <a href="./r_VACUUM_command.html">VACUUM</a>.</p></div></div>
       
         <h2 id="vacuum-sort-threshold">Vacuum threshold</h2>

         <p>By default, VACUUM skips the sort phase for any table where more than 95 percent of
            the table's rows are already sorted. Skipping the sort phase can significantly improve
            VACUUM performance. To change the default sort threshold for a single table, include the
            table name and the TO <em>threshold</em> PERCENT parameter when you run the
            VACUUM command. </p>
       
         <h2 id="vacuum-types">Vacuum types</h2>

         <p>For information about different vacuum types, see <a href="./r_VACUUM_command.html">VACUUM</a>.</p>
   
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./c_check_last_analyze.html">ANALYZE command history</div><div id="next" class="next-link" accesskey="n" href="./vacuum-managing-vacuum-times.html">Managing vacuum times</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/t_Reclaiming_storage_space202.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/t_Reclaiming_storage_space202.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>