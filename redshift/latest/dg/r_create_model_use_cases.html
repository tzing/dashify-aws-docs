<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Use cases - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_create_model_use_cases" /><meta name="default_state" content="r_create_model_use_cases" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/r_create_model_use_cases.html" /><meta name="description" content="Information about the various cases of CREATE MODEL." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Database Developer Guide" /><meta name="abstract" content="Create and manage a data warehouse with Amazon Redshift, an enterprise-level, petabyte scale, fully managed data warehousing service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/redshift/latest/dg/r_create_model_use_cases.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_create_model_use_cases.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_create_model_use_cases.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_create_model_use_cases.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_create_model_use_cases.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_create_model_use_cases.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_create_model_use_cases.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_create_model_use_cases.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_create_model_use_cases.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_create_model_use_cases.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_create_model_use_cases.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_create_model_use_cases.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_create_model_use_cases.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_create_model_use_cases.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_create_model_use_cases.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_create_model_use_cases.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_create_model_use_cases.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_create_model_use_cases.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_create_model_use_cases.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_create_model_use_cases.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_create_model_use_cases.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_create_model_use_cases.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Database Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Database Developer Guide" /><meta id="panorama-serviceConsolePage" value="Use cases" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Use cases - Amazon Redshift</title><meta name="pdf" content="/pdfs/redshift/latest/dg/redshift-dg.pdf#r_create_model_use_cases" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_create_model_use_cases.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_create_model_use_cases.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_create_model_use_cases.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,developer,sample data,database,database developer,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Database Developer Guide",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "SQL reference",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "SQL commands",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "CREATE MODEL",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_MODEL.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Use cases",
        "item" : "https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_MODEL.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/redshift/latest/dg/redshift-dg.pdf#r_create_model_use_cases" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Database Developer Guide</a></div><div id="page-toc-src"><a href="#r_simple_create_model">Simple CREATE MODEL </a><a href="#r_user_guidance_create_model">CREATE MODEL with user guidance</a><a href="#r_auto_off_create_model">CREATE XGBoost models with AUTO OFF</a><a href="#r_byom_create_model">Bring your own model (BYOM) - local inference</a><a href="#r_byom_create_model_remote">Bring your own model (BYOM) - remote inference</a><a href="#r_k-means_create_model">CREATE MODEL with K-MEANS</a><a href="#r_forecast_model">CREATE MODEL with Forecast</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="r_create_model_use_cases">Use cases</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>The following use cases demonstrate how to use CREATE MODEL to suit your needs.</p>
        <h2 id="r_simple_create_model">Simple CREATE MODEL</h2>
        <p>The following summarizes the basic options of the CREATE MODEL syntax.</p>

        

         
            <h3 id="r_simple-create-model-synposis">Simple CREATE MODEL syntax</h3>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE MODEL <em>model_name</em>
    FROM <span>{</span> <em>table_name</em> | ( <em>select_query</em> ) }
    TARGET <em>column_name</em>
    FUNCTION <em>prediction_function_name</em>
    IAM_ROLE <span>{</span> default }
    SETTINGS (
      S3_BUCKET <em>'bucket'</em>,
      [ MAX_CELLS integer ]
    )</code></pre>
         

         
            <h3 id="r_simple-create-model-parameters">Simple CREATE MODEL parameters</h3>
            <div class="variablelist">
                 
                 
                 
                 
                 
                 
                 
            <dl>
                    <dt><span class="term">
                        <em>model_name</em>
                    </span></dt>
                    <dd>
                        <p>The name of the model. The model name in a schema must be unique.</p>
                    </dd>
                 
                    <dt><span class="term">FROM <span>{</span> <em>table_name</em> | ( <em>select_query</em> ) }</span></dt>
                    <dd>
                        <p>The table_name or the query that specifies the training data. They can
                            either be an existing table in the system, or an Amazon Redshift-compatible SELECT
                            query enclosed with parentheses, that is (). There must be at least two
                            columns in the query result.  </p>
                    </dd>
                 
                    <dt><span class="term">TARGET <em>column_name</em></span></dt>
                    <dd>
                        <p>The name of the column that becomes the prediction target. The column must exist in the FROM clause. </p>
                    </dd>
                 
                    <dt><span class="term">FUNCTION <em>prediction_function_name</em>
                    </span></dt>
                    <dd>
                        <p>A value that specifies the name of the Amazon Redshift machine learning function to be
                            generated by the CREATE MODEL and used to make predictions using this model.
                            The function is created in the same schema as the model object and can be
                            overloaded.</p>
                        <p>Amazon Redshift machine learning supports models, such as Xtreme Gradient Boosted tree (XGBoost) models for regression and classification.</p>
                    </dd>
                 
                   <dt><span class="term">IAM_ROLE <span>{</span> default | 'arn:aws:iam::&lt;account-id&gt;:role/&lt;role-name&gt;' }</span></dt>
                    <dd>
                        <p> Use the default keyword to have Amazon Redshift use the IAM role that
                            is set as default and associated with the cluster when the CREAT MODEL
                            command runs. Alternatively, you can specify the ARN of an IAM role to use that role.</p>
                    </dd>
                 
                    <dt><span class="term">
                        <em>S3_BUCKET <em>'bucket'</em></em>
                    </span></dt>
                    <dd>
                        <p>The name of the Amazon S3 bucket that you previously created used to share training
                            data and artifacts between Amazon Redshift and SageMaker. Amazon Redshift creates a subfolder in
                            this bucket prior to unload of the training data. When training is complete,
                            Amazon Redshift deletes the created subfolder and its contents. </p>
                    </dd>
                 
                    <dt><span class="term">MAX_CELLS integer
                    </span></dt>
                    <dd>
                        <p>The maximum number of cells to export from the FROM clause. The default is
                            1,000,000. </p>
                        <p>The number of cells is the product of the number of rows in the training
                            data (produced by the FROM clause table or query) times the number of columns.
                            If the number of cells in the training data are more than that specified by the
                            max_cells parameter, CREATE MODEL downsamples the FROM clause training data to
                            reduce the size of the training set below MAX_CELLS. Allowing larger training
                            datasets can produce higher accuracy but also can mean the model takes longer
                            to train and costs more.</p>
                        <p>For information about costs of using Amazon Redshift, see <a href="./cost.html">Costs for using Amazon Redshift ML</a>.</p>
                        <p>For more information about costs associated with various cell numbers and free trial details, see <a href="https://aws.amazon.com/redshift/pricing" rel="noopener noreferrer" target="_blank"><span>Amazon Redshift pricing</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
                    </dd>
                </dl></div>
         
     
        <h2 id="r_user_guidance_create_model">CREATE MODEL with user guidance</h2>
        <p>Following, you can find a description of options for CREATE MODEL in addition to the
            options described in <a href="#r_simple_create_model">Simple CREATE MODEL</a>.</p>
        <p>By default, CREATE MODEL searches for the best combination of preprocessing and model
            for your specific dataset. You might want additional control or introduce additional domain
            knowledge (such as problem type or objective) over your model. In a customer churn
            scenario, if the outcome “customer is not active” is rare, then the F1 objective is often
            preferred to the accuracy objective. Because high accuracy models might predict “customer
            is active” all the time, this results in high accuracy but little business value. For
            information about F1 objective, see <a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_AutoMLJobObjective.html">AutoMLJobObjective</a> in the <em>Amazon SageMaker API Reference</em>.</p>
        <p>Then the CREATE MODEL follows your suggestions on the specified aspects, such as the
            objective. At the same time, the CREATE MODEL automatically discovers the best
            preprocessors and the best hyperparameters. </p>


         
            <h3 id="r_user_guidance-create-model-synposis">CREATE MODEL with user guidance syntax</h3>
            <p>CREATE MODEL offers more flexibility on the aspects that you can specify and the aspects that Amazon Redshift automatically discovers.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE MODEL <em>model_name</em>
    FROM <span>{</span> <em>table_name</em> | ( <em>select_statement</em> ) }
    TARGET <em>column_name</em>
    FUNCTION <em>function_name</em>
    IAM_ROLE <span>{</span> default }
    [ MODEL_TYPE <span>{</span> XGBOOST | MLP | LINEAR_LEARNER} ]
    [ PROBLEM_TYPE ( REGRESSION | BINARY_CLASSIFICATION | MULTICLASS_CLASSIFICATION ) ]
    [ OBJECTIVE ( 'MSE' | 'Accuracy' | 'F1' | 'F1Macro' | 'AUC') ]
    SETTINGS (
      S3_BUCKET 'bucket', |
      S3_GARBAGE_COLLECT <span>{</span> ON | OFF }, |
      KMS_KEY_ID 'kms_key_id', |
      MAX_CELLS integer, |
      MAX_RUNTIME integer (, ...)
    )   </code></pre>
         

         
            <h3 id="r_user_guidance-create-model-parameters">CREATE MODEL with user guidance parameters</h3>
            <div class="variablelist">
                 
                 
                 
                 
                 
                 
                 

                 
            <dl>
                    <dt><span class="term">
                        <em>MODEL_TYPE <span>{</span> XGBOOST | MLP | LINEAR_LEARNER }</em>
                    </span></dt>
                    <dd>
                        <p>(Optional) Specifies the model type. You can specify if you want to train a model of a specific model type, such as XGBoost, multilayer perceptron (MLP), or Linear Learner, which are all algorithms that Amazon SageMaker Autopilot supports. If you don't specify the parameter, then all supported model types are searched during training for the best model.</p>
                    </dd>
                 
                    <dt><span class="term">
                        <em>PROBLEM_TYPE ( REGRESSION | BINARY_CLASSIFICATION | MULTICLASS_CLASSIFICATION )</em>
                    </span></dt>
                    <dd>
                        <p>(Optional) Specifies the problem type. If you know the problem type, you
                            can restrict Amazon Redshift to only search of the best model of that specific model
                            type. If you don't specify this parameter, a problem type is discovered
                            during the training, based on your data.</p>
                    </dd>
                 
                    <dt><span class="term">OBJECTIVE ( 'MSE' | 'Accuracy' | 'F1' | 'F1Macro' | 'AUC')</span></dt>
                    <dd>
                        <p>(Optional) Specifies the name of the objective metric used to measure the
                            predictive quality of a machine learning system. This metric is optimized
                            during training to provide the best estimate for model parameter values from
                            data. If you don't specify a metric explicitly, the default behavior is to
                            automatically use MSE: for regression, F1: for binary classification, Accuracy:
                            for multiclass classification. For more information about objectives, see
                            <a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_AutoMLJobObjective.html">AutoMLJobObjective</a> in the
                            <em>Amazon SageMaker API Reference</em>.</p>
                    </dd>
                 
                    <dt><span class="term">MAX_CELLS integer
                    </span></dt>
                    <dd>
                        <p>(Optional) Specifies the number of cells in the training data. This value
                            is the product of the number of records (in the training query or table) times
                            the number of columns. The default is 1,000,000.</p>
                    </dd>
                 
                    <dt><span class="term">MAX_RUNTIME integer </span></dt>
                    <dd>
                        <p>(Optional) Specifies the maximum amount of time to train. Training jobs
                            often complete sooner depending on dataset size. This specifies the maximum
                            amount of time the training should take. The default is 5,400 (90
                            minutes).</p>
                    </dd>
                 
                    <dt><span class="term">S3_GARBAGE_COLLECT <span>{</span> ON | OFF }</span></dt>
                    <dd>
                        <p>(Optional) Specifies whether Amazon Redshift performs garbage collection on the
                            resulting datasets used to train models and the models. If set to OFF, the
                            resulting datasets used to train models and the models remains in Amazon S3 and can
                            be used for other purposes. If set to ON, Amazon Redshift deletes the artifacts in
                            Amazon S3 after the training completes. The default is ON.</p>
                    </dd>
                 
                    <dt><span class="term">KMS_KEY_ID  'kms_key_id'</span></dt>
                    <dd>
                        <p>(Optional) Specifies if Amazon Redshift uses server-side encryption with an
                            AWS KMS key to protect data at rest. Data in transit is protected with Secure
                            Sockets Layer (SSL). </p>
                    </dd>
                 
                    <dt><span class="term">
                        <em>PREPROCESSORS 'string' </em>
                    </span></dt>
                    <dd>
                        <p>(Optional) Specifies certain combinations of preprocessors to certain
                            sets of columns. The format is a list of columnSets, and the appropriate
                            transforms to be applied to each set of columns. Amazon Redshift applies all the
                            transformers in a specific transformers list to all columns in the
                            corresponding ColumnSet. For example, to apply OneHotEncoder with Imputer to
                            columns t1 and t2, use the sample command following.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE MODEL customer_churn
FROM customer_data
TARGET 'Churn'
FUNCTION predict_churn
IAM_ROLE <span>{</span> default | 'arn:aws:iam::&lt;account-id&gt;:role/&lt;role-name&gt;' }
PROBLEM_TYPE BINARY_CLASSIFICATION
OBJECTIVE 'F1'
PREPROCESSORS '[
...
<span>{</span>"ColumnSet": [
    "t1",
    "t2"
  ],
  "Transformers": [
    "OneHotEncoder",
    "Imputer"
  ]
},
<span>{</span>"ColumnSet": [
    "t3"
  ],
  "Transformers": [
    "OneHotEncoder"
  ]
},
<span>{</span>"ColumnSet": [
    "temp"
  ],
  "Transformers": [
    "Imputer",
    "NumericPassthrough"
  ]
}
]'
SETTINGS (
S3_BUCKET 'bucket'
)</code></pre></dd></dl></div>
            <p>Amazon Redshift supports the following transformers:</p>
            <div class="itemizedlist">

                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem"><p>OneHotEncoder – Typically used to encode a discrete value into a binary vector with one
                    nonzero value. This transformer is suitable for many machine learning
                    models.
                    
                </p></li><li class="listitem"><p>OrdinalEncoder – Encodes discrete values into a single integer. This transformer is
                    suitable for certain machine learning models, such as MLP and Linear Learner.
                    </p></li><li class="listitem"><p>NumericPassthrough – Passes input as is into the model.</p></li><li class="listitem"><p>Imputer – Fills in missing values and not a number (NaN) values.</p></li><li class="listitem"><p>ImputerWithIndicator – Fills in missing values and NaN values. This transformer also
                    creates an indicator of whether any values were missing and filled in.</p></li><li class="listitem"><p>Normalizer – Normalizes values, which can improve the performance of many machine
                    learning algorithms.</p></li><li class="listitem"><p>DateTimeVectorizer – Creates a vector embedding, representing a column of datetime data
                    type that can be used in machine learning models.</p></li><li class="listitem"><p>PCA – Projects the data into a lower dimensional space to reduce the number of features
                    while keeping as much information as possible.</p></li><li class="listitem"><p>StandardScaler – Standardizes features by removing the mean and scaling to unit variance.
                </p></li><li class="listitem"><p>MinMax – Transforms features by scaling each feature to a given range.</p></li></ul></div>

            <p>Amazon Redshift ML stores the trained transformers, and automatically applies them as
                part of the prediction query. You don't need to specify them when generating
                predictions from your model. </p>
         
     
        <h2 id="r_auto_off_create_model">CREATE XGBoost models with AUTO OFF</h2>
        <p>The AUTO OFF CREATE MODEL has generally different objectives from the default CREATE MODEL.</p>
        <p>As an advanced user who already knows the model type that you want and
            hyperparameters to use when training these models, you can use CREATE MODEL with AUTO
            OFF to turn off the CREATE MODEL automatic discovery of preprocessors and
            hyperparameters. To do so, you explicitly specify the model type. XGBoost is currently
            the only model type supported when AUTO is set to OFF. You can specify hyperparameters.
            Amazon Redshift uses default values for any hyperparameters that you specified.
            
        </p>

         
            <h3 id="r_auto_off-create-model-synposis">CREATE XGBoost models with AUTO
                    OFF syntax</h3>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE MODEL model_name
    FROM <span>{</span> <em>table_name</em> | (<em>select_statement</em> ) }
    TARGET <em>column_name</em>
    FUNCTION <em>function_name</em>
    IAM_ROLE <span>{</span> default }
    AUTO OFF
    MODEL_TYPE XGBOOST
    OBJECTIVE <span>{</span> 'reg:squarederror' | 'reg:squaredlogerror' | 'reg:logistic' |
                'reg:pseudohubererror' | 'reg:tweedie' | 'binary:logistic' | 'binary:hinge' |
                'multi:softmax' | 'rank:pairwise' | 'rank:ndcg' }
    HYPERPARAMETERS DEFAULT EXCEPT (
        NUM_ROUND '10',
        ETA '0.2',
        NUM_CLASS '10',
        (, ...)
    )
    PREPROCESSORS 'none'
    SETTINGS (
      S3_BUCKET 'bucket', |
      S3_GARBAGE_COLLECT <span>{</span> ON | OFF }, |
      KMS_KEY_ID 'kms_key_id', |
      MAX_CELLS integer, |
      MAX_RUNTIME integer (, ...)
    )   </code></pre>
         

         
            <h3 id="r_auto_off-create-model-parameters">CREATE XGBoost models with AUTO OFF parameters</h3>
            <div class="variablelist">
                 
                 
                 
                
                 
            <dl>
                    <dt><span class="term">
                        <em>AUTO OFF</em>
                    </span></dt>
                    <dd>
                        <p>Turns off CREATE MODEL automatic discovery of preprocessor, algorithm,
                            and hyper-parameters selection.</p>
                    </dd>
                 
                    <dt><span class="term">MODEL_TYPE XGBOOST</span></dt>
                    <dd>
                        <p>Specifies to use XGBOOST to train the model. </p>
                    </dd>
                 
                    <dt><span class="term">OBJECTIVE str</span></dt>
                    <dd>
                        <p>Specifies an objective recognized by the algorithm. Amazon Redshift supports reg:squarederror, reg:squaredlogerror, reg:logistic,
                            reg:pseudohubererror, reg:tweedie, binary:logistic, binary:hinge, multi:softmax.
                            For more information about these objectives, see <a href="https://xgboost.readthedocs.io/en/latest/parameter.html#learning-task-parameters" rel="noopener noreferrer" target="_blank"><span>Learning task parameters</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> in the XGBoost documentation.</p>
                    </dd>
                 
                    <dt><span class="term">HYPERPARAMETERS <span>{</span> DEFAULT | DEFAULT EXCEPT ( key ‘value’ (,..)  ) }</span></dt>
                    <dd>
                        <p>Specifies whether the default XGBoost parameters are used or overridden
                            by user-specified values. The values must be enclosed with single quotes.
                            Following are examples of parameters for XGBoost and their defaults.</p>
                        <div class="table-container"><div class="table-contents"><table id="w323aac67c10d139c19b9b9b3b9b3b3"><thead>
                                    <tr>
                                        <th>Parameter name</th>
                                        <th>Parameter value </th>
                                        <th>Default value</th>
                                        <th>Notes</th>
                                    </tr>
                                </thead>
                                    <tr>
                                        <td tabindex="-1">
                                            <p>num_class</p>
                                        </td>
                                        <td tabindex="-1">Integer</td>
                                        <td tabindex="-1">
                                            <p>Required for Multiclass classification.</p>
                                        </td>
                                        <td tabindex="-1">N/A</td>
                                    </tr>
                                    <tr>
                                        <td tabindex="-1">
                                            <p>num_round</p>
                                        </td>
                                        <td tabindex="-1">Integer</td>
                                        <td tabindex="-1">
                                            <p>100</p>
                                        </td>
                                        <td tabindex="-1">N/A</td>
                                    </tr>
                                    
                                    <tr>
                                        <td tabindex="-1">
                                            <p>tree_method</p>
                                        </td>
                                        <td tabindex="-1">String</td>
                                        <td tabindex="-1">Auto</td>
                                        <td tabindex="-1">N/A</td>
                                    </tr>
                                    <tr>
                                        <td tabindex="-1">
                                            <p>max_depth</p>
                                        </td>
                                        <td tabindex="-1">Integer</td>
                                        <td tabindex="-1">6</td>
                                        <td tabindex="-1">[0 , 10]</td>
                                    </tr>
                                    <tr>
                                        <td tabindex="-1">min_child_weight</td>
                                        <td tabindex="-1">Float</td>
                                        <td tabindex="-1">1</td>
                                        <td tabindex="-1">MinValue: 0, MaxValue: 120</td>
                                    </tr>
                                    <tr>
                                        <td tabindex="-1">subsample</td>
                                        <td tabindex="-1">Float</td>
                                        <td tabindex="-1">1</td>
                                        <td tabindex="-1">MinValue: 0.5, MaxValue: 1</td>
                                    </tr>
                                    <tr>
                                        <td tabindex="-1">gamma</td>
                                        <td tabindex="-1">Float</td>
                                        <td tabindex="-1">0</td>
                                        <td tabindex="-1">MinValue: 0, MaxValue: 5</td>
                                    </tr>
                                    <tr>
                                        <td tabindex="-1">alpha</td>
                                        <td tabindex="-1">Float</td>
                                        <td tabindex="-1">0</td>
                                        <td tabindex="-1">MinValue: 0, MaxValue: 1000</td>
                                    </tr>
                                    <tr>
                                        <td tabindex="-1">eta</td>
                                        <td tabindex="-1">Float</td>
                                        <td tabindex="-1">0.3</td>
                                        <td tabindex="-1">MinValue: 0.1, MaxValue: 0.5</td>
                                    </tr>
                                    <tr>
                                        <td tabindex="-1">colsample_byleve</td>
                                        <td tabindex="-1">Float</td>
                                        <td tabindex="-1">1</td>
                                        <td tabindex="-1">MinValue: 0.1, MaxValue: 1</td>
                                    </tr>
                                    <tr>
                                        <td tabindex="-1">colsample_bynode</td>
                                        <td tabindex="-1">Float</td>
                                        <td tabindex="-1">1</td>
                                        <td tabindex="-1">MinValue: 0.1, MaxValue: 1</td>
                                    </tr>
                                    <tr>
                                        <td tabindex="-1">colsample_bytree</td>
                                        <td tabindex="-1">Float</td>
                                        <td tabindex="-1">1</td>
                                        <td tabindex="-1">MinValue: 0.5, MaxValue: 1</td>
                                    </tr>
                                    <tr>
                                        <td tabindex="-1">lambda</td>
                                        <td tabindex="-1">Float</td>
                                        <td tabindex="-1">1</td>
                                        <td tabindex="-1">MinValue: 0, MaxValue: 1000</td>
                                    </tr>
                                    <tr>
                                        <td tabindex="-1">max_delta_step</td>
                                        <td tabindex="-1">Integer</td>
                                        <td tabindex="-1">0</td>
                                        <td tabindex="-1">[0, 10]</td>
                                    </tr>
                                </table></div></div>
                    </dd>
                </dl></div>

            <p>The following example prepares data for XGBoost.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">DROP TABLE IF EXISTS abalone_xgb;

    CREATE TABLE abalone_xgb (
    length_val float,
    diameter float,
    height float,
    whole_weight float,
    shucked_weight float,
    viscera_weight float,
    shell_weight float,
    rings int,
    record_number int);

    COPY abalone_xgb
    FROM 's3://redshift-downloads/redshift-ml/abalone_xg/'
    REGION 'us-east-1'
    IAM_ROLE default
    IGNOREHEADER 1 CSV;</code></pre>
            <p>The following example creates an XGBoost model with specified advanced options, such as MODEL_TYPE, OBJECTIVE, and PREPROCESSORS.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">DROP MODEL abalone_xgboost_multi_predict_age;

    CREATE MODEL abalone_xgboost_multi_predict_age
    FROM ( SELECT length_val,
                  diameter,
                  height,
                  whole_weight,
                  shucked_weight,
                  viscera_weight,
                  shell_weight,
                  rings
   FROM abalone_xgb WHERE record_number &lt; 2500 )
    TARGET rings FUNCTION ml_fn_abalone_xgboost_multi_predict_age
    IAM_ROLE default
    AUTO OFF
    MODEL_TYPE XGBOOST
    OBJECTIVE 'multi:softmax'
    PREPROCESSORS 'none'
    HYPERPARAMETERS DEFAULT EXCEPT (NUM_ROUND '100', NUM_CLASS '30')
    SETTINGS (S3_BUCKET 'your-bucket');</code></pre>
            <p>The following example uses an inference query to predict the age of the fish with
                a record number greater than 2500. It uses the function
                ml_fn_abalone_xgboost_multi_predict_age created from the above command. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select ml_fn_abalone_xgboost_multi_predict_age(length_val,
                                                   diameter,
                                                   height,
                                                   whole_weight,
                                                   shucked_weight,
                                                   viscera_weight,
                                                   shell_weight)+1.5 as age
from abalone_xgb where record_number &gt; 2500;</code></pre>
         
     
        <h2 id="r_byom_create_model">Bring your own model (BYOM) - local inference</h2>
        <p>Amazon Redshift ML supports using bring your own model (BYOM) for local inference.</p>
        <p>The following summarizes the options for the CREATE MODEL syntax for BYOM. You can
            use a model trained outside of Amazon Redshift with Amazon SageMaker for in-database inference locally
            in Amazon Redshift.</p>

         
            <h3 id="r_local-create-model">CREATE MODEL syntax for local inference </h3>
            <p>The following describes the CREATE MODEL syntax for local inference.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE MODEL <em>model_name</em>
    FROM (<em>'job_name'</em> | <em>'s3_path'</em> )
    FUNCTION <em>function_name</em> ( <em>data_type [, ...]</em> )
    RETURNS <em>data_type</em>
    IAM_ROLE <span>{</span> default }
    [ SETTINGS (
      S3_BUCKET <em>'bucket'</em>, | --required
      KMS_KEY_ID <em>'kms_string'</em>) --optional
    ];</code></pre>
            <p>Amazon Redshift currently only supports pretrained XGBoost, MLP, and Linear Learner models for BYOM. You

                can import SageMaker Autopilot and models directly trained in Amazon SageMaker for local inference
                using this path.
                
            </p>

             
                <h4 id="r_local-create-model-parameters">CREATE MODEL parameters for local inference</h4>
                <div class="variablelist">
                     
                     
                     
                     
                     
                     
                <dl>
                        <dt><span class="term">
                            <em>model_name</em>
                        </span></dt>
                        <dd>
                            <p>The name of the model. The model name in a schema must be unique.</p>
                        </dd>
                     
                        <dt><span class="term">FROM (<em>'job_name'</em> | <em>'s3_path'</em> )</span></dt>
                        <dd>
                            <p>The <em>job_name</em> uses an Amazon SageMaker job name as the input. The job name
                                can either be an Amazon SageMaker training job name or an Amazon SageMaker Autopilot job
                                name. The job must be created in the same AWS account that owns the Amazon Redshift cluster. To find the job name,
                                launch Amazon SageMaker. In the <b>Training</b> dropdown menu, choose <b>Training jobs</b>.</p>
                            <p>The <em>'s3_path'</em> specifies the S3 location of the
                                .tar.gz model artifacts file that is to be used when creating the model.</p>
                        </dd>
                     
                        <dt><span class="term">FUNCTION <em>function_name</em> ( <em>data_type</em> [, ...] )</span></dt>
                        <dd>
                            <p>The name of the function to be created and the data types of the input arguments. You can provide a schema name.</p>
                        </dd>
                     
                        <dt><span class="term">RETURNS <em>data_type</em></span></dt>
                        <dd>
                            <p>The data type of the value returned by the function.</p>
                        </dd>
                     
                       <dt><span class="term">IAM_ROLE <span>{</span> default | 'arn:aws:iam::&lt;account-id&gt;:role/&lt;role-name&gt;'}</span></dt>
                        <dd>
                            <p> Use the default keyword to have Amazon Redshift use the IAM role that is set as default and associated with the cluster when the CREATE MODEL command runs.</p>
                            <p>Use the Amazon Resource Name (ARN) for an IAM role that your cluster
                                uses for authentication and authorization. </p>
                        </dd>
                     
                        <dt><span class="term">SETTINGS (
                            S3_BUCKET <em>'bucket'</em>, |
                            KMS_KEY_ID <em>'kms_string'</em>)</span></dt>
                        <dd>
                            <p>The S3_BUCKET clause specifies the Amazon S3 location that is used to store
                                intermediate results.</p>
                            <p>(Optional) The KMS_KEY_ID clause specifies if Amazon Redshift uses server-side encryption with an AWS KMS key to protect data at rest. Data in transit is protected with Secure Sockets Layer (SSL).</p>
                            <p>For more information, see <a href="#r_user_guidance_create_model">CREATE MODEL with user guidance</a>.</p>
                        </dd>
                    </dl></div>

             

             
                <h4 id="r_local-create-model-example">CREATE MODEL for local inference example</h4>
                <p>The following example creates a model that has been previously trained in
                    Amazon SageMaker, outside of Amazon Redshift. Because the model type is supported by Amazon Redshift
                    ML for local inference, the following CREATE MODEL creates a function that can
                    be used locally in Amazon Redshift. You can provide a SageMaker training job name.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE MODEL customer_churn
    FROM 'training-job-customer-churn-v4'
    FUNCTION customer_churn_predict (varchar, int, float, float)
    RETURNS int
    IAM_ROLE default
    SETTINGS (S3_BUCKET 'your-bucket');</code></pre>
                <p>After the model is created, you can use the function <em>customer_churn_predict</em> with the specified argument types to make predictions.</p>
             
         
     
          <h2 id="r_byom_create_model_remote">Bring your own model (BYOM) - remote inference</h2>
          <p>Amazon Redshift ML also supports using bring your own model (BYOM) for remote inference.</p>
          <p>The following summarizes the options for the CREATE MODEL syntax for BYOM.</p>
          <div class="awsdocs-note awsdocs-sticky-note awsdocs-warning"><div class="awsdocs-note-icon"><awsui-icon name="status-warning" variant="error"></awsui-icon></div><div class="awsdocs-note-text"><p><em><b>This is prerelease documentation for the SUPER data type
                         for input to BYOM models in Amazon Redshift ML, 
                         which is in preview release. The documentation and the feature are both subject to change.
                         We recommend that you use this feature only with test clusters, and not in production environments. For preview terms and conditions, 
                         see <em>Beta and Previews</em> in <a href="https://aws.amazon.com/service-terms/" rel="noopener noreferrer" target="_blank"><span>AWS Service Terms</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.
                      </b></em>
                      </p></div></div>
          
          <p>Specifying to use the SUPER data type
             as input data and the returned data type indicates that you want to create a 
             large language model (LLM) hosted in Amazon SageMaker JumpStart.
             Creating LLMs is curently available only as a preview feature.
          This preview is available in the following AWS Regions.</p>
          <div class="itemizedlist">
              
              
              
              
              
          <ul class="itemizedlist"><li class="listitem"><p>US East (Ohio) (us-east-2)</p></li><li class="listitem"><p>US East (N. Virginia) (us-east-1)</p></li><li class="listitem"><p>Asia Pacific (Tokyo) (ap-northeast-1)</p></li><li class="listitem"><p>Europe (Ireland) (eu-west-1)</p></li><li class="listitem"><p>Europe (Stockholm) (eu-north-1)</p></li></ul></div>
          <p>You can create an Amazon Redshift cluster in <b>Preview</b> to test new features of Amazon Redshift.
                You can't use those features in production or move your <b>Preview</b> cluster to a production cluster or a cluster on another track.

                For preview terms and conditions, see <em>Beta and Previews</em> in <a href="https://aws.amazon.com/service-terms/" rel="noopener noreferrer" target="_blank"><span>AWS Service Terms</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>            
            <div class="procedure"><h6>To create a cluster in <b>Preview</b></h6><ol><li><p>Sign in to the AWS Management Console and open the Amazon Redshift console at
         <a href="https://console.aws.amazon.com/redshiftv2/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/redshiftv2/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p> </li><li><p>On the navigation menu, choose <b>Provisioned clusters dashboard</b>, and choose <b>Clusters</b>. The clusters for your account in
                    the current AWS Region are listed. A subset of properties of each cluster is
                    displayed in columns in the list.</p></li><li><p>A banner displays on the <b>Clusters</b> list page that introduces preview. 
                    Choose the button <b>Create preview cluster</b> to open the create cluster page.</p></li><li><p>Enter properties for your cluster. 
                    Choose the <b>Preview track</b> that contains the features you want to test.
                    We recommend entering a name for the cluster that indicates that it is on a preview track.
                    Choose options for your cluster, including options labeled as <b>-preview</b>, for the features you want to test.                                    
                    For general information about creating clusters, see 
                    <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-console.html#create-cluster">Creating a cluster</a> in the <em>Amazon Redshift Management Guide</em>.</p></li><li><p>Choose <b>Create cluster</b> to create a cluster in preview.</p>
                       <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The <code class="code">preview_2023</code> track is the most recent preview track available. 
                        This track supports creating clusters with RA3 node types only. Node types DC2 and DS2 and any older node type is not supported.</p></div></div></li><li><p>When your preview cluster is available, use your SQL client to load and query data.</p></li></ol></div>
          
          <p>You can also create a preview workgroup to create an LLM. You 
             can't use those features in production or move your workgroup to another workgroup. For preview terms and
             conditions, see Beta and Previews in <a href="https://aws.amazon.com/service-terms/" rel="noopener noreferrer" target="_blank"><span>AWS Service Terms</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. For instructions on how to create a preview workgroup, 
             see <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/serverless-workgroup-preview.html">Creating a preview workgroup</a>.</p>
            
             
          
         
            <h3 id="r_remote-create-model">CREATE MODEL syntax for remote inference </h3>
            <p>The following describes the CREATE MODEL syntax for remote inference.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE MODEL <em>model_name </em>
    FUNCTION <em>function_name</em> ( <em>data_type</em> [, ...] )
    RETURNS <em>data_type</em>
    SAGEMAKER <em>'endpoint_name'</em>[:<em>'model_name'</em>]
    IAM_ROLE <span>{</span> default | 'arn:aws:iam::&lt;account-id&gt;:role/&lt;role-name&gt;' }</code></pre>


             
                <h4 id="r_remote-create-model-parameters">CREATE MODEL parameters for remote inference</h4>
                <div class="variablelist">
                     
                     
                     
                     
                     
                <dl>
                        <dt><span class="term">
                            <em>model_name</em>
                        </span></dt>
                        <dd>
                            <p>The name of the model. The model name in a schema must be unique.</p>
                        </dd>
                     
                        <dt><span class="term">FUNCTION <em>fn_name</em> ( [<em>data_type</em>] [, ...] )</span></dt>
                        <dd>
                           <p>The name of the function and the data types of the input arguments. See 
                              <a href="https://docs.aws.amazon.com/redshift/latest/dg/c_Supported_data_types.html">Data types</a>
                              for all of the supported data types. <code class="code">Geography</code>, <code class="code">geometry</code>, 
                              and <code class="code">hllsketch</code> aren't supported. Specifying to use the SUPER data type
                              as input data and the returned data type indicates that you want to create a 
                              large language model (LLM) hosted in Amazon SageMaker JumpStart.</p>
                           <p>Alternatively, you can specify to use just the SUPER data type as the input data
                           without also using it as the returned data type. Using SUPER data type as input 
                           is available only as a preview feature.</p>
                           <p>You can also provide a schema name instead of a function name.</p>
                        </dd>
                     
                        <dt><span class="term">RETURNS <em>data_type</em></span></dt>
                        <dd>
                            <p>The data type of the value returned by the function. See 
                               <a href="https://docs.aws.amazon.com/redshift/latest/dg/c_Supported_data_types.html">Data types</a>
                            for all of the supported data types. <code class="code">Geography</code>, <code class="code">geometry</code>, 
                               and <code class="code">hllsketch</code> aren't supported. Specifying to use the SUPER data type
                               as input data and the returned data type indicates that you want to create a 
                               large language model (LLM) hosted in Amazon SageMaker JumpStart.</p>
                           <p>Alternatively, you can specify to use just the SUPER data type as the returned
                            data type without also using it as input data.</p>
                        </dd>
                     
                        <dt><span class="term">SAGEMAKER <em>'endpoint_name'</em>[:<em>'model_name'</em>]
                        </span></dt>
                        <dd>

                            <p>The name of the Amazon SageMaker endpoint. If the endpoint name points to a multimodel
                                endpoint, add the name of the model to use. The endpoint must be hosted
                                in the same AWS Region as the Amazon Redshift cluster. To find your endpoint,
                            launch Amazon SageMaker. In the <b>Inference</b> dropdown menu, choose <b>Endpoints</b>.</p>
                        </dd>
                     
                       <dt><span class="term">IAM_ROLE <span>{</span> default | 'arn:aws:iam::&lt;account-id&gt;:role/&lt;role-name&gt;'}</span></dt>
                        <dd>
                            <p> Use the default keyword to have Amazon Redshift use the IAM role that is set as default and associated with
                               the cluster when the CREATE MODEL command runs. Alternatively, you can specify the ARN of 
                            an IAM role to use that role.</p>

                        </dd>
                    </dl></div>
                <p>When the model is deployed to a SageMaker endpoint, SageMaker creates the information of the
                    model in Amazon Redshift. It then performs inference through the external function. You
                    can use the SHOW MODEL command to view the model information on your Amazon Redshift
                    cluster.</p>
             
             
                <h4 id="r_remote-create-model-usage-notes">CREATE MODEL for remote inference usage notes</h4>
                <p>Before using CREATE MODEL for remote inference, consider the following:</p>
                <div class="itemizedlist">
                    
                     
   
                     
                     
                     
   
                     
                    
                    
                  
                   

                <ul class="itemizedlist"><li class="listitem">
                      <p>BYOM models can only support one argument if you're using SUPER data type as input data, and the returned output must also be SUPER data type.</p>
                   </li><li class="listitem"><p>The model must accept inputs in the format of comma-separated values (CSV) through a content
                        type of text/CSV in SageMaker. Only applicable if you're not using the SUPER data type as input.</p>
                    </li><li class="listitem">
                       <p>The endpoint must be hosted by the same AWS account that owns the Amazon Redshift cluster.</p>
                    </li><li class="listitem">
                       <p>The outputs of models must be a single value of the type specified on creating the function,
                       in the format of comma-separated values (CSV) through a content type of text/CSV in SageMaker. Varchar data types shouldn't be in quotes, and each output must be in a new line. 
                       Only applicable if you specified that the model shouldn't return the SUPER data type. 
                       </p>
                    </li><li class="listitem">
                       <p>Models accept nulls as empty strings.</p>
                    </li><li class="listitem">
                       <p>Make sure either that the Amazon SageMaker endpoint has enough resources to accommodate inference
                        calls from Amazon Redshift or that the Amazon SageMaker endpoint can be automatically
                        scaled.</p>
                    </li><li class="listitem">
                      <p>When the returned type is SUPER, the model output must be JSON and the <code class="code">application/jsonlines</code> content type.</p>
                   </li><li class="listitem">
                      <p>When both the input and output types are SUPER, the model must accept and return JSON through the content type <code class="code">application/json</code>.</p>
                   </li></ul></div>
                 
                    <h5 id="r_remote-create-model-example">CREATE MODEL for remote inference example</h5>
                    <p>The following example creates a model that uses a SageMaker endpoint to make
                        predictions. Make sure that the endpoint is running to make predictions and
                        specify its name in the CREATE MODEL command.</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE MODEL remote_customer_churn
    FUNCTION remote_fn_customer_churn_predict (varchar, int, float, float)
    RETURNS int
    SAGEMAKER 'customer-churn-endpoint'
    IAM_ROLE default;</code></pre>
                   <p>The following example creates a large language model model (LLM) 
                      by using the SUPER data type as input data and outputs
                      the SUPER data type. LLMs are hosted in SageMaker Jumpstart.
                   </p>
                   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE MODEL sample_super_data_model
FUNCTION sample_super_data_model_predict(super)
RETURNS super
SAGEMAKER 'sample_super_data_model_endpoint'
IAM_ROLE default;</code></pre>
                 
             
         
     
        <h2 id="r_k-means_create_model">CREATE MODEL with K-MEANS</h2>
        <p>Amazon Redshift supports the K-Means algorithm that groups data that isn't labeled. This algorithm solves
            clustering problems where you want to discover groupings in the data. Unclassified data is
            grouped and partitioned based on its similarities and differences. </p>

         
            <h3 id="r_k-means-create-model-synposis">CREATE MODEL with K-MEANS
                    syntax</h3>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE MODEL model_name
    FROM <span>{</span> <em>table_name</em> | ( <em>select_statement</em> ) }
    FUNCTION <em>function_name</em>
    IAM_ROLE <span>{</span> default | 'arn:aws:iam::&lt;account-id&gt;:role/&lt;role-name&gt;' }
    AUTO OFF
    MODEL_TYPE KMEANS
    PREPROCESSORS 'string'
    HYPERPARAMETERS DEFAULT EXCEPT ( K 'val' [, ...] )
    SETTINGS (
      S3_BUCKET 'bucket',
      KMS_KEY_ID 'kms_string', |
        -- optional
      S3_GARBAGE_COLLECT on / off, |
        -- optional
      MAX_CELLS integer, |
        -- optional
      MAX_RUNTIME integer
        -- optional);</code></pre>

         
         
            <h3 id="r_k-means-create-model-parameters">CREATE MODEL with K-MEANS
                    parameters</h3>
            <div class="variablelist">
                 
                 
                 
                 
            <dl>
                    <dt><span class="term">
                        <em>AUTO OFF</em>
                    </span></dt>
                    <dd>
                        <p>Turns off CREATE MODEL automatic discovery of preprocessor, algorithm,
                            and hyper-parameters selection.</p>
                    </dd>
                 
                    <dt><span class="term">MODEL_TYPE KMEANS</span></dt>
                    <dd>
                        <p>Specifies to use KMEANS to train the model. </p>
                    </dd>
                 
                    <dt><span class="term">PREPROCESSORS 'string'</span></dt>
                    <dd>
                        <p>Specifies certain combinations of preprocessors to certain sets of
                            columns. The format is a list of columnSets, and the appropriate transforms
                            to be applied to each set of columns. Amazon Redshift supports 3 K-Means preprocessors, namely StandardScaler, MinMax, and NumericPassthrough.
                            If you don't want to apply any preprocessing for K-Means, choose
                            NumericPassthrough explicitly as a transformer. For more information about supported transformers, see <a href="#r_user_guidance-create-model-parameters">CREATE MODEL with user guidance parameters</a>.</p>
                        <p>The K-Means algorithm uses Euclidean distance to calculate similarity. Preprocessing the data ensures that the features of the model stay on the same scale and produce reliable results.</p>
                    </dd>
                 
                    <dt><span class="term">HYPERPARAMETERS DEFAULT EXCEPT ( K 'val' [, ...] )</span></dt>
                    <dd>
                        <p>Specifies whether the K-Means parameters are used. You must specify the <code class="code">K</code> parameter when using the K-Means algorithm. For more information, see <a href="https://docs.aws.amazon.com/sagemaker/latest/dg/k-means-api-config.html">K-Means Hyperparameters</a> in the <em>Amazon SageMaker Developer
                                Guide</em></p>
                    </dd>
                </dl></div>

            <p>The following example prepares data for K-Means.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE MODEL customers_clusters
FROM customers
FUNCTION customers_cluster
IAM_ROLE default
AUTO OFF
MODEL_TYPE KMEANS
PREPROCESSORS '[
<span>{</span>
  "ColumnSet": [ "*" ],
  "Transformers": [ "NumericPassthrough" ]
}
]'
HYPERPARAMETERS DEFAULT EXCEPT ( K '5' )
SETTINGS (S3_BUCKET 'bucket');

select customer_id, customers_cluster(...) from customers;
customer_id | customers_cluster
--------------------
12345            1
12346            2
12347            4
12348            0</code></pre>

         
     
       <h2 id="r_forecast_model">CREATE MODEL with Forecast</h2>
       <p>Forecast models in Redshift ML use Amazon Forecast to create accurate time-series forecasts. Doing so lets you 
          use historical data over a time period to make predictions about future events. Common use cases of Amazon Forecast include using retail product 
          data to decide how to price inventory, manufacturing quantity data to predict how much of one item to order, and web traffic data 
          to forecast how much traffic a web server might receive. </p>
       <p>
          <a href="https://docs.aws.amazon.com/forecast/latest/dg/limits.html">Quota limits from Amazon Forecast</a> are enforced in Amazon Redshift forecast models. For example, the maximum number of forecasts is 100, but it's adjustable. 
          Dropping a forecast model doesn’t automatically delete the associated resources in Amazon Forecast. If you delete a Redshift cluster, all associated 
          models are dropped as well.
       </p>
       <p>Note that Forecast models are currently only available in the following Regions:</p>
       <div class="itemizedlist">
           
           
           
          
           
           
           
           
           
          
           
           
       <ul class="itemizedlist"><li class="listitem"><p>US East (Ohio) (us-east-2)</p></li><li class="listitem"><p>US East (N. Virginia) (us-east-1)</p></li><li class="listitem"><p>US West (Oregon) (us-west-2)</p></li><li class="listitem"><p>Asia Pacific (Mumbai) (ap-south-1)</p></li><li class="listitem"><p>Asia Pacific (Seoul) (ap-northeast-2)</p></li><li class="listitem"><p>Asia Pacific (Singapore) (ap-southeast-1)</p></li><li class="listitem"><p>Asia Pacific (Sydney) (ap-southeast-2)</p></li><li class="listitem"><p>Asia Pacific (Tokyo) (ap-northeast-1)</p></li><li class="listitem"><p>Europe (Frankfurt) (eu-central-1)</p></li><li class="listitem"><p>Europe (Ireland) (eu-west-1)</p></li></ul></div>
        
          <h3 id="r_forecast_model-synopsis">CREATE MODEL with Forecast syntax</h3>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE [ OR REPLACE ] MODEL forecast_model_name 
FROM <span>{</span> table_name | ( select_query ) } 
TARGET column_name
IAM_ROLE <span>{</span> default | 'arn:aws:iam::&lt;account-id&gt;:role/&lt;role-name&gt;'} 
AUTO ON
MODEL_TYPE FORECAST
SETTINGS (
  S3_BUCKET 'bucket',
  HORIZON integer,
  FREQUENCY forecast_frequency
  [PERCENTILES '0.1', '0.5', '0.9']</code></pre>
        
        
          <h3 id="r_forecast_model-parameters">CREATE MODEL with Forecast parameters</h3>
          <div class="variablelist">
              
              
              
              
              
              
              
              
              
              
          <dl>
                <dt><span class="term">
                   <em>forecast_model_name</em>
                </span></dt>
                <dd>
                   <p>The name of the model. The model name must be unique.</p>
                </dd>
              
                <dt><span class="term">FROM <span>{</span> table_name | ( select_query ) }</span></dt>
                <dd>
                   <p>The table_name or the query that specifies the training data. This can either be an existing table in the system, or 
                      an Amazon Redshift compatible SELECT query enclosed with parentheses. The table or query result must have at least
                      three columns: (1) a varchar column that specifies the name of the time-series. Each dataset can have 
                      multiple time-series; (2) a datetime column; and (3) the target column to predict. This target column must be either an int or a float. If you supply a 
                      dataset that has more than three columns, Amazon Redshift assumes that all additional columns are part of a related time series. Note that related time series must be of type int or float. 
                      For more information about related time series, see <a href="https://docs.aws.amazon.com/forecast/latest/dg/related-time-series-datasets.html">Using Related Time Series Datasets</a>.</p>
                </dd>
              
                <dt><span class="term">TARGET column_name</span></dt>
                <dd>
                   <p>The name of the column that becomes the prediction target. The column must exist in the FROM clause.</p>
                </dd>
              
                <dt><span class="term">IAM_ROLE <span>{</span> default | 'arn:aws:iam::&lt;account-id&gt;:role/&lt;role-name&gt;' }</span></dt>
                <dd>
                   <p>Use the default keyword to have Amazon Redshift use the IAM role that is set as default 
                      and associated with the cluster when the CREAT MODEL command runs. Alternatively, 
                      you can specify an ARN of an IAM role to use that role.
                   </p>
                </dd>
              
                <dt><span class="term">AUTO ON</span></dt>
                <dd>
                   <p>Turns on the CREATE MODEL automatic discovery of algorithm and hyper-parameters selection. Specifying on
                      when creating a Forecast model indicates to use a Forecast AutoPredictor, where Amazon Forecast applies the optimal combinations of algorithms
                      to each time series in your dataset.</p>
                </dd>
              
                <dt><span class="term">MODEL_TYPE FORECAST</span></dt>
                <dd>
                   <p>Specifies to use FORECAST to train the model.</p>
                </dd>
              
                <dt><span class="term">S3_BUCKET 'bucket'</span></dt>
                <dd>
                   <p>The name of the Amazon Simple Storage Service bucket that you previously created and that’s used to share training data 
                      and artifacts between Amazon Redshift and Amazon Forecast. Amazon Redshift creates a subfolder in this bucket before unloading the training data. 
                      When training is complete, Amazon Redshift deletes the created subfolder and its contents.</p>
                </dd>
              
                <dt><span class="term">HORIZON integer</span></dt>
                <dd>
                   <p>The maximum number of predictions the forecast model can return. Once the model is trained, you can't change this integer.</p>
                </dd>
              
                <dt><span class="term">FREQUENCY forecast_frequency</span></dt>
                <dd>
                   <p>Specifies how granular you want the forecasts to be. Available options are <code class="code">Y | M | W | D | H | 30min | 15min | 10min | 5min | 1min</code>. 
                   Required if you’re training a forecast model.</p>
                </dd>
              
                <dt><span class="term">PERCENTILES string</span></dt>
                <dd>
                   <p>A comma-delimited string that specifies the forecast types used to train a predictor. Forecast types can be quantiles from 0.01 to 0.99, by increments of 0.01 or higher. 
                      You can also specify the mean forecast with mean. You can specify a maximum of five forecast types.</p>
                </dd>
             </dl></div>
          <p>The following example demonstrates how to create a simple forecast model.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE MODEL forecast_example
FROM forecast_electricity_
TARGET target 
IAM_ROLE 'arn:aws:iam::&lt;account-id&gt;:role/&lt;role-name&gt;'
AUTO ON 
MODEL_TYPE FORECAST
SETTINGS (S3_BUCKET 'redshift-ml-bucket',
          HORIZON 24,
          FREQUENCY 'H',
          PERCENTILES '0.25,0.50,0.75,mean',
          S3_GARBAGE_COLLECT OFF);</code></pre>
          
          <p>After you create the forecast model, you can create a new table with the prediction data.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE forecast_model_results as SELECT Forecast(forecast_example)</code></pre>
          
          <p>You can then query the new table to get predictions.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT * FROM forecast_model_results</code></pre>
        
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_create_model_usage_notes.html">Usage notes</div><div id="next" class="next-link" accesskey="n" href="./r_CREATE_PROCEDURE.html">CREATE PROCEDURE</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_create_model_use_cases.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/en_us/redshift/latest/dg/r_create_model_use_cases.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>