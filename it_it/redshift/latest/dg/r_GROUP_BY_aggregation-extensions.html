<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="it-IT"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Estensioni di aggregazione - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_GROUP_BY_aggregation-extensions" /><meta name="default_state" content="r_GROUP_BY_aggregation-extensions" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" /><meta name="description" content="Amazon Redshift supporta estensioni di aggregazione per eseguire il lavoro di più operazioni GROUP BY in un'unica istruzione." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guida per sviluppatori di database" /><meta name="abstract" content="Creare e gestire un data warehouse con Amazon Redshift, un servizio di data warehouse completamente gestito di livello aziendale e con capacità nell'ordine di più petabyte." /><meta name="guide-locale" content="it_it" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guida per sviluppatori di database" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guida per sviluppatori di database" /><meta id="panorama-serviceConsolePage" value="Estensioni di aggregazione" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Estensioni di aggregazione - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_GROUP_BY_aggregation-extensions" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,sviluppatore,dati campione,database,sviluppatore di database,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guida per sviluppatori di database",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Documentazione di riferimento a SQL",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Comandi SQL",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "SELECT",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_SELECT_synopsis.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Clausola GROUP BY",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_GROUP_BY_clause.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "Estensioni di aggregazione",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_GROUP_BY_clause.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_GROUP_BY_aggregation-extensions" target="_blank" rel="noopener noreferrer" title="Apri PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentazione</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guida per sviluppatori di database</a></div><div id="page-toc-src"><a href="#r_GROUP_BY_aggregation-extensions-grouping-sets">GROUPING SETS</a><a href="#r_GROUP_BY_aggregation-extensions-rollup">ROLLUP</a><a href="#r_GROUP_BY_aggregation-extensions-cube">CUBE</a><a href="#r_GROUP_BY_aggregation-extentions-grouping">Funzioni GROUPING/GROUPING_ID</a><a href="#r_GROUP_BY_aggregation-extentions-partial">ROLLUP e CUBE parziali</a><a href="#r_GROUP_BY_aggregation-extentions-concat">Raggruppamento concatenato</a><a href="#r_GROUP_BY_aggregation-extentions-nested">Raggruppamento nidificato</a><a href="#r_GROUP_BY_aggregation-extensions-usage-notes">Note per l'utilizzo</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Le traduzioni sono generate tramite traduzione automatica. In caso di conflitto tra il contenuto di una traduzione e la versione originale in Inglese, quest'ultima prevarrà.</p></awsui-alert><h1 class="topictitle" id="r_GROUP_BY_aggregation-extensions">Estensioni di aggregazione</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Amazon Redshift supporta estensioni di aggregazione per eseguire il lavoro di più operazioni GROUP BY in un'unica istruzione.</p><p> Gli esempi di estensioni di aggregazione utilizzano la tabella <code class="code">orders</code>, che contiene i dati di vendita di un'azienda di elettronica. Per creare gli <code class="code">orders</code>, procedi come segue.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE ORDERS (
    ID INT,
    PRODUCT CHAR(20),
    CATEGORY CHAR(20),
    PRE_OWNED CHAR(1),
    COST DECIMAL
);

INSERT INTO ORDERS VALUES
    (0, 'laptop',       'computers',    'T', 1000),
    (1, 'smartphone',   'cellphones',   'T', 800),
    (2, 'smartphone',   'cellphones',   'T', 810),
    (3, 'laptop',       'computers',    'F', 1050),
    (4, 'mouse',        'computers',    'F', 50);</code></pre>
               <h2 id="r_GROUP_BY_aggregation-extensions-grouping-sets"><em>GROUPING SETS</em></h2>
               <p> Calcola uno o più set di raggruppamento in una singola istruzione. Un set di raggruppamento è l'insieme di una singola clausola GROUP BY, un set di 0 o più colonne in base al quale è possibile raggruppare il set di risultati di una query. GROUP BY GROUPING SETS equivale all'esecuzione di una query UNION ALL su un set di risultati raggruppato in colonne diverse. Ad esempio, GROUP BY GROUP SETS((a), (b)) è equivalente a GROUP BY a UNION ALL GROUP BY b. </p>
               <p> L'esempio seguente restituisce il costo dei prodotti nella tabella degli ordini raggruppati in base alle categorie dei prodotti e al tipo di prodotti venduti. </p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
SELECT category, product, sum(cost) as total
FROM orders
GROUP BY GROUPING SETS(category, product);

       category       |       product        | total
----------------------+----------------------+-------
 computers            |                      |  2100
 cellphones           |                      |  1610
                      | laptop               |  2050
                      | smartphone           |  1610
                      | mouse                |    50

(5 rows)</code></pre>
             
               <h2 id="r_GROUP_BY_aggregation-extensions-rollup"><em>ROLLUP</em></h2>
                     <p> Presuppone una gerarchia in cui le colonne precedenti sono considerate le colonne padri delle colonne successive. ROLLUP raggruppa i dati in base alle colonne fornite, restituendo righe di subtotali aggiuntive che rappresentano i totali in tutti i livelli di colonne di raggruppamento, oltre alle righe raggruppate. Ad esempio, puoi utilizzare GROUP BY ROLLUP((a), (b)) per restituire un set di risultati raggruppato prima per a, poi per b supponendo che b sia una sottosezione di a. ROLLUP restituisce anche una riga con l'intero set di risultati senza colonne di raggruppamento. </p>
               <p>GROUP BY ROLLUP((a), (b)) è equivalente a GROUP BY GROUPING SETS((a,b), (a), ()). </p>
               <p>L'esempio seguente restituisce il costo dei prodotti nella tabella degli ordini raggruppati prima per categoria e poi per prodotto, con product come sezione della categoria.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT category, product, sum(cost) as total
FROM orders
GROUP BY ROLLUP(category, product) ORDER BY 1,2;

       category       |       product        | total
----------------------+----------------------+-------
 cellphones           | smartphone           |  1610
 cellphones           |                      |  1610
 computers            | laptop               |  2050
 computers            | mouse                |    50
 computers            |                      |  2100
                      |                      |  3710
(6 rows)</code></pre>

             
               <h2 id="r_GROUP_BY_aggregation-extensions-cube"><em>CUBE</em></h2>
                     <p> Raggruppa i dati in base alle colonne fornite, restituendo righe di subtotali aggiuntive che rappresentano i totali in tutti i livelli di colonne di raggruppamento, oltre alle righe raggruppate. CUBE restituisce le stesse righe di ROLLUP, ma aggiunge ulteriori righe di subtotali per ogni combinazione di colonne di raggruppamento non previste da ROLLUP. Ad esempio, è possibile utilizzare GROUP BY CUBE((a), (b)) per restituire un set di risultati raggruppato prima per a, poi per b, supponendo che b sia una sottosezione di a, quindi solo per b. CUBE restituisce anche una riga con l'intero set di risultati senza colonne di raggruppamento.</p>
               <p>GROUP BY CUBE((a), (b)) è equivalente a GROUP BY GROUPING SETS((a, b), (a), (b), ()). </p>
               <p>L'esempio seguente restituisce il costo dei prodotti nella tabella degli ordini raggruppati prima per categoria e poi per prodotto, con product come sezione della categoria. A differenza dell'esempio precedente per ROLLUP, l'istruzione restituisce risultati per ogni combinazione di colonne di raggruppamento. </p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT category, product, sum(cost) as total
FROM orders
GROUP BY CUBE(category, product) ORDER BY 1,2;

       category       |       product        | total
----------------------+----------------------+-------
 cellphones           | smartphone           |  1610
 cellphones           |                      |  1610
 computers            | laptop               |  2050
 computers            | mouse                |    50
 computers            |                      |  2100
                      | laptop               |  2050
                      | mouse                |    50
                      | smartphone           |  1610
                      |                      |  3710
(9 rows)</code></pre>
             
               <h2 id="r_GROUP_BY_aggregation-extentions-grouping"><em>Funzioni GROUPING/GROUPING_ID</em></h2>
               <p> ROLLUP e CUBE aggiungono valori NULL al set di risultati per indicare le righe di subtotali. Ad esempio, GROUP BY ROLLUP((a), (b)) restituisce una o più righe con un valore NULL nella colonna di raggruppamento b per indicare che si tratta di subtotali dei campi nella colonna di raggruppamento a. Questi valori NULL servono solo a soddisfare il formato delle tuple restituite.</p>
               <p> Quando si eseguono operazioni GROUP BY con ROLLUP e CUBE su relazioni che memorizzano i valori NULL, è possibile produrre set di risultati con righe che sembrano avere colonne di raggruppamento identiche. Tornando all'esempio precedente, se la colonna di raggruppamento b contiene un valore NULL memorizzato, GROUP BY ROLLUP((a), (b)) restituisce una riga con un valore NULL nella colonna di raggruppamento b che non è un subtotale. </p>
               <p> Per distinguere tra i valori NULL creati da ROLLUP e CUBE e i valori NULL memorizzati nelle tabelle stesse, è possibile utilizzare la funzione GROUPING o il relativo alias GROUPING_ID. GROUPING accetta un singolo set di raggruppamento come argomento e per ogni riga del set di risultati restituisce un valore di 0 o 1 bit corrispondente alla colonna di raggruppamento in quella posizione, quindi converte tale valore in un numero intero. Se il valore in quella posizione è un valore NULL creato da un'estensione di aggregazione, GROUPING restituisce 1. Restituisce 0 per tutti gli altri valori, inclusi i valori NULL memorizzati.</p>
               <p> Ad esempio, GROUPING(category, product) può restituire i seguenti valori per una determinata riga, a seconda dei valori della colonna di raggruppamento per quella riga. Ai fini di questo esempio, tutti i valori NULL nella tabella sono creati da un'estensione di aggregazione.</p>
               <div class="table-container"><div class="table-contents"><table id="w319aac47b9d187c19b9c15c11"><thead>
                        <tr>
                           <th>Colonna della categoria</th>
                           <th>Colonna del prodotto</th>
                           <th>Valore in bit della funzione GROUPING</th>
                           <th>Valore decimale</th>
                        </tr>
                     </thead>
                        <tr>
                           <td tabindex="-1">Non NULL</td>
                           <td tabindex="-1">Non NULL</td>
                           <td tabindex="-1">00</td>
                           <td tabindex="-1">0</td>
                        </tr>
                        <tr>
                           <td tabindex="-1">Non NULL</td>
                           <td tabindex="-1">NULL</td>
                           <td tabindex="-1">01</td>
                           <td tabindex="-1">1</td>
                        </tr>
                        <tr>
                           <td tabindex="-1">NULL</td>
                           <td tabindex="-1">Non NULL</td>
                           <td tabindex="-1">10</td>
                           <td tabindex="-1">2</td>
                        </tr>
                        <tr>
                           <td tabindex="-1">NULL</td>
                           <td tabindex="-1">NULL</td>
                           <td tabindex="-1">11</td>
                           <td tabindex="-1">3</td>
                        </tr>
                     </table></div></div>
               <p>Le funzioni di GROUPING vengono mostrate nella parte dell'elenco SELECT della query nel seguente formato.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">SELECT ... [GROUPING( <em>expr</em> )...] ...
  GROUP BY ... <span>{</span>CUBE | ROLLUP| GROUPING SETS} ( <em>expr</em> ) ...
               </code></pre>
               <p>L'esempio seguente è analogo all'esempio precedente per CUBE, ma con l'aggiunta di funzioni GROUPING per i relativi set di raggruppamento.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT category, product,
       GROUPING(category) as grouping0,
       GROUPING(product) as grouping1,
       GROUPING(category, product) as grouping2,
       sum(cost) as total
FROM orders
GROUP BY CUBE(category, product) ORDER BY 3,1,2;

       category       |       product        | grouping0 | grouping1 | grouping2 | total
----------------------+----------------------+-----------+-----------+-----------+-------
 cellphones           | smartphone           |         0 |         0 |         0 |  1610
 cellphones           |                      |         0 |         1 |         1 |  1610
 computers            | laptop               |         0 |         0 |         0 |  2050
 computers            | mouse                |         0 |         0 |         0 |    50
 computers            |                      |         0 |         1 |         1 |  2100
                      | laptop               |         1 |         0 |         2 |  2050
                      | mouse                |         1 |         0 |         2 |    50
                      | smartphone           |         1 |         0 |         2 |  1610
                      |                      |         1 |         1 |         3 |  3710
(9 rows)</code></pre>
             
               <h2 id="r_GROUP_BY_aggregation-extentions-partial"><em>ROLLUP e CUBE parziali</em></h2>
               <p> È possibile eseguire operazioni ROLLUP e CUBE con solo una parte dei subtotali. </p>
               <p> La sintassi per le operazioni parziali di ROLLUP e CUBE è la seguente.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">GROUP BY <em>expr1</em>, <span>{</span> ROLLUP | CUBE }(<em>expr2</em>, [, ...])</code></pre>
               <p>Qui, la clausola GROUP BY crea solo righe di subtotali a livello di <em>expr2</em> e successivi.</p>
               <p>Gli esempi seguenti mostrano le operazioni parziali di ROLLUP e CUBE nella tabella degli ordini, raggruppate in base allo stato di usato o meno di un prodotto; le operazioni di ROLLUP e CUBE vengono quindi eseguite nelle colonne della categoria e del prodotto.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT pre_owned, category, product,
       GROUPING(category, product, pre_owned) as group_id,
       sum(cost) as total
FROM orders
GROUP BY pre_owned, ROLLUP(category, product) ORDER BY 4,1,2,3;

 pre_owned |       category       |       product        | group_id | total
-----------+----------------------+----------------------+----------+-------
 F         | computers            | laptop               |        0 |  1050
 F         | computers            | mouse                |        0 |    50
 T         | cellphones           | smartphone           |        0 |  1610
 T         | computers            | laptop               |        0 |  1000
 F         | computers            |                      |        2 |  1100
 T         | cellphones           |                      |        2 |  1610
 T         | computers            |                      |        2 |  1000
 F         |                      |                      |        6 |  1100
 T         |                      |                      |        6 |  2610
(9 rows)

SELECT pre_owned, category, product,
       GROUPING(category, product, pre_owned) as group_id,
       sum(cost) as total
FROM orders
GROUP BY pre_owned, CUBE(category, product) ORDER BY 4,1,2,3;

 pre_owned |       category       |       product        | group_id | total
-----------+----------------------+----------------------+----------+-------
 F         | computers            | laptop               |        0 |  1050
 F         | computers            | mouse                |        0 |    50
 T         | cellphones           | smartphone           |        0 |  1610
 T         | computers            | laptop               |        0 |  1000
 F         | computers            |                      |        2 |  1100
 T         | cellphones           |                      |        2 |  1610
 T         | computers            |                      |        2 |  1000
 F         |                      | laptop               |        4 |  1050
 F         |                      | mouse                |        4 |    50
 T         |                      | laptop               |        4 |  1000
 T         |                      | smartphone           |        4 |  1610
 F         |                      |                      |        6 |  1100
 T         |                      |                      |        6 |  2610
(13 rows)</code></pre>
               <p>Poiché la colonna dei prodotti usati non è inclusa nelle operazioni ROLLUP e CUBE, non esiste una riga totale complessiva che includa tutte le altre righe. </p>
             
               <h2 id="r_GROUP_BY_aggregation-extentions-concat"><em>Raggruppamento concatenato</em></h2>
               <p> È possibile concatenare più clausole GROUPING SETS/ROLLUP/CUBE per calcolare diversi livelli di subtotali. I raggruppamenti concatenati restituiscono il prodotto cartesiano dei set di raggruppamento forniti. </p>
               <p> La sintassi per concatenare le clausole GROUPING SETS/ROLLUP/CUBE è la seguente.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">GROUP BY <span>{</span>ROLLUP|CUBE|GROUPING SETS}(<em>expr1</em>[, ...]),
         <span>{</span>ROLLUP|CUBE|GROUPING SETS}(<em>expr1</em>[, ...])[, ...]</code></pre>
               <p>L'esempio seguente mostra come un piccolo raggruppamento concatenato possa produrre un notevole set di risultati finali.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT pre_owned, category, product,
       GROUPING(category, product, pre_owned) as group_id,
       sum(cost) as total
FROM orders
GROUP BY CUBE(category, product), GROUPING SETS(pre_owned, ())
ORDER BY 4,1,2,3;

 pre_owned |       category       |       product        | group_id | total
-----------+----------------------+----------------------+----------+-------
 F         | computers            | laptop               |        0 |  1050
 F         | computers            | mouse                |        0 |    50
 T         | cellphones           | smartphone           |        0 |  1610
 T         | computers            | laptop               |        0 |  1000
           | cellphones           | smartphone           |        1 |  1610
           | computers            | laptop               |        1 |  2050
           | computers            | mouse                |        1 |    50
 F         | computers            |                      |        2 |  1100
 T         | cellphones           |                      |        2 |  1610
 T         | computers            |                      |        2 |  1000
           | cellphones           |                      |        3 |  1610
           | computers            |                      |        3 |  2100
 F         |                      | laptop               |        4 |  1050
 F         |                      | mouse                |        4 |    50
 T         |                      | laptop               |        4 |  1000
 T         |                      | smartphone           |        4 |  1610
           |                      | laptop               |        5 |  2050
           |                      | mouse                |        5 |    50
           |                      | smartphone           |        5 |  1610
 F         |                      |                      |        6 |  1100
 T         |                      |                      |        6 |  2610
           |                      |                      |        7 |  3710
(22 rows)</code></pre>
             
               <h2 id="r_GROUP_BY_aggregation-extentions-nested"><em>Raggruppamento nidificato</em></h2>
               <p> È possibile utilizzare le operazioni GROUPING SETS/ROLLUP/CUBE come GROUPING SETS <em>espr</em> per formare un raggruppamento nidificato. Il sottoraggruppamento all'interno dei GROUPING SETS nidificati viene appiattito. </p>
               <p> La sintassi per il raggruppamento nidificato è la seguente:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">GROUP BY GROUPING SETS(<span>{</span>ROLLUP|CUBE|GROUPING SETS}(<em>expr</em>[, ...])[, ...])</code></pre>
               <p>Analizza l'esempio seguente.</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT category, product, pre_owned,
       GROUPING(category, product, pre_owned) as group_id,
       sum(cost) as total
FROM orders
GROUP BY GROUPING SETS(ROLLUP(category), CUBE(product, pre_owned))
ORDER BY 4,1,2,3;

       category       |       product        | pre_owned | group_id | total
----------------------+----------------------+-----------+----------+-------
 cellphones           |                      |           |        3 |  1610
 computers            |                      |           |        3 |  2100
                      | laptop               | F         |        4 |  1050
                      | laptop               | T         |        4 |  1000
                      | mouse                | F         |        4 |    50
                      | smartphone           | T         |        4 |  1610
                      | laptop               |           |        5 |  2050
                      | mouse                |           |        5 |    50
                      | smartphone           |           |        5 |  1610
                      |                      | F         |        6 |  1100
                      |                      | T         |        6 |  2610
                      |                      |           |        7 |  3710
                      |                      |           |        7 |  3710
(13 rows)</code></pre>
               <p>È importante notare che, poiché sia ROLLUP(category) che CUBE(product, pre_owned) contengono il set di raggruppamento (), la riga che rappresenta il totale complessivo viene duplicata.</p>
             
               <h2 id="r_GROUP_BY_aggregation-extensions-usage-notes"><em>Note per l'utilizzo</em></h2><div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p>La clausola GROUP BY supporta fino a 64 set di raggruppamento. Nel caso di ROLLUP e CUBE o di una combinazione di GROUPING SETS, ROLLUP e CUBE, questa limitazione si applica al numero implicito di set di raggruppamento. Ad esempio, GROUP BY CUBE((a), (b)) conta per 4 set di raggruppamento, non 2.</p>
                  </li><li class="listitem">
                     <p>Non è possibile utilizzare le costanti come colonne di raggruppamento quando si utilizzano le estensioni di aggregazione.</p>
                  </li><li class="listitem">
                     <p>Non è possibile creare un set di raggruppamento che contiene colonne duplicate.</p>
                  </li></ul></div>
            <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avvertimento" /> <strong>JavaScript è disabilitato o non è disponibile nel tuo browser.</strong></p><p>Per usare la documentazione AWS, JavaScript deve essere abilitato. Consulta le pagine della guida del browser per le istruzioni.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenzioni dei documenti</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_GROUP_BY_clause.html">Clausola GROUP BY</div><div id="next" class="next-link" accesskey="n" href="./r_HAVING_clause.html">Clausola HAVING</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Questa pagina ti è stata utile? - Sì</div><div class="content"><p>Grazie per averci comunicato che stiamo facendo un buon lavoro!</p><p>Se hai un momento, ti invitiamo a dirci che cosa abbiamo fatto che ti è piaciuto così possiamo offrirti altri contenuti simili.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Questa pagina ti è stata utile? - No</div><div class="content"><p>Grazie per averci comunicato che questa pagina ha bisogno di essere modificata. Siamo spiacenti di non aver soddisfatto le tue esigenze.</p><p>Se hai un momento, ti invitiamo a dirci come possiamo migliorare la documentazione.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_GROUP_BY_aggregation-extensions.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>