<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="it-IT"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Piano di query - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="c-the-query-plan" /><meta name="default_state" content="c-the-query-plan" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-the-query-plan.html" /><meta name="description" content="Illustra come interpretare un piano di query." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guida per sviluppatori di database" /><meta name="abstract" content="Creare e gestire un data warehouse con Amazon Redshift, un servizio di data warehouse completamente gestito di livello aziendale e con capacità nell'ordine di più petabyte." /><meta name="guide-locale" content="it_it" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-the-query-plan.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c-the-query-plan.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c-the-query-plan.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c-the-query-plan.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c-the-query-plan.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-the-query-plan.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-the-query-plan.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-the-query-plan.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-the-query-plan.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-the-query-plan.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-the-query-plan.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-the-query-plan.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-the-query-plan.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c-the-query-plan.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c-the-query-plan.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c-the-query-plan.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c-the-query-plan.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-the-query-plan.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-the-query-plan.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/c-the-query-plan.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/c-the-query-plan.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-the-query-plan.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guida per sviluppatori di database" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guida per sviluppatori di database" /><meta id="panorama-serviceConsolePage" value="Piano di query" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Piano di query - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#c-the-query-plan" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-the-query-plan.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-the-query-plan.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-the-query-plan.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,sviluppatore,dati campione,database,sviluppatore di database,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guida per sviluppatori di database",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Ottimizzazione delle prestazioni delle query",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-optimizing-query-performance.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Elaborazione query",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-query-processing.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Piano di query",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-query-processing.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#c-the-query-plan" target="_blank" rel="noopener noreferrer" title="Apri PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentazione</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guida per sviluppatori di database</a></div><div id="page-toc-src"><a href="#EXPLAIN-operators">Operatori EXPLAIN</a><a href="#joins-in-EXPLAIN">Combinazioni su EXPLAIN</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Le traduzioni sono generate tramite traduzione automatica. In caso di conflitto tra il contenuto di una traduzione e la versione originale in Inglese, quest'ultima prevarrà.</p></awsui-alert><h1 class="topictitle" id="c-the-query-plan">Piano di query</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Per ottenere informazioni sulle operazioni individuali necessarie per eseguire una query, puoi utilizzare il piano di query. Prima di lavorare con il piano di query, consigliamo di capire in che modo Amazon Redshift gestisce l'elaborazione delle query e crea piani di query. Per ulteriori informazioni, consultare <a href="./c-query-planning.html">Pianificazione di query e flusso di lavoro di esecuzione</a>.</p><p>Per creare un piano di query, esegui il comando <a href="./r_EXPLAIN.html">EXPLAIN</a> seguito dal testo di query corrente. Il piano di query rende le seguenti informazioni:</p><div class="itemizedlist">
             
             
             
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>Quali operazioni eseguirà il motore di esecuzione, leggendo i risultati dal basso verso l'alto.</p>
            </li><li class="listitem">
               <p>Che tipo di fase esegue ogni operazione.</p>
            </li><li class="listitem">
               <p>Quali tabelle e colonne vengono utilizzate in ogni operazione.</p>
            </li><li class="listitem">
               <p>Quanti dati vengono eseguiti in ogni operazione, in termini di numero delle file e di larghezza dei dati in byte.</p>
            </li><li class="listitem">
               <p>Il costo relativo dell'operazione. Il <em>costo</em> è una misura che confronta i tempi di esecuzione relativi delle fasi all'interno di un piano. Il costo non fornisce alcuna informazioni precisa in merito all'attuale consumo di memoria o ai tempi di esecuzione; non fornisce inoltre un confronto significativo tra i piani di esecuzione. Non ti fornisce un'indicazione di quali operazioni stanno consumando più risorse in una query.</p>
            </li></ul></div><p>Il comando EXPLAIN non esegue effettivamente la query. Mostra solamente il piano che verrà eseguito da Amazon Redshift se la query viene eseguita nelle condizioni operative attuali. Se modifichi lo schema o i dati di una tabella ed esegui nuovamente il comando <a href="./r_ANALYZE.html">ANALYZE</a> per aggiornare i metadati statistici, il piano di query potrebbe essere differente.</p><p>L'output del piano di query che genera il comando EXPLAIN, è una visualizzazione semplificata e di alto livello dell'esecuzione della query. Non illustra i dettagli dell'elaborazione di query parallela. Per visualizzare le informazioni dettagliate, devi eseguire la stessa query, quindi ottenere le informazioni di riepilogo della query dalle visualizzazioni SVL_QUERY_SUMMARY o SVL_QUERY_REPORT. Per ulteriori informazioni sull'utilizzo di queste visualizzazioni, consultare <a href="./c-analyzing-the-query-summary.html">Analisi del riepilogo della query</a>.</p><p>Il seguente esempio illustra l'output EXPLAIN per una semplice query GROUP BY sulla tabella EVENT:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">explain select eventname, count(*) from event group by eventname;

                            QUERY PLAN
-------------------------------------------------------------------
XN HashAggregate  (cost=131.97..133.41 rows=576 width=17)
  -&gt;  XN Seq Scan on event  (cost=0.00..87.98 rows=8798 width=17)</code></pre><p>EXPLAIN restituisce i seguenti parametri per ogni operazione:</p><div class="variablelist">
             
             
             
         <dl>
               <dt><b><span class="term">Costo</span></b></dt>
               <dd>
                  <p>Un valore relativo utile per il confronto delle operazioni all'interno di un piano. Il costo è costituito da due valori decimali separati da due punti, ad esempio <code class="code">cost=131.97..133.41</code>. Il primo valore, in questo caso 131.97, fornisce il costo relativo della restituzione della prima riga per questa operazione. Il secondo valore, in questo caso 133.41, fornisce il costo relativo del completamento dell'operazione. I costi del piano di query sono cumulativi man mano che si legge il piano, quindi il  HashAggregate  costo in questo esempio (131,97.. 133.41) include il costo del Seq Scan sottostante (0,00.. 87,98).</p>
               </dd>
            
               <dt><b><span class="term">Righe</span></b></dt>
               <dd>
                  <p>Il numero di righe previsto da restituire. In questo esempio, si prevede che la scansione restituisca 8798 righe. L' HashAggregate operatore da solo dovrebbe restituire 576 righe (dopo che i nomi di eventi duplicati sono stati eliminati dal set di risultati).</p>
                  <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Nota</h6></div><div class="awsdocs-note-text"><p>La stima delle righe si basa sulle statistiche disponibili generate dal comando ANALYZE. Se il comando ANALYZE non è stato eseguito di recente, la stima sarà meno affidabile.</p></div></div>
               </dd>
            
               <dt><b><span class="term">Larghezza</span></b></dt>
               <dd>
                  <p>La larghezza stimata della riga media, misurata in byte. In questo esempio, si prevede che la riga media sia larga 17 byte.</p>
               </dd>
            </dl></div><h2 id="EXPLAIN-operators">Operatori EXPLAIN</h2>
            
            <p>Questa sezione descrive brevemente gli operatori che visualizzi più spesso nell'output EXPLAIN. Per un elenco completo degli operatori, consultare <a href="./r_EXPLAIN.html">EXPLAIN</a> nella sezione relativa ai comandi SQL.</p>
            <h3 id="scan-operator">Operatore scansione sequenziale</h3>
               
               <p>L'operatore scansione sequenziale (Seq Scan) indica una scansione della tabella. Seq Scan scansiona ogni colonna della tabella in maniera sequenziale dall'inizio alla fine, valutando le limitazioni della query (nella clausola WHERE) per ogni riga.</p>
             
            <h3 id="join-operators">Operatori di combinazione</h3>
               
               <p>Amazon Redshift seleziona gli operatori join basati sul progetto fisico delle tabelle combinate, la posizione dei dati necessari per il join e i requisiti specifici della stessa query.</p>
               <div class="itemizedlist">
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><span class="topcom">Loop nidificato</span></p>
                     <p>La combinazione meno ottimale è un loop nidificato, utilizzato principalmente per le combinazioni incrociate (prodotti cartesiano) e per alcune combinazioni di disuguaglianza.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Operatori hash join e hash</span></p>
                     <p>Generalmente più veloci di una combinazione loop nidificata, un operatore hash join e hash viene utilizzato per le inner join e per le outer join destra e sinistra. Questi operatori vengono utilizzati nel caso cui le tabelle combinate in cui si trovano le colonne di combinazione non siano chiavi di distribuzione <em>e</em> chiavi di ordinamento. L'operatore hash crea la tabella hash per la tabella interna nella combinazione; l'operatore hash join legge la tabella esterna, esegue la colonna di combinazione e trova corrispondenze nella tabella interna hash.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Merge join</span></p>
                     <p>Un merge join, generalmente la combinazione più veloce, viene utilizzato per le inner join e le outer join. Merge join non si utilizza per le full join. Questo operatore viene utilizzato nel caso cui le tabelle combinate in cui si trovano le colonne di combinazione siano chiavi di distribuzione <em>e</em> chiavi di ordinamento; inoltre viene utilizzato quando meno del 20 percento delle tabelle combinate non viene ordinato. Legge due tabelle ordinate e trova le righe corrispondenti. Per visualizzare la percentuale delle righe non ordinate, eseguire una query della tabella di sistema <a href="./r_SVV_TABLE_INFO.html">SVV_TABLE_INFO</a>.</p>
                  </li><li class="listitem"> 
                     <p><span class="topcom">Spatial Join</span></p>
                     <p>In genere un join rapido basato sulla prossimità dei dati spaziali, utilizzati per i tipi di dati <code class="code">GEOMETRY</code> e <code class="code">GEOGRAPHY</code>.</p>
                  </li></ul></div>
             
            <h3 id="aggregate-operators">Operatori di aggregazione</h3>
               
               <p>Il piano di query utilizza i seguenti operatori nelle query che implicano le funzioni aggregate e le operazioni GROUP BY.</p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><span class="topcom">Aggregazione</span></p>
                     <p>L'operatore per le funzioni aggregate scalari, come AVG e SUM.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">HashAggregate</span></p>
                     <p>L'operatore per le funzioni aggregate raggruppate in modo non ordinato.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">GroupAggregate</span></p>
                     <p>L'operatore per le funzioni aggregate raggruppate in modo ordinato.</p>
                  </li></ul></div>
             
            <h3 id="sort-operators">Operatori di ordinamento</h3>
               
               <p>Il piano di query utilizza i seguenti operatori quando le query devono ordinare o unire gli insiemi dei risultati.</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><span class="topcom">Ordina</span></p>
                     <p>Valuta le clausole ORDER BY e altre operazioni di ordinamento, come gli ordinamenti necessari per le query e le combinazioni UNION, le query SELECT DISTINCT e le funzioni finestra.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Unione</span></p>
                     <p>Produce risultati ordinati finali a seconda dei risultati ordinati intermedi che derivano dalle operazioni parallele.</p>
                  </li></ul></div>
             
            <h3 id="UNION-INTERSECT-and-EXCEPT-operators">Operatori UNION, INTERSECT ed EXCEPT</h3>
               
               <p>Il piano di query utilizza i seguenti operatori per le query che implicano le funzioni aggregate e le operazioni dell'insieme con UNION, INTERSECT e EXCEPT.</p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><span class="topcom">Sottoquery</span></p>
                     <p>Utilizzate per eseguire le query UNION.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Hash Intersect Distinct </span></p>
                     <p>Utilizzato per eseguire query INTERSECT .</p>
                  </li><li class="listitem">
                     <p><span class="topcom">SetOp Eccetto</span></p>
                     <p>Utilizzato per eseguire le query EXCEPT (o MINUS).</p>
                  </li></ul></div>
             
            <h3 id="other-operators">Altri operatori</h3>
               
               <p>I seguenti operatori appaiono frequentemente anche nell'output EXPLAIN per le query di routine.</p>
               <div class="itemizedlist">
                   
                   
                   
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><span class="topcom">Unique</span></p>
                     <p>Elimina i duplicati per le query SELECT DISTINCT e per le query UNION.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Limite</span></p>
                     <p>Elabora la clausola LIMIT.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Window</span></p>
                     <p>Esegue le funzioni finestra.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Risultato</span></p>
                     <p>Esegue le funzioni scalati che non implicano alcun accesso di tabella.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Subplan</span></p>
                     <p>Utilizzato per determinate sottoquery.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Rete</span></p>
                     <p>Invia risultati intermedi al nodo principale per elaborazioni future.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">Materialize</span></p>
                     <p>Salva le righe per l'ingresso delle combinazioni del loop nidificato e alcuni merge join.</p>
                  </li></ul></div>
             
         <h2 id="joins-in-EXPLAIN">Combinazioni su EXPLAIN</h2>
            
            <p>L'ottimizzatore di query utilizza diversi tipi di combinazioni per recuperare i dati della tabella, a seconda della struttura della query e delle tabelle sottostanti. L'output EXPLAIN fa riferimento al tipo di combinazione, alla tabella utilizzata e al modo in cui i dati della tabella vengono distribuiti all'interno del cluster, al fine di descrivere in che modo viene elaborata la query.</p>

            <h3 id="join-types">Esempi di tipo di join</h3>
               
               <p>I seguenti esempi mostrano i diversi tipi di combinazione che può utilizzare l'ottimizzatore di query. Il tipo di combinazione utilizzato nel piano della query dipende dal progetto fisico delle tabelle coinvolte.</p>
               <h4 id="hash-join-two-tables">Esempio: eseguire un hash join di due tabelle</h4>
                  
                  <p>La seguente query combina EVENT e CATEGORY sulla colonna CATID. CATID è la chiave di distribuzione e di ordinamento per CATEGORY, ma non per EVENT. Un hash join viene eseguito con EVENT come tabella esterna e CATEGORY come tabella interna. Dato che CATEGORY è la tabella più piccola, il pianificatore trasmette una copia della stessa ai nodi di calcolo durante l'elaborazione della query, mediante l'uso di DS_BCAST_INNER. Il costo di combinazione in questo esempio rappresenta la maggior parte del costo cumulativo del piano.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">explain select * from category, event where category.catid=event.catid;

                               QUERY PLAN
-------------------------------------------------------------------------
 XN Hash Join DS_BCAST_INNER  (cost=0.14..6600286.07 rows=8798 width=84)
   Hash Cond: ("outer".catid = "inner".catid)
   -&gt;  XN Seq Scan on event  (cost=0.00..87.98 rows=8798 width=35)
   -&gt;  XN Hash  (cost=0.11..0.11 rows=11 width=49)
         -&gt;  XN Seq Scan on category  (cost=0.00..0.11 rows=11 width=49)</code></pre>
                  <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Nota</h6></div><div class="awsdocs-note-text"><p>I rientri allineati degli operatori nell'output EXPLAIN, indicano a volte che quelle operazioni non dipendono l'una dall'altra e che possono iniziare in parallelo. Nell'esempio precedente, nonostante la scansione sulla tabella EVENT e le operazioni hash siano allineate, la scansione EVENT deve attendere il completamento totale dell'operazione hash.</p></div></div>
                
               <h4 id="merge-join-two-tables">Esempio: eseguire un merge join di due tabelle</h4>
                  
                  <p>La seguente query utilizza anche SELECT *, ma combina SALES e LISTING sulla colonna LISTID, dove LISTID è stato impostato come chiave di distribuzione e come chiave di ordinamento per entrambe le tabelle. Viene scelto un merge join e per la combinazione non è necessaria alcuna ridistribuzione dei dati (DS_DIST_NONE).</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">explain select * from sales, listing where sales.listid = listing.listid;
QUERY PLAN
-----------------------------------------------------------------------------
XN Merge Join DS_DIST_NONE  (cost=0.00..6285.93 rows=172456 width=97)
  Merge Cond: ("outer".listid = "inner".listid)
  -&gt;  XN Seq Scan on listing  (cost=0.00..1924.97 rows=192497 width=44)
  -&gt;  XN Seq Scan on sales  (cost=0.00..1724.56 rows=172456 width=53)</code></pre>
                  <p>L'esempio seguente dimostra i diversi tipi di combinazione all'interno della stessa query. Come nell'esempio precedente, SALES e LISTING vengono combinati mediante l'operatore merge join, ma la terza tabella EVENT deve essere combinata con i risultati dell'operatore merge join. Ancora una volta, l'operatore merge join incorre in un costo di trasmissione.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">explain select * from sales, listing, event
where sales.listid = listing.listid and sales.eventid = event.eventid;
                                  QUERY PLAN
----------------------------------------------------------------------------
XN Hash Join DS_BCAST_INNER  (cost=109.98..3871130276.17 rows=172456 width=132)
  Hash Cond: ("outer".eventid = "inner".eventid)
  -&gt;  XN Merge Join DS_DIST_NONE  (cost=0.00..6285.93 rows=172456 width=97)
        Merge Cond: ("outer".listid = "inner".listid)
        -&gt;  XN Seq Scan on listing  (cost=0.00..1924.97 rows=192497 width=44)
        -&gt;  XN Seq Scan on sales  (cost=0.00..1724.56 rows=172456 width=53)
  -&gt;  XN Hash  (cost=87.98..87.98 rows=8798 width=35)
        -&gt;  XN Seq Scan on event  (cost=0.00..87.98 rows=8798 width=35)</code></pre>
                
               <h4 id="join-aggregate-and-sort-example">Esempi: Join, Aggregate e Sort</h4>
                  
                  <p>La seguente query esegue un hash join delle tabelle SALES e EVENT, seguito da operazioni di distribuzione e aggregazione per verificare la funzione SUM raggruppata e la clausola ORDER BY. L'operatore Sort iniziale viene eseguito in parallelo sui nodi di calcolo. Quindi l'operatore Network invia i risultati al nodo principale, dove l'operatore Merge produce i risultati finali ordinati.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">explain select eventname, sum(pricepaid) from sales, event 
where sales.eventid=event.eventid group by eventname
order by 2 desc;
                                           QUERY PLAN
---------------------------------------------------------------------------------
 XN Merge  (cost=1002815366604.92..1002815366606.36 rows=576 width=27)
  Merge Key: sum(sales.pricepaid)
  -&gt;  XN Network  (cost=1002815366604.92..1002815366606.36 rows=576 width=27)
        Send to leader
        -&gt;  XN Sort  (cost=1002815366604.92..1002815366606.36 rows=576 width=27)
              Sort Key: sum(sales.pricepaid)
              -&gt;  XN HashAggregate  (cost=2815366577.07..2815366578.51 rows=576 width=27)
                    -&gt;  XN Hash Join DS_BCAST_INNER  (cost=109.98..2815365714.80 rows=172456 width=27)
                          Hash Cond: ("outer".eventid = "inner".eventid)
                          -&gt;  XN Seq Scan on sales  (cost=0.00..1724.56 rows=172456 width=14)
                          -&gt;  XN Hash  (cost=87.98..87.98 rows=8798 width=21)
                                -&gt;  XN Seq Scan on event  (cost=0.00..87.98 rows=8798 width=21)</code></pre>
                
             
            <h3 id="data-redistribution">Ridistribuzione dei dati</h3>
               
               <p>L'output EXPLAIN per le combinazioni, inoltre, specifica un metodo per come verranno spostati i dati all'interno di un cluster, così che la combinazione sia più semplice. Questo movimento di dati può essere sia una trasmissione che una ridistribuzione. In una trasmissione, i valori dei dati da un lato della combinazione vengono copiati da ogni nodo di calcolo su ogni altro nodo di calcolo, così che ognuno di essi finisca con una copia completa dei dati. In una ridistribuzione, la partecipazione dei valori dei dati viene inviata dalla loro sezione attuale alla nuova sezione (possibilmente su un nodo differente). Solitamente i dati vengono ridistribuiti per far corrispondere la chiave di distribuzione dell'altra tabella che ha partecipato alla combinazione, nel caso in cui la chiave di distribuzione sia una delle colonne di combinazione. Se nessuna delle tabelle dispone di chiavi di distribuzione su una delle colonne di combinazione, entrambe le tabelle vengono distribuite o la tabella interna viene trasmessa a ogni nodo.</p>
               <p>L'output EXPLAIN fa riferimento anche alle tabelle esterne e interne. La tabella interna viene scansionata per prima e appare più vicina al fondo del piano di query. La tabella interna è la tabella in cui si trovano le corrispondenza. Questa si trova solitamente in memoria, di solito è la tabella di origine per l'hashing e, probabilmente, è la tabella più piccola delle due combinate. La tabella esterna è la sorgente delle righe da combinare con la tabella interna. Viene letta solitamente dal disco. L'ottimizzatore di query sceglie la tabella interne e quella esterna a seconda delle statistiche del database, che provengono dall'esecuzione più recente del comando ANALYZE. L'ordine delle tabelle nella clausola FROM di una query non determina quale sia la tabella esterne né quella interna.</p>
               <p>Utilizza i seguenti attributi nei piani di query, per identificare come verranno spostati i dati per facilitare una query:</p>
               <div class="itemizedlist">
                   
                   
                   
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><span class="topcom">DS_BCAST_INNER</span></p>
                     <p>Una copia di tutta la tabella interna viene trasmessa a tutti i nodi di calcolo.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">DS_DIST_ALL_NONE</span></p>
                     <p>Non è necessaria alcuna ridistribuzione, perché la tabella interna è già stata distribuita su ogni nodo mediante l'uso di DISTSTYLE ALL.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">DS_DIST_NONE</span></p>
                     <p>Nessuna tabella viene ridistribuita. È possibile disporre di combinazioni collocate, nel caso in cui le sezioni corrispondenti vengano combinate senza lo spostamento dei dati tra i nodi.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">DS_DIST_INNER</span></p>
                     <p>La tabella interna viene ridistribuita.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">DS_DIST_OUTER</span></p>
                     <p>La tabella esterna viene ridistribuita.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">DS_DIST_ALL_INNER</span></p>
                     <p>Tutta la tabella interna viene ridistribuita in una singola sezione, perché la tabella esterna utilizza DISTSTYLE ALL.</p>
                  </li><li class="listitem">
                     <p><span class="topcom">DS_DIST_BOTH</span></p>
                     <p>Entrambe le tabelle vengono ridistribuite.</p>
                  </li></ul></div>
             
         <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avvertimento" /> <strong>JavaScript è disabilitato o non è disponibile nel tuo browser.</strong></p><p>Per usare la documentazione AWS, JavaScript deve essere abilitato. Consulta le pagine della guida del browser per le istruzioni.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenzioni dei documenti</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./c-query-planning.html">Pianificazione di query e flusso di lavoro di esecuzione</div><div id="next" class="next-link" accesskey="n" href="./reviewing-query-plan-steps.html">Revisione delle fasi del piano di query</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Questa pagina ti è stata utile? - Sì</div><div class="content"><p>Grazie per averci comunicato che stiamo facendo un buon lavoro!</p><p>Se hai un momento, ti invitiamo a dirci che cosa abbiamo fatto che ti è piaciuto così possiamo offrirti altri contenuti simili.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-the-query-plan.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Questa pagina ti è stata utile? - No</div><div class="content"><p>Grazie per averci comunicato che questa pagina ha bisogno di essere modificata. Siamo spiacenti di non aver soddisfatto le tue esigenze.</p><p>Se hai un momento, ti invitiamo a dirci come possiamo migliorare la documentazione.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-the-query-plan.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>