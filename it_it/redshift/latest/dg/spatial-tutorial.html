<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="it-IT"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tutorial: Utilizzo delle funzioni SQL spaziali con Amazon Redshift - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="spatial-tutorial" /><meta name="default_state" content="spatial-tutorial" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/spatial-tutorial.html" /><meta name="description" content="Utilizzare questo tutorial per informazioni su come utilizzare le funzioni SQL spaziali con Amazon Redshift." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guida per sviluppatori di database" /><meta name="abstract" content="Creare e gestire un data warehouse con Amazon Redshift, un servizio di data warehouse completamente gestito di livello aziendale e con capacità nell'ordine di più petabyte." /><meta name="guide-locale" content="it_it" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/spatial-tutorial.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/spatial-tutorial.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/spatial-tutorial.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/spatial-tutorial.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/spatial-tutorial.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/spatial-tutorial.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/spatial-tutorial.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/spatial-tutorial.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/spatial-tutorial.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/spatial-tutorial.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/spatial-tutorial.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/spatial-tutorial.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/spatial-tutorial.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/spatial-tutorial.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/spatial-tutorial.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/spatial-tutorial.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/spatial-tutorial.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/spatial-tutorial.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/spatial-tutorial.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/spatial-tutorial.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/spatial-tutorial.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/spatial-tutorial.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guida per sviluppatori di database" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guida per sviluppatori di database" /><meta id="panorama-serviceConsolePage" value="Tutorial: Utilizzo delle funzioni SQL spaziali con Amazon Redshift" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Tutorial: Utilizzo delle funzioni SQL spaziali con Amazon Redshift - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#spatial-tutorial" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/spatial-tutorial.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/spatial-tutorial.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/spatial-tutorial.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,sviluppatore,dati campione,database,sviluppatore di database,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guida per sviluppatori di database",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Query su dati spaziali in Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/geospatial-overview.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Tutorial: Utilizzo delle funzioni SQL spaziali con Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/geospatial-overview.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#spatial-tutorial" target="_blank" rel="noopener noreferrer" title="Apri PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentazione</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guida per sviluppatori di database</a></div><div id="page-toc-src"><a href="#spatial-tutorial-prerequisites">Prerequisiti</a><a href="#spatial-tutorial-test-data">Fase 1: Creazione di tabelle e caricamento dei dati di test</a><a href="#spatial-tutorial-query">Fase 2: Query su dati spaziali</a><a href="#spatial-tutorial-clean-up">Fase 3: eliminazione delle risorse</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Le traduzioni sono generate tramite traduzione automatica. In caso di conflitto tra il contenuto di una traduzione e la versione originale in Inglese, quest'ultima prevarrà.</p></awsui-alert><h1 class="topictitle" id="spatial-tutorial">Tutorial: Utilizzo delle funzioni SQL spaziali con Amazon Redshift</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Questo tutorial mostra come utilizzare alcune delle funzioni SQL spaziali con Amazon Redshift. </p><p>A tale scopo, viene eseguita una query su due tabelle utilizzando le funzioni SQL spaziali. Il tutorial utilizza i dati provenienti da set di dati pubblici che correlano i dati sulla posizione degli alloggi in affitto con i codici postali a Berlino, Germania. </p><div class="highlights" id="inline-topiclist"><h6>Argomenti</h6><ul><li><a href="#spatial-tutorial-prerequisites">Prerequisiti</a></li><li><a href="#spatial-tutorial-test-data">Fase 1: Creazione di tabelle e caricamento dei dati di test</a></li><li><a href="#spatial-tutorial-query">Fase 2: Query su dati spaziali</a></li><li><a href="#spatial-tutorial-clean-up">Fase 3: eliminazione delle risorse</a></li></ul></div>
        <h2 id="spatial-tutorial-prerequisites">Prerequisiti</h2>
           
        <p>Per questo tutorial, sono necessarie le seguenti risorse:</p>
           
        <div class="itemizedlist">
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                        <p>Un cluster e un database Amazon Redshift esistenti a cui è possibile accedere e aggiornare. Nel cluster esistente è possibile creare tabelle, caricare dati di esempio ed eseguire query SQL per dimostrare le funzioni spaziali. Il cluster deve avere almeno due nodi. Per informazioni su come creare un cluster, seguire la procedura riportata in <a href="https://docs.aws.amazon.com/redshift/latest/gsg/">Guida alle operazioni di base di Amazon Redshift</a>. </p>
            </li><li class="listitem">
                        <p>Per utilizzare l'editor di query Amazon Redshift, assicurarsi che il cluster si trovi in una regione AWS che supporta l'editor di query. Per ulteriori informazioni, consulta <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/query-editor.html">Esecuzione di query su un database con l'editor di query</a> nella <em>Guida alla gestione di Amazon Redshift</em>. </p>
            </li><li class="listitem">
                        <p>Le credenziali AWS per il cluster Amazon Redshift che consentono di caricare i dati di test da Amazon S3. Per informazioni su come accedere ad altri servizi AWS, come Amazon S3, consulta <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/authorizing-redshift-service.html">Autorizzazione di Amazon Redshift ad accedere ai servizi AWS</a>.</p>
            </li><li class="listitem">
                        <p>Il ruolo AWS Identity and Access Management (IAM) denominato <code class="code">mySpatialDemoRole</code>, che ha la policy gestita <code class="code">AmazonS3ReadOnlyAccess</code> collegata per leggere i dati Amazon S3. Per creare un ruolo con l'autorizzazione per caricare i dati da un bucket Amazon S3, consulta <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/copy-unload-iam-role.html">Autorizzazione delle operazioni COPY, UNLOAD e CREATE EXTERNAL SCHEMA mediante ruoli IAM</a> nella <em>Guida alla gestione di Amazon Redshift</em>. </p>
            </li><li class="listitem"><p>Dopo aver creato il ruolo IAM <code class="code">mySpatialDemoRole</code>, tale ruolo richiede un'associazione con il cluster Amazon Redshift. Per ulteriori informazioni su come creare tale associazione, consulta <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/copy-unload-iam-role.html">Autorizzazione delle operazioni COPY, UNLOAD e CREATE EXTERNAL SCHEMA mediante ruoli IAM</a> nella <em>Guida alla gestione di Amazon Redshift</em>. </p>    
            </li></ul></div>   

        
        <h2 id="spatial-tutorial-test-data">Fase 1: Creazione di tabelle e caricamento dei dati di test</h2>
            
            
             
            <p>I dati di origine utilizzati in questo tutorial sono contenuti in file denominati <code>accommodations.csv</code> e <code>zipcodes.csv</code>. </p>
        <p>Il file <code>accommodations.csv</code> è costituito da dati open source provenienti da insideairbnb.com. Il file <code>zipcodes.csv</code> fornisce codici postali che sono dati open source dell'istituto nazionale di statistica di Berlino-Brandeburgo in Germania (Amt für Statistik Berlino-Brandeburgo). Entrambe le origini dati sono fornite con una licenza Creative Commons. I dati sono limitati alla regione di Berlino, Germania. Questi file si trovano in un bucket pubblico Amazon S3 da utilizzare con questo tutorial. </p>
            
            <p>Facoltativamente, è possibile scaricare i dati di origine dai seguenti link Amazon S3:</p> 
            <div class="itemizedlist">
                 
                 
            <ul class="itemizedlist"><li class="listitem"><p><a href="https://s3.amazonaws.com/redshift-downloads/spatial-data/accommodations.csv" rel="noopener noreferrer" target="_blank"><span>Dati di origine per la tabella <code class="code">accommodations</code></span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. </p></li><li class="listitem"><p><a href="https://s3.amazonaws.com/redshift-downloads/spatial-data/zipcode.csv" rel="noopener noreferrer" target="_blank"><span>Dati di origine per la tabella <code class="code">zipcode</code></span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. </p></li></ul></div>
            
           <p>Utilizzare la procedura seguente per creare tabelle e caricare i dati di test. </p>

            <div class="procedure"><h6>Come creare tabelle e caricare dati di test</h6><ol><li>
                    <p>Aprire l'editor di query Amazon Redshift. Per ulteriori informazioni sull'utilizzo dell'editor di query, consulta <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/query-editor.html">Esecuzione di query su un database con l'editor della query</a> nella <em>Guida alla gestione di Amazon Redshift</em>. </p> 
                </li><li>
                    <p>Eliminare le tabelle utilizzate da questo tutorial se sono già presenti nel database. Per ulteriori informazioni, consulta <a href="#spatial-tutorial-clean-up">Fase 3: eliminazione delle risorse</a>. </p>
                </li><li>
                    <p>Creare la tabella <code class="code">accommodations</code> per memorizzare la posizione geografica di ogni alloggio (longitudine e latitudine), il nome dell'inserzione e altri dati aziendali. </p>
                <p>Questo tutorial esplora gli affitti di camere a Berlino, in Germania. La colonna <code class="code">shape</code> riporta i punti geografici della posizione degli alloggi. Le altre colonne contengono informazioni sull'affitto. </p>
                    <p>Per creare la tabella <code class="code">accommodations</code>, eseguire la seguente istruzione SQL nell'editor di query Amazon Redshift. </p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE TABLE public.accommodations (
  id INTEGER PRIMARY KEY,
  shape GEOMETRY,
  name VARCHAR(100),
  host_name VARCHAR(100),
  neighbourhood_group VARCHAR(100),
  neighbourhood VARCHAR(100),
  room_type VARCHAR(100),
  price SMALLINT,
  minimum_nights SMALLINT,
  number_of_reviews SMALLINT,
  last_review DATE,
  reviews_per_month NUMERIC(8,2),
  calculated_host_listings_count SMALLINT, 
  availability_365 SMALLINT
);</code></pre>
               </li><li>
                    <p>Creare la tabella <code class="code">zipcode</code> nell'editor di query per memorizzare i codici postali di Berlino. </p>
                <p>Un <em>codice postale (o CAP)</em> è definito come un poligono nella colonna <code class="code">wkb_geometry</code>. Le altre colonne descrivono metadati spaziali aggiuntivi relativi al codice postale. </p>
                <p>Per creare la tabella <code class="code">zipcode</code>, eseguire la seguente istruzione SQL nell'editor di query Amazon Redshift. </p>
                    
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">CREATE TABLE public.zipcode (
  ogc_field INTEGER PRIMARY KEY NOT NULL,
  wkb_geometry GEOMETRY,
  gml_id VARCHAR(256),
  spatial_name VARCHAR(256),
  spatial_alias VARCHAR(256),
  spatial_type VARCHAR(256)
 );</code></pre>
                    
                </li><li>
                    <p>Caricare le tabelle mediante i dati di esempio. </p>
                <p>I dati campione per questo tutorial si trovano in un bucket Amazon S3 che fornisce accesso in lettura a tutti gli utenti AWS autenticati. Assicurarsi di fornire credenziali AWS valide che consentano di accedere ad Amazon S3. </p>
                <p>Per caricare i dati di test nelle tabelle, emettere i seguenti comandi COPY. Sostituire <code class="replaceable"><code class="code">account-number</code></code> con il numero di account AWS. Il segmento della stringa delle credenziali racchiuso tra virgolette singole non deve contenere spazi o interruzioni di riga. </p>
                    
                    
  
                                                         
                            
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">COPY public.accommodations 
FROM 's3://redshift-downloads/spatial-data/accommodations.csv' 
DELIMITER ';' 
IGNOREHEADER 1 REGION 'us-east-1'
CREDENTIALS 'aws_iam_role=arn:aws:iam::<code class="replaceable">account-number</code>:role/mySpatialDemoRole';
</code></pre>
                            
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">COPY public.zipcode 
FROM 's3://redshift-downloads/spatial-data/zipcode.csv' 
DELIMITER ';' 
IGNOREHEADER 1 REGION 'us-east-1'
CREDENTIALS 'aws_iam_role=arn:aws:iam::<code class="replaceable">account-number</code>:role/mySpatialDemoRole';
</code></pre>  
 
 
                            
                            
                             
                            
                </li><li>
                    <p>Verificare che ogni tabella sia caricata correttamente emettendo i comandi seguenti. </p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">select count(*) from accommodations;</code></pre>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">select count(*) from zipcode;</code></pre>
                    <p>I risultati seguenti mostrano il numero di righe di ogni tabella di dati di test.</p>
                    <div class="table-container"><div class="table-contents"><table id="w319aac25c67c11c13c12b9"><thead>
                                <tr>
                                    <th>Nome tabella</th>
                                    <th>Righe</th>
                                </tr>
                            </thead>
                                <tr>
                                    <td tabindex="-1">alloggi</td>
                                    <td tabindex="-1">22.248</td>
                                </tr>
                                <tr>
                                    <td tabindex="-1">zipcode</td>
                                    <td tabindex="-1">190</td>
                                </tr>
                            </table></div></div>
                </li></ol></div>                       
     
        <h2 id="spatial-tutorial-query">Fase 2: Query su dati spaziali</h2>

        <p>Dopo aver creato e caricato le tabelle, è possibile eseguire le query utilizzando le istruzioni SQL SELECT. Le query seguenti illustrano alcune delle informazioni che è possibile recuperare. È possibile scrivere molte altre query che utilizzano funzioni spaziali per soddisfare le proprie esigenze. </p>
        <div class="procedure"><h6>Come eseguire query su dati spaziali</h6><ol><li>
                <p>Eseguire le query per ottenere il conteggio del numero totale di risultati memorizzati nella tabella <code class="code">accommodations</code>, come illustrato di seguito. Il sistema di riferimento territoriale è World Geodetic System (WGS) 84, che ha l'identificatore univoco di riferimento territoriale 4326.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT count(*) FROM public.accommodations WHERE ST_SRID(shape) = 4326;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
 count
-------
 22248</code></pre>                
            </li><li>
                <p>Recuperare gli oggetti geometrici in formato WKT (well-known text) con alcuni attributi aggiuntivi. Inoltre, è possibile verificare se questi dati del codice postale sono memorizzati anche nel World Geodetic System (WGS) 84, che utilizza l'ID di riferimento spaziale (SRID) 4326. Perché possano essere utilizzati in maniera incrociata, i dati spaziali devono essere conservati nello stesso sistema di riferimento territoriale. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT ogc_field, spatial_name, spatial_type, ST_SRID(wkb_geometry), ST_AsText(wkb_geometry) 
FROM public.zipcode 
ORDER BY spatial_name;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
ogc_field  spatial_name  spatial_type  st_srid  st_astext
---------------------------------------------------------------
0           10115        Polygon        4326     POLYGON((...))
4           10117        Polygon        4326     POLYGON((...))
8           10119        Polygon        4326     POLYGON((...))
...
(190 rows returned)</code></pre>
                
            </li><li>
                <p>Selezionare il poligono di Berlin Mitte (10117), un quartiere di Berlino, in formato GeoJSON, la sua dimensione e il numero di punti in questo poligono. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT ogc_field, spatial_name, ST_AsGeoJSON(wkb_geometry), ST_Dimension(wkb_geometry), ST_NPoints(wkb_geometry)
FROM public.zipcode 
WHERE spatial_name='10117';</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
ogc_field  spatial_name  spatial_type                                   st_dimension  st_npoint
-----------------------------------------------------------------------------------------------
4           10117         <span>{</span>"type":"Polygon", "coordinates":[[[...]]]}    2             331
</code></pre>
                
            </li><li>
                <p>Emettere il seguente comando SQL per visualizzare quante strutture ricettive si trovano nel raggio di 500 metri dalla Porta di Brandeburgo. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT count(*) 
FROM public.accommodations 
WHERE ST_DistanceSphere(shape, ST_GeomFromText('POINT(13.377704 52.516431)', 4326)) &lt; 500;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
count
------
  29
</code></pre>
                             
            </li><li>
                <p>Ottenere la posizione approssimativa della Porta di Brandeburgo dai dati archiviati nelle strutture elencate come nelle vicinanze eseguendo la seguente query.</p>
                <p>Questa query richiede una sottoselezione. Porta a un conteggio diverso perché la posizione richiesta non è la stessa della query precedente perché è più vicina agli alloggi. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">WITH poi(loc) as (
  SELECT st_astext(shape) FROM accommodations WHERE name LIKE '%brandenburg gate%'
)
SELECT count(*) 
FROM accommodations a, poi p
WHERE ST_DistanceSphere(a.shape, ST_GeomFromText(p.loc, 4326)) &lt; 500;</code></pre>                
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
count
------
  60
</code></pre>  
                
              
            </li><li>
                <p>Eseguire la seguente query per mostrare i dettagli di tutti gli alloggi intorno alla Porta di Brandeburgo, ordinati per prezzo in ordine decrescente. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT name, price, ST_AsText(shape) 
FROM public.accommodations
WHERE ST_DistanceSphere(shape, ST_GeomFromText('POINT(13.377704 52.516431)', 4326)) &lt; 500
ORDER BY price DESC;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
name                                                   price  st_astext
-------------------------------------------------------------------------------------------------------
DUPLEX APARTMENT/PENTHOUSE in 5* LOCATION! 7583        300    POINT(13.3826510209548 52.5159819722552)
DUPLEX-PENTHOUSE IN FIRST LOCATION! 7582               300    POINT(13.3799997083855 52.5135918444834)
... 
(29 rows returned)
</code></pre> 
                
                             
            </li><li>
                <p>Eseguire la seguente query per recuperare la sistemazione più costosa con il suo codice postale. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT 
  a.price, a.name, ST_AsText(a.shape), 
  z.spatial_name, ST_AsText(z.wkb_geometry) 
FROM accommodations a, zipcode z 
WHERE price = 9000 AND ST_Within(a.shape, z.wkb_geometry);</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
price   name                                 st_astext                                  spatial_name      st_astext
-------------------------------------------------------------------------------------------------------------------------------------------------
9000    Ueber den Dächern Berlins Zentrum    POINT(13.334436985013 52.4979779501538)    10777             POLYGON((13.3318284987227 52.4956021172799,...
</code></pre>               
            </li><li>
                <p>Calcolare il prezzo massimo, minimo o medio degli alloggi utilizzando una sottoquery. </p>
                <p>La query seguente elenca il prezzo medio degli alloggi in base al codice postale. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT 
  a.price, a.name, ST_AsText(a.shape), 
  z.spatial_name, ST_AsText(z.wkb_geometry) 
FROM accommodations a, zipcode z 
WHERE 
  ST_Within(a.shape, z.wkb_geometry) AND 
  price = (SELECT median(price) FROM accommodations)
ORDER BY a.price;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
price name                            st_astext                                   spatial_name   st_astext
---------------------------------------------------------------------------------------------------------------------------------------------                    
45    "Cozy room Berlin-Mitte"        POINT(13.3864349535358 52.5292016386514)    10115          POLYGON((13.3658598465795 52.535659581048,...
...
(723 rows returned)
</code></pre> 
                
            </li><li>
                <p>Eseguire la seguente query per recuperare il numero di alloggi elencati a Berlino. Per trovare gli hot spot, questi sono raggruppati per codice postale e ordinati in base alla quantità di fornitura. </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT z.spatial_name as zip, count(*) as numAccommodations 
FROM public.accommodations a, public.zipcode z
WHERE ST_Within(a.shape, z.wkb_geometry)
GROUP BY zip 
ORDER BY numAccommodations DESC;</code></pre>
                <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
zip  	numaccommodations
----------------------------
10245	872
10247	832
10437	733
10115	664
...
(187 rows returned)
</code></pre>
            </li></ol></div>




     
           <h2 id="spatial-tutorial-clean-up">Fase 3: eliminazione delle risorse</h2>
           
           
           <p>Il cluster genera dei costi fino a che è in esecuzione. Una volta completato questo tutorial, sarà possibile eliminare il cluster di esempio. </p>
           <p>Se desideri conservare il cluster, ma recuperare l'archiviazione utilizzata dalle tabelle di dati di test, emettere i comandi seguenti per eliminare le tabelle. </p>
           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">drop table public.accommodations cascade;</code></pre>
           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">drop table public.zipcode cascade;</code></pre>
           
       <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avvertimento" /> <strong>JavaScript è disabilitato o non è disponibile nel tuo browser.</strong></p><p>Per usare la documentazione AWS, JavaScript deve essere abilitato. Consulta le pagine della guida del browser per le istruzioni.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenzioni dei documenti</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./geospatial-overview.html">Query su dati spaziali</div><div id="next" class="next-link" accesskey="n" href="./spatial-copy-shapefile.html">Caricamento di uno shapefile</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Questa pagina ti è stata utile? - Sì</div><div class="content"><p>Grazie per averci comunicato che stiamo facendo un buon lavoro!</p><p>Se hai un momento, ti invitiamo a dirci che cosa abbiamo fatto che ti è piaciuto così possiamo offrirti altri contenuti simili.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/spatial-tutorial.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Questa pagina ti è stata utile? - No</div><div class="content"><p>Grazie per averci comunicato che questa pagina ha bisogno di essere modificata. Siamo spiacenti di non aver soddisfatto le tue esigenze.</p><p>Se hai un momento, ti invitiamo a dirci come possiamo migliorare la documentazione.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/spatial-tutorial.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>