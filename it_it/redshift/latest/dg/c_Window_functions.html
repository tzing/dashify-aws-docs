<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="it-IT"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Funzioni finestra - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="c_Window_functions" /><meta name="default_state" content="c_Window_functions" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html" /><meta name="description" content="Creare query aziendali analitiche in modo più efficiente utilizzando le funzioni finestra per SQL supportate da Amazon Redshift." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guida per sviluppatori di database" /><meta name="abstract" content="Creare e gestire un data warehouse con Amazon Redshift, un servizio di data warehouse completamente gestito di livello aziendale e con capacità nell'ordine di più petabyte." /><meta name="guide-locale" content="it_it" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c_Window_functions.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c_Window_functions.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c_Window_functions.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c_Window_functions.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c_Window_functions.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c_Window_functions.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_Window_functions.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_Window_functions.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c_Window_functions.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c_Window_functions.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/c_Window_functions.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/c_Window_functions.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guida per sviluppatori di database" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guida per sviluppatori di database" /><meta id="panorama-serviceConsolePage" value="Funzioni finestra" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Funzioni finestra - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#c_Window_functions" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,sviluppatore,dati campione,database,sviluppatore di database,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guida per sviluppatori di database",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Documentazione di riferimento a SQL",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Informazioni di riferimento sulle funzioni SQL",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_SQL_functions.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Funzioni finestra",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_SQL_functions.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#c_Window_functions" target="_blank" rel="noopener noreferrer" title="Apri PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentazione</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guida per sviluppatori di database</a></div><div id="page-toc-src"><a href="#r_Window_function_synopsis">Riepilogo della sintassi della funzione finestra</a><a href="#r_Examples_order_by_WF">Ordinamento univoco dei dati per le funzioni finestra</a><a href="#r_Window_function_supported">Funzioni supportate</a><a href="#r_Window_function_example">Tabella di esempio per gli esempi della funzione finestra </a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Le traduzioni sono generate tramite traduzione automatica. In caso di conflitto tra il contenuto di una traduzione e la versione originale in Inglese, quest'ultima prevarrà.</p></awsui-alert><h1 class="topictitle" id="c_Window_functions">Funzioni finestra</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Le funzioni finestra ti consentono di creare query aziendali analitiche in modo più efficiente. Le funzioni finestra operano su una partizione o "finestra" di un insieme di risultati e restituiscono un valore per ogni riga in quella finestra. Tuttavia, le funzioni non finestra eseguono i calcoli in relazione a ogni riga del set di risultati. A differenza delle funzioni di gruppo che aggregano le righe dei risultati, le funzioni finestra mantengono tutte le righe nell'espressione della tabella. </p><p> I valori restituiti sono calcolati utilizzando i valori dai set di righe in quella finestra. Per ogni riga nella tabella, la finestra definisce un set di righe che viene utilizzato per calcolare gli attributi aggiuntivi. Una finestra viene definita utilizzando una specifica della finestra (la clausola OVER) e si basa su tre concetti principali: </p><div class="itemizedlist">
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p> <em>Partizionamento della finestra,</em> che forma gruppi di righe (clausola PARTITION) </p>
         </li><li class="listitem">
            <p> <em>Ordinamento della finestra</em>, che definisce un ordine o una sequenza di righe all'interno di ciascuna partizione (clausola ORDER BY) </p>
         </li><li class="listitem">
            <p> <em>Frame della finestra</em>, che sono definiti in relazione a ciascuna riga per restringere ulteriormente l'insieme di righe (specifica ROWS) </p>
         </li></ul></div><p>Le funzioni finestra sono l'ultimo insieme di operazioni eseguite in una query ad eccezione della clausola ORDER BY finale. Tutti i join e tutte le clausole WHERE, GROUP BY e HAVING vengono completati prima che le funzioni finestra vengano elaborate. Pertanto, le funzioni finestra possono essere visualizzate solo nell'elenco di selezione o nella clausola ORDER BY. È possibile utilizzare più funzioni finestra all'interno di una singola query con diverse clausole del frame. È inoltre possibile utilizzare le funzioni finestra in altre espressioni scalari, come ad esempio CASE. </p>
         <h2 id="r_Window_function_synopsis">Riepilogo della sintassi della funzione finestra</h2>
         
         
         <p>Le funzioni della finestra seguono una sintassi standard, che è la seguente.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><em>function</em> (<em>expression</em>) OVER (
[ PARTITION BY <em>expr_list</em> ]
[ ORDER BY <em>order_list</em> [ <em>frame_clause</em> ] ] )</code></pre>
         <p> Qui, <em>function</em> è una delle funzioni descritte in questa sezione.</p> 
         <p>L'<em>expr_list</em> è il seguente.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><em>expression</em> | <em>column_name</em> [, <em>expr_list</em> ]</code></pre>
         <p> L'<em>order_list</em> è il seguente. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><em>expression</em> | <em>column_name</em> [ ASC | DESC ] 
[ NULLS FIRST | NULLS LAST ]
[, <em>order_list</em> ]</code></pre>
         <p> La <em>frame_clause</em> è la seguente. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">ROWS
<span>{</span> UNBOUNDED PRECEDING | <em>unsigned_value</em> PRECEDING | CURRENT ROW } |

<span>{</span> BETWEEN
<span>{</span> UNBOUNDED PRECEDING | <em>unsigned_value</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW}
AND
<span>{</span> UNBOUNDED FOLLOWING | <em>unsigned_value</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW }}</code></pre>
          
            <h3 id="r_Window_function_synopsis-arguments">Argomenti</h3>
            
            
            <div class="variablelist">
                
                
                
                
                
                
                
                
                
            <dl>
                  <dt><span class="term"> <em>funzione</em> </span></dt>
                  <dd>
                     <p>La funzione finestra. Per informazioni dettagliate, vedere le descrizioni della singola funzione. </p>
                  </dd>
                
                  <dt><span class="term">OVER </span></dt>
                  <dd>
                     <p>La clausola che definisce la specifica della finestra. La clausola OVER è obbligatoria per le funzioni finestra e le contraddistingue da altre funzioni SQL. </p>
                  </dd>
                
                  <dt><span class="term">PARTITION BY <em>expr_list</em> </span></dt>
                  <dd>
                     <p>(Facoltativo) La clausola PARTITION BY suddivide il set di risultati in partizioni in modo molto simile alla clausola GROUP BY. Se è presente una clausola di partizione, la funzione viene calcolata per le righe in ogni partizione. Se non viene specificata alcuna clausola di partizione, una singola partizione contiene l'intera tabella e la funzione viene calcolata per quella tabella completa. </p>
                     <p>Le funzioni di classificazione DENSE_RANK, NTILE, RANK e ROW_NUMBER richiedono un confronto globale di tutte le righe nell'insieme di risultati. Quando viene utilizzata una clausola PARTITION BY, l'ottimizzatore della query può eseguire ciascuna aggregazione in parallelo distribuendo il carico di lavoro su più sezioni in base alle partizioni. Se la clausola PARTITION BY non è presente, la fase di aggregazione deve essere eseguita in serie su una singola sezione, che può avere un impatto negativo significativo sulle prestazioni, in particolare per i cluster di grandi dimensioni.</p>
                     <p>Amazon Redshift non supporta letterali stringa nelle clausole PARTITION BY.</p>
                  </dd>
                
                  <dt><span class="term">ORDER BY <em>order_list</em> </span></dt>
                  <dd>
                     <p>(Facoltativo) La funzione finestra viene applicata alle righe all'interno di ciascuna partizione ordinata in base alla specifica dell'ordine in ORDER BY. Questa clausola ORDER BY è distinta e completamente non correlata a una clausola ORDER BY in una <em>frame_clause</em>. La clausola ORDER BY può essere utilizzata senza la clausola PARTITION BY. </p>
                     <p>Per le funzioni di classificazione, la clausola ORDER BY identifica le misure per i valori di classificazione. Per le funzioni di aggregazione, le righe partizionate devono essere ordinate prima che la funzione di aggregazione sia calcolata per ciascun frame. Per ulteriori informazioni sui tipi di funzione finestra, consultare <a href="./c_Window_functions.html">Funzioni finestra</a>.</p>
                     <p>Gli identificatori o le espressioni di colonna che valutano gli identificatori di colonna sono obbligatori nell'elenco degli ordini. Né le costanti né le espressioni costanti possono essere utilizzate come sostituti dei nomi delle colonne. </p>
                     <p>I valori NULL vengono trattati come il proprio gruppo, ordinati e classificati in base all'opzione NULLS FIRST o NULLS LAST. Per impostazione predefinita, i valori NULL vengono ordinati e classificati per ultimi in ordine ASC e ordinati e classificati per primi in ordine DESC.</p>
                     <p>Amazon Redshift non supporta letterali stringa nelle clausole ORDER BY.</p>
                     <p> Se viene omessa la clausola ORDER BY, l'ordine delle righe non è deterministico. </p>
                     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Nota</h6></div><div class="awsdocs-note-text"><p>In qualsiasi sistema parallelo come ad esempio Amazon Redshift, quando una clausola ORDER BY non produce un ordinamento univoco e totale dei dati, l'ordine delle righe è non deterministico. Ovvero, se l'espressione ORDER BY produce valori duplicati (un ordinamento parziale), l'ordine di restituzione di tali righe potrebbe variare da una sola esecuzione di Amazon Redshift a quella successiva. A loro volta, le funzioni finestra potrebbero restituire risultati inattesi o incoerenti. Per ulteriori informazioni, consultare <a href="#r_Examples_order_by_WF">Ordinamento univoco dei dati per le funzioni finestra</a>. </p></div></div>
                  </dd>
                
                  <dt><span class="term"> <em>column_name</em> </span></dt>
                  <dd>
                     <p>Nome di una colonna da partizionare o da ordinare. </p>
                  </dd>
                
                  <dt><span class="term">ASC | DESC </span></dt>
                  <dd>
                     <p>Opzione che definisce l'ordinamento per l'espressione, come segue: </p>
                     <div class="itemizedlist">
                         
                         
                     <ul class="itemizedlist"><li class="listitem">
                           <p>ASC: crescente (ad esempio, dal più piccolo al più grande per i valori numerici e da 'A' a 'Z' per le stringhe di caratteri). Se non viene specificata alcuna opzione, i dati vengono ordinati in ordine crescente per impostazione predefinita.</p>
                        </li><li class="listitem">
                           <p>DESC: decrescente (ad esempio, dal più grande al più piccolo per i valori numerici e da 'Z' ad 'A' per le stringhe). </p>
                        </li></ul></div>
                  </dd>
                
                  <dt><span class="term">NULLS FIRST | NULLS LAST</span></dt>
                  <dd>
                     <p>Opzione che specifica se NULLS deve essere ordinato per primo, prima di valori non null, o per ultimo, dopo valori non null. Per impostazione predefinita, i NULLS vengono ordinati e classificati per ultimi in ordine ASC e ordinati e classificati per primi in ordine DESC.</p>
                  </dd>
                
                  <dt><span class="term"> <em>frame_clause</em> </span></dt>
                  <dd>
                     
                     <p>Per le funzioni di aggregazione, la clausola frame perfeziona ulteriormente l'insieme di righe in una finestra della funzione quando si utilizza ORDER BY. Fornisce la capacità di includere o escludere set di righe all'interno del risultato ordinato. La clausola frame è composta dalla parola chiave ROWS e dagli specificatori associati.</p>
                     <p>La clausola frame non si applica alle funzioni di classificazione. Inoltre, la clausola frame non è richiesta quando non viene utilizzata alcuna clausola ORDER BY nella clausola OVER per una funzione di aggregazione. Se una clausola ORDER BY viene utilizzata per una funzione di aggregazione, è necessaria una clausola del frame esplicita.</p>
                     <p>Quando non viene specificata alcuna clausola ORDER BY, il frame implicito è illimitato: equivalente a ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING. </p>
                  </dd>
                
                  <dt><span class="term">ROWS</span></dt>
                  <dd>
                     <p>Questa clausola definisce il frame della finestra specificando una compensazione fisica dalla riga corrente.</p>
                     <p>Questa clausola specifica le righe nella finestra o partizione corrente con cui deve essere combinato il valore nella riga corrente. Usa argomenti che specificano la posizione della riga, che può essere prima o dopo la riga corrente. Il punto di riferimento per tutti i frame della finestra è la riga corrente. Ogni riga diventa a sua volta la riga corrente mentre il frame della finestra scorre in avanti nella partizione.</p>
                     <p>Il frame può essere un semplice insieme di righe fino a includere la riga corrente:</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>UNBOUNDED PRECEDING | <em>offset</em> PRECEDING | CURRENT ROW}</code></pre>
                     <p>Oppure può essere un insieme di righe tra due limiti.</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">BETWEEN
<span>{</span> UNBOUNDED PRECEDING | <em>offset</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW }
AND
<span>{</span> UNBOUNDED FOLLOWING | <em>offset</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW }</code></pre>
                     <p>UNBOUNDED PRECEDING indica che la finestra inizia nella prima riga della partizione; <em>offset</em> PRECEDING indica che la finestra inizia un numero di righe equivalente al valore di compensazione prima della riga corrente. UNBOUNDED PRECEDING è il valore predefinito.</p>
                     <p>CURRENT ROW indica che la finestra inizia o termina nella riga corrente. </p>
                     <p>UNBOUNDED FOLLOWING indica che la finestra termina nell'ultima riga della partizione; <em>offset</em> FOLLOWING indica che la finestra termina un numero di righe equivalente al valore di compensazione dopo la riga corrente.</p>
                     <p><em>offset</em> identifica un numero fisico di righe prima o dopo la riga corrente. In questo caso, <em>offset</em> deve essere una costante che valuta un valore numerico positivo. Ad esempio, 5 FOLLOWING terminerà il frame 5 righe dopo la riga corrente.</p>
                     
                     <p>Laddove BETWEEN non viene specificato, il frame è implicitamente limitato dalla riga corrente. Ad esempio, <code class="code">ROWS 5 PRECEDING</code> è uguale a <code class="code">ROWS BETWEEN 5 PRECEDING AND CURRENT ROW</code>. Inoltre, <code class="code">ROWS
                           UNBOUNDED FOLLOWING</code> è uguale a <code class="code">ROWS BETWEEN CURRENT ROW AND
                              UNBOUNDED FOLLOWING</code>.</p>
                     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Nota</h6></div><div class="awsdocs-note-text"><p>Non è possibile specificare un frame in cui il limite iniziale è maggiore del limite finale. Ad esempio, non è possibile specificare nessuno di questi frame: </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">between 5 following and 5 preceding
between current row and 2 preceding
between 3 following and current row</code></pre></div></div>
                  </dd>
               </dl></div>
          
         
       
         <h2 id="r_Examples_order_by_WF">Ordinamento univoco dei dati per le funzioni finestra</h2>
         
         
         <p>Se una clausola ORDER BY per una funzione finestra non produce un ordinamento univoco e totale dei dati, l'ordine delle righe è non deterministico. Se l'espressione ORDER BY produce valori duplicati (un ordinamento parziale), l'ordine di restituzione di tali righe può variare in più esecuzioni. In questo caso, le funzioni finestra possono restituire risultati inattesi o incoerenti. </p>
         <p>Ad esempio, la seguente query restituisce risultati diversi su più esecuzioni. Si ottengono questi risultati diversi perché <code class="code">order by dateid</code> non genera un ordinamento univoco dei dati per la funzione finestra SUM. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select dateid, pricepaid,
sum(pricepaid) over(order by dateid rows unbounded preceding) as sumpaid
from sales
group by dateid, pricepaid;

dateid | pricepaid |   sumpaid
--------+-----------+-------------
1827 |   1730.00 |     1730.00
1827 |    708.00 |     2438.00
1827 |    234.00 |     2672.00
...

select dateid, pricepaid,
sum(pricepaid) over(order by dateid rows unbounded preceding) as sumpaid
from sales
group by dateid, pricepaid;

dateid | pricepaid |   sumpaid
--------+-----------+-------------
1827 |    234.00 |      234.00
1827 |    472.00 |      706.00
1827 |    347.00 |     1053.00
...</code></pre>
         <p> In questo caso, l'aggiunta di una seconda colonna ORDER BY alla funzione finestra potrebbe risolvere il problema. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select dateid, pricepaid,
sum(pricepaid) over(order by dateid, pricepaid rows unbounded preceding) as sumpaid
from sales
group by dateid, pricepaid;

dateid | pricepaid | sumpaid
--------+-----------+---------
1827 |    234.00 |  234.00
1827 |    337.00 |  571.00
1827 |    347.00 |  918.00
...</code></pre>
       
         <h2 id="r_Window_function_supported">Funzioni supportate</h2>
      <p>Amazon Redshift supporta due tipi di funzioni finestra: di aggregazione e di classificazione.</p>
      <p>Queste sono le funzioni di aggregazione supportate: </p>
      <div class="itemizedlist">
          
          
          
          
          
          
          
          
               
          
          
          
          
          
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><a href="./r_WF_AVG.html">Funzione finestra AVG</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_COUNT.html">Funzione finestra COUNT</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_CUME_DIST.html">Funzione finestra CUME_DIST</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_DENSE_RANK.html">Funzione finestra DENSE_RANK</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_first_value.html">Funzione finestra FIRST_VALUE</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_LAG.html">Funzione finestra LAG</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_last_value.html">Funzione finestra LAST_VALUE</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_LEAD.html">Funzione finestra LEAD</a> </p>
         </li><li class="listitem">
               <p><a href="./r_WF_LISTAGG.html">Funzione finestra LISTAGG</a> </p>
            </li><li class="listitem">
            <p><a href="./r_WF_MAX.html">Funzione finestra MAX</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_MEDIAN.html">Funzione finestra MEDIAN</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_MIN.html">Funzione finestra MIN</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_NTH.html">Funzione finestra NTH_VALUE</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_PERCENTILE_CONT.html">Funzione finestra PERCENTILE_CONT</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_PERCENTILE_DISC.html">Funzione finestra PERCENTILE_DISC</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_RATIO_TO_REPORT.html">Funzione finestra RATIO_TO_REPORT</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_STDDEV.html">Funzioni finestra STDDEV_SAMP e STDDEV_POP</a> (STDDEV_SAMP e STDDEV sono sinonimi) </p>
         </li><li class="listitem">
            <p><a href="./r_WF_SUM.html">Funzione finestra SUM</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_VARIANCE.html">Funzioni finestra VAR_SAMP e VAR_POP</a> (VAR_SAMP e VARIANCE sono sinonimi)</p>
         </li></ul></div>
      <p>Queste sono le funzioni di classificazione supportate: </p>
      <div class="itemizedlist">
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><a href="./r_WF_DENSE_RANK.html">Funzione finestra DENSE_RANK</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_NTILE.html">Funzione finestra NTILE</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_PERCENT_RANK.html">Funzione finestra PERCENT_RANK</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_RANK.html">Funzione finestra RANK</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_ROW_NUMBER.html">Funzione finestra ROW_NUMBER</a></p>
         </li></ul></div>
       
         <h2 id="r_Window_function_example">Tabella di esempio per gli esempi della funzione finestra</h2>
         
         <p>Sono presenti esempi di funzione finestra specifici con la descrizione di ogni funzione. Alcuni degli esempi utilizzano una tabella denominata WINSALES, che contiene 11 righe, come mostrato di seguito.</p>
         <div class="table-container"><div class="table-contents"><table id="w319aac47c11c45c17b5"><thead>
                  <tr>
                     <th>SALESID </th>
                     <th>DATEID </th>
                     <th>SELLERID </th>
                     <th>BUYERID </th>
                     <th>QTÀ </th>
                     <th>QTY_SHIPPED </th>
                  </tr>
               </thead>
                  <tr>
                     <td tabindex="-1"> 30001 </td>
                     <td tabindex="-1"> 2/8/2003 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1">10 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 10001 </td>
                     <td tabindex="-1"> 24/12/2003 </td>
                     <td tabindex="-1"> 1 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1">10 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 10005 </td>
                     <td tabindex="-1"> 24/12/2003 </td>
                     <td tabindex="-1"> 1 </td>
                     <td tabindex="-1"> A </td>
                     <td tabindex="-1"> 30 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 40001 </td>
                     <td tabindex="-1"> 9/1/2004 </td>
                     <td tabindex="-1"> 4 </td>
                     <td tabindex="-1"> A </td>
                     <td tabindex="-1"> 40 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 10006 </td>
                     <td tabindex="-1"> 18/01/2004 </td>
                     <td tabindex="-1"> 1 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 20001 </td>
                     <td tabindex="-1"> 12/2/2004 </td>
                     <td tabindex="-1"> 2 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 20 </td>
                     <td tabindex="-1">20 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 40005 </td>
                     <td tabindex="-1"> 12/2/2004 </td>
                     <td tabindex="-1"> 4 </td>
                     <td tabindex="-1"> A </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1">10 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 20002 </td>
                     <td tabindex="-1"> 16/2/2004 </td>
                     <td tabindex="-1"> 2 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 20 </td>
                     <td tabindex="-1">20 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 30003 </td>
                     <td tabindex="-1"> 18/4/2004 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 15 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 30004 </td>
                     <td tabindex="-1"> 18/4/2004 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 20 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 30007 </td>
                     <td tabindex="-1"> 7/9/2004 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 30 </td>
                     <td tabindex="-1"> </td>
                  </tr>
               </table></div></div>
         <p>Il seguente script crea e popola la tabella WINSALES di esempio.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE winsales(
  salesid int,
  dateid date,
  sellerid int,
  buyerid char(10),
  qty int,
  qty_shipped int);

INSERT INTO winsales VALUES
  (30001, '8/2/2003', 3, 'b', 10, 10),
  (10001, '12/24/2003', 1, 'c', 10, 10),
  (10005, '12/24/2003', 1, 'a', 30, null),	
  (40001, '1/9/2004', 4, 'a', 40, null),	
  (10006, '1/18/2004', 1, 'c', 10, null),	
  (20001, '2/12/2004', 2, 'b', 20, 20),
  (40005, '2/12/2004', 4, 'a', 10, 10),
  (20002, '2/16/2004', 2, 'c', 20, 20),
  (30003, '4/18/2004', 3, 'b', 15, null),
  (30004, '4/18/2004', 3, 'b', 20, null),	
  (30007, '9/7/2004', 3, 'c', 30, null);	 
</code></pre>
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avvertimento" /> <strong>JavaScript è disabilitato o non è disponibile nel tuo browser.</strong></p><p>Per usare la documentazione AWS, JavaScript deve essere abilitato. Consulta le pagine della guida del browser per le istruzioni.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenzioni dei documenti</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_TO_VARBYTE.html">TO_VARBYTE</div><div id="next" class="next-link" accesskey="n" href="./r_WF_AVG.html">AVG</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Questa pagina ti è stata utile? - Sì</div><div class="content"><p>Grazie per averci comunicato che stiamo facendo un buon lavoro!</p><p>Se hai un momento, ti invitiamo a dirci che cosa abbiamo fatto che ti è piaciuto così possiamo offrirti altri contenuti simili.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Questa pagina ti è stata utile? - No</div><div class="content"><p>Grazie per averci comunicato che questa pagina ha bisogno di essere modificata. Siamo spiacenti di non aver soddisfatto le tue esigenze.</p><p>Se hai un momento, ti invitiamo a dirci come possiamo migliorare la documentazione.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>