<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="it-IT"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>MERGE - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_MERGE" /><meta name="default_state" content="r_MERGE" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" /><meta name="description" content="Inserisce, aggiorna ed elimina i valori in una tabella in base ai valori di una tabella di origine." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guida per sviluppatori di database" /><meta name="abstract" content="Creare e gestire un data warehouse con Amazon Redshift, un servizio di data warehouse completamente gestito di livello aziendale e con capacità nell'ordine di più petabyte." /><meta name="guide-locale" content="it_it" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_MERGE.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_MERGE.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_MERGE.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_MERGE.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_MERGE.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_MERGE.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_MERGE.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_MERGE.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guida per sviluppatori di database" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guida per sviluppatori di database" /><meta id="panorama-serviceConsolePage" value="MERGE" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>MERGE - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_MERGE" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,sviluppatore,dati campione,database,sviluppatore di database,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guida per sviluppatori di database",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Documentazione di riferimento a SQL",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Comandi SQL",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "MERGE",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_SQL_commands.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_MERGE" target="_blank" rel="noopener noreferrer" title="Apri PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentazione</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guida per sviluppatori di database</a></div><div id="page-toc-src"><a href="#r_MERGE-synopsis">Sintassi</a><a href="#r_MERGE-parameters">Parametri</a><a href="#r_MERGE_usage_notes">Note per l'utilizzo</a><a href="#sub-examples-merge">Esempi</a><a href="#r_MERGE-see-also">Consulta anche</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Le traduzioni sono generate tramite traduzione automatica. In caso di conflitto tra il contenuto di una traduzione e la versione originale in Inglese, quest'ultima prevarrà.</p></awsui-alert><h1 class="topictitle" id="r_MERGE">MERGE</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Unisce in modo condizionale le righe da una tabella di origine a una tabella di destinazione. In genere, ciò può essere ottenuto solo utilizzando separatamente più istruzioni di inserimento, aggiornamento o eliminazione. Per ulteriori informazioni sulle operazioni che MERGE consente di combinare, consulta <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_UPDATE.html">UPDATE</a>, <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_DELETE.html">DELETE</a> e <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_INSERT_30.html">INSERT</a>.</p>
         <h2 id="r_MERGE-synopsis">Sintassi</h2>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">MERGE INTO <em>target_table</em> 
USING <em>source_table</em> [ [ AS ] <em>alias</em> ] 
ON <em>match_condition</em> 
[ WHEN MATCHED THEN <span>{</span> UPDATE SET <em>col_name</em> = <span>{</span> <em>expr</em> } [,...] | DELETE }
WHEN NOT MATCHED THEN INSERT [ ( <em>col_name</em> [,...] ) ] VALUES ( <span>{</span> <em>expr</em> } [, ...] ) |
REMOVE DUPLICATES ]</code></pre>

       
         <h2 id="r_MERGE-parameters">Parametri</h2>
         <div class="variablelist">
             
             
             
             
            
             
             
             

             
             
             
             
             
         <dl>
               <dt><span class="term"> <em>target_table</em></span></dt>
               <dd>
                  <p>La tabella temporanea o permanente in cui si include l'istruzione MERGE.</p>
               </dd>
             
               <dt><span class="term"> <em>source_table</em></span></dt>
               <dd>
                  <p>La tabella temporanea o permanente che fornisce le righe da unire in <em>target_table</em>. <em>source_table</em> può essere anche una tabella Spectrum. <em>source_table</em> non può essere una vista o una sottoquery.</p>
               </dd>
             
               <dt><span class="term"> <em>alias</em></span></dt>
               <dd>
                  <p>Nome alternativo temporaneo per <em>source_table</em>.</p>
                  <p>Questo parametro è facoltativo. Anche il precedente <em>alias</em> con AS è facoltativo.</p>
               </dd>
             
               <dt><span class="term"> <em>match_condition</em></span></dt>
               <dd>
                  <p>Specifica predicati uguali tra la colonna della tabella di origine e la colonna della tabella di destinazione che vengono utilizzati per determinare se le righe in <em>source_table</em> possono essere abbinate alle righe in <em>target_table</em>. Se la condizione è soddisfatta, MERGE esegue <em>matched_clause</em> per quella riga. In caso contrario, MERGE esegue <em>not_matched_clause</em> per quella riga.</p>
               </dd>
             
               <dt><span class="term">WHEN MATCHED</span></dt>
               <dd>
                  <p> Specifica l'operazione da eseguire quando la condizione di corrispondenza tra una riga di origine e una riga di destinazione risulta True. È possibile specificare un'azione UPDATE o un'azione DELETE. </p>
               </dd>
             
               <dt><span class="term">UPDATE</span></dt>
               <dd><p> Aggiorna la riga corrispondente in <em>target_table</em>. Vengono aggiornati solo i valori nel <em>col_name</em> specificato. </p></dd>
             
               <dt><span class="term">DELETE</span></dt>
               <dd><p> Elimina la riga corrispondente in <em>target_table</em>. </p></dd>
             
               <dt><span class="term">WHEN NOT MATCHED</span></dt>
               <dd>
                  <p> Specifica l'operazione da eseguire quando la condizione di corrispondenza risulta False o Unknown. È possibile specificare solo l'azione di inserimento INSERT per questa clausola. </p>
               </dd>
             
               <dt><span class="term">INSERT</span></dt>
               <dd><p> Inserisce una riga in <em>target_table</em>. Il <em>col_name</em> di destinazione può essere elencato in qualsiasi ordine. Se non viene fornito alcun valore <em>col_name</em>, per impostazione predefinita l'ordine è quello di tutte le colonne della tabella nel loro ordine dichiarato. </p></dd>
             
               <dt><span class="term"> <em>nome_col</em></span></dt>
               <dd>
                  <p>Una o più nomi di colonne da modificare. Non includere il nome della tabella quando specifichi la colonna di destinazione.</p>
               </dd>
             
               <dt><span class="term"> <em>expr</em></span></dt>
               <dd>
                  <p>L'espressione che definisce il nuovo valore per <em>col_name</em>.</p>
               </dd>
             
               <dt><span class="term"> REMOVE DUPLICATES</span></dt>
               <dd>
                  <p>Specifica che il comando MERGE viene eseguito in modalità semplificata. La modalità semplificata presenta i seguenti requisiti:</p>
                  <div class="itemizedlist">
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem"><p> <em>target_table</em> e <em>source_table</em> devono avere lo stesso numero di colonne e tipi di colonna compatibili. </p></li><li class="listitem"><p> Ometti la clausola WHEN e le clausole UPDATE e INSERT dal comando MERGE. </p></li><li class="listitem"><p> Usa la clausola REMOVE DUPLICATES nel comando MERGE. </p></li></ul></div>
                  <p>In modalità semplificata, MERGE esegue le seguenti operazioni:</p>
                  <div class="itemizedlist">
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem"><p> Le righe in <em>target_table</em> che hanno una corrispondenza in <em>source_table</em> vengono aggiornate in modo che corrispondano ai valori in <em>source_table</em>. </p></li><li class="listitem"><p> Le righe in <em>source_table</em> che non hanno una corrispondenza in <em>target_table</em> vengono inserite in <em>target_table</em>. </p></li><li class="listitem"><p> Quando più righe in <em>target_table</em> corrispondono alla stessa riga in <em>source_table</em>, le righe duplicate vengono rimosse. Amazon Redshift mantiene una riga e la aggiorna. Le righe duplicate che non corrispondono a una riga in <em>source_table</em> restano invariate. </p></li></ul></div>
                  <p>L'utilizzo di REMOVE DUPLICATES offre prestazioni migliori rispetto all'utilizzo di WHEN MATCHED e WHEN NOT MATCHED. Consigliamo di utilizzare REMOVE DUPLICATES se <em>target_table</em> e <em>source_table</em> sono compatibili e non è necessario conservare le righe duplicate in <em>target_table</em>.</p>
               </dd>
            </dl></div>
       
         <h2 id="r_MERGE_usage_notes">Note per l'utilizzo</h2>
         <div class="itemizedlist">
             
             
             
             
             
             
            
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>Per eseguire le istruzioni MERGE, devi essere il proprietario sia di <em>source_table</em> che di <em>target_table</em> o disporre dell'autorizzazione SELECT per tali tabelle. Inoltre, devi disporre delle autorizzazioni UPDATE, DELETE e INSERT per <em>target_table</em>, a seconda delle operazioni incluse nell'istruzione MERGE.</p>
            </li><li class="listitem">
               <p> <em>target_table</em> non può essere una tabella di sistema, una tabella di catalogo o una tabella esterna. </p>
            </li><li class="listitem">
               <p> <em>source_table</em> e <em>target_table</em> non possono essere la stessa tabella. </p>
            </li><li class="listitem">
               <p> Non è possibile utilizzare la clausola WITH in un'istruzione MERGE. </p>
            </li><li class="listitem">
               <p> Le righe in <em>target_table</em> non possono corrispondere a più righe in <em>source_table</em>. </p>
               <p>Considera il seguente esempio:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (1, 'Bob'), (2, 'John');
INSERT INTO source VALUES (1, 'Tony'), (1, 'Alice'), (3, 'Bill');

MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN UPDATE SET id = source.id, name = source.name
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);
ERROR: Found multiple matches to update the same tuple.

MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN DELETE
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);
ERROR: Found multiple matches to update the same tuple.</code></pre>
               <p>In entrambe le istruzioni MERGE, l'operazione non riesce perché nella tabella <code class="code">source</code> sono presenti più righe con un valore ID di <code class="code">1</code>.</p>
            </li><li class="listitem">
               <p> <em>match_condition</em> ed <em>expr</em> non possono fare riferimento parzialmente a colonne di tipo SUPER. Ad esempio, se l'oggetto di tipo SUPER è un array o una struttura, non puoi usare singoli elementi di quella colonna per <em>match_condition</em> o <em>expr</em>, ma puoi utilizzare l'intera colonna. </p>
               <p>Considera il seguente esempio:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE IF NOT EXISTS target (key INT, value SUPER);
CREATE TABLE IF NOT EXISTS source (key INT, value SUPER);

INSERT INTO target VALUES (1, JSON_PARSE('<span>{</span>"key": 88}'));
INSERT INTO source VALUES (1, ARRAY(1, 'John')), (2, ARRAY(2, 'Bill'));

MERGE INTO target USING source ON target.key = source.key
WHEN matched THEN UPDATE SET value = source.value[0]
WHEN NOT matched THEN INSERT VALUES (source.key, source.value[0]);
ERROR: Partial reference of SUPER column is not supported in MERGE statement.</code></pre>
               <p>Per ulteriori informazioni sul tipo SUPER, consulta <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SUPER_type.html">Tipo SUPER</a>.</p>
            </li><li class="listitem">
               <p>Se <em>source_table</em> è di grandi dimensioni, la definizione delle colonne di join sia da <em>target_table</em> che da <em>source_table</em> come chiavi di distribuzione può migliorare le prestazioni.</p>
            </li><li class="listitem">
               <p>Per utilizzare la clausola REMOVE DUPLICATES, sono necessarie le autorizzazioni SELECT, INSERT e DELETE per <em>target_table</em>.</p>
            </li></ul></div>
       
         <h2 id="sub-examples-merge">Esempi</h2>
         <p>L'esempio seguente crea due tabelle, quindi esegue un'operazione MERGE su di esse, aggiornando le righe corrispondenti nella tabella di destinazione e inserendo righe che prive di corrispondenze. Quindi inserisce un altro valore nella tabella di origine ed esegue un'altra operazione MERGE, questa volta eliminando le righe corrispondenti e inserendo la nuova riga dalla tabella di origine.</p>
         <p>Per prima cosa crea e compila le tabelle di origine e destinazione.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (101, 'Bob'), (102, 'John'), (103, 'Susan');
INSERT INTO source VALUES (102, 'Tony'), (103, 'Alice'), (104, 'Bill');

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 102 | John
 103 | Susan
(3 rows)

SELECT * FROM source;
 id  |    name
-----+------------
 102 | Tony
 103 | Alice
 104 | Bill
(3 rows)</code></pre>
         <p>Quindi, unisci la tabella di origine con la tabella di destinazione, aggiornando la tabella di destinazione con le righe corrispondenti e inserisci le righe della tabella di origine che non hanno alcuna corrispondenza.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN UPDATE SET id = source.id, name = source.name
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 102 | Tony
 103 | Alice
 104 | Bill
(4 rows)</code></pre>
         <p>Tieni presente che le righe con valori ID di 102 e 103 vengono aggiornate in modo che corrispondano ai valori dei nomi della tabella di destinazione. Inoltre, nella tabella di destinazione viene inserita una nuova riga con un valore ID di 104 e il valore del nome Bill.</p>
         <p>Quindi, inserisci una nuova riga nella tabella di origine.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">INSERT INTO source VALUES (105, 'David');

SELECT * FROM source;
 id  |    name
-----+------------
 102 | Tony
 103 | Alice
 104 | Bill
 105 | David
(4 rows)</code></pre>
         <p>Infine, esegui un'operazione di unione eliminando le righe corrispondenti nella tabella di destinazione e inserendo le righe prive di corrispondenze.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN DELETE
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 105 | David
(2 rows)</code></pre>
         <p>Le righe con valori ID di 102, 103 e 104 vengono eliminate dalla tabella di destinazione e una nuova riga con un valore ID di 105 e il valore del nome David viene inserita nella tabella di destinazione.</p>
         <p>L'esempio seguente mostra un comando MERGE che utilizza la clausola REMOVE DUPLICATES.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (30, 'Tony'), (11, 'Alice'), (23, 'Bill');
INSERT INTO source VALUES (23, 'David'), (22, 'Clarence');

MERGE INTO target USING source ON target.id = source.id REMOVE DUPLICATES;

SELECT * FROM target;
id | name
---+------------
30 | Tony
11 | Alice
23 | David
22 | Clarence
(4 rows)</code></pre>
         <p><em>L'esempio seguente mostra un comando MERGE che utilizza la clausola REMOVE DUPLICATES, che rimuove le righe duplicate da <em>target_table</em> se ci sono righe corrispondenti in source_table</em>.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (30, 'Tony'), (30, 'Daisy'), (11, 'Alice'), (23, 'Bill'), (23, 'Nikki');
INSERT INTO source VALUES (23, 'David'), (22, 'Clarence');

MERGE INTO target USING source ON target.id = source.id REMOVE DUPLICATES;

SELECT * FROM target;
id | name
---+------------
30 | Tony
30 | Daisy
11 | Alice
23 | David
22 | Clarence
(5 rows)</code></pre>
         <p>Dopo l'esecuzione di MERGE, c'è solo una riga con un valore ID di 23 in <em>target_table</em>. Poiché non c'era alcuna riga in <em>source_table</em> con il valore ID 30, le due righe duplicate con valori ID 30 rimangono in <em>target_table</em>.</p>
       
         <h2 id="r_MERGE-see-also">consultare anche</h2>
         <p>
            <a href="./r_INSERT_30.html">INSERT</a>, <a href="./r_UPDATE.html">UPDATE</a>,
            <a href="./r_DELETE.html">DELETE</a>
         </p>
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avvertimento" /> <strong>JavaScript è disabilitato o non è disponibile nel tuo browser.</strong></p><p>Per usare la documentazione AWS, JavaScript deve essere abilitato. Consulta le pagine della guida del browser per le istruzioni.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenzioni dei documenti</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_LOCK.html">LOCK</div><div id="next" class="next-link" accesskey="n" href="./r_PREPARE.html">PREPARE</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Questa pagina ti è stata utile? - Sì</div><div class="content"><p>Grazie per averci comunicato che stiamo facendo un buon lavoro!</p><p>Se hai un momento, ti invitiamo a dirci che cosa abbiamo fatto che ti è piaciuto così possiamo offrirti altri contenuti simili.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Questa pagina ti è stata utile? - No</div><div class="content"><p>Grazie per averci comunicato che questa pagina ha bisogno di essere modificata. Siamo spiacenti di non aver soddisfatto le tue esigenze.</p><p>Se hai un momento, ti invitiamo a dirci come possiamo migliorare la documentazione.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>