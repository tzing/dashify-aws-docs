<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="it-IT"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>STL_QUERYTEXT - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_STL_QUERYTEXT" /><meta name="default_state" content="r_STL_QUERYTEXT" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_STL_QUERYTEXT.html" /><meta name="description" content="Acquisisce il testo di query per i comandi SQL." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guida per sviluppatori di database" /><meta name="abstract" content="Creare e gestire un data warehouse con Amazon Redshift, un servizio di data warehouse completamente gestito di livello aziendale e con capacità nell'ordine di più petabyte." /><meta name="guide-locale" content="it_it" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_STL_QUERYTEXT.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_STL_QUERYTEXT.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guida per sviluppatori di database" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guida per sviluppatori di database" /><meta id="panorama-serviceConsolePage" value="STL_QUERYTEXT" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>STL_QUERYTEXT - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_STL_QUERYTEXT" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_STL_QUERYTEXT.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_STL_QUERYTEXT.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_STL_QUERYTEXT.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,sviluppatore,dati campione,database,sviluppatore di database,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guida per sviluppatori di database",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Riferimento di tabelle e viste di sistema",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/cm_chap_system-tables.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Monitoraggio del sistema (solo con provisioning)",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_intro_system_views.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Viste STL per la registrazione",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_intro_STL_tables.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "STL_QUERYTEXT",
        "item" : "https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_intro_STL_tables.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_STL_QUERYTEXT" target="_blank" rel="noopener noreferrer" title="Apri PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentazione</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guida per sviluppatori di database</a></div><div id="page-toc-src"><a href="#r_STL_QUERYTEXT-table-columns">Colonne di tabella</a><a href="#r_STL_QUERYTEXT-sample-queries">Query di esempio</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Le traduzioni sono generate tramite traduzione automatica. In caso di conflitto tra il contenuto di una traduzione e la versione originale in Inglese, quest'ultima prevarrà.</p></awsui-alert><h1 class="topictitle" id="r_STL_QUERYTEXT">STL_QUERYTEXT</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Acquisisce il testo di query per i comandi SQL.</p><p>Eseguire una query sulla tabella STL_QUERYTEXT per acquisire l'SQL registrato per le seguenti istruzioni: </p><div class="itemizedlist">
             
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>SELECT, SELECT INTO</p>
            </li><li class="listitem">
                <p>INSERT, UPDATE, DELETE</p>
            </li><li class="listitem">
                <p>COPY</p>
            </li><li class="listitem">
                <p>UNLOAD</p>
            </li><li class="listitem">
                
                <p>Le query generate dall'esecuzione di VACUUM e ANALYZE</p>
            </li><li class="listitem">
                <p>CREATE TABLE AS (CTAS)</p>
            </li></ul></div><p>Per eseguire una query dell'attività per queste istruzioni in un dato periodo di tempo, unisci le viste STL_QUERYTEXT e STL_QUERY.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Nota</h6></div><div class="awsdocs-note-text"><p>Le viste STL_QUERY e STL_QUERYTEXT contengono solo informazioni sulle query, non su altre utility o comandi DDL. Per un elenco e le informazioni su tutte le istruzioni eseguite da Amazon Redshift, è possibile anche eseguire query sulle tabelle STL_DDLTEXT e STL_UTILITYTEXT. Per un elenco completo di tutte le istruzioni eseguite da Amazon Redshift, è possibile eseguire una query sulla vista SVL_STATEMENTTEXT.</p></div></div><p>Consulta anche <a href="./r_STL_DDLTEXT.html">STL_DDLTEXT</a>, <a href="./r_STL_UTILITYTEXT.html">STL_UTILITYTEXT</a> e <a href="./r_SVL_STATEMENTTEXT.html">SVL_STATEMENTTEXT</a>.</p><p>STL_QUERYTEXT è visibile a tutti gli utenti. Gli utenti con privilegi avanzati visualizzano tutte le righe; gli utenti regolari visualizzano solo i propri dati. Per ulteriori informazioni, consulta <a href="./cm_chap_system-tables.html#c_visibility-of-data">Visibilità dei dati nelle tabelle e nelle viste di sistema</a>.</p><p>Alcuni o tutti i dati di questa tabella sono definiti anche nella vista di monitoraggio SYS <a href="./SYS_QUERY_TEXT.html">SYS_QUERY_TEXT</a>. I dati nella vista di monitoraggio SYS sono formattati in modo da essere più facili da usare e comprendere. Ti consigliamo di utilizzare la vista di monitoraggio SYS per le query.</p>
            <h2 id="r_STL_QUERYTEXT-table-columns">Colonne di tabella</h2>


            <div class="table-container"><div class="table-contents"><table id="w320aac49c17b9c71c19b3"><thead>
                        <tr>
                            <th>Nome colonna </th>
                            <th>Tipo di dati </th>
                            <th>Descrizione </th>
                        </tr>
                    </thead>
                        <tr>
                            <td tabindex="-1">userid</td>
                            <td tabindex="-1">integer</td>
                            <td tabindex="-1">ID dell'utente che ha generato la voce.</td>
                        </tr>
                        <tr>
                            <td tabindex="-1">xid </td>
                            <td tabindex="-1">bigint </td>
                            <td tabindex="-1">ID transazione. </td>
                        </tr>
                        <tr>
                            <td tabindex="-1">pid</td>
                            <td tabindex="-1">integer</td>
                            <td tabindex="-1">ID processo. In genere, tutte le query in una sessione sono eseguite nello stesso processo, quindi questo valore di solito rimane costante se esegui una serie di query nella stessa sessione. Seguendo determinati eventi interni, Amazon Redshift può riavviare una sessione attiva e assegnare un nuovo PID. Per ulteriori informazioni, consulta <a href="./r_STL_RESTARTED_SESSIONS.html">STL_RESTARTED_SESSIONS</a>. È possibile utilizzare questa colonna per eseguire la connessione alla vista <a href="./r_STL_ERROR.html">STL_ERROR</a>. </td>
                        </tr>
                        <tr>
                            <td tabindex="-1">query </td>
                            <td tabindex="-1">integer</td>
                            <td tabindex="-1">ID query. La colonna di query può essere utilizzata per unire altre tabelle e visualizzazioni del sistema.</td>
                        </tr>
                        <tr>
                            <td tabindex="-1">sequenza </td>
                            <td tabindex="-1">integer </td>
                            <td tabindex="-1">Quando una singola istruzione contiene più di 200 caratteri, vengono registrate delle righe aggiuntive per tale istruzione. La sequenza 0 è la prima riga, 1 la seconda e così via. </td>
                        </tr>
                        <tr>
                            <td tabindex="-1">text </td>
                            <td tabindex="-1">character(200) </td>
                            <td tabindex="-1">Testo SQL, in incrementi da 200 caratteri. Questo campo potrebbe contenere caratteri speciali come barra rovesciata (<code class="code">\\</code>) e nuova riga (<code class="code">\n</code>). </td>
                        </tr>
                    </table></div></div>
         
            <h2 id="r_STL_QUERYTEXT-sample-queries">Query di esempio</h2>


            <p>È possibile utilizzare la funzione PG_BACKEND_PID() per recuperare le informazioni sulla sessione corrente. Ad esempio, la query seguente restituisce l'ID di query e una porzione del testo di query delle query completate nella sessione corrente.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select query, substring(text,1,60)
from stl_querytext
where pid = pg_backend_pid()
order by query desc;

 query |                         substring
-------+--------------------------------------------------------------
 28262 | select query, substring(text,1,80) from stl_querytext where 
 28252 | select query, substring(path,0,80) as path from stl_unload_l
 28248 | copy category from 's3://dw-tickit/manifest/category/1030_ma
 28247 | Count rows in target table
 28245 | unload ('select * from category') to 's3://dw-tickit/manifes
 28240 | select query, substring(text,1,40) from stl_querytext where 
(6 rows)</code></pre>

             
                <h3 id="r_STL_QUERYTEXT-reconstruct-sql">Ricostruzione dell'SDL archiviato</h3>
            <p>Per ricostruire l'SQL archiviato nella colonna <code class="code">text</code> di STL_QUERYTEXT, eseguire un'istruzione SELECT per creare un SQL da 1 o più parti nella colonna <code class="code">text</code>. Prima di eseguire l'SQL ricostruito, sostituire un carattere speciale qualsiasi (<code class="code">\n</code>) con una nuova riga. Il risultato della dichiarazione SELECT seguente è dato da una riga di SQL ricostruiti nel campo <code class="code">query_statement</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">SELECT query, LISTAGG(CASE WHEN LEN(RTRIM(text)) = 0 THEN text ELSE RTRIM(text) END) WITHIN GROUP (ORDER BY sequence) as query_statement, COUNT(*) as row_count 
FROM stl_querytext GROUP BY query ORDER BY query desc;</code></pre>
            <p>Ad esempio, la query seguente seleziona 3 colonne. La query stessa è più lunga di 200 caratteri ed è archiviata in parti in STL_QUERYTEXT.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">select
1 AS a0123456789012345678901234567890123456789012345678901234567890,
2 AS b0123456789012345678901234567890123456789012345678901234567890,
3 AS b012345678901234567890123456789012345678901234
FROM stl_querytext;</code></pre>
            
            <p>In questo esempio, la query è archiviata in 2 parti (righe) nella colonna <code class="code">text</code> di STL_QUERYTEXT.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">select query, sequence, text
from stl_querytext where query=pg_last_query_id() order by query desc, sequence limit 10;</code></pre>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
query  | sequence |                                                                                             text                                                                                                   
-------+----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    45 |        0 | select\n1 AS a0123456789012345678901234567890123456789012345678901234567890,\n2 AS b0123456789012345678901234567890123456789012345678901234567890,\n3 AS b012345678901234567890123456789012345678901234
    45 |        1 | \nFROM stl_querytext;</code></pre>
            
                <p>Per ricostruire l'SQL archiviato in STL_QUERYTEXT, eseguire l'SQL seguente. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select LISTAGG(CASE WHEN LEN(RTRIM(text)) = 0 THEN text ELSE RTRIM(text) END, '') within group (order by sequence) AS text 
from stl_querytext where query=pg_last_query_id();
</code></pre>
                <p>Per utilizzare l'SQL ricostruito derivante nel client, sostituire qualsiasi carattere speciale (<code class="code">\n</code>) con una nuova riga. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copia"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
                                                                                                             text                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 select\n1 AS a0123456789012345678901234567890123456789012345678901234567890,\n2 AS b0123456789012345678901234567890123456789012345678901234567890,\n3 AS b012345678901234567890123456789012345678901234\nFROM stl_querytext;
</code></pre>
                         
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avvertimento" /> <strong>JavaScript è disabilitato o non è disponibile nel tuo browser.</strong></p><p>Per usare la documentazione AWS, JavaScript deve essere abilitato. Consulta le pagine della guida del browser per le istruzioni.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenzioni dei documenti</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_STL_QUERY_METRICS.html">STL_QUERY_METRICS</div><div id="next" class="next-link" accesskey="n" href="./r_STL_REPLACEMENTS.html">STL_REPLACEMENTS</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Questa pagina ti è stata utile? - Sì</div><div class="content"><p>Grazie per averci comunicato che stiamo facendo un buon lavoro!</p><p>Se hai un momento, ti invitiamo a dirci che cosa abbiamo fatto che ti è piaciuto così possiamo offrirti altri contenuti simili.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_STL_QUERYTEXT.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Questa pagina ti è stata utile? - No</div><div class="content"><p>Grazie per averci comunicato che questa pagina ha bisogno di essere modificata. Siamo spiacenti di non aver soddisfatto le tue esigenze.</p><p>Se hai un momento, ti invitiamo a dirci come possiamo migliorare la documentazione.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_STL_QUERYTEXT.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>