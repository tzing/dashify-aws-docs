<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS::S3::Bucket ReplicationRule - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="aws-properties-s3-bucket-replicationrule" /><meta name="default_state" content="aws-properties-s3-bucket-replicationrule" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" /><meta name="description" content="Specifies which Amazon S3 objects to replicate and where to store the replicas." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json;toc-AWS_S3.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" hreflang="x-default" /><meta name="feedback-item" content="S3" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="AWS::S3::Bucket ReplicationRule" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS::S3::Bucket ReplicationRule - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=S3&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Amazon Simple Storage Service (Amazon S3) resource type reference",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_S3.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "AWS::S3::Bucket",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-s3-bucket.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "AWS::S3::Bucket ReplicationRule",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-s3-bucket.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="AWS_S3.html">User Guide</a></div><div id="page-toc-src"><a href="#aws-properties-s3-bucket-replicationrule-syntax">Syntax</a><a href="#aws-properties-s3-bucket-replicationrule-properties">Properties</a><a href="#aws-properties-s3-bucket-replicationrule--examples">Examples</a></div><div id="page-filters" style="display:none"><filter label="All" id="All"></filter><filter label="JSON" id="JSON"></filter><filter label="YAML" id="YAML"></filter></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="aws-properties-s3-bucket-replicationrule">AWS::S3::Bucket ReplicationRule</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Specifies which Amazon S3 objects to replicate and where to store the replicas.</p><h2 id="aws-properties-s3-bucket-replicationrule-syntax">Syntax</h2><p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p><div id="JSON" name="JSON" class="section langfilter"><h3 id="aws-properties-s3-bucket-replicationrule-syntax.json">JSON</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "<a href="#cfn-s3-bucket-replicationrule-deletemarkerreplication">DeleteMarkerReplication</a>" : <code class="replaceable"><a href="./aws-properties-s3-bucket-deletemarkerreplication.html">DeleteMarkerReplication</a></code>,
  "<a href="#cfn-s3-bucket-replicationrule-destination">Destination</a>" : <code class="replaceable"><a href="./aws-properties-s3-bucket-replicationdestination.html">ReplicationDestination</a></code>,
  "<a href="#cfn-s3-bucket-replicationrule-filter">Filter</a>" : <code class="replaceable"><a href="./aws-properties-s3-bucket-replicationrulefilter.html">ReplicationRuleFilter</a></code>,
  "<a href="#cfn-s3-bucket-replicationrule-id">Id</a>" : <code class="replaceable">String</code>,
  "<a href="#cfn-s3-bucket-replicationrule-prefix">Prefix</a>" : <code class="replaceable">String</code>,
  "<a href="#cfn-s3-bucket-replicationrule-priority">Priority</a>" : <code class="replaceable">Integer</code>,
  "<a href="#cfn-s3-bucket-replicationrule-sourceselectioncriteria">SourceSelectionCriteria</a>" : <code class="replaceable"><a href="./aws-properties-s3-bucket-sourceselectioncriteria.html">SourceSelectionCriteria</a></code>,
  "<a href="#cfn-s3-bucket-replicationrule-status">Status</a>" : <code class="replaceable">String</code>
}
</code></pre></div><div id="YAML" name="YAML" class="section langfilter"><h3 id="aws-properties-s3-bucket-replicationrule-syntax.yaml">YAML</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">  <a href="#cfn-s3-bucket-replicationrule-deletemarkerreplication">DeleteMarkerReplication</a>: <code class="replaceable">
    <a href="./aws-properties-s3-bucket-deletemarkerreplication.html">DeleteMarkerReplication</a></code>
  <a href="#cfn-s3-bucket-replicationrule-destination">Destination</a>: <code class="replaceable">
    <a href="./aws-properties-s3-bucket-replicationdestination.html">ReplicationDestination</a></code>
  <a href="#cfn-s3-bucket-replicationrule-filter">Filter</a>: <code class="replaceable">
    <a href="./aws-properties-s3-bucket-replicationrulefilter.html">ReplicationRuleFilter</a></code>
  <a href="#cfn-s3-bucket-replicationrule-id">Id</a>: <code class="replaceable">String</code>
  <a href="#cfn-s3-bucket-replicationrule-prefix">Prefix</a>: <code class="replaceable">String</code>
  <a href="#cfn-s3-bucket-replicationrule-priority">Priority</a>: <code class="replaceable">Integer</code>
  <a href="#cfn-s3-bucket-replicationrule-sourceselectioncriteria">SourceSelectionCriteria</a>: <code class="replaceable">
    <a href="./aws-properties-s3-bucket-sourceselectioncriteria.html">SourceSelectionCriteria</a></code>
  <a href="#cfn-s3-bucket-replicationrule-status">Status</a>: <code class="replaceable">String</code>
</code></pre></div><h2 id="aws-properties-s3-bucket-replicationrule-properties">Properties</h2><div class="variablelist"><dl><dt id="cfn-s3-bucket-replicationrule-deletemarkerreplication"><span class="term"><code class="code">DeleteMarkerReplication</code></span></dt><dd>
         <p>Specifies whether Amazon S3 replicates delete markers. If you specify a <code class="code">Filter</code>
         in your replication configuration, you must also include a
            <code class="code">DeleteMarkerReplication</code> element. If your <code class="code">Filter</code> includes a
            <code class="code">Tag</code> element, the <code class="code">DeleteMarkerReplication</code>
            <code class="code">Status</code> must be set to Disabled, because Amazon S3 does not support replicating
         delete markers for tag-based rules. For an example configuration, see <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/replication-add-config.html#replication-config-min-rule-config">Basic Rule Configuration</a>. </p>
         <p>For more information about delete marker replication, see <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/delete-marker-replication.html">Basic Rule
            Configuration</a>. </p>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If you are using an earlier version of the replication configuration, Amazon S3 handles
            replication of delete markers differently. For more information, see <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/replication-add-config.html#replication-backward-compat-considerations">Backward Compatibility</a>.</p></div></div>
      <p><em>Required</em>: No</p><p><em>Type</em>: <a href="./aws-properties-s3-bucket-deletemarkerreplication.html">DeleteMarkerReplication</a></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-s3-bucket-replicationrule-destination"><span class="term"><code class="code">Destination</code></span></dt><dd>
         <p>A container for information about the replication destination and its configurations
         including enabling the S3 Replication Time Control (S3 RTC).</p>
      <p><em>Required</em>: Yes</p><p><em>Type</em>: <a href="./aws-properties-s3-bucket-replicationdestination.html">ReplicationDestination</a></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-s3-bucket-replicationrule-filter"><span class="term"><code class="code">Filter</code></span></dt><dd>
    
    <p>A filter that identifies the subset of objects to which the replication rule applies. A
        <code class="code">Filter</code> must specify exactly one <code class="code">Prefix</code>, <code class="code">TagFilter</code>, or
      an <code class="code">And</code> child element. The use of the filter field indicates that this is a V2
      replication configuration. This field isn't supported in a V1 replication
      configuration.</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>V1 replication configuration only supports filtering by key prefix. To filter using a V1
        replication configuration, add the <code class="code">Prefix</code> directly as a child element of the
          <code class="code">Rule</code> element.</p></div></div>
  <p><em>Required</em>: No</p><p><em>Type</em>: <a href="./aws-properties-s3-bucket-replicationrulefilter.html">ReplicationRuleFilter</a></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-s3-bucket-replicationrule-id"><span class="term"><code class="code">Id</code></span></dt><dd>
    <p>A unique identifier for the rule. The maximum value is 255 characters. If you don't
      specify a value, AWS CloudFormation generates a random ID. When using a V2
      replication configuration this property is capitalized as "ID".</p>
  <p><em>Required</em>: No</p><p><em>Type</em>: String</p><p><em>Maximum</em>: <code class="code">255</code></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-s3-bucket-replicationrule-prefix"><span class="term"><code class="code">Prefix</code></span></dt><dd>
    <p>An object key name prefix that identifies the object or objects to which the rule applies.
      The maximum prefix length is 1,024 characters. To include all objects in a bucket, specify an
      empty string. To filter using a V1 replication configuration, add the <code class="code">Prefix</code>
      directly as a child element of the <code class="code">Rule</code> element.</p>
    <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Replacement must be made for object keys containing special characters (such as carriage
        returns) when using XML requests. For more information, see <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-keys.html#object-key-xml-related-constraints"> XML
          related object key constraints</a>.</p></div></div>
  <p><em>Required</em>: No</p><p><em>Type</em>: String</p><p><em>Maximum</em>: <code class="code">1024</code></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-s3-bucket-replicationrule-priority"><span class="term"><code class="code">Priority</code></span></dt><dd>
         <p>The priority indicates which rule has precedence whenever two or more replication rules
         conflict. Amazon S3 will attempt to replicate objects according to all replication rules.
         However, if there are two or more rules with the same destination bucket, then objects will
         be replicated according to the rule with the highest priority. The higher the number, the
         higher the priority. </p>
         <p>For more information, see <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/replication.html">Replication</a> in the
            <em>Amazon S3 User Guide</em>.</p>
      <p><em>Required</em>: No</p><p><em>Type</em>: Integer</p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-s3-bucket-replicationrule-sourceselectioncriteria"><span class="term"><code class="code">SourceSelectionCriteria</code></span></dt><dd>
    <p>A container that describes additional filters for identifying the source objects that you
      want to replicate. You can choose to enable or disable the replication of these
      objects.</p>
  <p><em>Required</em>: No</p><p><em>Type</em>: <a href="./aws-properties-s3-bucket-sourceselectioncriteria.html">SourceSelectionCriteria</a></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-s3-bucket-replicationrule-status"><span class="term"><code class="code">Status</code></span></dt><dd>
         <p>Specifies whether the rule is enabled.</p>
      <p><em>Required</em>: Yes</p><p><em>Type</em>: String</p><p><em>Allowed values</em>: <code class="code">Disabled | Enabled</code></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd></dl></div><h2 id="aws-properties-s3-bucket-replicationrule--examples">Examples</h2><p></p><div class="highlights" id="inline-topiclist"><h6> </h6><ul><li><a href="#aws-properties-s3-bucket-replicationrule--examples--Associate_a_replication_configuration_IAM_role_with_an_S3_bucket">Associate a replication configuration IAM role with an S3 bucket</a></li><li><a href="#aws-properties-s3-bucket-replicationrule--examples--Enable_versioning_and_replicate_objects">Enable versioning and replicate objects</a></li></ul></div><h3 id="aws-properties-s3-bucket-replicationrule--examples--Associate_a_replication_configuration_IAM_role_with_an_S3_bucket">Associate a replication configuration IAM role with an S3 bucket</h3><p>The following example creates an S3 bucket and grants it permission to write to a
          replication bucket by using an AWS Identity and Access Management (IAM)
          role. To avoid a circular dependency, the role's policy is declared as a separate
          resource. The bucket depends on the <code class="code">WorkItemBucketBackupRole</code> role. If the
          policy is included in the role, the role also depends on the bucket.</p><div id="JSON" name="JSON" class="section langfilter"><h4 id="aws-properties-s3-bucket-replicationrule--examples--Associate_a_replication_configuration_IAM_role_with_an_S3_bucket--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Resources": <span>{</span>
        "RecordServiceS3Bucket": <span>{</span>
            "Type": "AWS::S3::Bucket",
            "DeletionPolicy": "Retain",
            "Properties": <span>{</span>
                "ReplicationConfiguration": <span>{</span>
                    "Role": <span>{</span>
                        "Fn::GetAtt": [
                            "WorkItemBucketBackupRole",
                            "Arn"
                        ]
                    },
                    "Rules": [
                        <span>{</span>
                            "Destination": <span>{</span>
                                "Bucket": <span>{</span>
                                    "Fn::Join": [
                                        "",
                                        [
                                            "arn:aws:s3:::",
                                            <span>{</span>
                                                "Fn::Join": [
                                                    "-",
                                                    [
                                                        <span>{</span>
                                                            "Ref": "AWS::Region"
                                                        },
                                                        <span>{</span>
                                                            "Ref": "AWS::StackName"
                                                        },
                                                        "replicationbucket"
                                                    ]
                                                ]
                                            }
                                        ]
                                    ]
                                },
                                "StorageClass": "STANDARD"
                            },
                            "Id": "Backup",
                            "Prefix": "",
                            "Status": "Enabled"
                        }
                    ]
                },
                "VersioningConfiguration": <span>{</span>
                    "Status": "Enabled"
                }
            }
        },
        "WorkItemBucketBackupRole": <span>{</span>
            "Type": "AWS::IAM::Role",
            "Properties": <span>{</span>
                "AssumeRolePolicyDocument": <span>{</span>
                    "Statement": [
                        <span>{</span>
                            "Action": [
                                "sts:AssumeRole"
                            ],
                            "Effect": "Allow",
                            "Principal": <span>{</span>
                                "Service": [
                                    "s3.amazonaws.com"
                                ]
                            }
                        }
                    ]
                }
            }
        },
        "BucketBackupPolicy": <span>{</span>
            "Type": "AWS::IAM::Policy",
            "Properties": <span>{</span>
                "PolicyDocument": <span>{</span>
                    "Statement": [
                        <span>{</span>
                            "Action": [
                                "s3:GetReplicationConfiguration",
                                "s3:ListBucket"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                <span>{</span>
                                    "Fn::Join": [
                                        "",
                                        [
                                            "arn:aws:s3:::",
                                            <span>{</span>
                                                "Ref": "RecordServiceS3Bucket"
                                            }
                                        ]
                                    ]
                                }
                            ]
                        },
                        <span>{</span>
                            "Action": [
                                "s3:GetObjectVersion",
                                "s3:GetObjectVersionAcl"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                <span>{</span>
                                    "Fn::Join": [
                                        "",
                                        [
                                            "arn:aws:s3:::",
                                            <span>{</span>
                                                "Ref": "RecordServiceS3Bucket"
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        <span>{</span>
                            "Action": [
                                "s3:ReplicateObject",
                                "s3:ReplicateDelete"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                <span>{</span>
                                    "Fn::Join": [
                                        "",
                                        [
                                            "arn:aws:s3:::",
                                            <span>{</span>
                                                "Fn::Join": [
                                                    "-",
                                                    [
                                                        <span>{</span>
                                                            "Ref": "AWS::Region"
                                                        },
                                                        <span>{</span>
                                                            "Ref": "AWS::StackName"
                                                        },
                                                        "replicationbucket"
                                                    ]
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ]
                },
                "PolicyName": "BucketBackupPolicy",
                "Roles": [
                    <span>{</span>
                        "Ref": "WorkItemBucketBackupRole"
                    }
                ]
            }
        }
    }
}</code></pre></div><div id="YAML" name="YAML" class="section langfilter"><h4 id="aws-properties-s3-bucket-replicationrule--examples--Associate_a_replication_configuration_IAM_role_with_an_S3_bucket--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Resources:
  RecordServiceS3Bucket:
    Type: 'AWS::S3::Bucket'
    DeletionPolicy: Retain
    Properties:
      ReplicationConfiguration:
        Role: !GetAtt
          - WorkItemBucketBackupRole
          - Arn
        Rules:
          - Destination:
              Bucket: !Join
                - ''
                - - 'arn:aws:s3:::'
                  - !Join
                    - '-'
                    - - !Ref 'AWS::Region'
                      - !Ref 'AWS::StackName'
                      - replicationbucket
              StorageClass: STANDARD
            Id: Backup
            Prefix: ''
            Status: Enabled
      VersioningConfiguration:
        Status: Enabled
  WorkItemBucketBackupRole:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action:
              - 'sts:AssumeRole'
            Effect: Allow
            Principal:
              Service:
                - s3.amazonaws.com
  BucketBackupPolicy:
    Type: 'AWS::IAM::Policy'
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - 's3:GetReplicationConfiguration'
              - 's3:ListBucket'
            Effect: Allow
            Resource:
              - !Join
                - ''
                - - 'arn:aws:s3:::'
                  - !Ref RecordServiceS3Bucket
          - Action:
              - 's3:GetObjectVersion'
              - 's3:GetObjectVersionAcl'
            Effect: Allow
            Resource:
              - !Join
                - ''
                - - 'arn:aws:s3:::'
                  - !Ref RecordServiceS3Bucket
                  - /*
          - Action:
              - 's3:ReplicateObject'
              - 's3:ReplicateDelete'
            Effect: Allow
            Resource:
              - !Join
                - ''
                - - 'arn:aws:s3:::'
                  - !Join
                    - '-'
                    - - !Ref 'AWS::Region'
                      - !Ref 'AWS::StackName'
                      - replicationbucket
                  - /*
      PolicyName: BucketBackupPolicy
      Roles:
        - !Ref WorkItemBucketBackupRole</code></pre></div><h3 id="aws-properties-s3-bucket-replicationrule--examples--Enable_versioning_and_replicate_objects">Enable versioning and replicate objects</h3><p>The following example enables versioning and two replication rules. The rules copy
          objects prefixed with either <code class="code">MyPrefix</code> and <code class="code">MyOtherPrefix</code> and
          stores the copied objects in a bucket named <code class="code">my-replication-bucket</code>.</p><div id="JSON" name="JSON" class="section langfilter"><h4 id="aws-properties-s3-bucket-replicationrule--examples--Enable_versioning_and_replicate_objects--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "AWSTemplateFormatVersion": "2010-09-09",
    "Resources": <span>{</span>
        "S3Bucket": <span>{</span>
            "Type": "AWS::S3::Bucket",
            "Properties": <span>{</span>
                "VersioningConfiguration": <span>{</span>
                    "Status": "Enabled"
                },
                "ReplicationConfiguration": <span>{</span>
                    "Role": "arn:aws:iam::123456789012:role/replication_role",
                    "Rules": [
                        <span>{</span>
                            "Id": "MyRule1",
                            "Status": "Enabled",
                            "Prefix": "MyPrefix",
                            "Destination": <span>{</span>
                                "Bucket": "arn:aws:s3:::my-replication-bucket",
                                "StorageClass": "STANDARD"
                            }
                        },
                        <span>{</span>
                            "Status": "Enabled",
                            "Prefix": "MyOtherPrefix",
                            "Destination": <span>{</span>
                                "Bucket": "arn:aws:s3:::my-replication-bucket"
                            }
                        }
                    ]
                }
            }
        }
    }
}</code></pre></div><div id="YAML" name="YAML" class="section langfilter"><h4 id="aws-properties-s3-bucket-replicationrule--examples--Enable_versioning_and_replicate_objects--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket'
    Properties:
      VersioningConfiguration:
        Status: Enabled
      ReplicationConfiguration:
        Role: 'arn:aws:iam::123456789012:role/replication_role'
        Rules:
          - Id: MyRule1
            Status: Enabled
            Prefix: MyPrefix
            Destination:
              Bucket: 'arn:aws:s3:::my-replication-bucket'
              StorageClass: STANDARD
          - Status: Enabled
            Prefix: MyOtherPrefix
            Destination:
              Bucket: 'arn:aws:s3:::my-replication-bucket'</code></pre></div><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./aws-properties-s3-bucket-replicationdestination.html">ReplicationDestination</div><div id="next" class="next-link" accesskey="n" href="./aws-properties-s3-bucket-replicationruleandoperator.html">ReplicationRuleAndOperator</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=S3&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=S3&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-replicationrule.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>