<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="zh-TW"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>逐步解說：建置管線以用於測試和生產堆疊 - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="continuous-delivery-codepipeline-basic-walkthrough" /><meta name="default_state" content="continuous-delivery-codepipeline-basic-walkthrough" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" /><meta name="description" content="了解如何建置 CodePipeline 管道，以自AWS CloudFormation動執行許多動作，以實現持續交付工作流程。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="使用者指南" /><meta name="abstract" content="使 AWS CloudFormation 用本使用者指南可預測並重複地建立和管理 AWS 基礎架構部署。" /><meta name="guide-locale" content="zh_tw" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="使用者指南" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="使用者指南" /><meta id="panorama-serviceConsolePage" value="逐步解說：建置管線以用於測試和生產堆疊" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>逐步解說：建置管線以用於測試和生產堆疊 - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,資源佈建,資源組態,基礎設施管理,CloudFormer,CloudFormation 堆疊,CloudFormation 堆疊集,CloudFormation 範本,變更集合" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "使用者指南",
        "item" : "https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "使用 CodePipeline 進行持續交付",
        "item" : "https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "逐步解說：建置管線以用於測試和生產堆疊",
        "item" : "https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">文件</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">使用者指南</a></div><div id="page-toc-src"><a href="#w9aac21c11b5">必要條件</a><a href="#w9aac21c11b7">逐步解說概觀</a><a href="#w9aac21c11b9">步驟 1：編輯成品並將它上傳到 S3 儲存貯體</a><a href="#w9aac21c11c11">步驟 2：建立管道堆疊</a><a href="#w9aac21c11c13">步驟 3：檢視 WordPress 堆疊</a><a href="#w9aac21c11c15">步驟 4：清除資源</a><a href="#w9aac21c11c19">另請參閱</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>本文為英文版的機器翻譯版本，如內容有任何歧義或不一致之處，概以英文版為準。</p></awsui-alert><h1 class="topictitle" id="continuous-delivery-codepipeline-basic-walkthrough">逐步解說：建置管線以用於測試和生產堆疊</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>試想您提交 AWS CloudFormation 範本的發行程序，然後 AWS CloudFormation 使用此範本自動建置測試堆疊。檢閱測試堆疊後，您可以預覽您的變更將如何修改您的生產堆疊，然後選擇是否要實作。為達成此工作流程，您可以使用 AWS CloudFormation 建置您的測試堆疊、刪除測試堆疊、建立變更集，然後執行變更集。不過，每個動作您都必須手動與 AWS CloudFormation 互動。在本逐步解說中，我們將建置自動執行許多動作的 CodePipeline 管道，協助您透過AWS CloudFormation堆疊實現持續交付工作流程。</p>
    <h2 id="w9aac21c11b5">必要條件</h2>
    <p>本逐步解說假設您已使用 CodePipeline 和AWS CloudFormation，並且瞭解管線、AWS CloudFormation範本和堆疊的運作方式。若要取得有關的更多資訊 CodePipeline，請參閱<a href="https://docs.aws.amazon.com/codepipeline/latest/userguide/">AWS CodePipeline使用者指南</a>。您也必須在相同 AWS 區域中，擁有您將用於建立管道的 Amazon S3 <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingBucket.html">儲存貯體</a>。</p>
    <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>範例 WordPress 範本會建立需要連線至網際網路的 EC2 執行個體。確認您有允許將流量傳送至網際網路的預設 VPC 和子網路。</p></div></div>
   
    <h2 id="w9aac21c11b7">逐步解說概觀</h2>
    <p>本逐步解說會為堆疊中的範例 WordPress 網站建置管道。此管道分為三個階段。每個階段皆必須至少包含一個動作，它是管道在您的成品 (您的輸入) 上執行的任務。階段會組織管道中的動作。 CodePipeline 在階段處理新成品之前，必須先完成階段中的所有動作，例如，如果您已提交新輸入以重新執行管線。</p>
    <p>在此逐步教學結束時，您將擁有可執行以下工作流程的管道：</p>
    <div class="orderedlist">
       
       
       
    <ol><li>
        <p>管道的第一個階段會從儲存庫其擷取來源成品 (AWS CloudFormation 範本及其組態檔案)。</p>
        <p>您將準備一個包含範例 WordPress 範本的成品，並將其上傳到 S3 儲存貯體。</p>
      </li><li>
        <p>在第二個階段，管道會建立測試堆疊，然後等待您的核准。</p>
        <p>在您檢閱測試堆疊之後，可選擇繼續使用原始管道或建立並提交另一個成品來進行變更。如果您核准，此階段將會刪除測試堆疊，然後管道將持續至下一個階段。</p>
      </li><li>
        <p>在第三個階段，管道會針對生產堆疊建立變更集，然後等待您的核准。</p>
        <p>在您初次執行時，不會有生產堆疊。變更集向您顯示 AWS CloudFormation 將建立的所有資源。如果您核准，此階段將執行變更集並建置您的生產堆疊。</p>
      </li></ol></div>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>AWS CloudFormation 是免費服務。但是，您必須以目前的費率為您包含在堆疊中的 AWS 資源支付費用，例如 EC2 執行個體。如需有關 AWS 定價的詳細資訊，請參閱 <a href="https://aws.amazon.com/" rel="noopener noreferrer" target="_blank"><span>http://aws.amazon.com</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> 上各項產品的詳細資訊頁面。</p></div></div>
   
    <h2 id="w9aac21c11b9">步驟 1：編輯成品並將它上傳到 S3 儲存貯體</h2>
    <p>在您建置管道之前，必須設定來源儲存庫與檔案。 CodePipeline 會將這些資源複製到您管道的<a href="https://docs.aws.amazon.com/codepipeline/latest/userguide/concepts.html">成品存放區</a>，然後使用它們在管道中執行動作，例如建立 AWS CloudFormation 堆疊。</p>
    <p>當您使用 Amazon Simple Storage Service (Amazon S3) 做為來源儲存庫時， CodePipeline 需要先壓縮來源檔案，然後再將它們上傳到 S3 儲存貯體。壓縮檔案是可包含AWS CloudFormation範本、範本組態檔或兩者的 CodePipeline 成品。我們提供一個包含示例 WordPress 模板和兩個模板配置文件的成品。這兩個組態檔案會指定 WordPress 範本的參數值。  CodePipeline 在創建 WordPress 堆棧時使用它們。其中一個檔案包含測試堆疊的參數值，另一個則包含生產堆疊的參數值。您將必須編輯組態檔案，例如，指定您擁有的現有 EC2 金鑰對名稱。如需成品的詳細資訊，請參閱 <a href="./continuous-delivery-codepipeline-cfn-artifacts.html">AWS CloudFormation 成品</a>。</p>
    <p>在您建置成品之後，會將它上傳到 S3 儲存貯體。</p>
    <div class="procedure"><h6>編輯和上傳成品</h6><ol><li>
        <p><a href="https://s3.amazonaws.com/cloudformation-examples/user-guide/continuous-deployment/wordpress-single-instance.zip" rel="noopener noreferrer" target="_blank"><span>下載並開啟成品範例：wordpress-single-instance</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>https://s3.amazonaws.com/cloudformation-examples/user-guide/continuous-deployment/</p>
        <p>此成品包含三個檔案：</p>
        <div class="itemizedlist">
           
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p>示例 WordPress 模板：<code class="code">wordpress-single-instance.yaml</code></p>
          </li><li class="listitem">
            <p>測試堆疊的範本組態檔案：<code class="code">test-stack-configuration.json</code></p>
          </li><li class="listitem">
            <p>生產堆疊的範本組態檔案：<code class="code">prod-stack-configuration.json</code></p>
          </li></ul></div>
      </li><li>
        <p>擷取所有檔案，然後使用任何文字編輯器來修改範本組態檔案。</p>
        <p>開啟組態檔案，查看它們包含對應至 WordPress 範本參數的索引鍵值組。組態檔案指定參數值，您的管道在建立測試和生產堆疊時，將會使用這些參數值。</p>
        <p>編輯 <code class="code">test-stack-configuration.json</code> 檔案以指定測試堆疊的參數值，並指定 <code class="code">prod-stack-configuration.json</code> 檔案以指定生產堆疊的參數值。</p>
        <div class="itemizedlist">
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p>將<code class="code">DBPassword</code>和<code class="code">DBRootPassword</code>金鑰的值變更為可用來登入 WordPress 資料庫的密碼。如 WordPress 範本中所定義，參數值必須只包含英數字元。</p>
          </li><li class="listitem">
            <p>將 <code class="code">KeyName</code> 金鑰值變更為您將建立管道之區域中現有的 EC2 金鑰對名稱。</p>
          </li></ul></div>
      </li><li>
        <p>將修改過的組態檔新增至原始成品 (<code class="code">.zip</code>) 檔案，以取代重複的檔案。</p>
        <p>您現在可以自訂成品，並可將它上傳到 S3 儲存貯體。</p>
      </li><li>
        <p><a href="https://docs.aws.amazon.com/AmazonS3/latest/user-guide/UploadingObjectsintoAmazonS3.html">將成品上傳到您擁有的 S3 儲存貯體。</a></p>
        <p>請注意檔案的位置。當您建置管道時，將指定此檔案的位置。</p>
        <p>有關成品和 S3 儲存貯體的說明：</p>
        <div class="itemizedlist">
           
           
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p>使用與您將建立管道之相同 AWS 區域中的儲存貯體。</p>
          </li><li class="listitem">
            <p>CodePipeline 要求值區<a href="https://docs.aws.amazon.com/AmazonS3/latest/user-guide/enable-bucket-versioning.html">已啟用版本控制</a>。</p>
          </li><li class="listitem">
            <p>您也可以使用不需要您在上傳檔案之前壓縮檔案的服務，例如 GitHub 或 CodeCommit，來源儲存庫。</p>
          </li><li class="listitem">
            <p>成品可以包含敏感的資訊，例如密碼。<a href="https://docs.aws.amazon.com/AmazonS3/latest/user-guide/EditingPermissionsonanObject.html">限制存取</a>，只有獲得允許使用者可以檢視檔案。當您這樣做時，請確保仍然 CodePipeline 可以訪問該文件。</p>
          </li></ul></div>
      </li></ol></div>
    <p>您現在有一個可 CodePipeline 以拉入管道的成品。在下一個步驟中，您將指定成品的位置並建立 WordPress 管道。</p>
   
    <h2 id="w9aac21c11c11">步驟 2：建立管道堆疊</h2>
    <p>若要建立 WordPress 管線，您將使用範例AWS CloudFormation範本。除了建立管道之外，範本還會為 CodePipeline 和AWS CloudFormation、成 CodePipeline 品存放區的 S3 儲存貯體設定 AWS Identity and Access Management (IAM) 服務角色，以及管道向其傳送通知的 Amazon 簡單通知服務 (Amazon SNS) 主題，例如有關檢閱的通知。範例範本可讓您輕鬆佈建和設定單一 AWS CloudFormation 堆疊中的這些資源。</p>
    <p>如需管道設定的詳細資訊，請參閱 <a href="#codepipeline-basic-walkthrough-template-details">管道有何功能</a>。</p>
    <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>範例 WordPress 範本會建立需要連線至網際網路的 EC2 執行個體。確認您的預設 VPC 和子網路允許將流量傳送至網際網路。</p></div></div>
    <div class="procedure"><h6>建立管道堆疊</h6><ol><li>
        <p>請至 <a href="https://s3.amazonaws.com/cloudformation-examples/user-guide/continuous-deployment/basic-pipeline.yml" rel="noopener noreferrer" target="_blank"><span>https://s3.amazonaws.com/cloudformation-examples/user-guide/continuous-deployment/basic-pipeline.yml</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> 下載範例範本。並將它儲存在您的電腦。</p>
      </li><li>
        <p>開啟主AWS CloudFormation控台，<a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>網址為 https://console.aws.amazon.com/cloudformation/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>。</p>
      </li><li>
        <p>選擇支援 CodePipeline 和的AWS區域AWS CloudFormation。</p>
        <p>如需詳細資訊，請參閱 <em>AWS 一般參考</em> 中的 <a href="https://docs.aws.amazon.com/general/latest/gr/rande.html">AWS 區域與端點</a>。</p>
      </li><li>
        <p>選擇<b>建立堆疊</b>。</p>
      </li><li>
        <p>在 <b>Specify template (指定範本) </b>下方，選擇 <b>Upload a template file (上傳範本檔案)</b>，然後選擇您剛剛下載的範本 <code class="code">basic-pipeline.yml</code>。</p>
      </li><li>
        <p>選擇<b>下一步</b>。</p>
      </li><li>
        <p>在 <b>Stack Name</b> (堆疊名稱) 中輸入 <code class="code">sample-WordPress-pipeline</code>。</p>
      </li><li>
        <p>在 <b>Parameters (參數)</b> 區段中指定以下參數值，然後選擇 <b>Next (下一步)</b>。設定堆疊參數時，如果您為 WordPress 範本及其組態檔案保持相同的名稱，則可以使用預設值。否則，請指定您使用的檔案名稱。</p>
        <div class="variablelist">
           
           
           
           
        <dl>
            <dt><span class="term"><b>PipelineName</b></span></dt>
            <dd>
              <p>您的管道名稱，例如 <code class="code">WordPress-test-pipeline</code>。</p>
            </dd>
           
            <dt><span class="term"><b>S3 儲存貯體</b></span></dt>
            <dd>
              <p>您用於儲存成品 (<code class="code">.zip</code> 檔案) 的 S3 儲存貯體名稱。</p>
            </dd>
           
            <dt><span class="term"><b>SourceS3Key</b></span></dt>
            <dd>
              <p>成品的檔案名稱。如果您將成品儲存於資料夾，請將其作為檔案名稱的一部分包含在內，例如 <code class="code">folder/subfolder/wordpress-single-instance.zip</code>。</p>
            </dd>
           
            <dt><span class="term"><b>電子郵件</b></span></dt>
            <dd>
              <p> CodePipeline 傳送管線通知的電子郵件地址，例如<code class="code">myemail@example.com</code>。</p>
            </dd>
          </dl></div>
      </li><li>
        <p>在此逐步解說中，您不需要新增標籤或指定進階設定，因此請選擇 <b>Next (下一步)</b>。</p>
      </li><li>
        <p>確認堆疊名稱和範本 URL 正確，然後選擇 <b>Create stack (建立堆疊)</b>。</p>
      </li><li>
        <p>為了確認您知道 AWS CloudFormation 可能會建立 IAM 資源，請勾選核取方塊。</p>
      </li></ol></div>
    <p>AWS CloudFormation 可能需要幾分鐘的時間來建立您的堆疊。若要監控進度，請檢視堆疊事件。如需詳細資訊，請參閱 <a href="./cfn-console-view-stack-data-resources.html">檢視 AWS CloudFormation 堆疊資料和資源 AWS Management Console</a>。</p>
    <p>建立堆疊後， CodePipeline 啟動您的新管道。若要查看其狀態，請參閱 <a href="https://console.aws.amazon.com/codepipeline/" rel="noopener noreferrer" target="_blank"><span>CodePipeline  主控台</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>。從管線清單中，選擇 <b>WordPress-test</b> 管線。</p>
     
      <h3 id="codepipeline-basic-walkthrough-template-details">管道有何功能</h3>
      <p>本節說明管道的三個階段，使用範例 WordPress 管線範本中的程式碼片段。</p>
       
        <h4 id="w9aac21c11c11c15b5">階段 1：來源</h4>
        <p>管道的第一階段是來源階段，您在其中指定原始程式碼的位置。每次將修訂推送到此位置時，都 CodePipeline 會重新執行管道。</p>
        <p>原始程式碼位於 S3 儲存貯體，並以其檔案名稱識別。您指定這些值作為您建立管道堆疊時的輸入參數值。為了允許在後續階段使用來源成品，程式碼片段指定 <code class="code">OutputArtifacts</code> 屬性，其名稱為 <code class="code">TemplateSource</code>。為了在之後的階段使用此成品，您指定 <code class="code">TemplateSource</code> 作為輸入成品。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">- Name: S3Source
  Actions:
    - Name: TemplateSource
      ActionTypeId:
        Category: Source
        Owner: AWS
        Provider: S3
        Version: '1'
      Configuration:
        S3Bucket: !Ref 'S3Bucket'
        S3ObjectKey: !Ref 'SourceS3Key'
      OutputArtifacts:
        - Name: TemplateSource</code></pre>
       
       
        <h4 id="w9aac21c11c11c15b7">第二階段： TestStage</h4>
        <p>在 <code class="code">TestStage</code> 階段，管道會建立測試堆疊、等待您的核准，然後刪除測試堆疊。</p>
        <p>對於<code class="code">CreateStack</code>動作，管道使用測試配置文件和 WordPress 模板來創建測試堆棧。這兩個檔案包含在從來源階段引進的 <code class="code">TemplateSource</code> 輸入成品中。程式碼片段使用 <code class="code">REPLACE_ON_FAILURE</code> 動作模式。如果堆疊建立失敗，管道將會取代它，因此在重新執行管道之前，您不需要清除或排解堆疊的問題。動作模式對於測試堆疊的快速更新很有用。對於 <code class="code">RoleArn</code> 屬性，此值是在範本中其他位置宣告的 AWS CloudFormation 服務角色。</p>
        <p><code class="code">ApproveTestStack</code> 動作會暫停管道，並傳送通知給您在建立管道堆疊時指定的電子郵件地址。管道暫停時，您可以檢查 WordPress 測試堆棧及其資源。用 CodePipeline 於<a href="https://docs.aws.amazon.com/codepipeline/latest/userguide/approvals-approve-or-reject.html">核准或拒絕</a>此動作。<code class="code">CustomData</code> 屬性包含您要核准之動作的描述，核准之後管道會將通知新增至電子郵件。</p>
        <p>核准此動作後，會 CodePipeline 移至<code class="code">DeleteTestStack</code>動作並刪除測試 WordPress 堆疊及其資源。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">- Name: TestStage
  Actions:
    - Name: CreateStack
      ActionTypeId:
        Category: Deploy
        Owner: AWS
        Provider: CloudFormation
        Version: '1'
      InputArtifacts:
        - Name: TemplateSource
      Configuration:
        ActionMode: REPLACE_ON_FAILURE
        RoleArn: !GetAtt [CFNRole, Arn]
        StackName: !Ref TestStackName
        TemplateConfiguration: !Sub "TemplateSource::$<span>{</span>TestStackConfig}"
        TemplatePath: !Sub "TemplateSource::$<span>{</span>TemplateFileName}"
      RunOrder: '1'
    - Name: ApproveTestStack
      ActionTypeId:
        Category: Approval
        Owner: AWS
        Provider: Manual
        Version: '1'
      Configuration:
        NotificationArn: !Ref CodePipelineSNSTopic
        CustomData: !Sub 'Do you want to create a change set against the production stack and delete the $<span>{</span>TestStackName} stack?'
      RunOrder: '2'
    - Name: DeleteTestStack
      ActionTypeId:
        Category: Deploy
        Owner: AWS
        Provider: CloudFormation
        Version: '1'
      Configuration:
        ActionMode: DELETE_ONLY
        RoleArn: !GetAtt [CFNRole, Arn]
        StackName: !Ref TestStackName
      RunOrder: '3'</code></pre>
       
       
        <h4 id="w9aac21c11c11c15b9">第三階段： ProdStage</h4>
        <p>管道的 <code class="code">ProdStage</code> 階段會針對現有的生產堆疊建立變更集、等待核准，然後執行變更集。</p>
        <p>變更集可在 AWS CloudFormation 對生產堆疊實作所有變更之前，提供所有修改的預覽。在您第一個管道執行時，您不會有執行中的生產堆疊。變更集顯示 AWS CloudFormation 在建立測試堆疊時執行的動作。欲建立變更集，<code class="code">CreateChangeSet</code>動作會使用 WordPress 範例範本和<code class="code">TemplateSource</code>輸入人工因素的生產範本組態。</p>
        <p>類似上個階段，<code class="code">ApproveChangeSet</code> 動作將暫停管道，並傳送電子郵件通知。管道暫停時，您可以檢視變更集，以檢查對生產 WordPress 堆疊所提議的所有修改。用 CodePipeline 於<a href="https://docs.aws.amazon.com/codepipeline/latest/userguide/approvals-approve-or-reject.html">核准或拒絕</a>此動作以分別繼續或停止配管。</p>
        <p>在您核准此動作之後，<code class="code">ExecuteChangeSet</code> 動作將執行變更集，以便 AWS CloudFormation 執行變更集所描述的所有動作。對於初始運行，AWS CloudFormation創建生 WordPress 產堆棧。在後續執行時，AWS CloudFormation 將更新堆疊。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">- Name: ProdStage
  Actions:
    - Name: CreateChangeSet
      ActionTypeId:
        Category: Deploy
        Owner: AWS
        Provider: CloudFormation
        Version: '1'
      InputArtifacts:
        - Name: TemplateSource
      Configuration:
        ActionMode: CHANGE_SET_REPLACE
        RoleArn: !GetAtt [CFNRole, Arn]
        StackName: !Ref ProdStackName
        ChangeSetName: !Ref ChangeSetName
        TemplateConfiguration: !Sub "TemplateSource::$<span>{</span>ProdStackConfig}"
        TemplatePath: !Sub "TemplateSource::$<span>{</span>TemplateFileName}"
      RunOrder: '1'
    - Name: ApproveChangeSet
      ActionTypeId:
        Category: Approval
        Owner: AWS
        Provider: Manual
        Version: '1'
      Configuration:
        NotificationArn: !Ref CodePipelineSNSTopic
        CustomData: !Sub 'A new change set was created for the $<span>{</span>ProdStackName} stack. Do you want to implement the changes?'
      RunOrder: '2'
    - Name: ExecuteChangeSet
      ActionTypeId:
        Category: Deploy
        Owner: AWS
        Provider: CloudFormation
        Version: '1'
      Configuration:
        ActionMode: CHANGE_SET_EXECUTE
        ChangeSetName: !Ref ChangeSetName
        RoleArn: !GetAtt [CFNRole, Arn]
        StackName: !Ref ProdStackName
      RunOrder: '3'</code></pre>
       
     
   
    <h2 id="w9aac21c11c13">步驟 3：檢視 WordPress 堆疊</h2>
    <p>在管線中 CodePipeline 執行時，它會用AWS CloudFormation來建立測試和生產堆疊。若要查看這些堆疊及其輸出的狀態，請使用 AWS CloudFormation 主控台。</p>
    <div class="procedure"><h6>檢視堆疊</h6><ol><li>
        <p>開啟主AWS CloudFormation控台，<a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>網址為 https://console.aws.amazon.com/cloudformation/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>。</p>
      </li><li>
        <p>根據您的管道處於測試或生產階段，選擇 <code class="code">Test-MyWordPressSite</code> 或 <code class="code">Prod-MyWordPressSite</code> 堆疊。</p>
      </li><li>
        <p>若要查看您堆疊的狀態，請檢視堆疊<a href="./cfn-console-view-stack-data-resources.html">事件</a>。</p>
      </li></ol></div>
    <p>如果堆疊處於故障狀態，請檢視狀態原因以找出堆疊錯誤。修正錯誤，然後重新執行管道。如果堆棧處於狀<code class="code">CREATE_COMPLETE</code>態，請查看其輸出以獲取 WordPress 站點的 URL。</p>
    <p>您已成功用於 CodePipeline 為範例 WordPress 網站建立持續傳遞工作流程。如果您提交變更至 S3 儲存貯體， CodePipeline 會自動偵測新版本，然後重新執行管道。此工作流程可讓您更容易提交和測試變更，然後再變更您的生產網站。</p>
   
    <h2 id="w9aac21c11c15">步驟 4：清除資源</h2>
    <p>為避免您為不需要的服務支付費用，請刪除您的資源。</p>
    <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>刪除管線堆 WordPress 疊之前，請先刪除測試和生產堆疊。管線堆疊包含刪除堆 WordPress 疊所需的服務角色。如果您先刪除管道堆疊，可以<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_DeleteStack.html">將另一個服務角色 Amazon 資源名稱 (ARN)</a> 與堆 WordPress疊建立關聯，然後刪除它們。</p></div></div>
    <div class="procedure"><h6>刪除成品存放區中的物件</h6><ol><li><p>前往 <a href="https://console.aws.amazon.com/s3/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/s3/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> 開啟的 Amazon Simple Storage Service (Amazon S3) 主控台。</p></li><li>
        <p>選擇 CodePipeline 用作管道成品存放區的 S3 儲存貯體。</p>
        <p>儲存貯體的名稱需使用此：<code class="code"><code class="replaceable">stackname-artifactstorebucket-id</code></code>。如果您依照此逐步解說，儲存貯體名稱可能類似於以下範例：<code class="code">sample-WordPress-pipeline-artifactstorebucket-12345abcd12345</code>。</p>
      </li><li>
        <p>刪除成品存放區 S3 儲存貯體中的所有物件。</p>
        <p>當您在下個步驟中刪除管道堆疊時，此儲存貯體必須是空的。否則，AWS CloudFormation 將無法刪除該儲存貯體。</p>
      </li></ol></div>
    <div class="procedure"><h6>刪除堆疊</h6><ol><li>
        <p>從 AWS CloudFormation 主控台選擇您要刪除的堆疊。</p>
        <p>如果管線建立的 WordPress 堆疊仍在執行中，請先選擇它們。在預設情況下，堆疊名稱為 <code class="code">Test-MyWordPressSite</code> 和 <code class="code">Prod-MyWordPressSite</code>。</p>
        <p>如果您已刪除 WordPress 堆疊，請選擇<code class="code">sample-WordPress-pipeline</code>堆疊。</p>
      </li><li>
        <p>選擇 <b>Actions</b> (動作)，然後選擇 <b>Delete Stack</b> (刪除堆疊)。</p>
      </li><li>
        <p>在確認訊息中，選擇 <b>Yes, Delete (是，刪除)</b>。</p>
      </li></ol></div>
    <p>AWS CloudFormation 刪除堆疊所有的堆疊資源，例如 EC2 執行個體、通知主題、服務角色和管道。</p>
    <p>現在您已瞭解如何使用建置基本AWS CloudFormation工作流程 CodePipeline，您可以使用範例範本和成品做為建置您自己的工作流程的起點。</p>
   
    <h2 id="w9aac21c11c19">另請參閱</h2>
    <p>以下相關資源可協助您使用這些參數。</p>
    <div class="itemizedlist">
       
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>如需有關中AWS CloudFormation動作參數的詳細資訊 CodePipeline，請參閱《<em>AWS CodePipeline使用指南》</em>中的<a href="https://docs.aws.amazon.com/codepipeline/latest/userguide/action-reference-CloudFormation.html">AWS CloudFormation</a>動作組態參考。</p>
      </li><li class="listitem">
        <p>如需動作提供者的範例範本值 (例如 <code class="code">Owner</code> 欄位或 <code class="code">configuration</code> 欄位)，請參閱 <em>AWS CodePipeline User Guide</em> (《 使用者指南》) 中的 <a href="https://docs.aws.amazon.com/codepipeline/latest/userguide/action-reference.html">Action structure reference</a> (動作結構參考)。</p>
      </li><li class="listitem">
        <p>若要下載 YAML 或 JSON 格式的範例管線堆疊範本，請參閱<em>AWS CodePipeline使用者指南AWS CloudFormation</em>中的<a href="https://docs.aws.amazon.com/codepipeline/latest/userguide/tutorials-cloudformation.html">建立管線下的</a>教學課程。</p>
      </li><li class="listitem">
        <p>如需範例範本組態檔，請參閱 <a href="https://docs.aws.amazon.com/codepipeline/latest/userguide/continuous-delivery-codepipeline-cfn-artifacts.html">AWS CloudFormation 成品</a>。</p>
      </li></ul></div>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>您的瀏覽器已停用或無法使用 Javascript。</strong></p><p>您必須啟用 Javascript，才能使用 AWS 文件。請參閱您的瀏覽器說明頁以取得說明。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">文件慣用形式</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./continuous-delivery-codepipeline.html">持續交付</div><div id="next" class="next-link" accesskey="n" href="./continuous-delivery-codepipeline-action-reference.html">組態屬性參考</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">此頁面是否有幫助？ - 是</div><div class="content"><p>感謝您，讓我們知道我們做得很好！</p><p>若您有空，歡迎您告知我們值得讚許的地方，這樣才能保持良好服務。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="意見回饋" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">此頁面是否有幫助？ - 否</div><div class="content"><p>感謝讓我們知道此頁面仍須改善。很抱歉，讓您失望。</p><p>若您有空，歡迎您提供改善文件的方式。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="意見回饋" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/continuous-delivery-codepipeline-basic-walkthrough.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>