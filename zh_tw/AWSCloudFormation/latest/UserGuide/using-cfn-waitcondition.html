<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="zh-TW"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>在範本中建立等待條件 - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="using-cfn-waitcondition" /><meta name="default_state" content="using-cfn-waitcondition" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><meta name="description" content="在範本中建立等待條件可協調堆疊資源的建立，或追蹤組態程序的進度。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="使用者指南" /><meta name="abstract" content="使 AWS CloudFormation 用本使用者指南可預測並重複地建立和管理 AWS 基礎架構部署。" /><meta name="guide-locale" content="zh_tw" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="使用者指南" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="使用者指南" /><meta id="panorama-serviceConsolePage" value="在範本中建立等待條件" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>在範本中建立等待條件 - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,資源佈建,資源組態,基礎設施管理,CloudFormer,CloudFormation 堆疊,CloudFormation 堆疊集,CloudFormation 範本,變更集合" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "使用者指南",
        "item" : "https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "使用 AWS CloudFormation 範本",
        "item" : "https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "演練",
        "item" : "https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/CHAP_Using.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "在範本中建立等待條件",
        "item" : "https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/CHAP_Using.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">文件</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">使用者指南</a></div><div id="page-toc-src"><a href="#using-cfn-waitconditionhandle">使用等待條件控點</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>本文為英文版的機器翻譯版本，如內容有任何歧義或不一致之處，概以英文版為準。</p></awsui-alert><h1 class="topictitle" id="using-cfn-waitcondition">在範本中建立等待條件</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>對於 Amazon EC2 和 Auto Scaling 資源，我們建議您使用 CreationPolicy 屬性而不是等待條件。將 CreationPolicy 屬性添加到這些資源中，並使用 cfn-signal 幫助程序腳本在實例創建過程成功完成時發出信號。</p><p>如需詳細資訊，請參閱 <a href="./aws-attribute-creationpolicy.html">CreationPolicy 屬性</a> 或 <a href="./deploying.applications.html">在 Amazon EC2 上部署應用程式 AWS CloudFormation</a> 。</p></div></div><p>您可以使用 <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-waitconditionhandle.html"><code class="code">AWS::CloudFormation::WaitConditionHandle</code></a> 資源和 <a href="./aws-attribute-creationpolicy.html">CreationPolicy 屬性</a> 屬性執行下列動作：</p><div class="itemizedlist">
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>協調堆疊資源建立與堆疊建立外部的其他組態動作</p>
         </li><li class="listitem">
            <p>追蹤組態程序的狀態</p>
         </li></ul></div><p>例如，您可以在應用程式組態完成一部分後，開始建立另一個資源，或是在安裝和組態程序期間傳送訊號來追蹤其進度。</p><h2 id="using-cfn-waitconditionhandle">使用等待條件控點</h2>
            
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>如果您使用 <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-endpoints.html">VPC 端點</a>功能，VPC 中回應等待條件的資源必須能夠存取 AWS CloudFormation特定的 Amazon Simple Storage Service (Amazon S3) 儲存貯體。資源必須傳送等待條件回應至預先簽章的 Amazon S3 URL。如果資源無法將回應傳送至 Amazon S3， AWS CloudFormation
不會收到回應，而堆疊操作會失敗。如需詳細資訊，請參閱<a href="./cfn-vpce-bucketnames.html">設定 AWS CloudFormation 適用的 VPC 端點</a>和<a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies-vpc-endpoint.html">Amazon S3 VPC 端點的儲存貯體政策範例</a>。</p></div></div>
            <p>您可以使用等待條件和等待條件句柄來 AWS CloudFormation 暫停堆棧的創建，並在繼續創建堆棧之前等待信號。例如，您可能想要先在 Amazon EC2 執行個體下載並設定應用程式，才會認為 Amazon EC2 執行個體已建立完成。</p>
            <p>下列清單摘要說明如何搭配使用等待條件與等待條件控點</p>
            <div class="itemizedlist">
                 
                 
                 
                 
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>AWS CloudFormation 創建一個等待條件，就像任何其他資源。 AWS CloudFormation 建立等待條件時，會將等待條件的狀態報告為 CREATE_IN_PROGRESS，並等待直到收到必要的成功訊號數目或等待條件的逾時期間已過期為止。如果在逾時期限到期之前 AWS CloudFormation 收到必要的成功訊號數目，它會繼續建立堆疊；否則，會將等待條件的狀態設定為，<code class="code">CREATE_FAILED</code>並將堆疊復原。</p>
                </li><li class="listitem">
                    <p>此<code class="code">Timeout</code>屬性決定 AWS CloudFormation 等待必要的成功訊號數目的時間長度。 <code class="code">Timeout</code>是一個最小綁定屬性，這意味著超時發生的時間不會早於您指定的時間，但可能會在此後不久發生。您可以指定的時間上限是 43200 秒 (12 小時)。</p>
                </li><li class="listitem">
                    <p>通常建議在建立特定資源後 (例如 Amazon EC2 執行個體、RDS 資料庫執行個體或 Auto Scaling 群組) 立即開始等待條件。若要執行此作業，請將 <a href="./aws-attribute-dependson.html">DependsOn 屬性</a>新增至等待條件。當您將 <code class="code">DependsOn</code> 屬性新增至等待條件時，您要指定只在特定資源已建立完成後才建立等待條件。建立等待條件後，會 AWS CloudFormation 開始逾時期間並等待成功訊號。</p>
                </li><li class="listitem">
                    <p>您也可以在其他資源上使用 <code class="code">DependsOn</code> 屬性。例如，您可能想要先建立 Amazon RDS 資料庫執行個體，並在該資料庫執行個體上設定資料庫，再建立使用該資料庫的 EC2 執行個體。在此情況下，您會建立具有指定資料庫執行個體之 <code class="code">DependsOn</code> 屬性的等待條件，再建立具有指定等待條件之 <code class="code">DependsOn</code> 屬性的 EC2 執行個體資源。這可確保只在資料庫執行個體和等待條件都完成後才建立 EC2 執行個體。</p>
                </li><li class="listitem">
                    <p>AWS CloudFormation 在將等待條件的狀態設定為<code class="code">CREATE_COMPLETE</code>繼續建立堆疊之前，必須接收指定數目的等待條件的成功訊號。等待條件的 <code class="code">Count</code> 屬性會指定成功訊號數目。若未設定，預設為 1。</p>
                </li><li class="listitem">
                    <p>等待條件需要等待條件控點設定預先簽章的 URL 作為訊號傳送機制。預先簽署的 URL 可讓您傳送訊號，而無需提供 AWS 認證。您可以使用該預先簽章的 URL 傳送成功或失敗訊號，這會封裝在 JSON 陳述式中。如需該 JSON 陳述式的格式，請參閱「<a href="#using-cfn-waitcondition-signaljson">等待條件訊號 JSON 格式</a>」。</p>
                </li><li class="listitem">
                    <p>如果等待條件在逾時期限到期之前收到必要的成功訊號數目 (如 Count 屬性中所定義)，則會將等待條件 AWS CloudFormation 標示為<code class="code">CREATE_COMPLETE</code>並繼續建立堆疊。否則， AWS CloudFormation 會失敗等待條件並將堆疊復原 (例如，如果逾時期限到期而沒有必要的成功訊號，或者如果收到失敗訊號)。</p>
                </li></ul></div>
            <div class="procedure"><h6>在堆疊中使用等待條件：</h6><ol><li>
                    <p>在堆疊的範本中宣告 <code class="code">AWS::CloudFormation::WaitConditionHandle</code> 資源。等待條件控點沒有屬性；不過，<code class="code">WaitConditionHandle</code> 資源的參考會解析為預先簽章的 URL，以便您用來將成功或失敗訊號傳送至 <code class="code">WaitCondition</code>。例如：</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"myWaitHandle" : <span>{</span>
     "Type" : "AWS::CloudFormation::WaitConditionHandle",
     "Properties" : <span>{</span>
     }
}</code></pre>
                </li><li>
                    <p>在堆疊的範本中宣告 <code class="code">AWS::CloudFormation::WaitCondition</code> 資源。<code class="code">WaitCondition</code> 資源有兩個必要屬性：<code class="code">Handle</code> 是範本中宣告之 <code class="code">WaitConditionHandle</code> 的參考，而 <code class="code">Timeout</code> 是 AWS CloudFormation 需要等候的秒數。您可以選擇性地設定<code class="code">Count</code>屬性，以決定等待條件必須接收的成功訊號數目，才 AWS CloudFormation 能繼續建立堆疊。</p>
                    <p>若要控制何時觸發等待條件，您可以在等待條件中設定 <code class="code">DependsOn</code> 屬性。<code class="code">DependsOn</code> 子句會建立資源與等待條件的關聯。在 AWS CloudFormation
建立 <code class="code">DependsOn</code> 資源之後，它會在發生下列其中一個事件前，封鎖進一步的堆疊資源建立：a) 逾時期間過期 b) 收到必要的成功訊號數目 c) 收到失敗訊號。</p>
                    <p>以下是等待條件範例，該等待條件會在成功建立 <code class="code">Ec2Instance</code> 資源之後開始，並使用 <code class="code">myWaitHandle</code> 資源作為 <code class="code">WaitConditionHandle</code>，其逾時為 4500 秒，而其預設 <code class="code">Count</code> 為 1 (因為未指定 <code class="code">Count</code> 屬性)：</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"myWaitCondition" : <span>{</span>
    "Type" : "AWS::CloudFormation::WaitCondition",
    "DependsOn" : "Ec2Instance",
    "Properties" : <span>{</span>
        "Handle" : <span>{</span> "Ref" : "myWaitHandle" },
        "Timeout" : "4500"
    }
}</code></pre>
                </li><li>
                    <p>取得預先簽章的 URL 以用於傳送訊號。</p>
                    <p>在範本中，透過將 <code class="code">AWS::CloudFormation::WaitConditionHandle</code> 資源的邏輯名稱傳遞至 Ref 內部函數，即可擷取預先簽章的 URL。例如，您可以在 <code class="code">AWS::EC2::Instance</code> 資源上使用 <code class="code">UserData</code> 屬性，將預先簽章的 URL 傳遞至 Amazon EC2 執行個體，讓這些執行個體上執行的指令碼或應用程式可以將成功或失敗訊號傳送至 AWS CloudFormation：</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"UserData" : <span>{</span>
   "Fn::Base64" : <span>{</span>
       "Fn::Join" : [ "", ["SignalURL=", <span>{</span> "Ref" : "myWaitHandle" } ] ]
   }
}</code></pre>
                    <p>附註：在 AWS Management Console 或 AWS CloudFormation 命令列工具中，預先簽署的 URL 會顯示為等待條件處理碼資源的實體 ID。</p>
                </li><li>
                    <p>選取用於偵測堆疊何時進入等待條件的方法。</p>
                    <p>如果您建立啟用通知的堆疊，則會將每個堆疊事件的通知 AWS CloudFormation 發佈到指定主題。如果您或您的應用程式訂閱該主題，您可以監控等待條件控點建立事件的通知，並從通知訊息擷取預先簽章的 URL。</p>
                    <p>您也可以使用 AWS Management Console、 AWS CloudFormation 命令列工具或 AWS CloudFormation API 監視堆疊的事件。</p>
                </li><li>
                    <p>使用預先簽章的 URL 傳送成功或失敗訊號。</p>
                    <p>若要傳送訊號，您可以使用預先簽章的 URL 傳送 HTTP 請求訊息。請求方法必須是 <code class="code">PUT</code>，而且 <code class="code">Content-Type</code> 標頭必須是空白字串或予以省略。請求訊息必須是 <a href="#using-cfn-waitcondition-signaljson">等待條件訊號 JSON 格式</a> 中指定格式的 JSON 結構。</p>
                    <p>您必須傳送<code class="code">Count</code>屬性指定的成功訊號數，才能 AWS CloudFormation 繼續建立堆疊。如果您的 <code class="code">Count</code> 大於 1，在傳送至特定等待條件的所有訊號之間，每個訊號的 <code class="code">UniqueId</code> 值必須都是不重複的。<code class="code">UniqueId</code> 是任意英數字串。</p>
                    <p><code class="code">curl</code> 命令是傳送訊號的一種方式。下列範例示範將成功訊號傳送至等待條件的 <code class="code">curl</code> 命令列。</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">curl -T /tmp/a \
  "https://cloudformation-waitcondition-test.s3.amazonaws.com/arn%3Aaws%3Acloudformation%3A<span>us-east-2</span>%3A034017226601%3Astack%2Fstack-gosar-20110427004224-test-stack-with-WaitCondition--VEYW%2Fe498ce60-70a1-11e0-81a7-5081d0136786%2FmyWaitConditionHandle?Expires=1303976584&amp;AWSAccessKeyId=AKIAIOSFODNN7EXAMPLE&amp;Signature=ik1twT6hpS4cgNAw7wyOoRejVoo%3D"</code></code></pre>
                    <p>其中 /tmp/a 檔案包含下列 JSON 結構：</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">
<span>{</span>
   "Status" : "SUCCESS",
   "Reason" : "Configuration Complete",
   "UniqueId" : "ID1234",
   "Data" : "Application has completed configuration."
}</code></pre>
                    <p>此範例示範傳送同一個成功訊號的 <code class="code">curl</code> 命令列，差別在於在命令列中以參數的形式傳送 JSON 結構。</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">curl -X PUT \
  -H 'Content-Type:' --data-binary '<span>{</span>"Status" : "SUCCESS","Reason" : "Configuration Complete","UniqueId" : "ID1234","Data" : "Application has completed configuration."}' \
  "https://cloudformation-waitcondition-test.s3.amazonaws.com/arn%3Aaws%3Acloudformation%3A<span>us-east-2</span>%3A034017226601%3Astack%2Fstack-gosar-20110427004224-test-stack-with-WaitCondition--VEYW%2Fe498ce60-70a1-11e0-81a7-5081d0136786%2FmyWaitConditionHandle?Expires=1303976584&amp;AWSAccessKeyId=AKIAIOSFODNN7EXAMPLE&amp;Signature=ik1twT6hpS4cgNAw7wyOoRejVoo%3D"</code></code></pre>
                </li></ol></div>
            <h3 id="using-cfn-waitcondition-signaljson">等待條件訊號 JSON 格式</h3>
                
                <p>當您傳送等待條件訊號時，您必須使用下列 JSON 格式：</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Status" : "StatusValue",
  "UniqueId" : "Some UniqueId",
  "Data" : "Some Data",
  "Reason" : "Some Reason"
}</code></pre>
                <p>其中：</p>
                <p><em>StatusValue</em>必須是下列其中一個值：</p>
                <div class="itemizedlist">
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p><em>SUCCESS</em> 表示成功訊號。</p>
                    </li><li class="listitem">
                        <p><em>FAILURE</em> 表示失敗訊號，並會觸發失敗等待條件和堆疊復原。</p>
                    </li></ul></div>
                <p><em><code class="code">UniqueId</code></em>識別到的信號 AWS CloudFormation。如果等待條件的<code class="code">Count</code>屬性大於 1，則該<code class="code">UniqueId</code>值在針對特定等待條件發送的所有信號中必須是唯一的; 否則， AWS CloudFormation 將認為該信號具有相同的先前發送的信號的重新傳輸<code class="code">UniqueId</code>，並且將忽略該信號。</p>
                <p><em><code class="code">Data</code></em> 是您要以訊號傳回的任何資訊。該<code class="code">Data</code>值可以通過調用模板中的<a href="./intrinsic-function-reference-getatt.html">Fn::GetAtt 函數</a>來訪問。例如，如果您為等待條件創建以下輸出值<code class="code">mywaitcondition</code>，則可以使用 AWS CloudFormation 控制台的<code class="code">aws cloudformation describe-stacks</code>命令，<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_DescribeStacks.html"><code class="code">DescribeStacks</code></a>API 操作或「<b>輸</b>出」選項卡來查看由<code class="code">Data</code>發送到的有效信號發送到 AWS CloudFormation：</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">
"WaitConditionData" : <span>{</span>
  "Value" : <span>{</span> "Fn::GetAtt" : [ "mywaitcondition", "Data" ]},
  "Description" : "The data passed back as part of signalling the WaitCondition"
},
            </code></pre>
                <p><a href="./intrinsic-function-reference-getatt.html">Fn::GetAtt 函數函</a>數返回<code class="code">UniqueId</code>和<code class="code">Data</code>作為 JSON 結構中的名稱/值對。下列是由上述定義之 <code class="code">WaitConditionData</code> 輸出值傳回的 <code class="code">Data</code> 屬性範例：</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>"Signal1":"Application has completed configuration."}</code></pre>
                <p><em>Reason</em> 是字串，內容除了需要符合 JSON 規定以外，沒有其他限制。</p>
             
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>您的瀏覽器已停用或無法使用 Javascript。</strong></p><p>您必須啟用 Javascript，才能使用 AWS 文件。請參閱您的瀏覽器說明頁以取得說明。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">文件慣用形式</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./deploying.applications.html">部署應用程式</div><div id="next" class="next-link" accesskey="n" href="./CHAP_TemplateQuickRef.html">範本程式碼片段</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">此頁面是否有幫助？ - 是</div><div class="content"><p>感謝您，讓我們知道我們做得很好！</p><p>若您有空，歡迎您告知我們值得讚許的地方，這樣才能保持良好服務。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="意見回饋" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">此頁面是否有幫助？ - 否</div><div class="content"><p>感謝讓我們知道此頁面仍須改善。很抱歉，讓您失望。</p><p>若您有空，歡迎您提供改善文件的方式。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="意見回饋" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>