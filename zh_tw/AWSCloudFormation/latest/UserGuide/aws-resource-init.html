<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="zh-TW"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS::CloudFormation::Init - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="aws-resource-init" /><meta name="default_state" content="aws-resource-init" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="description" content="您可以使用 AWS::CloudFormation::Init 資源類型，在 cfn-init 協助程式指令碼的 Amazon EC2 執行個體上加入中繼資料。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="使用者指南" /><meta name="abstract" content="使 AWS CloudFormation 用本使用者指南可預測並重複地建立和管理 AWS 基礎架構部署。" /><meta name="guide-locale" content="zh_tw" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="使用者指南" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="使用者指南" /><meta id="panorama-serviceConsolePage" value="AWS::CloudFormation::Init" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS::CloudFormation::Init - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,資源佈建,資源組態,基礎設施管理,CloudFormer,CloudFormation 堆疊,CloudFormation 堆疊集,CloudFormation 範本,變更集合" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "使用者指南",
        "item" : "https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "使用 AWS CloudFormation 範本",
        "item" : "https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "範本剖析",
        "item" : "https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/template-anatomy.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "中繼資料",
        "item" : "https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/metadata-section-structure.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "AWS::CloudFormation::Init",
        "item" : "https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/metadata-section-structure.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">文件</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">使用者指南</a></div><div id="page-toc-src"><a href="#aws-resource-cloudformation-init-syntax">語法</a><a href="#aws-resource-init-configsets">組態集</a><a href="#aws-resource-init-commands">命令</a><a href="#aws-resource-init-files">檔案</a><a href="#aws-resource-init-groups">群組</a><a href="#aws-resource-init-packages">套件</a><a href="#aws-resource-init-services">服務</a><a href="#aws-resource-init-sources">來源</a><a href="#aws-resource-init-users">使用者</a></div><div id="page-filters" style="display:none"><filter label="All" id="All"></filter><filter label="JSON" id="JSON"></filter><filter label="YAML" id="YAML"></filter></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>本文為英文版的機器翻譯版本，如內容有任何歧義或不一致之處，概以英文版為準。</p></awsui-alert><h1 class="topictitle" id="aws-resource-init"><code class="code">AWS::CloudFormation::Init</code></h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>透過 <code class="code">AWS::CloudFormation::Init</code> 資源類型，即可在 cfn-init 協助程式指令碼的 Amazon EC2 執行個體上加入中繼資料。如果範本呼叫 cfn-init 指令碼，該指令碼會在 <code class="code">AWS::CloudFormation::Init</code> 中繼資料金鑰內尋找根資源中繼資料。如需 cfn-init 的詳細資訊，請參閱 <a href="./cfn-init.html">cfn-init</a>。</p><p>cfn-init 支援適用於 Linux 系統的所有中繼資料類型，亦支援適用於 Windows 的中繼資料類型 (但必須符合以下幾節所述的條件)。</p><p>如需使用 <code class="code">AWS::CloudFormation::Init</code> 與 cfn-init 協助程式指令碼的範例，請參閱<a href="./deploying.applications.html">在 Amazon EC2 上部署應用程式 AWS CloudFormation</a>。</p><p>如需說明如何使用 cfn-init 建立 Windows 堆疊的範例，請參閱 <a href="./cfn-windows-stacks-bootstrapping.html">引導窗 AWS CloudFormation 口堆棧</a>。</p>
      <h2 id="aws-resource-cloudformation-init-syntax">語法</h2>

      <p>組態會分為不同區段。下列範本程式碼片段會說明在範本中將 cfn-init 中繼資料連接至 EC2 執行個體資源的方法。</p>
      <p>系統已將中繼資料整編為組態金鑰，而您可以將這些金鑰分組至各個組態集；在範本中呼叫 cfn-init 時，即可指定組態集。若您未指定組態集，cfn-init 即會尋找名稱為 <em>config</em> 的單一組態金鑰。</p>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>cfn-init 協助程式指令碼在處理這些組態區段時，會按照以下順序：packages、groups、users、sources、files、commands，最後是 services。如果您需要以不同順序進行處理，請將各區段分成不同的組態金鑰，接著使用組態集來指定處理組態金鑰時應採用的順序。</p></div></div>

      <div id="JSON" name="JSON" class="section langfilter">
         <h3 id="aws-resource-cloudformation-init-syntax.json">JSON</h3>

         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Resources": <span>{</span>
  "MyInstance": <span>{</span>
    "Type": "AWS::EC2::Instance",
    "Metadata" : <span>{</span>
      "AWS::CloudFormation::Init" : <span>{</span>
        "config" : <span>{</span>
          "packages" : <span>{</span>
            :
          },
          "groups" : <span>{</span>
            :
          },
          "users" : <span>{</span>
            :
          },
          "sources" : <span>{</span>
            :
          },
          "files" : <span>{</span>
            :
          },
          "commands" : <span>{</span>
            :
          },
          "services" : <span>{</span>
            :
          }
        }
      }
    },
    "Properties": <span>{</span>
      :
    }
  }
}</code></pre>
      </div>
      <div id="YAML" name="YAML" class="section langfilter">
         <h3 id="aws-resource-cloudformation-init-syntax.yaml">YAML</h3>

         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Resources: 
  MyInstance: 
    Type: AWS::EC2::Instance
    Metadata: 
      AWS::CloudFormation::Init: 
        config: 
          packages: 
            :
          groups: 
            :
          users: 
            :
          sources: 
            :
          files: 
            :
          commands: 
            :
          services: 
            :
    Properties: 
      :</code></pre>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>若要指定 Amazon EC2 執行個體的 <code class="code">AWS::CloudFormation::Init</code> 屬性，請參閱 <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-init.html#cfn-init-Examples"> Amazon Linux 範例</a>。</p></div></div>
      </div>
    
      <h2 id="aws-resource-init-configsets">組態集</h2>

      <p>如果您想建立多個組態金鑰，並讓 cfn-init 按照特定順序來處理這些金鑰，則請建立包含所需組態金鑰順序的組態集。</p>
       
         <h3 id="w9aac23c15c15c23c13b5">單一組態集</h3>

         <p>下列範本程式碼片段會建立名為 <code class="code">ascending</code> 與 <code class="code">descending</code> 的組態集，並分別在當中包含兩個組態金鑰。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example1.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"AWS::CloudFormation::Init" : <span>{</span>
    "configSets" : <span>{</span>
        "ascending" : [ "config1" , "config2" ],
        "descending" : [ "config2" , "config1" ]
    },
    "config1" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$CFNTEST\" &gt; test.txt",
                "env" : <span>{</span> "CFNTEST" : "I come from config1." },
                "cwd" : "~"
            }
        }
    },
    "config2" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$CFNTEST\" &gt; test.txt",
                "env" : <span>{</span> "CFNTEST" : "I come from config2" },
                "cwd" : "~"
            }
        }
    }
}     </code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example1.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWS::CloudFormation::Init: 
  configSets: 
    ascending: 
      - "config1"
      - "config2"
    descending: 
      - "config2"
      - "config1"
  config1: 
    commands: 
      test: 
        command: "echo \"$CFNTEST\" &gt; test.txt"
        env: 
          CFNTEST: "I come from config1."
        cwd: "~"
  config2: 
    commands: 
      test: 
        command: "echo \"$CFNTEST\" &gt; test.txt"
        env: 
          CFNTEST: "I come from config2"
        cwd: "~"</code></pre>
         </div>
          
            <h4 id="w9aac23c15c15c23c13b5b9">相關的 cfn-init 呼叫</h4>

            <p>以下範例會參考上述範例組態集來呼叫 cfn-init，且為清楚起見，該範例會以縮寫形式進行呼叫；如需完整語法，請參閱 <a href="./cfn-init.html">cfn-init</a>。</p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>若指定使用 <code class="code">ascending</code> 組態集來呼叫 cfn-init：</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c ascending</code></code></pre>
                  <p>指令碼將優先處理 <code class="code">config1</code>，接著處理 <code class="code">config2</code>，test.txt 檔案即會包含文字 <code class="code">I
                        come from config2</code>。</p>
               </li><li class="listitem">
                  <p>若指定使用 <code class="code">descending</code> 組態集來呼叫 cfn-init：</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c descending</code></code></pre>
                  <p>指令碼將優先處理 <code class="code">config2</code>，接著處理 <code class="code">config1</code>，test.txt 檔案即會包含文字 <code class="code">I
                        come from config1</code>。</p>
               </li></ul></div>
          
       
       
         <h3 id="w9aac23c15c15c23c13b7">多個組態集</h3>

         <p>您可以建立多個組態集，並使用 cfn-init 指令碼來呼叫一系列的組態集；而每個組態集皆能包含組態金鑰清單或參考其他組態集。以下列範本程式碼片段為例，其將建立三個組態集。第一個組態集 <code class="code">test1</code> 會包含一個名為 <code class="code">1</code> 的組態金鑰；第二個組態集 <code class="code">test2</code> 會參考 <code class="code">test1</code> 組態集，並涵蓋一個名為 <code class="code">2</code> 的組態金鑰；而第三個預設組態集則會參考 <code class="code">test2</code> 組態集。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example2.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"AWS::CloudFormation::Init" : <span>{</span>
    "configSets" : <span>{</span>
        "test1" : [ "1" ],
        "test2" : [ <span>{</span> "ConfigSet" : "test1" }, "2" ],
        "default" : [ <span>{</span> "ConfigSet" : "test2" } ]
    },
    "1" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$MAGIC\" &gt; test.txt",
                "env" : <span>{</span> "MAGIC" : "I come from the environment!" },
                "cwd" : "~"
            }
        }
    },
    "2" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$MAGIC\" &gt;&gt; test.txt",
                "env" : <span>{</span> "MAGIC" : "I am test 2!" },
                "cwd" : "~"
            }
        }
    }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example2.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWS::CloudFormation::Init:
  1:
    commands:
      test:
        command: "echo \"$MAGIC\" &gt; test.txt"
        env:
          MAGIC: "I come from the environment!"
        cwd: "~"
  2:
    commands:
      test:
        command: "echo \"$MAGIC\" &gt;&gt; test.txt"
        env:
          MAGIC: "I am test 2!"
        cwd: "~"
  configSets: 
    test1:
      - "1"
    test2:
      -
        ConfigSet: "test1"
      - "2"
    default:
      -
        ConfigSet: "test2"</code></pre>
         </div>
          
            <h4 id="w9aac23c15c15c23c13b7b9">相關的 cfn-init 呼叫</h4>

            <p>下方將參考上述範本程式碼片段所宣告的組態集來呼叫 cfn-init，且為清楚起見，該範例會以縮寫形式進行呼叫；如需完整語法，請參閱 <a href="./cfn-init.html">cfn-init</a>。</p>
            <div class="itemizedlist">
                
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>若僅指定 <code class="code">test1</code>：</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c test1</code></code></pre>
                  <p>cfn-init 僅會處理組態金鑰 <code class="code">1</code>。</p>
               </li><li class="listitem">
                  <p>若僅指定 <code class="code">test2</code>：</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c test2</code></code></pre>
                  <p>cfn-init 會優先處理組態金鑰 <code class="code">1</code>，再處理組態金鑰 <code class="code">2</code>。</p>
               </li><li class="listitem">
                  <p>若指定 <code class="code">default</code> 組態集 (或未指定任何組態集)：</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c default</code></code></pre>
                  <p>系統的行為會與指定組態集 <code class="code">test2</code> 時相同。</p>
               </li></ul></div>
          
       
    
      <h2 id="aws-resource-init-commands">命令</h2>

      <p>透過 commands 金鑰，即可在 EC2 執行個體上執行命令；而系統會依照名稱的字母順序來處理這些命令。</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c17b5"><thead>
               <tr>
                  <th>金錀</th>
                  <th>必要</th>
                  <th>描述</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>command</p>
                  </td>
                  <td tabindex="-1">必要</td>
                  <td tabindex="-1">
                     <p>以陣列或字串來指定要執行的命令。如果使用陣列，則不需跳脫空格字元或用引號括起指令參數。請勿使用陣列指定多個命令。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>env</p>
                  </td>
                  <td tabindex="-1">選用</td>
                  <td tabindex="-1">
                     <p>可藉由此金鑰設定命令的環境變數。此屬性會進行覆寫，而非附加至現有的環境。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>cwd</p>
                  </td>
                  <td tabindex="-1">選用</td>
                  <td tabindex="-1">
                     <p>工作目錄。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>test</p>
                  </td>
                  <td tabindex="-1">選用</td>
                  <td tabindex="-1">
                     <p>此測試命令能判斷 cfn-init 是否執行 command 金鑰所指定的命令；如果測試通過，則 cfn-init 會執行命令。cfn-init 指令碼將在 Bash 或 <code>cmd.exe</code> 等命令解譯器中執行測試。系統會根據解譯器所傳回的結束代碼來判斷是否能通過測試。</p>
                     <p>若作業系統為 Linux，測試命令必須傳回結束代碼 <code class="code">0</code>，以代表通過測試。若作業系統為 Windows，則測試命令必須傳回 %ERRORLEVEL% <code class="code">0</code>。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>ignoreErrors</p>
                  </td>
                  <td tabindex="-1">選用</td>
                  <td tabindex="-1">
                     <p>在 command 金鑰包含的命令執行失敗並傳回非零值時，可藉由此布林值來判斷是否要繼續執行 cfn-init。若您希望即使命令失敗也要繼續執行 cfn-init，請將此值設定為 <code class="code">true</code>；若要在命令失敗時停止執行 cfn-init，則請將此值設定為 <code class="code">false</code>。預設值為 <code class="code">false</code>。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>waitAfterCompletion</p>
                  </td>
                  <td tabindex="-1">選用</td>
                  <td tabindex="-1">
                     <p>僅適用於 Windows 系統。可藉由此金鑰指定命令完成後的等待時間 (以秒為單位)，以防該命令導致系統重新啟動。預設值為 60 秒，且「forever」(永久) 值會指示系統結束 cfn-init，唯有完成重新啟動後才能繼續執行。如果您不想等候每個命令，請將此值設定為 <code class="code">0</code>。</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="w9aac23c15c15c23c15b7">範例</h3>

         <p>下列範例程式碼片段在 <code class="code">~/test.txt</code> 檔案不存在時，會呼叫 echo 命令。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-commands-example.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"commands" : <span>{</span>
    "test" : <span>{</span>
        "command" : "echo \"$MAGIC\" &gt; test.txt",
        "env" : <span>{</span> "MAGIC" : "I come from the environment!" },
        "cwd" : "~",
        "test" : "test ! -e ~/test.txt",
        "ignoreErrors" : "false"
    },
    "test2" : <span>{</span>
        "command" : "echo \"$MAGIC2\" &gt; test2.txt",
        "env" : <span>{</span> "MAGIC2" : "I come from the environment!" },
        "cwd" : "~",
        "test" : "test ! -e ~/test2.txt",
        "ignoreErrors" : "false"
    }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-commands-example.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">commands:
  test:
    command: "echo \"$MAGIC\" &gt; test.txt"
    env:
      MAGIC: "I come from the environment!"
    cwd: "~"
    test: "test ! -e ~/test.txt"
    ignoreErrors: "false"
  test2:
    command: "echo \"$MAGIC2\" &gt; test2.txt"
    env:
      MAGIC2: "I come from the environment!"
    cwd: "~"
    test: "test ! -e ~/test2.txt"
    ignoreErrors: "false"</code></pre>
         </div>
       
    
      <h2 id="aws-resource-init-files">檔案</h2>

      <p>透過 <code class="code">files</code> 金鑰，即可在 EC2 執行個體上建立檔案。該內容可能會內嵌於範本中，亦能從 URL 取得；檔案會依詞典編纂順序寫入磁碟。下表會列出支援的金鑰。</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c19b5"><thead>
               <tr>
                  <th>金錀</th>
                  <th>描述</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>內容</p>
                  </td>
                  <td tabindex="-1">
                     <p>此金鑰可能是字串或格式正確的 JSON 物件。如果您採用 JSON 物件做為內容，則系統會將 JSON 寫入磁碟上的檔案。您必須評估 <code class="code">Fn::GetAtt</code> 或 <code class="code">Ref</code> 等任何內部函數，才能將 JSON 物件寫入磁碟。建立符號連結時，請以符號連結目標來指定內容。</p>
                     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>如果要建立符號連結，協助程式指令碼即會修改目標檔案的許可。目前要建立符號連結，仍必須先修改目標檔案的許可。</p></div></div>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>source</p>
                  </td>
                  <td tabindex="-1">
                     <p>用來載入檔案的 URL，您無法使用 content 金鑰來指定此選項。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>編碼</p>
                  </td>
                  <td tabindex="-1">
                     <p>編碼格式；唯有在內容是字串時，才能使用此金鑰。編碼並不適用於來源。</p>
                     <p>有效值：<code class="code">plain</code> | <code class="code">base64</code></p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>群組</p>
                  </td>
                  <td tabindex="-1">
                     <p>擁有此檔案的群組名稱，Windows 系統不支援此金鑰。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>owner</p>
                  </td>
                  <td tabindex="-1">
                     <p>擁有此檔案的使用者名稱，Windows 系統不支援此金鑰。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>模式</p>
                  </td>
                  <td tabindex="-1">
                     <p>六位數的 8 進制值，代表此檔案的模式；Windows 系統不支援此金鑰。請使用前三位數來建立符號連結，並採用後三位數來設定許可。若要建立符號連結，請指定 <code class="userinput">120<code class="replaceable">xxx</code></code>，其中 <code class="code">xxx</code> 定義目標檔案的許可。若要指定檔案的許可，請使用三個數字，例如 <code class="userinput">000644</code>。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>驗證</p>
                  </td>
                  <td tabindex="-1">
                     <p>要使用的身分驗證方法名稱，此金鑰會覆寫任何預設的身分驗證。透過此屬性，即可選取 <a href="./aws-resource-authentication.html">AWS::CloudFormation::Authentication</a> 資源所定義的身分驗證方法。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>context</p>
                  </td>
                  <td tabindex="-1">
                     <p>可藉由此金鑰指定檔案內容，進而將其做為 <a href="http://mustache.github.io/mustache.5.html" rel="noopener noreferrer" target="_blank"><span>Mustache 範本</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>進行處理。您必須安裝 <code class="code">aws-cfn-bootstrap</code> 1.3–11 或更新版本以及 <a href="https://github.com/defunkt/pystache" rel="noopener noreferrer" target="_blank"><span>pystache</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>，才能使用此金鑰。</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="w9aac23c15c15c23c17b7">範例</h3>

         <p>下列範例程式碼片段會建立名稱為 setup.mysql 的檔案，並將該檔案當成大型安裝作業的一部分。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-setup-mysql.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"files" : <span>{</span>
  "/tmp/setup.mysql" : <span>{</span>
    "content" : <span>{</span> "Fn::Join" : ["", [
      "CREATE DATABASE ", <span>{</span> "Ref" : "DBName" }, ";\n",
      "CREATE USER '", <span>{</span> "Ref" : "DBUsername" }, "'@'localhost' IDENTIFIED BY '",
                       <span>{</span> "Ref" : "DBPassword" }, "';\n",
      "GRANT ALL ON ", <span>{</span> "Ref" : "DBName" }, ".* TO '", <span>{</span> "Ref" : "DBUsername" },
                       "'@'localhost';\n",
      "FLUSH PRIVILEGES;\n"
      ]]},
    "mode"  : "000644",
    "owner" : "root",
    "group" : "root"
  }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-setup-mysql.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">files: 
  /tmp/setup.mysql: 
    content: !Sub |
      CREATE DATABASE $<span>{</span>DBName};
      CREATE USER '$<span>{</span>DBUsername}'@'localhost' IDENTIFIED BY '$<span>{</span>DBPassword}';
      GRANT ALL ON $<span>{</span>DBName}.* TO '$<span>{</span>DBUsername}'@'localhost';
      FLUSH PRIVILEGES;
    mode: "000644"
    owner: "root"
    group: "root"</code></pre>
         </div>
         <p>完整的模板可在以下位置找到：<a href="https://s3.amazonaws.com/cloudformation-templates-us-east-1/Drupal_Single_Instance.template" rel="noopener noreferrer" target="_blank"><span>https://s3.amazonaws.com/ cloudformation-templates-us-east-</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> 1/單實例模板</p>
         <p>下列範例程式碼片段所建立的符號連結 <code class="code">/tmp/myfile2.txt</code> 會指向現有檔案 <code class="code">/tmp/myfile1.txt</code>；而目標檔案 <code class="code">/tmp/myfile1.txt</code> 的許可則是由模式 <code class="code">644</code> 所定義。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-symlink.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"files" : <span>{</span>
  "/tmp/myfile2.txt" : <span>{</span>
    "content" : "/tmp/myfile1.txt",
    "mode" : "120644"
  }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-symlink.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">files:
  /tmp/myfile2.txt:
    content: "/tmp/myfile1.txt"
    mode: "120644"</code></pre>
         </div>
         <p>Mustache 範本主要用來建立組態檔案。例如，您可以將組態檔案存放在 S3 儲存貯體中，並插入 Refs 和 GetAtts 範本，而不是使用。<a href="./intrinsic-function-reference-join.html">Fn::Join</a>下列範例程式碼片段會將「Content for test9」(test9 的內容) 輸出至 <code>/tmp/test9.txt</code>。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-test9.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">
"files" : <span>{</span>
    "/tmp/test9.txt" : <span>{</span>
        "content" : "Content for <span>{</span><span>{</span>name}}",
        "context" : <span>{</span> "name" : "test9" }
    }
} </code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-test9.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">files:
  /tmp/test9.txt:
    content: "Content for <span>{</span><span>{</span>name}}"
    context:
      name: "test9"</code></pre>
         </div>
         <p>使用 Mustache 範本時，請注意以下事項：</p>
         <div class="itemizedlist">
             
             
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>要處理的檔案皆必須具備 context 金鑰。</p>
            </li><li class="listitem">
               <p>context 金鑰必須是金鑰值映射，但可以將該金鑰設為巢狀。</p>
            </li><li class="listitem">
               <p>您可以透過 content 金鑰來處理具備內嵌內容的檔案，並採用 source 金鑰處理遠端檔案。</p>
            </li><li class="listitem">
               <p>Mustache 支援的內容將視 pystache 版本而定，而版本 0.5.2 可支援 <a href="https://github.com/mustache/spec/tree/v1.1.2" rel="noopener noreferrer" target="_blank"><span>Mustache 1.1.2 規格</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>。</p>
            </li></ul></div>
       
    
      <h2 id="aws-resource-init-groups">群組</h2>

      <p>透過 groups 金鑰，即可建立 Linux/UNIX 群組和指派群組 ID。請注意，Windows 系統並不支援 groups 金鑰。</p>
      <p>若要建立群組，請新增一組新的索引鍵/值組，此對組會將新的群組名稱對應至選用的群組 ID。groups 金鑰可以包含一個或多個群組名稱。下表會列出可用的金鑰。</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c21b7"><thead>
               <tr>
                  <th>金錀</th>
                  <th>描述</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>
                        <code class="code">gid</code></p>
                  </td>
                  <td tabindex="-1">
                     <p>群組 ID 編號。</p>
                     <p>如果指定了群組 ID，而該群組的名稱已存在，則群組建立作業會失敗；如果另一個群組具有指定的群組 ID，作業系統可能會拒絕建立群組。</p>
                     <p>範例：<code class="code"><span>{</span> "gid" : "23" }</code></p>
                  </td>
               </tr>
            </table></div></div>
      
       
         <h3 id="aws-resource-init-groups-snippet">範例程式碼片段</h3>

         <p>下列範例程式碼片段會指定名為 <code class="code">groupOne</code> 的群組，但未指派群組 ID；同時還會建立另一個名為 <code class="code">groupTwo</code> 的群組，並將群組 ID 值指定為 <code class="code">45</code>。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-groups-snippet.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"groups" : <span>{</span>
    "groupOne" : <span>{</span>},
    "groupTwo" : <span>{</span> "gid" : "45" }
}</code></pre>
         </div>
         
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-groups-snippet.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">groups:
  groupOne: <span>{</span>}
  groupTwo:
    gid: "45"</code></pre>
         </div>
       
    
      <h2 id="aws-resource-init-packages">套件</h2>

      <p>透過 packages 金鑰，即可下載預先封裝的應用程式與元件，然後加以安裝。但在 Windows 系統上，packages 金鑰僅支援 MSI 安裝程式。</p>
       
         <h3 id="aws-resource-init-packages-formats">支援的套件格式</h3>

         <p>cfn-init 指令碼目前支援以下套件格式：apt、msi、python、rpm、rubygems、yum 與 Zypper。處理套件時，系統會採用以下順序：首先是 rpm、yum/apt/zypper，接著則是 rubygems 和 python。rubygems 和 python 之間不分順序，而系統在安裝每個套件管理工具中的套件時，不保證會按照任何順序。</p>
       
       
         <h3 id="aws-resource-init-packages-versions">指定版本</h3>

         <p>在每個套件管理工具中，系統會以套件名稱和版本清單來指定各個套件。版本可以是字串、版本清單，亦能是空白字串或清單；空白字串或清單代表要安裝最新版本。如果管理工具為 rpm 格式，則系統會以磁碟上的檔案路徑或 URL 來指定版本。</p>
         <p>若您有指定套件版本，cfn-init 即會嘗試安裝該版本，無論執行個體上是否已經安裝新版本的套件。部分套件管理工具支援多個版本，有些則不支援。如需詳細資訊，請參閱套件管理工具的文件。若您未指定版本且系統已安裝某個套件版本，則 cfn-init 指令碼不會安裝新版本，因為 cfn-init 指令碼會假設您想保留並使用現有版本。</p>
       
       
         <h3 id="aws-resource-init-packages-snippet">範例程式碼片段</h3>

          
            <h4 id="w9aac23c15c15c23c21b9b3">RPM、yum、Rubygems 與 Zypper</h4>

            <p>下列程式碼片段將指定 rpm 的版本 URL、請求 yum 與 Zypper 的最新版本，並使用 rubygems 的 chef 0.10.2 版：</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-packages-example1.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"rpm" : <span>{</span>
  "epel" : "http://download.fedoraproject.org/pub/epel/5/i386/epel-release-5-4.noarch.rpm"
},
"yum" : <span>{</span>
  "httpd" : [],
  "php" : [],
  "wordpress" : []
},
"rubygems" : <span>{</span>
  "chef" : [ "0.10.2" ]
},
"zypper" : <span>{</span>
  "git" : []
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-packages-example1.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">rpm:
  epel: "http://download.fedoraproject.org/pub/epel/5/i386/epel-release-5-4.noarch.rpm"
yum:
  httpd: []
  php: []
  wordpress: []
rubygems:
  chef:
    - "0.10.2"
zypper:
  git: []</code></pre>
            </div>
          
          
            <h4 id="w9aac23c15c15c23c21b9b5">MSI 套件</h4>

            <p>下列程式碼片段將指定 MSI 套件的 URL：</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-packages-example2.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"msi" : <span>{</span>
  "awscli" : "https://s3.amazonaws.com/aws-cli/AWSCLI64.msi"
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-packages-example2.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">msi:
  awscli: "https://s3.amazonaws.com/aws-cli/AWSCLI64.msi"</code></pre>
            </div>
          
       
    
      <h2 id="aws-resource-init-services">服務</h2>

      <p>透過 services 金鑰，即可定義執行個體啟動時應啟用或停用的服務。Linux 系統會透過 sysvinit 或 systemd 來支援此金鑰，而 Windows 系統則會透過 Windows 服務管理員進行支援。</p>
      <p>您也可以使用 services 金鑰指定 sources、packages 與 files 的相依關係；如此一來，若安裝檔案時需要重新啟動，cfn-init 將負責重新啟動服務。例如，如果您下載了 Apache HTTP 伺服器套件，則在堆疊建立程序期間，系統會自動啟動 Apache HTTP 伺服器套件安裝作業。然而，如果您稍後在堆疊建立程序中更新 Apache HTTP 伺服器組態，便必須重新啟動 Apache 伺服器，更新內容才會生效。您可以使用 services 金鑰來確保系統已重新啟動 Apache HTTP 服務。</p>
      <p>下表會列出支援的金鑰。</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c25b9"><thead>
               <tr>
                  <th>金錀</th>
                  <th>描述</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>ensureRunning</p>
                  </td>
                  <td tabindex="-1">
                     <p>將此金鑰設為 true，即可確保 cfn-init 完成後會繼續執行服務。</p>
                     <p>將此金鑰設為 false，即可確保 cfn-init 完成後不會繼續執行服務。</p>
                     <p>如果略過此金鑰，將不會改變服務狀態。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>已啟用</p>
                  </td>
                  <td tabindex="-1">
                     <p>將此金鑰設為 true，即可確保開機時會自動啟動服務。</p>
                     <p>將此金鑰設為 false，即可確保開機時不會自動啟動服務。</p>
                     <p>如果略過此金鑰，將不會改變此屬性。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>files</p>
                  </td>
                  <td tabindex="-1">
                     <p>檔案清單。如果 cfn-init 透過 files 區塊直接變更檔案，系統會重新啟動本服務。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>sources</p>
                  </td>
                  <td tabindex="-1">
                     <p>目錄清單。如果 cfn-init 將封存檔案解壓縮至其中一個目錄，系統會重新啟動本服務。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>packages</p>
                  </td>
                  <td tabindex="-1">
                     <p>對應套件管理工具與套件名稱清單。如果 cfn-init 安裝或更新其中一個套件，系統會重新啟動本服務。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>commands</p>
                  </td>
                  <td tabindex="-1">
                     <p>命令名稱清單。如果 cfn-init 執行指定的命令，系統會重新啟動本服務。</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="w9aac23c15c15c23c23c11">範例</h3>

          
            <h4 id="w9aac23c15c15c23c23c11b3">Linux</h4>

            <p>下列 Linux 程式碼片段所設定的服務如下：</p>
            <div class="itemizedlist">
                
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>若 cfn-init 修改 <code class="code">/etc/nginx/nginx.conf</code> 或 <code class="code">/var/www/html</code>，nginx 服務將重新啟動。</p>
               </li><li class="listitem">
                  <p>若 cfn-init 使用 yum 來安裝或更新 php、spawn-fcgi，php-fastcgi 服務將重新啟動。</p>
               </li><li class="listitem">
                  <p>系統將透過 systemd 停止並停用 sendmail 服務。</p>
               </li></ul></div>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-services-example1.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"services" : <span>{</span>
  "sysvinit" : <span>{</span>
    "nginx" : <span>{</span>
      "enabled" : "true",
      "ensureRunning" : "true",
      "files" : ["/etc/nginx/nginx.conf"],
      "sources" : ["/var/www/html"]
    },
    "php-fastcgi" : <span>{</span>
      "enabled" : "true",
      "ensureRunning" : "true",
      "packages" : <span>{</span> "yum" : ["php", "spawn-fcgi"] }
    }
  },
  "systemd": <span>{</span>
    "sendmail" : <span>{</span>
      "enabled" : "false",
      "ensureRunning" : "false"
    }
  }
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-services-example1.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">services:
  sysvinit:
    nginx:
      enabled: "true"
      ensureRunning: "true"
      files:
        - "/etc/nginx/nginx.conf"
      sources:
        - "/var/www/html"
    php-fastcgi:
      enabled: "true"
      ensureRunning: "true"
      packages:
        yum:
          - "php"
          - "spawn-fcgi"
  systemd:
    sendmail:
      enabled: "false"
      ensureRunning: "false"</code></pre>
               <p>要將 systemd 與服務搭配使用，則服務必須已設定 systemd 單位檔案。以下單位檔案允許 systemd 啟動和停止多使用者服務目標中的 <a href="./cfn-hup.html">cfn-hup</a> 常駐程式：</p>
                  
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="conf ">[Unit]
Description=cfn-hup daemon
[Service]
ExecStart=/usr/bin/cfn-hup -v
PIDFile=/var/run/cfn-hup.pid
[Install]
WantedBy=multi-user.target</code></pre>
               <p>此組態假定 cfn-hup 安裝在 <em>/usr/bin</em> 目錄下。不過，cfn-hup 的實際安裝位置可能會因平台而異。您可以透過在 <em>/etc/systemd/system/cfn-hup.service.d/override.conf</em> 中建立覆寫檔案來覆寫此組態，如下所示：</p>
                  
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="conf "># In this example, cfn-hup executable is available under /usr/local/bin
[Service]
ExecStart=
ExecStart=/usr/local/bin/cfn-hup -v</code></pre>
            </div>
          
          
            <h4 id="aws-resource-init-windows-example">Windows</h4>

            <p>下列 Windows 程式碼片段會啟動 <a href="./cfn-hup.html">cfn-hup</a> 服務並將其設為自動執行；而在 <code class="code">cfn-init</code> 修改指定的組態檔案時，則會重新啟動服務：</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-services-example2.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"services" : <span>{</span>
  "windows" : <span>{</span>
    "cfn-hup" : <span>{</span>
      "enabled" : "true",
      "ensureRunning" : "true",
      "files" : ["c:\\cfn\\cfn-hup.conf", "c:\\cfn\\hooks.d\\cfn-auto-reloader.conf"]
    }
  }
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-services-example2.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">services:
  windows:
    cfn-hup:
      enabled: "true"
      ensureRunning: "true"
      files:
        - "c:\\cfn\\cfn-hup.conf"
        - "c:\\cfn\\hooks.d\\cfn-auto-reloader.conf"</code></pre>
            </div>
          
       
    
      <h2 id="aws-resource-init-sources">來源</h2>

      <p>透過 sources 金鑰，即可下載封存檔案，並在 EC2 執行個體上的目標目錄中進行解壓縮。Linux 與 Windows 系統完全支援此金鑰。</p>
       
         <h6>支援的格式</h6>
         <p>支援的格式包括：</p>
       
      <div class="itemizedlist">
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><code class="code">tar</code></p>
         </li><li class="listitem">
            <p><code class="code">tar+gzip</code></p>
         </li><li class="listitem">
            <p><code class="code">tar+bz2</code></p>
         </li><li class="listitem">
            <p><code class="code">zip</code></p>
         </li></ul></div>
     
         <h3 id="aws-resource-init-sources-examples">範例</h3>
      
            <h4 id="aws-resource-init-sources-examples-github">GitHub</h4>
            <p>如果您使用 GitHub 作為原始檔控制系統，您可以使用 cfn-init 和原始碼套件機制來提取特定版本的應用程式。  GitHub 允許您通過 URL 從特定版本創建 .zip 或 .tar，如下所示：</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="text ">https://github.com/&lt;your directory&gt;/(zipball|tarball)/&lt;version&gt;</code></pre>
            <p>舉例來說，下列程式碼片段會將 <em>main</em> 版本壓縮為 <code>.tar</code> 檔案。</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-sources-example1.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"sources" : <span>{</span>
  "/etc/puppet" : "https://github.com/user1/cfn-demo/tarball/main"
  }</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-sources-example1.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">sources:
  /etc/puppet: "https://github.com/user1/cfn-demo/tarball/main"</code></pre>
            </div>
          
      
            <h4 id="aws-resource-init-sources-examples-s3">S3 儲存貯體</h4>
            <p>以下範例從 S3 儲存貯體下載了 tarball，並將其解壓縮至 <code class="code">/etc/myapp</code>：</p>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>您可以針對來源使用身分驗證憑證，但不能將 authentication 金鑰放入 sources 區塊。反之，您可以在 <code class="code">S3AccessCreds</code> 區塊中加入 buckets 金鑰。如需 Amazon S3 驗證憑證的詳細資訊，請參閱 <a href="./aws-resource-authentication.html">AWS::CloudFormation::Authentication</a>。</p><p><span>如需範例，請參閱<a href="https://s3.amazonaws.com/cloudformation-templates-us-east-1/S3Bucket_SourceAuth.template" rel="noopener noreferrer" target="_blank"><span>範例範本</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>。</span></p></div></div>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-sources-example2.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"sources" : <span>{</span>
  "/etc/myapp" : "https://s3.amazonaws.com/mybucket/myapp.tar.gz"
  }</code></pre>
               
               
               

            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-sources-example2.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">sources:
  /etc/myapp: "https://s3.amazonaws.com/mybucket/myapp.tar.gz"</code></pre>
               
               
               


            </div>
          
       
    
      <h2 id="aws-resource-init-users">使用者</h2>

      <p>透過 users 金鑰，即可在 EC2 執行個體上建立 Linux/UNIX 使用者。請注意，Windows 系統並不支援 users 金鑰。</p>
      <p>下表會列出支援的金鑰。</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c29b7"><thead>
               <tr>
                  <th>金錀</th>
                  <th>描述</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>uid</p>
                  </td>
                  <td tabindex="-1">
                     <p>使用者 ID。如果使用者名稱具有不同的使用者 ID，則建立程序會失敗。若該使用者 ID 已指派給現有的使用者，作業系統可能會拒絕建立請求。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>群組</p>
                  </td>
                  <td tabindex="-1">
                     <p>群組名稱清單。系統會將使用者新增至清單中的各群組。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>homeDir</p>
                  </td>
                  <td tabindex="-1">
                     <p>使用者的主目錄。</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="aws-resource-init-users-example">範例</h3>

         <p>會使用 <code class="code">/sbin/nologin</code> 的 shell，來將使用者建立為非互動式系統的使用者。這是設計本身所致，無法修改。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-users-example.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"users" : <span>{</span>
    "myUser" : <span>{</span>
        "groups" : ["groupOne", "groupTwo"],
        "uid" : "50",
        "homeDir" : "/tmp"
    }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-users-example.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">users:
  myUser:
    groups:
      - "groupOne"
      - "groupTwo"
    uid: "50"
    homeDir: "/tmp"</code></pre>
         </div>
       
   <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>您的瀏覽器已停用或無法使用 Javascript。</strong></p><p>您必須啟用 Javascript，才能使用 AWS 文件。請參閱您的瀏覽器說明頁以取得說明。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">文件慣用形式</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./aws-resource-authentication.html">AWS::CloudFormation::Authentication</div><div id="next" class="next-link" accesskey="n" href="./aws-resource-cloudformation-interface.html">AWS::CloudFormation::Interface</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">此頁面是否有幫助？ - 是</div><div class="content"><p>感謝您，讓我們知道我們做得很好！</p><p>若您有空，歡迎您告知我們值得讚許的地方，這樣才能保持良好服務。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="意見回饋" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-init.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">此頁面是否有幫助？ - 否</div><div class="content"><p>感謝讓我們知道此頁面仍須改善。很抱歉，讓您失望。</p><p>若您有空，歡迎您提供改善文件的方式。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="意見回饋" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-init.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>