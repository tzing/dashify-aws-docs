<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="ja-JP"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>モジュールを使用したリソース構成のカプセル化と再利用 - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="modules" /><meta name="default_state" content="modules" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/modules.html" /><meta name="description" content="モジュールを使用して、リソース実装の複雑さについて深い知識を習得することなく、ベストプラクティス、専門分野の知識、受け入れられたガイドラインをテンプレートに組み込んだリソース構成を組み込む方法について学びます。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="ユーザーガイド" /><meta name="abstract" content="このユーザーガイドでは、AWS CloudFormation を使用して、予測かつ再現可能な方法で、AWS インフラストラクチャのデプロイを作成して管理します。" /><meta name="guide-locale" content="ja_jp" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/modules.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/modules.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="ユーザーガイド" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="ユーザーガイド" /><meta id="panorama-serviceConsolePage" value="モジュールを使用したリソース構成のカプセル化と再利用" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>モジュールを使用したリソース構成のカプセル化と再利用 - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/modules.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/modules.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/modules.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,リソースのプロビジョニング,リソース構成,インフラストラクチャ管理,CloudFormer,CloudFormation スタック,CloudFormation StackSet,CloudFormation テンプレート,変更セット" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "ユーザーガイド",
        "item" : "https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "AWS CloudFormation テンプレートの使用",
        "item" : "https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "モジュールを使用したリソース構成のカプセル化と再利用",
        "item" : "https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/template-guide.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">ドキュメント</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">ユーザーガイド</a></div><div id="page-toc-src"><a href="#modules-using">テンプレートでのモジュールの使用</a><a href="#module-using-params">パラメータを使用してモジュール値を指定する</a><a href="#module-ref-resources">モジュール内のリソースの参照</a><a href="#module-considerations">モジュールを使用するときの考慮事項</a><a href="#module-versioning">モジュールの登録とバージョン管理</a><a href="#module-enabling">パブリックモジュールをアクティベートする</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="modules">モジュールを使用したリソース構成のカプセル化と再利用</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p><em>モジュール</em>は、スタックテンプレート全体に含めるリソース構成をパッケージ化する、透過的で管理しやすく、繰り返し可能な方法です。モジュールは、共通のサービス構成とベストプラクティスを、スタックテンプレートに含めるためのモジュール式のカスタマイズ可能なビルディングブロックとしてカプセル化できます。モジュールを使用すると、リソース実装の複雑さを深く理解することなく、ベストプラクティス、専門分野の知識、承認されたガイドライン (セキュリティ、コンプライアンス、ガバナンス、業界規制などの領域について) をテンプレートに含めることができます。</p><p>たとえば、ネットワークのドメイン専門家は、組み込みのセキュリティグループと、セキュリティガイドラインに準拠した入力/出力ルールを含むモジュールを作成できます。その後、そのモジュールをテンプレートに含めることで、VPC、サブネット、セキュリティグループ、ゲートウェイがどのように機能するかを考えるのに時間を費やすことなく、セキュアなネットワーキングインフラストラクチャをスタックにプロビジョニングできます。また、モジュールはバージョン管理されているため、セキュリティガイドラインが時間の経過とともに変更された場合、モジュールの作成者はそれらの変更を組み込んだ新しいバージョンのモジュールを作成できます。</p><p>テンプレートでモジュールを使用することの特徴は次のとおりです。</p><div class="itemizedlist">
   
   
   
   
 <ul class="itemizedlist"><li class="listitem">
   <p><em>予測可能性</em>: モジュールは CloudFormation レジストリに登録されているスキーマに準拠する必要があります。そのため、テンプレートにモジュールを含めると解決できるリソースがわかります。</p>
  </li><li class="listitem">
   <p><em>再利用性</em>: 複数のテンプレートとアカウントで同じモジュールを使用できます。</p>
  </li><li class="listitem">
   <p><em>トレーサビリティ</em>: CloudFormation では、スタック内のどのリソースがモジュールからプロビジョニングされたかを把握できるため、リソース変更のソースを簡単に把握できます。</p>
  </li><li class="listitem">
   <p><em>管理機能</em>: モジュールを登録すると、バージョニング、アカウント、リージョンの可用性など、CloudFormation レジストリを使用してモジュールを管理できます。</p>
  </li></ul></div><p>モジュールには次のものを含めることができます。</p><div class="itemizedlist">
   
   
 <ul class="itemizedlist"><li class="listitem">
   <p>モジュールからプロビジョニングされる 1 つ以上のリソース、および出力や条件などの関連データ。</p>
  </li><li class="listitem">
   <p><em>任意のモジュールパラメータ</em>。モジュールが使用されるたびにカスタム値を指定できます。</p>
  </li></ul></div><p>モジュールタイプの開発については、「CloudFormation コマンドラインインターフェースユーザーガイド」の「<a href="https://docs.aws.amazon.com/cloudformation-cli/latest/userguide/modules-develop.html">Developing module types</a>」(モジュールタイプの開発) を参照してください。</p>
  <h2 id="modules-using">テンプレートでのモジュールの使用</h2>
  <p>モジュールを使用するには、モジュールを使用するアカウントとリージョンに登録されていることを確認してください。詳細については、「<a href="./registry.html#registry-public-private">パブリック拡張とプライベート拡張</a>」を参照してください。CloudFormation レジストリのモジュールをプライベート拡張として登録します。次に、個々のリソースと同じように扱います。</p>
  <div class="itemizedlist">
    
    
  <ul class="itemizedlist"><li class="listitem">
    <p>それをテンプレートの <code class="code"><a href="./resources-section-structure.html">リソース</a></code> セクションに含めます。</p>
   </li><li class="listitem">
    <p>モジュールに必要なプロパティを指定します。</p>
   </li></ul></div>
  <p>スタックオペレーションを開始すると、CloudFormation は、含まれているモジュールを適切なリソースに解決する処理済みテンプレートを生成します。変更セットを使用して 、スタック操作を実際に実行する前に、追加または更新するリソースをプレビューします。詳細については、「<a href="./using-cfn-updating-stacks-changesets.html">変更セットを使用したスタックの更新</a>」を参照してください。</p>
  <p>次の例を考えてみましょう。リソースとモジュールの両方を含むテンプレートがあります。テンプレートには、1 つの個別のリソース、<b>ResourceA</b> とモジュール <b>ModuleParent</b> が含まれます。このモジュールには、<b>ResourceB</b> と <b>ResourceC</b> の 2 つのリソース、およびネストされたモジュール <b>ModuleChild</b> が含まれています。<b>ModuleChild</b> には、1 つのリソース <b>ResourceD</b> が含まれています。このテンプレートからスタックを作成すると、CloudFormation はテンプレートを処理し、モジュールを適切なリソースに解決します。結果のスタックには、<b>ResourceA</b>、<b>ResourceB</b>、<b>ResourceC</b>、および <b>ResourceD</b> の 4 つのリソースがあります。</p>
  <div class="mediaobject">
    
    <img src="images/modules-resource-inclusion.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;    スタックオペレーション中、CloudFormation はスタックテンプレートに含まれている 2 つのモジュールを適切な 4 つのリソースに解決します。&#xA;   " style="max-width:100%" />
    
    
  </div>
  <p>CloudFormation は、スタック内のどのリソースがモジュールから作成されたかを追跡します。この情報は、特定のスタックの [<b>Events</b>] (イベント)、[<b>Resources</b>] (リソース)、および [<b>Drifts</b>] (ドリフト) タブに表示できます。また、変更セットのプレビューにも表示されます。</p>
  <p>モジュールはテンプレート内のリソースと区別できます。これは、リソースで使用される一般的な 3 つのパート規則とは対照的に、次の 4 つの部分からなる命名規則に従っているためです。</p>
  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="text "><code class="replaceable">organization</code>::<code class="replaceable">service</code>::<code class="replaceable">use-case</code>::MODULE</code></pre>
  
  <h2 id="module-using-params">パラメータを使用してモジュール値を指定する</h2>
  <p>モジュールには、モジュールパラメータを含めることができます。テンプレートパラメーターと同様に、モジュールパラメーターを使用すると、モジュールを含むテンプレート (またはモジュール) からモジュールにカスタム値を入力できます。モジュールはこれらの値を使用して、そのモジュールに含まれるリソースのプロパティを設定できます。</p>
  <p>また、モジュールプロパティを設定するテンプレートパラメータを定義して、スタック操作時にモジュールに渡される値をユーザーが入力できるようにすることもできます。テンプレートのパラメータの定義に関する詳細は、「<a href="./parameters-section-structure.html">パラメータ</a>」を参照してください。</p>
  <p>同様に、モジュールパラメータを含むネストされたモジュールがモジュールに含まれている場合、次のことができます。</p>
  <div class="itemizedlist">
    
    
  <ul class="itemizedlist"><li class="listitem">
    <p>ネストされたモジュールのパラメータの値を親モジュールで直接指定します。</p>
   </li><li class="listitem">
    <p>親モジュール内の対応するモジュールパラメータを定義して、ネストされたモジュールのパラメータを、親モジュールが含まれているテンプレート (またはモジュール) で設定できるようにします。</p>
   </li></ul></div>
   
   <h3 id="module-using-params-example-1">テンプレートパラメータを使用したモジュールパラメータ値の指定</h3>
   <p>次の例は、モジュールに値を渡すテンプレートパラメータを定義する方法を示しています。</p>
   <p>ここで、<code class="code">BucketName</code> を含むテンプレートは、スタック操作中にユーザーが S3 バケット名を指定できるようにするテンプレートパラメータ <code class="code">My::S3::SampleBucket::MODULE</code> を定義します。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">// Template containing My::S3::SampleBucket::MODULE
<span>{</span>
  "Parameters": <span>{</span>
    "<b>BucketName</b>": <span>{</span>
      "Description": "Name for your sample bucket",
      "Type": "String"
    }
  },
  "Resources": <span>{</span>
    "MyBucket": <span>{</span>
      "Type": "<b>My::S3::SampleBucket::MODULE</b>",
      "Properties": <span>{</span>
        "<b>BucketName</b>": <span>{</span>
          "Ref": "BucketName"
        }
      }
    }
  }
}</code></pre>
   
   
   <h3 id="module-using-params-example-2">親モジュールから子モジュール内のリソースのプロパティを指定する</h3>
   <p>次の例は、別のモジュール内にネストされているモジュールでパラメータ値を指定する方法を示しています。</p>
   <p>この最初のモジュール <code class="code">My::S3::SampleBucketPrivate::MODULE</code> は、子モジュールになります。これは、<code class="code">BucketName</code> と <code class="code">AccessControl</code> の 2 つのパラメータを定義します。これらのパラメータに指定された値は、モジュールに含まれる <code class="code">AWS::S3::Bucket</code> リソースの <code class="code">BucketName</code> および<code class="code">AccessControl</code> プロパティを指定するために使用されます。以下は <code class="code">My::S3::SampleBucketPrivate::MODULE</code> のテンプレートフラグメントです。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">// My::S3::SampleBucketPrivate::MODULE
<span>{</span>
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "A sample S3 Bucket with Versioning and DeletionPolicy.",
    "Parameters": <span>{</span>
        "<b>BucketName</b>": <span>{</span>
            "Description": "Name for the bucket",
            "Type": "String"
        },
        "<b>AccessControl</b>": <span>{</span>
            "Description": "AccessControl for the bucket",
            "Type": "String"
        }
    },
    "Resources": <span>{</span>
        "S3Bucket": <span>{</span>
            "Type": "AWS::S3::Bucket",
            "Properties": <span>{</span>
                "<b>BucketName</b>": <span>{</span>
                    "Ref": "BucketName"
                },
                "<b>AccessControl</b>": <span>{</span>
                    "Ref": "AccessControl"
                },
                "DeletionPolicy": "Retain",
                "VersioningConfiguration": <span>{</span>
                    "Status": "Enabled"
                }
            }
        }
    }
}</code></pre>
   <p>次に、前のモジュールは親モジュール <code class="code">My::S3::SampleBucket::MODULE</code> 内にネストされます。親モジュール <code class="code">My::S3::SampleBucket::MODULE</code> は、次の方法で子モジュールのパラメータを設定します。</p>
   <div class="itemizedlist">
     
     
   <ul class="itemizedlist"><li class="listitem">
     <p><code class="code">My::S3::SampleBucketPrivate::MODULE</code> の <code class="code">AccessControl</code> パラメータを <code class="code">Private</code> に設定します。</p>
    </li><li class="listitem">
     <p><code class="code">BucketName</code> では 、モジュールパラメータを定義します。これにより、<code class="code">My::S3::SampleBucket::MODULE</code> を含むテンプレート (またはモジュール) でバケット名を指定できます 。</p>
    </li></ul></div>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">// My::S3::SampleBucket::MODULE
<span>{</span>
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "A sample S3 Bucket. With Private AccessControl.",
  "Parameters": <span>{</span>
    "<b>BucketName</b>": <span>{</span>
      "Description": "Name for your sample bucket",
      "Type": "String"
    }
  },
  "Resources": <span>{</span>
    "MyBucket": <span>{</span>
      "Type": "<b>My::S3::SampleBucketPrivate::MODULE</b>",
      "Properties": <span>{</span>
        "<b>BucketName</b>": <span>{</span>
          "Ref": "BucketName"
        },
        "<b>AccessControl</b>" : "Private"
      }
    }
  }
}</code></pre>
   
   
   <h3 id="modules-using-parameters-constraints">モジュールパラメータの制約の指定</h3>
   <p>モジュールパラメータは、制約の適用をサポートしていません。詳細については、「<a href="./parameters-section-structure.html#parameters-section-structure-properties">プロパティ</a>」を参照してください。モジュールパラメータに対して制約チェックを実行するには、必要な制約を持つテンプレートパラメータを作成し、モジュールパラメータでそのテンプレートパラメータを参照します。</p>
   
  
  <h2 id="module-ref-resources">モジュール内のリソースの参照</h2>
  <p>モジュール内のリソースは、論理名で参照できます。モジュールに含まれるリソースの完全修飾論理名は、次の組み合わせによって構築できます。</p>
  <div class="itemizedlist">
    
    
  <ul class="itemizedlist"><li class="listitem">
    <p>包含テンプレート (または包含モジュール)) 内のモジュールに指定された論理名。</p>
   </li><li class="listitem">
    <p>モジュールで指定された、リソースの論理名。</p>
   </li></ul></div>
  <p>リソースの完全修飾論理名は、区切り文字としてピリオドを使用する場合であっても、使用しない場合であっても、指定することができます。例えば、以下の論理名は両方とも有効で、機能的には同等です。</p>
  <div class="itemizedlist">
    
    
  <ul class="itemizedlist"><li class="listitem">
    <p><code class="code"><code class="replaceable">ModuleLogicalName</code>.<code class="replaceable">ResourceLogicalName</code></code></p>
   </li><li class="listitem">
    <p><code class="code"><code class="replaceable">ModuleLogicalNameResourceLogicalName</code></code></p>
   </li></ul></div>
  <p>このようにして、<code class="code">GetAtt</code> <code class="code">Ref</code> および組み込み関数を使用して、モジュールリソースのプロパティ値にアクセスできます。</p>
  <p>次の例では、テンプレートはモジュール内のプロパティを参照して、テンプレート自体のリソースに対応するプロパティを設定します。</p>
  <p><code class="code">My::S3::SampleBucket::MODULE</code>モジュールに、<code class="code">S3Bucket</code> の論理名を持つ <code class="code">AWS::S3::Bucket</code> リソースが含まれているとします。<code class="code">Ref</code> 組み込み関数を使用してこのリソースのバケット名を参照するには、テンプレート <code class="code">MyBucket</code> 内のモジュールで指定された論理名とモジュール <code class="code">S3Bucket</code> 内のリソースの論理名を組み合わせて、リソース <code class="code">MyBucket.S3Bucket</code> または <code class="code">MyBucketS3Bucket</code> の完全修飾論理名を取得します。</p>
  <p>モジュールに含まれるリソースの論理名は、モジュールのスキーマで指定されます。このスキーマには、次の方法でアクセスできます。</p>
  <div class="itemizedlist">
    
    
  <ul class="itemizedlist"><li class="listitem">
    <p>CloudFormation レジストリ内のモジュールを見つけます。[<b>Schema</b>] タブにモジュールスキーマが表示されます。</p>
   </li><li class="listitem">
    <p><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_DescribeType.html"><code class="code">DescribeType</code></a> 操作を使用して、スキーマを含むモジュールの詳細を返します。</p>
   </li></ul></div>

  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">// Template that uses My::S3::SampleBucket::MODULE
<span>{</span>
  "Parameters": <span>{</span>
    "BucketName": <span>{</span>
      "Description": "Name for your sample bucket",
      "Type": "String"
   }
 },
  "Resources": <span>{</span>
    "MyBucket": <span>{</span>
      "Type": "My::S3::SampleBucket::MODULE",
      "Properties": <span>{</span>
          "BucketName": <span>{</span>
            "Ref": "BucketName"
         }
      }
    },
    "exampleQueue": <span>{</span>
      "Type": "AWS::SQS::Queue",
      "Properties": <span>{</span>
          "QueueName": <span>{</span>
            "Ref": "<b>MyBucket.S3Bucket</b>"
          }
      }
    }
},
"Outputs": <span>{</span>
  "BucketArn": <span>{</span>
      "Value": <span>{</span>
          "Fn::GetAtt": [
             "<b>MyBucket</b>",
             "<b>S3Bucket.Arn</b>"
          ]
      }
    }
  }
}</code></pre>
  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Parameters:
  BucketName:
    Description: Name for your sample bucket
    Type: String
Resources:
  MyBucket:
    Type: My::S3::SampleBucket::MODULE
    Properties:
      BucketName: !Ref BucketName
  exampleQueue:
    Type: AWS::SQS::Queue
    Properties:
      QueueName: !Ref <b>MyBucket.S3Bucket</b>
Outputs:
  BucketArn:
    Value: !<b>GetAtt MyBucket.S3Bucket.Arn</b></code></pre>
  
  <h2 id="module-considerations">モジュールを使用するときの考慮事項</h2>
  <div class="itemizedlist">
    
    
    
    
    
    
  <ul class="itemizedlist"><li class="listitem">
    <p>モジュールは追加料金なしで使用できます。スタック内でそれらのモジュールが解決したリソースに対してのみお支払いいただきます。</p>
   </li><li class="listitem">
    <p>CloudFormation クォータ (スタックで許可されるリソースの最大数、テンプレート本文の最大サイズなど) は、テンプレートに含まれるリソースがモジュールから取得されているかどうかにかかわらず、処理されたテンプレートに適用されます。詳細については、「<a href="./cloudformation-limits.html">AWS CloudFormation のクォータ</a>」を参照してください。</p>
   </li><li class="listitem">
    <p><em>スタック</em>レベルで指定するタグは、モジュールから派生した個々のリソースに割り当てられます。</p>
   </li><li class="listitem">
    <p>モジュールレベルで指定されたヘルパースクリプトは、CloudFormation がテンプレートを処理するときに、モジュールに含まれる個々のリソースには伝達されません。</p>
   </li><li class="listitem">
    <p>モジュールで指定された出力は、テンプレートレベルで出力に伝播されます。</p>
    <p>各出力には、モジュールで定義されたモジュールの論理名と出力名を連結した論理 ID が割り当てられます。出力に関する詳細は、「<a href="./outputs-section-structure.html">出力</a>」を参照してください。</p>
   </li><li class="listitem">
    <p>モジュールで指定されたパラメータは、テンプレートレベルのパラメータには伝達されません。</p>
    <p>ただし、モジュールレベルのパラメータを参照するテンプレートレベルのパラメータを作成できます。詳細については、「<a href="#module-using-params">パラメータを使用してモジュール値を指定する</a>」を参照してください。</p>
   </li></ul></div>
  
  <h2 id="module-versioning">モジュールの登録とバージョン管理</h2>
  <p>CloudFormation レジストリを使用して、アカウントとリージョンのモジュールを登録および管理します。詳細については、「<a href="./registry.html">AWS CloudFormation レジストリの使用</a>」を参照してください。</p>
  <p>特定のアカウントとリージョンに、同じモジュールの複数のバージョンを登録できます。次の考慮事項に注意が必要です。</p>
  <div class="itemizedlist">
    
    
    
    
    
    
  <ul class="itemizedlist"><li class="listitem">
    <p>モジュールを使用するアカウントとリージョンに、モジュールを登録する必要があります。</p>
   </li><li class="listitem">
    <p>スタックオペレーション中、CloudFormation は、<em>スタックオペレーションが実行されているアカウントおよびリージョンで</em>、デフォルトバージョンとして現在登録されているモジュールの任意のバージョンを使用します。これには、他のモジュールにネストされているモジュールも含まれます。</p>
    <p>したがって、異なるアカウントまたはリージョンで、同じモジュールの異なるバージョンをデフォルトバージョンとして登録している場合、同じテンプレートを使用すると、異なる結果になる可能性があることに注意してください。</p>
    <p>詳細については、「<a href="./registry-private.html#registry-set-version">AWS CLI を使用して使用するプライベート拡張のバージョンを指定する</a>」を参照してください。</p>
   </li><li class="listitem">
    <p>スタックオペレーション中、CloudFormation は、スタックオペレーションが実行されているアカウントおよびリージョンで、デフォルトバージョンとして現在登録されている<em>リソース</em>の任意のバージョンを使用します。これには、モジュールを含めることによって生成されたリソースが含まれます。</p>
   </li><li class="listitem">
    <p>モジュールのデフォルトバージョンを変更しても、スタックの更新オペレーションは開始されません。ただし、次にそのモジュールを含むテンプレート (スタックの更新など) でスタックオペレーションを実行すると、CloudFormation は新しいデフォルトバージョンをオペレーションで使用します。</p>
    <p>これに関する例外の 1 つは、以下で説明するように、[<b>use previous template</b>] オプションを指定してスタックの更新を実行することです。</p>
   </li><li class="listitem">
    <p>スタックの更新オペレーションで、[<b>use previous template</b>] (以前のテンプレートを使用) オプションを指定すると、CloudFormation はスタック更新のために以前に処理されたテンプレートを使用し、モジュールに加えた変更については再処理しません。</p>
   </li><li class="listitem">
    <p>一貫した結果を保証するために、スタックセットで使用するためにスタックテンプレートにモジュールを含める場合は、スタックインスタンスをデプロイする予定のすべてのアカウントとリージョンで、同じバージョンのモジュールがデフォルトバージョンとして設定されていることを確認する必要があります。これは、他のモジュールにネストされているモジュールの場合を含みます。スタックセットの詳細については、「<a href="./what-is-cfnstacksets.html">AWS CloudFormation StackSets の操作</a>」を参照してください。</p>
   </li></ul></div>
  <p>モジュールの新しいバージョンの登録、またはデフォルトバージョンの変更に関する詳細は、「<a href="./registry.html">AWS CloudFormation レジストリの使用</a>」を参照してください。</p>
  
  <h2 id="module-enabling">アカウントで使用するためにパブリックモジュールをアクティベートする</h2>
  <p>アカウントとリージョンでパブリックモジュールを正常にアクティブ化するには、モジュールに含まれる各サードパーティのパブリック拡張 (リソースまたはモジュール) に対して以下が当てはまる必要があります。</p>
  <div class="itemizedlist">
    
    
  <ul class="itemizedlist"><li class="listitem">
    <p>アカウントとリージョンで拡張がすでにアクティブ化されている必要があります。</p>
    <p>モジュール内のエクステンションがタイプ名のエイリアスを使用する場合、エクステンションは同じタイプ名エイリアスを使用してアカウントとリージョンに登録する必要があります。詳細については、「<a href="./registry-public.html#registry-public-enable-alias">拡張を参照するエイリアスを指定する</a>」を参照してください。</p>
   </li><li class="listitem">
    <p>現在アクティブ化されているエクステンションのバージョンは、モジュールで指定されているエクステンションのサポートされているメジャーバージョンのいずれかである必要があります。詳細については、「CloudFormation CLI ユーザーガイド」の「<a href="https://docs.aws.amazon.com/cloudformation-cli/latest/userguide/modules-structure.html#modules-structure-publishing-prereqs">Module requirements for publishing a public module</a>」(パブリックモジュールを公開するためのモジュール要件) を参照してください。</p>
   </li></ul></div>
  <p>適切なサードパーティのパブリック拡張と拡張のバージョンがアクティブ化されていない場合、CloudFormation はオペレーションに失敗し、モジュールを正常にアクティブ化する前にアクティブ化する必要がある拡張やバージョンをリストするエラーが表示されます。</p>
 <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>ブラウザで JavaScript が無効になっているか、使用できません。</strong></p><p>AWS ドキュメントを使用するには、JavaScript を有効にする必要があります。手順については、使用するブラウザのヘルプページを参照してください。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">ドキュメントの表記規則</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./macros-example.html">マクロの例: マクロの作成と使用</div><div id="next" class="next-link" accesskey="n" href="./blue-green.html">ECS ブルー/グリーンデプロイの実行</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">このページは役に立ちましたか? - はい</div><div class="content"><p>ページが役に立ったことをお知らせいただき、ありがとうございます。</p><p>お時間がある場合は、何が良かったかお知らせください。今後の参考にさせていただきます。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="フィードバック" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/modules.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">このページは役に立ちましたか? - いいえ</div><div class="content"><p>このページは修正が必要なことをお知らせいただき、ありがとうございます。ご期待に沿うことができず申し訳ありません。</p><p>お時間がある場合は、ドキュメントを改善する方法についてお知らせください。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="フィードバック" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/modules.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>