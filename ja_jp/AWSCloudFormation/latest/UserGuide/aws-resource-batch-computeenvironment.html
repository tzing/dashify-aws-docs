<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS::Batch::ComputeEnvironment - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="aws-resource-batch-computeenvironment" /><meta name="default_state" content="aws-resource-batch-computeenvironment" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" /><meta name="description" content="Use the AWS CloudFormation AWS::Batch::ComputeEnvironment resource for Batch." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json;toc-AWS_Batch.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" hreflang="x-default" /><meta name="feedback-item" content="AWSBatch" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="AWS::Batch::ComputeEnvironment" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS::Batch::ComputeEnvironment - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWSBatch&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "AWS Batch resource type reference",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Batch.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "AWS::Batch::ComputeEnvironment",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Batch.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="AWS_Batch.html">User Guide</a></div><div id="page-toc-src"><a href="#aws-resource-batch-computeenvironment-syntax">Syntax</a><a href="#aws-resource-batch-computeenvironment-properties">Properties</a><a href="#aws-resource-batch-computeenvironment-return-values">Return values</a><a href="#aws-resource-batch-computeenvironment--examples">Examples</a><a href="#aws-resource-batch-computeenvironment--seealso">See also</a></div><div id="page-filters" style="display:none"><filter label="All" id="All"></filter><filter label="JSON" id="JSON"></filter><filter label="YAML" id="YAML"></filter></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="aws-resource-batch-computeenvironment">AWS::Batch::ComputeEnvironment</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>The <code class="code">AWS::Batch::ComputeEnvironment</code> resource defines your AWS Batch compute environment. You can define <code class="code">MANAGED</code> or
            <code class="code">UNMANAGED</code> compute environments. <code class="code">MANAGED</code> compute environments
         can use Amazon EC2 or AWS Fargate resources. <code class="code">UNMANAGED</code>
         compute environments can only use EC2 resources. For more information, see <a href="https://docs.aws.amazon.com/batch/latest/userguide/compute_environments.html">Compute
            Environments</a> in the <em>AWS Batch User Guide</em>.</p><p>In a managed compute environment, AWS Batch manages the capacity and
         instance types of the compute resources within the environment. This is based on the
         compute resource specification that you define or the <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-launch-templates.html">launch template</a> that you
         specify when you create the compute environment. You can choose either to use EC2 On-Demand
         Instances and EC2 Spot Instances, or to use Fargate and Fargate Spot capacity in your
         managed compute environment. You can optionally set a maximum price so that Spot Instances
         only launch when the Spot Instance price is below a specified percentage of the On-Demand
         price.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Multi-node parallel jobs are not supported on Spot Instances.</p></div></div><p>In an unmanaged compute environment, you can manage your own EC2 compute resources and
         have a lot of flexibility with how you configure your compute resources. For example, you
         can use custom AMI. However, you need to verify that your AMI meets the Amazon ECS
         container instance AMI specification. For more information, see <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/container_instance_AMIs.html">container instance
            AMIs</a> in the <em>Amazon Elastic Container Service Developer
            Guide</em>. After you have created your unmanaged compute environment, you can use
         the <a href="https://docs.aws.amazon.com/batch/latest/APIReference/API_DescribeComputeEnvironments.html">DescribeComputeEnvironments</a> operation to find the Amazon ECS cluster that is
         associated with it. Then, manually launch your container instances into that Amazon ECS
         cluster. For more information, see <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/launch_container_instance.html">Launching an Amazon
            ECS container instance</a> in the <em>Amazon Elastic Container Service
            Developer Guide</em>.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>To create a compute environment that uses EKS resources, the caller must have
            permissions to call <code class="code">eks:DescribeCluster</code>.</p></div></div><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>AWS Batch doesn't upgrade the AMIs in a compute environment after it's
            created except under specific conditions. For example, it doesn't automatically update
            the AMIs when a newer version of the Amazon ECS optimized AMI is available. Therefore,
            you're responsible for the management of the guest operating system (including updates
            and security patches) and any additional application software or utilities that you
            install on the compute resources. There are two ways to use a new AMI for your AWS Batch jobs. The original method is to complete these steps:</p><div class="orderedlist">
             
             
             
             
         <ol><li>
               <p>Create a new compute environment with the new AMI.</p>
            </li><li>
               <p>Add the compute environment to an existing job queue.</p>
            </li><li>
               <p>Remove the earlier compute environment from your job queue.</p>
            </li><li>
               <p>Delete the earlier compute environment.</p>
            </li></ol></div><p>In April 2022, AWS Batch added enhanced support for updating compute
            environments. For example, the <code class="code">UpdateComputeEnvironent</code> API lets you use the
               <code class="code">ReplaceComputeEnvironment</code> property to dynamically update compute
            environment parameters such as the launch template or instance type without replacement.
            For more information, see <a href="https://docs.aws.amazon.com/batch/latest/userguide/updating-compute-environments.html">Updating compute
               environments</a> in the <em>
               AWS Batch User Guide</em>.
            </p><p>To use the enhanced updating of compute environments to update
            AMIs, follow these rules:</p><div class="itemizedlist">
             
             
             
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>Either do not set the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html#cfn-batch-computeenvironment-servicerole">ServiceRole</a> property or set it to the <b>AWSServiceRoleForBatch</b> service-linked role.</p>
            </li><li class="listitem">
               <p>Set the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-allocationstrategy">AllocationStrategy</a> property to <code class="code">BEST_FIT_PROGRESSIVE</code> or
                     <code class="code">SPOT_CAPACITY_OPTIMIZED</code>.</p>
            </li><li class="listitem">
               <p>Set the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html#cfn-batch-computeenvironment-replacecomputeenvironment">ReplaceComputeEnvironment</a> property to <code class="code">false</code>.</p>
               <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Set the <code class="code">ReplaceComputeEnvironment</code> property to <code class="code">true</code>
                     if the compute environment uses the <code class="code">BEST_FIT</code> allocation
                     strategy.</p></div></div>
               <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If the <code class="code">ReplaceComputeEnvironment</code> property is set to
                        <code class="code">false</code>, you might receive an error message when you update the
                     CFN template for a compute environment. This issue occurs if the updated
                        <code class="code">desiredvcpus</code> value is less than the current
                        <code class="code">desiredvcpus</code> value. As a workaround, delete the
                        <code class="code">desiredvcpus</code> value from the updated template or use the
                        <code class="code">minvcpus</code> property to manage the number of vCPUs. For
                     information, see <a href="https://docs.aws.amazon.com/batch/latest/userguide/troubleshooting.html#error-desired-vcpus-update">Error message when you update the <code class="code">DesiredvCpus</code>
                     setting</a>.</p></div></div>
            </li><li class="listitem">
               <p>Set the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-updatetolatestimageversion">UpdateToLatestImageVersion</a> property to
                  <code class="code">true</code>.
                  This property is used when you update a compute environment. The <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-updatetolatestimageversion">UpdateToLatestImageVersion</a> property is ignored when you create a
                  compute environment.</p>
            </li><li class="listitem">
               <p>Either do not specify an image ID in <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-imageid">ImageId</a> or <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-ec2configurationobject.html#cfn-batch-computeenvironment-ec2configurationobject-imageidoverride">ImageIdOverride</a> properties, or in the launch template identified by
                  the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-launchtemplate">Launch Template</a> property. In that case AWS Batch will
                  select the latest Amazon ECS optimized AMI supported by AWS Batch at
                  the time the infrastructure update is initiated. Alternatively you can specify the
                  AMI ID in the <code class="code">ImageId</code> or <code class="code">ImageIdOverride</code> properties, or
                  the launch template identified by the <code class="code">LaunchTemplate</code> properties.
                  Changing any of these properties will trigger an infrastructure update.</p>
            </li></ul></div><p>If these rules are followed, any update that triggers an infrastructure update will
            cause the AMI ID to be re-selected. If the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-launchtemplatespecification.html#cfn-batch-computeenvironment-launchtemplatespecification-version">Version</a> property of the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-launchtemplatespecification.html">LaunchTemplateSpecification</a> is set to <code class="code">$Latest</code> or
               <code class="code">$Default</code>, the latest or default version of the launch template will be
            evaluated up at the time of the infrastructure update, even if the
               <code class="code">LaunchTemplateSpecification</code> was not updated.</p></div></div><h2 id="aws-resource-batch-computeenvironment-syntax">Syntax</h2><p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p><div id="JSON" name="JSON" class="section langfilter"><h3 id="aws-resource-batch-computeenvironment-syntax.json">JSON</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Type" : "AWS::Batch::ComputeEnvironment",
  "Properties" : <span>{</span>
      "<a href="#cfn-batch-computeenvironment-computeenvironmentname">ComputeEnvironmentName</a>" : <code class="replaceable">String</code>,
      "<a href="#cfn-batch-computeenvironment-computeresources">ComputeResources</a>" : <code class="replaceable"><a href="./aws-properties-batch-computeenvironment-computeresources.html">ComputeResources</a></code>,
      "<a href="#cfn-batch-computeenvironment-eksconfiguration">EksConfiguration</a>" : <code class="replaceable"><a href="./aws-properties-batch-computeenvironment-eksconfiguration.html">EksConfiguration</a></code>,
      "<a href="#cfn-batch-computeenvironment-replacecomputeenvironment">ReplaceComputeEnvironment</a>" : <code class="replaceable">Boolean</code>,
      "<a href="#cfn-batch-computeenvironment-servicerole">ServiceRole</a>" : <code class="replaceable">String</code>,
      "<a href="#cfn-batch-computeenvironment-state">State</a>" : <code class="replaceable">String</code>,
      "<a href="#cfn-batch-computeenvironment-tags">Tags</a>" : <code class="replaceable"><span>{</span><code class="replaceable">Key</code>: <code class="replaceable">Value</code>, ...}</code>,
      "<a href="#cfn-batch-computeenvironment-type">Type</a>" : <code class="replaceable">String</code>,
      "<a href="#cfn-batch-computeenvironment-unmanagedvcpus">UnmanagedvCpus</a>" : <code class="replaceable">Integer</code>,
      "<a href="#cfn-batch-computeenvironment-updatepolicy">UpdatePolicy</a>" : <code class="replaceable"><a href="./aws-properties-batch-computeenvironment-updatepolicy.html">UpdatePolicy</a></code>
    }
}
</code></pre></div><div id="YAML" name="YAML" class="section langfilter"><h3 id="aws-resource-batch-computeenvironment-syntax.yaml">YAML</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Type: AWS::Batch::ComputeEnvironment
Properties:
  <a href="#cfn-batch-computeenvironment-computeenvironmentname">ComputeEnvironmentName</a>: <code class="replaceable">String</code>
  <a href="#cfn-batch-computeenvironment-computeresources">ComputeResources</a>: <code class="replaceable">
    <a href="./aws-properties-batch-computeenvironment-computeresources.html">ComputeResources</a></code>
  <a href="#cfn-batch-computeenvironment-eksconfiguration">EksConfiguration</a>: <code class="replaceable">
    <a href="./aws-properties-batch-computeenvironment-eksconfiguration.html">EksConfiguration</a></code>
  <a href="#cfn-batch-computeenvironment-replacecomputeenvironment">ReplaceComputeEnvironment</a>: <code class="replaceable">Boolean</code>
  <a href="#cfn-batch-computeenvironment-servicerole">ServiceRole</a>: <code class="replaceable">String</code>
  <a href="#cfn-batch-computeenvironment-state">State</a>: <code class="replaceable">String</code>
  <a href="#cfn-batch-computeenvironment-tags">Tags</a>: <code class="replaceable">
    <code class="replaceable">Key</code>: <code class="replaceable">Value</code></code>
  <a href="#cfn-batch-computeenvironment-type">Type</a>: <code class="replaceable">String</code>
  <a href="#cfn-batch-computeenvironment-unmanagedvcpus">UnmanagedvCpus</a>: <code class="replaceable">Integer</code>
  <a href="#cfn-batch-computeenvironment-updatepolicy">UpdatePolicy</a>: <code class="replaceable">
    <a href="./aws-properties-batch-computeenvironment-updatepolicy.html">UpdatePolicy</a></code>
</code></pre></div><h2 id="aws-resource-batch-computeenvironment-properties">Properties</h2><div class="variablelist"><dl><dt id="cfn-batch-computeenvironment-computeenvironmentname"><span class="term"><code class="code">ComputeEnvironmentName</code></span></dt><dd>
         <p>The name for your compute environment. It can be up to 128 characters long. It can contain uppercase and
 lowercase letters, numbers, hyphens (-), and underscores (_).</p>
      <p><em>Required</em>: No</p><p><em>Type</em>: String</p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p></dd><dt id="cfn-batch-computeenvironment-computeresources"><span class="term"><code class="code">ComputeResources</code></span></dt><dd>
      <p>The ComputeResources property type specifies details of the compute resources managed by
         the compute environment. This parameter is required for managed compute environments. For
         more information, see <a href="https://docs.aws.amazon.com/batch/latest/userguide/compute_environments.html">Compute Environments</a> in
         the <em>AWS Batch User Guide</em>.</p>
   <p><em>Required</em>: No</p><p><em>Type</em>: <a href="./aws-properties-batch-computeenvironment-computeresources.html">ComputeResources</a></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-batch-computeenvironment-eksconfiguration"><span class="term"><code class="code">EksConfiguration</code></span></dt><dd>
         <p>The details for the Amazon EKS cluster that supports the compute environment.</p>
      <p><em>Required</em>: No</p><p><em>Type</em>: <a href="./aws-properties-batch-computeenvironment-eksconfiguration.html">EksConfiguration</a></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p></dd><dt id="cfn-batch-computeenvironment-replacecomputeenvironment"><span class="term"><code class="code">ReplaceComputeEnvironment</code></span></dt><dd>
      <p>Specifies whether the compute environment is replaced if an update is made that requires
         replacing the instances in the compute environment. The default value is <code class="code">true</code>.
         To enable more properties to be updated, set this property to <code class="code">false</code>. When
         changing the value of this property to <code class="code">false</code>, do not change any other
         properties at the same time. If other properties are changed at the same time, and the
         change needs to be rolled back but it can't, it's possible for the stack to go into the
            <code class="code">UPDATE_ROLLBACK_FAILED</code> state. You can't update a stack that is in the
            <code class="code">UPDATE_ROLLBACK_FAILED</code> state. However, if you can continue to roll it back,
         you can return the stack to its original settings and then try to update it again. For more
         information, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-continueupdaterollback.html">Continue rolling back an update</a> in the <em>AWS CloudFormation User
            Guide</em>.</p>
      <p>The properties that can't be changed without replacing the compute environment are in
         the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html"><code class="code">ComputeResources</code></a> property type: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-allocationstrategy"><code class="code">AllocationStrategy</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-bidpercentage"><code class="code">BidPercentage</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-ec2configuration"><code class="code">Ec2Configuration</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-ec2keypair"><code class="code">Ec2KeyPair</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-ec2keypair"><code class="code">Ec2KeyPair</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-imageid"><code class="code">ImageId</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-instancerole"><code class="code">InstanceRole</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-instancetypes"><code class="code">InstanceTypes</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-launchtemplate"><code class="code">LaunchTemplate</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-maxvcpus"><code class="code">MaxvCpus</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-minvcpus"><code class="code">MinvCpus</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-placementgroup"><code class="code">PlacementGroup</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-securitygroupids"><code class="code">SecurityGroupIds</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-subnets"><code class="code">Subnets</code></a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-tags">Tags</a>, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-type"><code class="code">Type</code></a>, and <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-batch-computeenvironment-computeresources.html#cfn-batch-computeenvironment-computeresources-updatetolatestimageversion"><code class="code">UpdateToLatestImageVersion</code></a>.</p>
   <p><em>Required</em>: No</p><p><em>Type</em>: Boolean</p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-batch-computeenvironment-servicerole"><span class="term"><code class="code">ServiceRole</code></span></dt><dd>
         <p>The full Amazon Resource Name (ARN) of the IAM role that allows AWS Batch to make calls to other AWS
      services on your behalf. For more information, see <a href="https://docs.aws.amazon.com/batch/latest/userguide/service_IAM_role.html">AWS Batch service IAM role</a> in the
        <em>
               AWS Batch User Guide</em>.</p>
         <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>If your account already created the AWS Batch service-linked role, that role is used by
        default for your compute environment unless you specify a different role here. If the
        AWS Batch service-linked role doesn't exist in your account, and no role is specified here,
        the service attempts to create the AWS Batch service-linked role in your account.</p></div></div>
         <p>If your specified role has a path other than <code class="code">/</code>, then you must specify either
      the full role ARN (recommended) or prefix the role name with the path. For example, if a
      role with the name <code class="code">bar</code> has a path of <code class="code">/foo/</code>, specify
        <code class="code">/foo/bar</code> as the role name. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html#identifiers-friendly-names">Friendly
        names and paths</a> in the <em>IAM User Guide</em>.</p>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Depending on how you created your AWS Batch service role, its ARN might contain the
          <code class="code">service-role</code> path prefix. When you only specify the name of the service role,
        AWS Batch assumes that your ARN doesn't use the <code class="code">service-role</code> path prefix. Because
        of this, we recommend that you specify the full ARN of your service role when you create
        compute environments.</p></div></div>
      <p><em>Required</em>: No</p><p><em>Type</em>: String</p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-batch-computeenvironment-state"><span class="term"><code class="code">State</code></span></dt><dd>
         <p>The state of the compute environment. If the state is <code class="code">ENABLED</code>, then the
      compute environment accepts jobs from a queue and can scale out automatically based on
      queues.</p>
         <p>If the state is <code class="code">ENABLED</code>, then the AWS Batch scheduler can attempt to place jobs
      from an associated job queue on the compute resources within the environment. If the compute
      environment is managed, then it can scale its instances out or in automatically, based on the
      job queue demand.</p>
         <p>If the state is <code class="code">DISABLED</code>, then the AWS Batch scheduler doesn't attempt to place
      jobs within the environment. Jobs in a <code class="code">STARTING</code> or <code class="code">RUNNING</code> state
      continue to progress normally. Managed compute environments in the <code class="code">DISABLED</code> state
      don't scale out. </p>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Compute environments in a <code class="code">DISABLED</code> state may continue to incur billing
        charges. To prevent additional charges, turn off and then delete the compute environment.
        For more information, see <a href="https://docs.aws.amazon.com/batch/latest/userguide/compute_environment_parameters.html#compute_environment_state">State</a> in the <em>
                  AWS Batch User Guide</em>.</p></div></div>
         <p>When an instance is idle, the instance scales down to the <code class="code">minvCpus</code> value.
      However, the instance size doesn't change. For example, consider a <code class="code">c5.8xlarge</code>
      instance with a <code class="code">minvCpus</code> value of <code class="code">4</code> and a <code class="code">desiredvCpus</code>
      value of <code class="code">36</code>. This instance doesn't scale down to a <code class="code">c5.large</code>
      instance.</p>
      <p><em>Required</em>: No</p><p><em>Type</em>: String</p><p><em>Allowed values</em>: <code class="code">ENABLED | DISABLED</code></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-batch-computeenvironment-tags"><span class="term"><code class="code">Tags</code></span></dt><dd>
         <p>The tags applied to the compute environment.</p>
      <p><em>Required</em>: No</p><p><em>Type</em>: Object of String</p><p><em>Pattern</em>: <code class="code">.*</code></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p></dd><dt id="cfn-batch-computeenvironment-type"><span class="term"><code class="code">Type</code></span></dt><dd>
         <p>The type of the compute environment: <code class="code">MANAGED</code> or <code class="code">UNMANAGED</code>. For
      more information, see <a href="https://docs.aws.amazon.com/batch/latest/userguide/compute_environments.html">Compute Environments</a> in the <em>
               AWS Batch User Guide</em>.</p>
      <p><em>Required</em>: Yes</p><p><em>Type</em>: String</p><p><em>Allowed values</em>: <code class="code">MANAGED | UNMANAGED</code></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p></dd><dt id="cfn-batch-computeenvironment-unmanagedvcpus"><span class="term"><code class="code">UnmanagedvCpus</code></span></dt><dd>
         <p>The maximum number of vCPUs for an unmanaged compute environment. This parameter is only
      used for fair share scheduling to reserve vCPU capacity for new share identifiers. If this
      parameter isn't provided for a fair share job queue, no vCPU capacity is reserved.</p>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>This parameter is only supported when the <code class="code">type</code> parameter is set to
          <code class="code">UNMANAGED</code>.</p></div></div>
      <p><em>Required</em>: No</p><p><em>Type</em>: Integer</p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-batch-computeenvironment-updatepolicy"><span class="term"><code class="code">UpdatePolicy</code></span></dt><dd>
         <p>Specifies the infrastructure update policy for the compute environment. For more information
   about infrastructure updates, see <a href="https://docs.aws.amazon.com/batch/latest/userguide/updating-compute-environments.html">Updating compute environments</a> in the
    <em>
               AWS Batch User Guide</em>.</p>
      <p><em>Required</em>: No</p><p><em>Type</em>: <a href="./aws-properties-batch-computeenvironment-updatepolicy.html">UpdatePolicy</a></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd></dl></div><h2 id="aws-resource-batch-computeenvironment-return-values">Return values</h2><h3 id="aws-resource-batch-computeenvironment-return-values-ref">Ref</h3><p>When you pass the logical ID of this resource to the intrinsic <code class="code">Ref</code> function, <code class="code">Ref</code> returns the compute environment ARN, such as <code class="code">arn:aws:batch:<em>us-east-1</em>:<em>555555555555</em>:compute-environment/<em>M4OnDemand</em></code>.</p><p>For more information about using the <code class="code">Ref</code> function, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html"><code class="code">Ref</code></a>.</p><h3 id="aws-resource-batch-computeenvironment-return-values-fn--getatt">Fn::GetAtt</h3><p>The <code class="code">Fn::GetAtt</code> intrinsic function returns a value for a specified attribute of this type. The following are the available attributes and sample return values.</p>
<p>For more information about using the <code class="code">Fn::GetAtt</code> intrinsic function, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-getatt.html"><code class="code">Fn::GetAtt</code></a>.</p><h4 id="aws-resource-batch-computeenvironment-return-values-fn--getatt-fn--getatt"></h4><div class="variablelist"><dl><dt id="ComputeEnvironmentArn-fn::getatt"><span class="term"><code class="code">ComputeEnvironmentArn</code></span></dt><dd>
      <p>Returns the compute environment ARN, such as <code class="code">arn:aws:batch:<em>us-east-1</em>:<em>111122223333</em>:compute-environment/<em>ComputeEnvironmentName</em></code>.</p>
   </dd></dl></div><h2 id="aws-resource-batch-computeenvironment--examples">Examples</h2><p></p><h3 id="aws-resource-batch-computeenvironment--examples--Managed_Compute_Environment">Managed Compute Environment</h3><p>The following example creates a managed compute environment called
                  <code class="code">C4OnDemand</code> that uses C4 On-Demand instances and a custom AMI.</p><div id="JSON" name="JSON" class="section langfilter"><h4 id="aws-resource-batch-computeenvironment--examples--Managed_Compute_Environment--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span> "ComputeEnvironment": <span>{</span> "Type":
            "AWS::Batch::ComputeEnvironment", "Properties": <span>{</span> "Type": "MANAGED", "ServiceRole":
               "arn:aws:iam::<em>111122223333</em>:role/aws-service-role/batch.amazonaws.com/AWSServiceRoleForBatch",
            "ComputeEnvironmentName": "C4OnDemand", "ComputeResources": <span>{</span> "MaxvCpus": 128,
            "SecurityGroupIds": [ "sg-abcd1234" ], "Type": "EC2", "Subnets": [ "subnet-aaaaaaaa",
            "subnet-bbbbbbbb", "subnet-cccccccc" ], "MinvCpus": 0, "ImageId": "ami-a1b2c3d4",
            "InstanceRole": "ecsInstanceRole", "InstanceTypes": [ "c4.large", "c4.xlarge",
            "c4.2xlarge", "c4.4xlarge", "c4.8xlarge" ], "Ec2KeyPair": "id_rsa", "Tags": <span>{</span> "Name":
            "Batch Instance - C4OnDemand" }, "DesiredvCpus": 48 }, "State": "ENABLED" } }
            }</code></pre></div><div id="YAML" name="YAML" class="section langfilter"><h4 id="aws-resource-batch-computeenvironment--examples--Managed_Compute_Environment--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">ComputeEnvironment: Type: AWS::Batch::ComputeEnvironment
            Properties: Type: MANAGED ServiceRole: arn:aws:iam::<em>111122223333</em>:role/aws-service-role/batch.amazonaws.com/AWSServiceRoleForBatch
            ComputeEnvironmentName: C4OnDemand ComputeResources: MaxvCpus: 128 SecurityGroupIds: -
            sg-abcd1234 Type: EC2 Subnets: - subnet-aaaaaaaa - subnet-bbbbbbbb - subnet-cccccccc
            MinvCpus: 0 ImageId: ami-a1b2c3d4 InstanceRole: ecsInstanceRole InstanceTypes: -
            c4.large - c4.xlarge - c4.2xlarge - c4.4xlarge - c4.8xlarge Ec2KeyPair: id_rsa Tags:
            <span>{</span>"Name" : "Batch Instance - C4OnDemand"} DesiredvCpus: 48 State: ENABLED</code></pre></div><h2 id="aws-resource-batch-computeenvironment--seealso">See also</h2><div class="itemizedlist">
             
         <ul class="itemizedlist"><li class="listitem">
               <p>
                  <a href="https://docs.aws.amazon.com/batch/latest/userguide/compute_environments.html">Compute Environments</a> in the <em>AWS Batch User Guide</em>.</p>
            </li></ul></div><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./AWS_Batch.html">AWS Batch</div><div id="next" class="next-link" accesskey="n" href="./aws-properties-batch-computeenvironment-computeresources.html">ComputeResources</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWSBatch&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWSBatch&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-batch-computeenvironment.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>