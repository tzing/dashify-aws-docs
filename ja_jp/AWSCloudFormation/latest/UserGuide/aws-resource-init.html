<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="ja-JP"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS::CloudFormation::Init - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="aws-resource-init" /><meta name="default_state" content="aws-resource-init" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="description" content="AWS::CloudFormation::Init リソースタイプを使用することで、cfn-init ヘルパースクリプトの Amazon EC2 インスタンスにメタデータを含めます。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="ユーザーガイド" /><meta name="abstract" content="このユーザーガイドでは、AWS CloudFormation を使用して、予測かつ再現可能な方法で、AWS インフラストラクチャのデプロイを作成して管理します。" /><meta name="guide-locale" content="ja_jp" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="ユーザーガイド" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="ユーザーガイド" /><meta id="panorama-serviceConsolePage" value="AWS::CloudFormation::Init" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS::CloudFormation::Init - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,リソースのプロビジョニング,リソース構成,インフラストラクチャ管理,CloudFormer,CloudFormation スタック,CloudFormation StackSet,CloudFormation テンプレート,変更セット" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "ユーザーガイド",
        "item" : "https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "AWS CloudFormation テンプレートの使用",
        "item" : "https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "テンプレートの構造分析",
        "item" : "https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/template-anatomy.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "メタデータ",
        "item" : "https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/metadata-section-structure.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "AWS::CloudFormation::Init",
        "item" : "https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/metadata-section-structure.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">ドキュメント</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">ユーザーガイド</a></div><div id="page-toc-src"><a href="#aws-resource-cloudformation-init-syntax">Syntax</a><a href="#aws-resource-init-configsets">Configset</a><a href="#aws-resource-init-commands">コマンド</a><a href="#aws-resource-init-files">ファイル</a><a href="#aws-resource-init-groups">グループ</a><a href="#aws-resource-init-packages">パッケージ</a><a href="#aws-resource-init-services">サービス</a><a href="#aws-resource-init-sources">[Sources] (出典)</a><a href="#aws-resource-init-users">[ユーザー]</a></div><div id="page-filters" style="display:none"><filter label="All" id="All"></filter><filter label="JSON" id="JSON"></filter><filter label="YAML" id="YAML"></filter></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="aws-resource-init"><code class="code">AWS::CloudFormation::Init</code></h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p><code class="code">AWS::CloudFormation::Init</code> 型を使用して、cfn-init ヘルパースクリプトの Amazon EC2 インスタンスにメタデータを含めます。テンプレートが cfn-init スクリプトを呼び出す場合、スクリプトは <code class="code">AWS::CloudFormation::Init</code> メタデータキーをルートとするリソースメタデータを検索します。cfn-init の詳細については、「<a href="./cfn-init.html">cfn-init</a>」を参照してください。</p><p>cfn-init は、Linux システムのすべてのメタデータの種類をサポートしています。以降のセクションで説明されている条件付きで、Windows のメタデータの種類もサポートしています。</p><p><code class="code">AWS::CloudFormation::Init</code> と cfn-init ヘルパースクリプトの使用例については、<a href="./deploying.applications.html">AWS CloudFormation を使用して Amazon EC2 にアプリケーションをデプロイする</a> をご参照ください。</p><p>cfn-init を使用して Windows スタックを作成する方法の例については、「<a href="./cfn-windows-stacks-bootstrapping.html">AWS CloudFormation Windows スタックのブートストラップ</a>」を参照してください。</p>
      <h2 id="aws-resource-cloudformation-init-syntax">Syntax</h2>

      <p>構成は、いくつかのセクションに分かれています。以下のテンプレートスニペットは、テンプレート内の EC2 インスタンスリソースに cfn-init 用のメタデータをアタッチする方法を示しています。</p>
      <p>メタデータは、設定キーに編成されます。これを configset にグループ化することができます。テンプレートで cfn-init を呼び出すときに、configset を指定できます。configset を指定しない場合、cfn-init は <em>config</em> という設定キーを探します。</p>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注記</h6></div><div class="awsdocs-note-text"><p>cfn-init ヘルパースクリプトは、次の手順でこれらの構成セクションを処理します。パッケージ、グループ、ユーザー、ソース、ファイル、コマンド、そしてサービスの順です。別の順番にする場合は、セクションを別の設定キーに分割し、設定キーが処理される順序を指定する configset を使用します。</p></div></div>

      <div id="JSON" name="JSON" class="section langfilter">
         <h3 id="aws-resource-cloudformation-init-syntax.json">JSON</h3>

         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Resources": <span>{</span>
  "MyInstance": <span>{</span>
    "Type": "AWS::EC2::Instance",
    "Metadata" : <span>{</span>
      "AWS::CloudFormation::Init" : <span>{</span>
        "config" : <span>{</span>
          "packages" : <span>{</span>
            :
          },
          "groups" : <span>{</span>
            :
          },
          "users" : <span>{</span>
            :
          },
          "sources" : <span>{</span>
            :
          },
          "files" : <span>{</span>
            :
          },
          "commands" : <span>{</span>
            :
          },
          "services" : <span>{</span>
            :
          }
        }
      }
    },
    "Properties": <span>{</span>
      :
    }
  }
}</code></pre>
      </div>
      <div id="YAML" name="YAML" class="section langfilter">
         <h3 id="aws-resource-cloudformation-init-syntax.yaml">YAML</h3>

         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Resources: 
  MyInstance: 
    Type: AWS::EC2::Instance
    Metadata: 
      AWS::CloudFormation::Init: 
        config: 
          packages: 
            :
          groups: 
            :
          users: 
            :
          sources: 
            :
          files: 
            :
          commands: 
            :
          services: 
            :
    Properties: 
      :</code></pre>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注記</h6></div><div class="awsdocs-note-text"><p>Amazon EC2 インスタンスの <code class="code">AWS::CloudFormation::Init</code> プロパティを指定するには、<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-init.html#cfn-init-Examples"> Amazon Linux の例</a>を参照してください。</p></div></div>
      </div>
    
      <h2 id="aws-resource-init-configsets">Configset</h2>

      <p>複数の設定キーを作成し、特定の順序で cfn-init によって処理されるようにする場合は、目的の順序で設定キーが含まれている configset を作成します。</p>
       
         <h3 id="w9aac23c15c15c23c13b5">単一の Configset</h3>

         <p>次のテンプレートスニペットは、<code class="code">ascending</code> と <code class="code">descending</code> という configset を作成します。それぞれに、2 つの設定キーが含まれます。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example1.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"AWS::CloudFormation::Init" : <span>{</span>
    "configSets" : <span>{</span>
        "ascending" : [ "config1" , "config2" ],
        "descending" : [ "config2" , "config1" ]
    },
    "config1" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$CFNTEST\" &gt; test.txt",
                "env" : <span>{</span> "CFNTEST" : "I come from config1." },
                "cwd" : "~"
            }
        }
    },
    "config2" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$CFNTEST\" &gt; test.txt",
                "env" : <span>{</span> "CFNTEST" : "I come from config2" },
                "cwd" : "~"
            }
        }
    }
}     </code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example1.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWS::CloudFormation::Init: 
  configSets: 
    ascending: 
      - "config1"
      - "config2"
    descending: 
      - "config2"
      - "config1"
  config1: 
    commands: 
      test: 
        command: "echo \"$CFNTEST\" &gt; test.txt"
        env: 
          CFNTEST: "I come from config1."
        cwd: "~"
  config2: 
    commands: 
      test: 
        command: "echo \"$CFNTEST\" &gt; test.txt"
        env: 
          CFNTEST: "I come from config2"
        cwd: "~"</code></pre>
         </div>
          
            <h4 id="w9aac23c15c15c23c13b5b9">関連した cfn-init の呼び出し</h4>

            <p>次の例は、前の例の configset を参照する cfn-init を呼び出します。例に示した呼び出しは、わかりやすくするために簡略化されています。完全な構文については、「<a href="./cfn-init.html">cfn-init</a>」を参照してください。</p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>cfn-init への呼び出しが <code class="code">ascending</code> configset を指定する場合は、次のようになります。</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c ascending</code></code></pre>
                  <p>スクリプトは <code class="code">config1</code> を処理してから <code class="code">config2</code> を処理し、test.txt ファイルに含まれるテキストは <code class="code">I
                        come from config2</code> になります。</p>
               </li><li class="listitem">
                  <p>cfn-init への呼び出しが <code class="code">descending</code> configset を指定する場合は、次のようになります。</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c descending</code></code></pre>
                  <p>スクリプトは <code class="code">config2</code> を処理してから <code class="code">config1</code> を処理し、test.txt ファイルに含まれるテキストは <code class="code">I
                        come from config1</code> になります。</p>
               </li></ul></div>
          
       
       
         <h3 id="w9aac23c15c15c23c13b7">複数の Configset</h3>

         <p>複数の configset を作成し、これらを cfn-init スクリプトで呼び出すことができます。各 configset には、設定キーや他の configset への参照のリストを含めることができます。たとえば、次のテンプレートスニペットは 3 個の configset を作成します。最初の configset (<code class="code">test1</code>) には、<code class="code">1</code> という名前の設定キーが含まれます。2 つ目の configset (<code class="code">test2</code>) には、<code class="code">test1</code> configset への参照と、<code class="code">2</code> という名前の設定キーが含まれています。3 つ目の configset (デフォルト) には、configset <code class="code">test2</code> への参照が含まれています。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example2.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"AWS::CloudFormation::Init" : <span>{</span>
    "configSets" : <span>{</span>
        "test1" : [ "1" ],
        "test2" : [ <span>{</span> "ConfigSet" : "test1" }, "2" ],
        "default" : [ <span>{</span> "ConfigSet" : "test2" } ]
    },
    "1" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$MAGIC\" &gt; test.txt",
                "env" : <span>{</span> "MAGIC" : "I come from the environment!" },
                "cwd" : "~"
            }
        }
    },
    "2" : <span>{</span>
        "commands" : <span>{</span>
            "test" : <span>{</span>
                "command" : "echo \"$MAGIC\" &gt;&gt; test.txt",
                "env" : <span>{</span> "MAGIC" : "I am test 2!" },
                "cwd" : "~"
            }
        }
    }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-cloudformation-init-configset-example2.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWS::CloudFormation::Init:
  1:
    commands:
      test:
        command: "echo \"$MAGIC\" &gt; test.txt"
        env:
          MAGIC: "I come from the environment!"
        cwd: "~"
  2:
    commands:
      test:
        command: "echo \"$MAGIC\" &gt;&gt; test.txt"
        env:
          MAGIC: "I am test 2!"
        cwd: "~"
  configSets: 
    test1:
      - "1"
    test2:
      -
        ConfigSet: "test1"
      - "2"
    default:
      -
        ConfigSet: "test2"</code></pre>
         </div>
          
            <h4 id="w9aac23c15c15c23c13b7b9">関連した cfn-init の呼び出し</h4>

            <p>以下の cfn-init への呼び出しは、前のテンプレートスニペットで宣言されている configset を参照します。例に示した呼び出しは、わかりやすくするために簡略化されています。完全な構文については、「<a href="./cfn-init.html">cfn-init</a>」を参照してください。</p>
            <div class="itemizedlist">
                
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p><code class="code">test1</code> のみを指定する場合は、次のようになります。</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c test1</code></code></pre>
                  <p>cfn-init は設定キー <code class="code">1</code> のみを処理します。</p>
               </li><li class="listitem">
                  <p><code class="code">test2</code> のみを指定する場合は、次のようになります。</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c test2</code></code></pre>
                  <p>cfn-init は設定キー <code class="code">1</code> を処理し、その後、設定キー <code class="code">2</code> を処理します。</p>
               </li><li class="listitem">
                  <p><code class="code">default</code> configset を指定する (または configset をまったく指定しない) 場合は、次のようになります。</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">cfn-init -c default</code></code></pre>
                  <p>configset <code class="code">test2</code> を指定した場合と同じ動作になります。</p>
               </li></ul></div>
          
       
    
      <h2 id="aws-resource-init-commands">コマンド</h2>

      <p>commands キーを使用すると、EC2 インスタンスでコマンドを実行できます。コマンドは、名前のアルファベット順に処理されます。</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c17b5"><thead>
               <tr>
                  <th>キー</th>
                  <th>必要</th>
                  <th>説明</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>コマンド</p>
                  </td>
                  <td tabindex="-1">必須</td>
                  <td tabindex="-1">
                     <p>実行するコマンドを指定する配列または文字列です。配列を使用する場合、スペース文字をエスケープしたり、コマンドパラメータを引用符で囲んだりする必要はありません。配列を使用して複数のコマンドを指定しないでください。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>env</p>
                  </td>
                  <td tabindex="-1">オプションです。</td>
                  <td tabindex="-1">
                     <p>コマンドの環境変数を設定します。このプロパティは、既存の環境に追加するのではなく、既存の環境を上書きします。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>cwd</p>
                  </td>
                  <td tabindex="-1">オプションです。</td>
                  <td tabindex="-1">
                     <p>作業ディレクトリ。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>test</p>
                  </td>
                  <td tabindex="-1">オプションです。</td>
                  <td tabindex="-1">
                     <p>command キーに指定されているコマンドが cfn-init で実行されるかどうかを決定するテストコマンドです。テストが成功すると、cloud-init はコマンドを実行します。cfn-init スクリプトは、Bash や <code>cmd.exe</code> などのコマンドインタープリタ内でテストを実行します。テストの合否は、インタープリタが返す終了コードによって決まります。</p>
                     <p>Linux の場合、テストを成功するためには、テストコマンドが終了コード <code class="code">0</code> を返す必要があります。Windows の場合、テストコマンドで %ERRORLEVEL% が <code class="code">0</code> として返される必要があります。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>ignoreErrors</p>
                  </td>
                  <td tabindex="-1">オプションです。</td>
                  <td tabindex="-1">
                     <p>コマンドキーに含まれているコマンドが失敗した (非ゼロ値を返した) 場合に cfn-init を実行し続けるかどうかを指定するブール値です。コマンドが失敗しても cfn-init の実行を続ける場合は、<code class="code">true</code> に設定します。コマンドが失敗したら cfn-init の実行を停止する場合は、<code class="code">false</code> に設定します。デフォルト値は <code class="code">false</code> です。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>waitAfterCompletion</p>
                  </td>
                  <td tabindex="-1">オプションです。</td>
                  <td tabindex="-1">
                     <p>Windows システムの場合のみ。コマンドによって再起動が行われる場合に、コマンド終了後にどのぐらい待機するかを指定します (秒単位)。デフォルト値は 60 秒です。値を "forever" にすると、cfn-init が終了し、再起動が完了した後に再開されます。すべてのコマンドを待ちたくない場合、この値を <code class="code">0</code> に設定します。</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="w9aac23c15c15c23c15b7">例</h3>

         <p>次の例では、<code class="code">~/test.txt</code> ファイルが存在しない場合に、スニペットが echo コマンドを呼び出します。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-commands-example.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"commands" : <span>{</span>
    "test" : <span>{</span>
        "command" : "echo \"$MAGIC\" &gt; test.txt",
        "env" : <span>{</span> "MAGIC" : "I come from the environment!" },
        "cwd" : "~",
        "test" : "test ! -e ~/test.txt",
        "ignoreErrors" : "false"
    },
    "test2" : <span>{</span>
        "command" : "echo \"$MAGIC2\" &gt; test2.txt",
        "env" : <span>{</span> "MAGIC2" : "I come from the environment!" },
        "cwd" : "~",
        "test" : "test ! -e ~/test2.txt",
        "ignoreErrors" : "false"
    }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-commands-example.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">commands:
  test:
    command: "echo \"$MAGIC\" &gt; test.txt"
    env:
      MAGIC: "I come from the environment!"
    cwd: "~"
    test: "test ! -e ~/test.txt"
    ignoreErrors: "false"
  test2:
    command: "echo \"$MAGIC2\" &gt; test2.txt"
    env:
      MAGIC2: "I come from the environment!"
    cwd: "~"
    test: "test ! -e ~/test2.txt"
    ignoreErrors: "false"</code></pre>
         </div>
       
    
      <h2 id="aws-resource-init-files">ファイル</h2>

      <p><code class="code">files</code> キーを使用すると、EC2 インスタンス上にファイルを作成できます。内容は、テンプレートにおいてインラインで指定することも、URL から取得することもできます。ファイルは辞書式順序でディスクに書き込まれます。次の表ではサポートされるキーの一覧を示します。</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c19b5"><thead>
               <tr>
                  <th>キー</th>
                  <th>説明</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>content</p>
                  </td>
                  <td tabindex="-1">
                     <p>文字列または適切な書式の JSON オブジェクトです。コンテンツとして JSON オブジェクトを使用すると、JSON はディスク上のファイルに書き込まれます。JSON オブジェクトがディスクに書き込まれる前に、組み込み関数 (<code class="code">Fn::GetAtt</code> や<code class="code">Ref</code> など) が評価されます。シンボリックリンクを作成する場合には、コンテンツとしてシンボリックリンクターゲットを指定します。</p>
                     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注記</h6></div><div class="awsdocs-note-text"><p>シンボリックリンクを作成すると、ヘルパースクリプトによってターゲットファイルのアクセス許可が変更されます。現在、ターゲットファイルのアクセス許可を変更することなくシンボリックリンクを作成することはできません。</p></div></div>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>ソース</p>
                  </td>
                  <td tabindex="-1">
                     <p>ファイルの読み込み元の URL です。このオプションと content キーを一緒に指定することはできません。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>encoding</p>
                  </td>
                  <td tabindex="-1">
                     <p>エンコード形式です。内容が文字列の場合にのみ使用します。source を使用している場合、エンコードは適用されません。</p>
                     <p>有効な値: <code class="code">plain</code> | <code class="code">base64</code></p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>グループ</p>
                  </td>
                  <td tabindex="-1">
                     <p>このファイルの所有グループの名前です。Windows システムではサポートされていません。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>owner (オーナー)</p>
                  </td>
                  <td tabindex="-1">
                     <p>このファイルの所有ユーザーの名前です。Windows システムではサポートされていません。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>mode</p>
                  </td>
                  <td tabindex="-1">
                     <p>このファイルのモードを表す 6 桁の 8 進値です。Windows システムではサポートされていません。最初の 3 桁はシンボリックリンクに使用し、最後の 3 桁は権限の設定に使用します。シンボリックリンクを作成するには、<code class="userinput">120<code class="replaceable">xxx</code></code> を指定します (<code class="code">xxx</code> はターゲットファイルのアクセス許可を定義します)。ファイルのアクセス許可を指定するには、「<code class="userinput">000644</code>」のように後半 3 桁の数字を使用します。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>認証</p>
                  </td>
                  <td tabindex="-1">
                     <p>使用する認証方法の名前です。これはデフォルトの認証を無効にします。<a href="./aws-resource-authentication.html">AWS::CloudFormation::Authentication</a> リソースで定義する認証方法を選択するために、このプロパティを使用できます。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>context</p>
                  </td>
                  <td tabindex="-1">
                     <p><a href="http://mustache.github.io/mustache.5.html" rel="noopener noreferrer" target="_blank"><span>Mustache テンプレート</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>として処理されるファイルのコンテキストを指定します。このキーを使用するには、<a href="https://github.com/defunkt/pystache" rel="noopener noreferrer" target="_blank"><span>pystache</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> に加えて、<code class="code">aws-cfn-bootstrap</code> 1.3-11 以降がインストールされている必要があります。</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="w9aac23c15c15c23c17b7">例</h3>

         <p>以下の例では、インストールの一部として setup.mysql というファイルを作成します。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-setup-mysql.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"files" : <span>{</span>
  "/tmp/setup.mysql" : <span>{</span>
    "content" : <span>{</span> "Fn::Join" : ["", [
      "CREATE DATABASE ", <span>{</span> "Ref" : "DBName" }, ";\n",
      "CREATE USER '", <span>{</span> "Ref" : "DBUsername" }, "'@'localhost' IDENTIFIED BY '",
                       <span>{</span> "Ref" : "DBPassword" }, "';\n",
      "GRANT ALL ON ", <span>{</span> "Ref" : "DBName" }, ".* TO '", <span>{</span> "Ref" : "DBUsername" },
                       "'@'localhost';\n",
      "FLUSH PRIVILEGES;\n"
      ]]},
    "mode"  : "000644",
    "owner" : "root",
    "group" : "root"
  }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-setup-mysql.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">files: 
  /tmp/setup.mysql: 
    content: !Sub |
      CREATE DATABASE $<span>{</span>DBName};
      CREATE USER '$<span>{</span>DBUsername}'@'localhost' IDENTIFIED BY '$<span>{</span>DBPassword}';
      GRANT ALL ON $<span>{</span>DBName}.* TO '$<span>{</span>DBUsername}'@'localhost';
      FLUSH PRIVILEGES;
    mode: "000644"
    owner: "root"
    group: "root"</code></pre>
         </div>
         <p>すべてのテンプレートは <a href="https://s3.amazonaws.com/cloudformation-templates-us-east-1/Drupal_Single_Instance.template" rel="noopener noreferrer" target="_blank"><span>https://s3.amazonaws.com/cloudformation-templates-us-east-1/Drupal_Single_Instance.template</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> で入手できます。</p>
         <p>次のサンプルスニペットでは、既存のファイル <code class="code">/tmp/myfile2.txt</code> をポイントするシンボリックリンク <code class="code">/tmp/myfile1.txt</code> を作成します。ターゲットファイル <code class="code">/tmp/myfile1.txt</code> のアクセス許可は、モード値 <code class="code">644</code> によって定義されます。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-symlink.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"files" : <span>{</span>
  "/tmp/myfile2.txt" : <span>{</span>
    "content" : "/tmp/myfile1.txt",
    "mode" : "120644"
  }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-symlink.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">files:
  /tmp/myfile2.txt:
    content: "/tmp/myfile1.txt"
    mode: "120644"</code></pre>
         </div>
         <p>Mustache テンプレートは、構成ファイルを作成するために主に使用されます。たとえば、<a href="./intrinsic-function-reference-join.html">Fn::Join</a> を使用する代わりに、S3 バケットに構成ファイルを保存して、テンプレートから Refs と GetAtts を挿入できます。次のサンプルスニペットでは、「Content for test9」を <code>/tmp/test9.txt</code> に出力します。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-test9.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">
"files" : <span>{</span>
    "/tmp/test9.txt" : <span>{</span>
        "content" : "Content for <span>{</span><span>{</span>name}}",
        "context" : <span>{</span> "name" : "test9" }
    }
} </code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-test9.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">files:
  /tmp/test9.txt:
    content: "Content for <span>{</span><span>{</span>name}}"
    context:
      name: "test9"</code></pre>
         </div>
         <p>Mustache テンプレートを使用する場合、次の点に注意してください。</p>
         <div class="itemizedlist">
             
             
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>ファイルが処理されるには、コンテキストキーが存在する必要があります。</p>
            </li><li class="listitem">
               <p>コンテキストキーは、キーと値のマッピングである必要がありますが、入れ子にすることができます。</p>
            </li><li class="listitem">
               <p>コンテンツキーを使用してインラインコンテンツを含むファイルを処理し、ソースキーを使用してリモートファイルを処理できます。</p>
            </li><li class="listitem">
               <p>Mustache サポートは、pystache のバージョンによって決まります。バージョン 0.5.2 は、<a href="https://github.com/mustache/spec/tree/v1.1.2" rel="noopener noreferrer" target="_blank"><span>Mustache 1.1.2 仕様</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>をサポートします。</p>
            </li></ul></div>
       
    
      <h2 id="aws-resource-init-groups">グループ</h2>

      <p>groups キーを使用すると、Linux/UNIX グループを作成して、グループ ID を割り当てることができます。groups キーは Windows システムではサポートされません。</p>
      <p>グループを作成するには、新しいグループ名をオプションのグループ ID に関連付ける新しいキーと値のペアを追加します。groups キーでは、1 つまたは複数のグループ名を指定できます。次の表では使用できるキーの一覧を示します。</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c21b7"><thead>
               <tr>
                  <th>キー</th>
                  <th>説明</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>
                        <code class="code">gid</code></p>
                  </td>
                  <td tabindex="-1">
                     <p>グループ ID 番号です。</p>
                     <p>グループ ID を指定し、同じ名前のグループが既に存在する場合、グループの作成は失敗します。指定したグループ ID が別のグループに割り当てられている場合、OS はグループの作成を拒否することがあります。</p>
                     <p>例：<code class="code"><span>{</span> "gid" : "23" }</code></p>
                  </td>
               </tr>
            </table></div></div>
      
       
         <h3 id="aws-resource-init-groups-snippet">例</h3>

         <p>次の例では、<code class="code">groupOne</code> という名前のグループをグループ ID なしで指定し、<code class="code">groupTwo</code> という名前のグループをグループ ID 値 <code class="code">45</code> で指定しています。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-groups-snippet.json">JSON</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"groups" : <span>{</span>
    "groupOne" : <span>{</span>},
    "groupTwo" : <span>{</span> "gid" : "45" }
}</code></pre>
         </div>
         
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-groups-snippet.yaml">YAML</h4>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">groups:
  groupOne: <span>{</span>}
  groupTwo:
    gid: "45"</code></pre>
         </div>
       
    
      <h2 id="aws-resource-init-packages">パッケージ</h2>

      <p>パッケージキーを使用して、パッケージ済みのアプリケーションとコンポーネントをダウンロードしてインストールできます。Windows システムでは、パッケージキーは MSI インストーラのみをサポートします。</p>
       
         <h3 id="aws-resource-init-packages-formats">サポートされるパッケージ形式</h3>

         <p>cfn-init スクリプトで現在サポートされているパッケージ形式は、apt、msi、python、rpm、rubygems、yum および Zypper です。パッケージは、rpm、yum/apt/zypper、rubygems、python の順序で処理されます。rubygems と python の間に順序はなく、各パッケージマネージャー内のパッケージのインストール順序に保証はありません。</p>
       
       
         <h3 id="aws-resource-init-packages-versions">バージョンの指定</h3>

         <p>各パッケージマネージャ内では、各パッケージはパッケージ名およびバージョンのリストとして指定されます。バージョンは、文字列、バージョンのリスト、あるいは空の文字列またはリストのいずれでもかまいません。空の文字列またはリストは、最新バージョンを指定することを示します。rpm マネージャの場合、バージョンはディスク上のファイルへのパスまたは URL として指定します。</p>
         <p>パッケージのバージョンを指定した場合は、それより新しいバージョンのパッケージがインスタンスに既にインストールされていたとしても、指定されたバージョンのインストールが試みられます。パッケージマネージャには、複数のバージョンをサポートするものと、サポートしないものがあります。詳細については、パッケージマネージャのドキュメントを検証してください。バージョンを指定せず、あるバージョンのパッケージが既にインストールされている場合は、cfn-init スクリプトは新しいバージョンをインストールしません—ユーザーが既存のバージョンを維持して使用することを望んでいるものと想定します。</p>
       
       
         <h3 id="aws-resource-init-packages-snippet">例</h3>

          
            <h4 id="w9aac23c15c15c23c21b9b3">RPM、yum、Rubygems および Zypper</h4>

            <p>次の例では、rpm のバージョン URL を指定し、yum および Zypper から最新のバージョンを要求し、rubygems から chef のバージョン 0.10.2 を要求しています。</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-packages-example1.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"rpm" : <span>{</span>
  "epel" : "http://download.fedoraproject.org/pub/epel/5/i386/epel-release-5-4.noarch.rpm"
},
"yum" : <span>{</span>
  "httpd" : [],
  "php" : [],
  "wordpress" : []
},
"rubygems" : <span>{</span>
  "chef" : [ "0.10.2" ]
},
"zypper" : <span>{</span>
  "git" : []
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-packages-example1.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">rpm:
  epel: "http://download.fedoraproject.org/pub/epel/5/i386/epel-release-5-4.noarch.rpm"
yum:
  httpd: []
  php: []
  wordpress: []
rubygems:
  chef:
    - "0.10.2"
zypper:
  git: []</code></pre>
            </div>
          
          
            <h4 id="w9aac23c15c15c23c21b9b5">MSI パッケージ</h4>

            <p>次のスニペットは、MSI パッケージの URL を指定します。</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-packages-example2.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"msi" : <span>{</span>
  "awscli" : "https://s3.amazonaws.com/aws-cli/AWSCLI64.msi"
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-packages-example2.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">msi:
  awscli: "https://s3.amazonaws.com/aws-cli/AWSCLI64.msi"</code></pre>
            </div>
          
       
    
      <h2 id="aws-resource-init-services">サービス</h2>

      <p>services キーを使用すると、インスタンスが起動されるときに有効化または無効化する必要のあるサービスを定義できます。Linux システムでは、このキーは sysvinit または systemd を使用してサポートされています。Windows システムでは、Windows サービスマネージャーを使用してサポートされています。</p>
      <p>また、services キーではソース、パッケージ、ファイルへの依存関係も指定でき、インストールされているファイルのために再起動が必要になった場合に、cfn-init がサービスの再起動を処理します。たとえば、Apache HTTP Server パッケージをダウンロードする場合は、スタックの作成プロセス中にパッケージインストールが自動的に Apache HTTP Server を起動します。ただし、Apache HTTP Server 構成がスタック作成プロセスの後の方で更新されると、その更新は Apache サーバーが再起動されなければ有効になりません。Apache HTTP サービスが必ず再起動されるようにするために services キーを使用できます。</p>
      <p>次の表ではサポートされるキーの一覧を示します。</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c25b9"><thead>
               <tr>
                  <th>キー</th>
                  <th>説明</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>ensureRunning</p>
                  </td>
                  <td tabindex="-1">
                     <p>true に設定すると、cfn-init が終了した後でサービスが実行されます。</p>
                     <p>false に設定すると、cfn-init が終了した後でサービスが実行されません。</p>
                     <p>このキーを省略すると、サービスの状態は変更されません。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>有効</p>
                  </td>
                  <td tabindex="-1">
                     <p>true に設定すると、起動時にサービスが自動的に開始されます。</p>
                     <p>false に設定すると、起動時にサービスが自動的に開始されません。</p>
                     <p>このキーを省略すると、このプロパティは変更されません。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>ファイル</p>
                  </td>
                  <td tabindex="-1">
                     <p>ファイルのリストです。cfn-init がファイルブロックを通じていずれかを直接変更する場合、このサービスは再起動されます。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>sources</p>
                  </td>
                  <td tabindex="-1">
                     <p>ディレクトリのリストです。cfn-init がこれらのディレクトリの 1 つにアーカイブを展開する場合、このサービスは再起動されます。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>パッケージ</p>
                  </td>
                  <td tabindex="-1">
                     <p>パッケージ名のリストに対するパッケージマネージャのマップです。cfn-init がこれらのパッケージの 1 つをインストールまたは更新する場合、このサービスは再起動されます。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>commands</p>
                  </td>
                  <td tabindex="-1">
                     <p>コマンド名のリストです。cfn-init が指定したコマンドを実行する場合、このサービスは再開されます。</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="w9aac23c15c15c23c23c11">例</h3>

          
            <h4 id="w9aac23c15c15c23c23c11b3">Linux</h4>

            <p>次に示す Linux スニペットは次のようにサービスを設定します。</p>
            <div class="itemizedlist">
                
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>cfn-init によって <code class="code">/etc/nginx/nginx.conf</code> または <code class="code">/var/www/html</code> が変更された場合、nginx サービスは再起動されます。</p>
               </li><li class="listitem">
                  <p>php-fastcgi サービスは、cfn-init が yum を使用して php または spawn-fcgi をインストールまたは更新する場合、再起動されます。</p>
               </li><li class="listitem">
                  <p>systemd を使用して sendmail サービスは停止され、無効になります。</p>
               </li></ul></div>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-services-example1.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"services" : <span>{</span>
  "sysvinit" : <span>{</span>
    "nginx" : <span>{</span>
      "enabled" : "true",
      "ensureRunning" : "true",
      "files" : ["/etc/nginx/nginx.conf"],
      "sources" : ["/var/www/html"]
    },
    "php-fastcgi" : <span>{</span>
      "enabled" : "true",
      "ensureRunning" : "true",
      "packages" : <span>{</span> "yum" : ["php", "spawn-fcgi"] }
    }
  },
  "systemd": <span>{</span>
    "sendmail" : <span>{</span>
      "enabled" : "false",
      "ensureRunning" : "false"
    }
  }
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-services-example1.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">services:
  sysvinit:
    nginx:
      enabled: "true"
      ensureRunning: "true"
      files:
        - "/etc/nginx/nginx.conf"
      sources:
        - "/var/www/html"
    php-fastcgi:
      enabled: "true"
      ensureRunning: "true"
      packages:
        yum:
          - "php"
          - "spawn-fcgi"
  systemd:
    sendmail:
      enabled: "false"
      ensureRunning: "false"</code></pre>
               <p>サービスで systemd を使用するには、サービスに systemd ユニットファイルが設定されている必要があります。次のユニットファイルにより、systemd はマルチユーザーサービスターゲットの <a href="./cfn-hup.html">cfn-hup</a> デーモンを開始および停止します。</p>
                  
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="conf ">[Unit]
Description=cfn-hup daemon
[Service]
ExecStart=/usr/bin/cfn-hup -v
PIDFile=/var/run/cfn-hup.pid
[Install]
WantedBy=multi-user.target</code></pre>
               <p>この構成は、cfn-hup が /usr/bin/ ディレクトリにインストールされていることを想定しています。ただし、cfn-hup がインストールされている実際の場所は、プラットフォームによって異なる可能性があります。/etc/systemd/system/cfn-hup.service.d/override.conf にオーバーライドファイルを作成することにより、この構成を以下のようにオーバーライドできます。</p>
                  
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="conf "># In this example, cfn-hup executable is available under /usr/local/bin
[Service]
ExecStart=
ExecStart=/usr/local/bin/cfn-hup -v</code></pre>
            </div>
          
          
            <h4 id="aws-resource-init-windows-example">Windows</h4>

            <p>次の Windows スニペットは、<a href="./cfn-hup.html">cfn-hup</a> サービスを開始し、それを自動に設定します。指定された構成ファイルを <code class="code">cfn-init</code> が変更する場合は、サービスを再起動します。</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-services-example2.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"services" : <span>{</span>
  "windows" : <span>{</span>
    "cfn-hup" : <span>{</span>
      "enabled" : "true",
      "ensureRunning" : "true",
      "files" : ["c:\\cfn\\cfn-hup.conf", "c:\\cfn\\hooks.d\\cfn-auto-reloader.conf"]
    }
  }
}</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-services-example2.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">services:
  windows:
    cfn-hup:
      enabled: "true"
      ensureRunning: "true"
      files:
        - "c:\\cfn\\cfn-hup.conf"
        - "c:\\cfn\\hooks.d\\cfn-auto-reloader.conf"</code></pre>
            </div>
          
       
    
      <h2 id="aws-resource-init-sources">[Sources] (出典)</h2>

      <p>sources キーを使用すると、アーカイブファイルをダウンロードし、EC2 インスタンス上のターゲットディレクトリに解凍できます。このキーは Linux と Windows の両方のシステムで完全にサポートされています。</p>
       
         <h6>サポートされる形式</h6>
         <p>サポートされる形式:</p>
       
      <div class="itemizedlist">
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><code class="code">tar</code></p>
         </li><li class="listitem">
            <p><code class="code">tar+gzip</code></p>
         </li><li class="listitem">
            <p><code class="code">tar+bz2</code></p>
         </li><li class="listitem">
            <p><code class="code">zip</code></p>
         </li></ul></div>
     
         <h3 id="aws-resource-init-sources-examples">例</h3>
      
            <h4 id="aws-resource-init-sources-examples-github">GitHub</h4>
            <p>ソース管理システムとして GitHub を使用する場合は、cfn-init とソースパッケージメカニズムを使用して、アプリケーションの特定のバージョンを取得します。GitHub では次のように URL を通じて特定のバージョンから .zip または .tar を作成することができます。</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="text ">https://github.com/&lt;your directory&gt;/(zipball|tarball)/&lt;version&gt;</code></pre>
            <p>例えば、次のスニペットはバージョン <em>main</em> を <code>.tar</code> ファイルとして取り出します。</p>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-sources-example1.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"sources" : <span>{</span>
  "/etc/puppet" : "https://github.com/user1/cfn-demo/tarball/main"
  }</code></pre>
            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-sources-example1.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">sources:
  /etc/puppet: "https://github.com/user1/cfn-demo/tarball/main"</code></pre>
            </div>
          
      
            <h4 id="aws-resource-init-sources-examples-s3">S3 バケット</h4>
            <p>次の例では、S3 バケットからを tarball をダウンロードし、<code class="code">/etc/myapp</code> に解凍しています。</p>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注記</h6></div><div class="awsdocs-note-text"><p>ソースの認証情報を使用できます。ただし、ソースブロックに認証キーを格納することはできません。代わりに、<code class="code">S3AccessCreds</code> ブロックにバケットキーを含めます。Amazon S3 認証情報の詳細については、「<a href="./aws-resource-authentication.html">AWS::CloudFormation::Authentication</a>」を参照してください。</p><p><span>例については、「<a href="https://s3.amazonaws.com/cloudformation-templates-us-east-1/S3Bucket_SourceAuth.template" rel="noopener noreferrer" target="_blank"><span>サンプルテンプレート</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>」を参照してください。</span></p></div></div>
            <div id="JSON" name="JSON" class="section langfilter">
               <h5 id="aws-resource-init-sources-example2.json">JSON</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"sources" : <span>{</span>
  "/etc/myapp" : "https://s3.amazonaws.com/mybucket/myapp.tar.gz"
  }</code></pre>
               
               
               

            </div>
            <div id="YAML" name="YAML" class="section langfilter">
               <h5 id="aws-resource-init-sources-example2.yaml">YAML</h5>

               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">sources:
  /etc/myapp: "https://s3.amazonaws.com/mybucket/myapp.tar.gz"</code></pre>
               
               
               


            </div>
          
       
    
      <h2 id="aws-resource-init-users">[ユーザー]</h2>

      <p>users キーを使用すると、Linux/UNIX ユーザーを EC2 インスタンス上に作成できます。users キーは Windows システムではサポートされません。</p>
      <p>次の表ではサポートされるキーの一覧を示します。</p>
      <div class="table-container"><div class="table-contents"><table id="w1348aac17c17c17c19c29b7"><thead>
               <tr>
                  <th>キー</th>
                  <th>説明</th>
               </tr>
            </thead>
               <tr>
                  <td tabindex="-1">
                     <p>uid</p>
                  </td>
                  <td tabindex="-1">
                     <p>ユーザー ID です。異なるユーザー ID で同じユーザー名が存在した場合、作成処理は失敗します。ユーザー ID が既存のユーザーに既に割り当てあれている場合、オペレーティングシステムは作成要求を拒否することがあります。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>グループ</p>
                  </td>
                  <td tabindex="-1">
                     <p>グループ名のリストです。ユーザーはリスト内の各グループに追加されます。</p>
                  </td>
               </tr>
               <tr>
                  <td tabindex="-1">
                     <p>homeDir</p>
                  </td>
                  <td tabindex="-1">
                     <p>ユーザーのホームディレクトリです。</p>
                  </td>
               </tr>
            </table></div></div>
       
         <h3 id="aws-resource-init-users-example">例</h3>

         <p>ユーザーは、<code class="code">/sbin/nologin</code> のシェルで非対話形式のシステムユーザーとして作成されます。これは設計によるものであり、変更できません。</p>
         <div id="JSON" name="JSON" class="section langfilter">
            <h4 id="aws-resource-init-users-example.json">JSON</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"users" : <span>{</span>
    "myUser" : <span>{</span>
        "groups" : ["groupOne", "groupTwo"],
        "uid" : "50",
        "homeDir" : "/tmp"
    }
}</code></pre>
         </div>
         <div id="YAML" name="YAML" class="section langfilter">
            <h4 id="aws-resource-init-users-example.yaml">YAML</h4>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">users:
  myUser:
    groups:
      - "groupOne"
      - "groupTwo"
    uid: "50"
    homeDir: "/tmp"</code></pre>
         </div>
       
   <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>ブラウザで JavaScript が無効になっているか、使用できません。</strong></p><p>AWS ドキュメントを使用するには、JavaScript を有効にする必要があります。手順については、使用するブラウザのヘルプページを参照してください。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">ドキュメントの表記規則</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./aws-resource-authentication.html">AWS::CloudFormation::Authentication</div><div id="next" class="next-link" accesskey="n" href="./aws-resource-cloudformation-interface.html">AWS::CloudFormation::Interface</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">このページは役に立ちましたか? - はい</div><div class="content"><p>ページが役に立ったことをお知らせいただき、ありがとうございます。</p><p>お時間がある場合は、何が良かったかお知らせください。今後の参考にさせていただきます。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="フィードバック" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">このページは役に立ちましたか? - いいえ</div><div class="content"><p>このページは修正が必要なことをお知らせいただき、ありがとうございます。ご期待に沿うことができず申し訳ありません。</p><p>お時間がある場合は、ドキュメントを改善する方法についてお知らせください。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="フィードバック" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-init.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>