<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Atualizar uma visualização materializada - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="materialized-view-refresh" /><meta name="default_state" content="materialized-view-refresh" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-refresh.html" /><meta name="description" content="Atualize os dados em uma visão materializada usando REFRESH." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guia do desenvolvedor de banco de dados" /><meta name="abstract" content="Crie e gerencie um data warehouse com o Amazon Redshift, um serviço de data warehouse totalmente gerenciado, em escala de petabyte e de nível empresarial." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-refresh.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/materialized-view-refresh.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/materialized-view-refresh.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/materialized-view-refresh.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/materialized-view-refresh.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-refresh.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-refresh.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/materialized-view-refresh.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/materialized-view-refresh.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-refresh.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/materialized-view-refresh.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/materialized-view-refresh.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/materialized-view-refresh.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/materialized-view-refresh.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/materialized-view-refresh.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/materialized-view-refresh.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/materialized-view-refresh.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-refresh.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-refresh.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/materialized-view-refresh.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/materialized-view-refresh.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/materialized-view-refresh.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guia do desenvolvedor de banco de dados" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guia do desenvolvedor de banco de dados" /><meta id="panorama-serviceConsolePage" value="Atualizar uma visualização materializada" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Atualizar uma visualização materializada - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#materialized-view-refresh" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-refresh.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-refresh.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-refresh.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,desenvolvedor,dados de amostra,banco de dados,desenvolvedor do banco de dados,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do desenvolvedor de banco de dados",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Criar visualizações materializadas no Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-overview.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Atualizar uma visualização materializada",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-overview.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#materialized-view-refresh" target="_blank" rel="noopener noreferrer" title="Abrir em PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guia do desenvolvedor de banco de dados</a></div><div id="page-toc-src"><a href="#materialized-view-auto-refresh">Atualizar automaticamente uma visualização materializada</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="materialized-view-refresh">Atualizar uma visualização materializada</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Quando você cria uma visualização materializada, seu conteúdo reflete o estado da tabela ou das tabelas do banco de dados subjacente na ocasião. Os dados da visualização materializada permanecem inalterados, mesmo quando as aplicações fazem alterações nos dados nas tabelas subjacentes. Para atualizar os dados na visão materializada, você pode usar a instrução <code class="code">REFRESH MATERIALIZED VIEW</code> a qualquer momento para atualizar manualmente as visões materializadas. Ao usar essa instrução, o Amazon Redshift identifica as alterações que ocorreram na tabela ou tabelas base e aplica essas alterações à visão materializada.</p><p>O Amazon Redshift tem duas estratégias para atualizar uma visão materializada: </p><div class="itemizedlist">
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>Em muitos casos, o Amazon Redshift pode realizar uma atualização incremental. Em uma <em>atualização incremental</em>, o Amazon Redshift identifica rapidamente as alterações nos dados nas tabelas de base desde a última atualização e atualiza os dados na visão materializada. A atualização incremental é compatível com as seguintes construções SQL usadas na consulta ao definir a visualização materializada:</p>
                <div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Construções que contêm as cláusulas SELECT, FROM, [INNER] JOIN, WHERE, GROUP BY ou HAVING.</p>
                    </li><li class="listitem">
                        <p>Construções que contêm agregações, como SUM, MIN, MAX, AVG e COUNT.</p>
                    </li><li class="listitem">
                        <p>A maioria das funções SQL integradas, especificamente aquelas que são imutáveis, visto que têm os mesmos argumentos de entrada e sempre produzem a mesma saída. </p>
                    </li></ul></div>
                <p>A atualização incremental também é compatível para uma visão materializada baseada em uma tabela da unidade de compartilhamento de dados.</p>
            </li><li class="listitem">
                <p>Se uma atualização incremental não for possível, o Amazon Redshift executa uma atualização completa. Uma <em>atualização total</em> executa novamente a instrução SQL subjacente substituindo todos os dados na visualização materializada.</p>
            </li><li class="listitem">
                <p>O Amazon Redshift seleciona automaticamente o método de atualização para uma visão materializada, dependendo da consulta SELECT usada para defini-la. </p>
            </li></ul></div><p>Atualizar uma visão materializada em uma visão materializada não é um processo em cascata. Em outras palavras, suponha que você tenha uma visão materializada A que depende da visão materializada B. Neste caso, quando o REFRESH MATERIALIZED VIEW A é invocado, A é atualizado usando a versão atual de B, mesmo quando B está desatualizado. Para atualizar A totalmente, antes de atualizar A, primeiro atualize B em uma transação separada.</p><p>O exemplo a seguir mostra como criar um plano de atualização completo para uma visualização materializada programaticamente. Para atualizar a visualização materializada v, primeiro atualize a visualização materializada u. Para atualizar a visualização materializada w, primeiro atualize a visualização materializada u e, em seguida, a visualização materializada v.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE t(a INT);
CREATE MATERIALIZED VIEW u AS SELECT * FROM t;
CREATE MATERIALIZED VIEW v AS SELECT * FROM u;
CREATE MATERIALIZED VIEW w AS SELECT * FROM v;

WITH RECURSIVE recursive_deps (mv_tgt, lvl, mv_dep) AS
( SELECT trim(name) as mv_tgt, 0 as lvl, trim(ref_name) as mv_dep
  FROM stv_mv_deps
  UNION ALL
  SELECT R.mv_tgt, R.lvl+1 as lvl, trim(S.ref_name) as mv_dep
  FROM stv_mv_deps S, recursive_deps R
  WHERE R.mv_dep = S.name
)

SELECT mv_tgt, mv_dep from recursive_deps
ORDER BY mv_tgt, lvl DESC;

 mv_tgt | mv_dep
--------+--------
 v      | u
 w      | u
 w      | v
(3 rows)</code></pre><p>O exemplo a seguir mostra uma mensagem informativa quando você executa REFRESH MATERIALIZED VIEW em uma visualização materializada que depende de uma visualização materializada desatualizada.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create table a(a int);</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create materialized view b as select * from a;</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create materialized view c as select * from b;</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">insert into a values (1);</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">refresh materialized view c;

INFO:  Materialized view c is already up to date.  However, it depends on another materialized view that is not up to date.</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">REFRESH MATERIALIZED VIEW b;
INFO:  Materialized view b was incrementally updated successfully.</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">REFRESH MATERIALIZED VIEW c;
INFO:  Materialized view c was incrementally updated successfully.</code></pre><p>No momento, o Amazon Redshift tem as limitações a seguir para atualização incremental de visualizações materializadas. </p><p>O Amazon Redshift não oferece suporte à atualização incremental para visualizações materializadas que são definidas com uma consulta usando os seguintes elementos SQL:</p><div class="itemizedlist">
                 
                 
                 
                 
                
                 
                 

                 

                 
                
            <ul class="itemizedlist"><li class="listitem">
                    <p>OUTER JOIN (RIGHT, LEFT ou FULL).</p></li><li class="listitem">
                    <p>As operações definidas UNION, INTERSECT, EXCEPT e MINUS.</p></li><li class="listitem">
                    <p>As funções de agregação MEDIAN, PERCENTILE_CONT, LISTAGG, STDDEV_SAMP, STDDEV_POP, APPROXIMATE COUNT e APPROXIMATE PERCENTILE e funções de agregação bit a bit.</p>
                    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>As funções agregadas COUNT, SUM e AVG são aceitas.</p></div></div>
                </li><li class="listitem">
                    <p>Funções agregadas DISTINCT, como DISTINCT COUNT, DISTINCT SUM e assim por diante.</p></li><li class="listitem"><p>Funções de janela.</p></li><li class="listitem"><p>Uma consulta que usa tabelas temporárias para otimização de consultas, como para otimizar subexpressões comuns.</p></li><li class="listitem"><p>Subconsultas.</p></li><li class="listitem">
                    <p>Tabelas externas referenciando os formatos a seguir na consulta que define a visão materializada. </p>
                    <div class="itemizedlist">
                         
                         
                    <ul class="itemizedlist"><li class="listitem">
                            <p> Delta Lake </p>
                        </li><li class="listitem">
                            <p> Hudi </p>
                        </li></ul></div>
                    <p>A atualização incremental é compatível na faixa de visualização para visões materializadas definidas usando formatos diferentes dos listados acima. Para obter mais informações sobre como configurar clusters de visualização, consulte <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-console.html#cluster-preview">Creating a preview cluster</a> no <em>Guia de gerenciamento do Amazon Redshift</em>. Para obter mais informações sobre como configurar grupos de trabalho de visualização, consulte <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/serverless-workgroup-preview.html">Creating a preview workgroup</a> no <em>Guia de gerenciamento do Amazon Redshift</em>. </p>
                </li></ul></div>
            <h2 id="materialized-view-auto-refresh">Atualizar automaticamente uma visualização materializada</h2>
        <p>O Amazon Redshift pode atualizar automaticamente as visualizações materializadas com dados atualizados de suas tabelas base quando as visualizações materializadas são criadas ou alteradas para ter a opção de atualização automática. O Amazon Redshift atualiza automaticamente as visualizações materializadas o mais rápido possível após as alterações nas tabelas base.</p>
            <p>Para concluir a atualização das visualizações materializadas mais importantes com impacto mínimo nos workloads ativos em seu cluster, o Amazon Redshift considera vários fatores. Esses fatores incluem a carga atual do sistema, os recursos necessários para atualização, os recursos de cluster disponíveis e a frequência com que as visualizações materializadas são usadas. </p>
            <p>O Amazon Redshift prioriza suas workloads sobre a atualização automática e pode interromper a atualização automática para preservar a performance da workload do usuário. Essa abordagem pode atrasar a atualização de algumas visualizações materializadas. Em alguns casos, você precisará de um comportamento de atualização mais determinístico para as visualizações materializadas. Nesse caso, considere usar a atualização manual conforme descrito em <a href="./materialized-view-refresh-sql-command.html">REFRESH MATERIALIZED VIEW</a> ou atualização programada usando as operações da API do programador do Amazon Redshift ou o console.</p>
        <p>Você pode definir a atualização automática para visualizações materializadas usando CREATE MATERIALIZED VIEW. Você também pode usar a cláusula AUTO REFRESH para atualizar visualizações materializadas automaticamente. Para obter mais informações sobre como criar visualizações materializadas, consulte <a href="./materialized-view-create-sql-command.html">CREATE MATERIALIZED VIEW</a>. Você pode ativar a atualização automática para uma visualizações materializada atual usando <a href="./r_ALTER_MATERIALIZED_VIEW.html">ALTER MATERIALIZED VIEW</a>.</p>
      
            <p>Considere o seguinte ao atualizar visualizações materializadas:</p>
            <div class="itemizedlist">
                 

             
             
                 
            <ul class="itemizedlist"><li class="listitem"><p>Você ainda pode atualizar uma visualizações materializada explicitamente usando o comando REFRESH MATERIALIZED VIEW mesmo que não tenha ativado a renovação automática para a visualizações materializada.</p></li><li class="listitem"><p>O Amazon Redshift não atualiza automaticamente as visualizações materializadas definidas em tabelas externas.</p></li><li class="listitem"><p>Para status de atualização, você pode verificar SVL_MV_REFRESH_STATUS, que registra consultas iniciadas pelo usuário ou atualizadas automaticamente. </p></li><li class="listitem"><p>Para executar REFRESH em exibições materializadas somente recomputadas, certifique-se de que você tenha a permissão CREATE em esquemas. Para obter mais informações, consulte <a href="./r_GRANT.html">GRANT</a>.</p></li></ul></div>
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./materialized-view-auto-rewrite.html">Regravação automática de consulta para usar visualizações materializadas</div><div id="next" class="next-link" accesskey="n" href="./materialized-view-auto-mv.html">Visualizações materializadas automatizadas</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-refresh.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/materialized-view-refresh.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>