<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>STL_QUERY - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_STL_QUERY" /><meta name="default_state" content="r_STL_QUERY" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_STL_QUERY.html" /><meta name="description" content="Retorna as informações de execução de uma consulta de banco de dados." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guia do desenvolvedor de banco de dados" /><meta name="abstract" content="Crie e gerencie um data warehouse com o Amazon Redshift, um serviço de data warehouse totalmente gerenciado, em escala de petabyte e de nível empresarial." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_STL_QUERY.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_STL_QUERY.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_STL_QUERY.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_STL_QUERY.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_STL_QUERY.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_STL_QUERY.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_STL_QUERY.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_STL_QUERY.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_STL_QUERY.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_STL_QUERY.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_STL_QUERY.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_STL_QUERY.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_STL_QUERY.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_STL_QUERY.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_STL_QUERY.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_STL_QUERY.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_STL_QUERY.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_STL_QUERY.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_STL_QUERY.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_STL_QUERY.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_STL_QUERY.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_STL_QUERY.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guia do desenvolvedor de banco de dados" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guia do desenvolvedor de banco de dados" /><meta id="panorama-serviceConsolePage" value="STL_QUERY" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>STL_QUERY - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_STL_QUERY" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_STL_QUERY.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_STL_QUERY.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_STL_QUERY.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,desenvolvedor,dados de amostra,banco de dados,desenvolvedor do banco de dados,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do desenvolvedor de banco de dados",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Referência de visualizações e tabelas do sistema",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/cm_chap_system-tables.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Monitoramento do sistema (somente provisionado)",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_intro_system_views.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Visualizações STL de registro em log",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_intro_STL_tables.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "STL_QUERY",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_intro_STL_tables.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_STL_QUERY" target="_blank" rel="noopener noreferrer" title="Abrir em PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guia do desenvolvedor de banco de dados</a></div><div id="page-toc-src"><a href="#sub-r_STL_QUERY-table-columns">Colunas da tabela</a><a href="#r_STL_QUERY-sample-queries">Consultas de exemplo</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="r_STL_QUERY">STL_QUERY</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Retorna as informações de execução de uma consulta de banco de dados.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>As visualizações STL_QUERY e STL_QUERYTEXT contêm apenas informações sobre consultas, não outro utilitário e comandos DDL. Para obter uma lista e informações sobre todas as instruções executadas pelo Amazon Redshift, também é possível consultar as visualizações STL_DDLTEXT e STL_UTILITYTEXT. Para obter uma lista completa de todas as instruções executadas pelo Amazon Redshift, é possível consultar a visualização SVL_STATEMENTTEXT.</p></div></div><p>Para gerenciar o espaço em disco, as visualizações de log STL retêm aproximadamente dois a cinco dias de histórico de log, dependendo do uso do log e do espaço em disco disponível. Se quiser reter os dados de log, você precisará copiá-los periodicamente para outras tabelas ou descarregá-los no Amazon S3.</p><p>STL_QUERY permanece visível para todos os usuários. Os superusuários podem ver todas as linhas; usuários regulares podem ver somente seus próprios dados. Para obter mais informações, consulte <a href="./cm_chap_system-tables.html#c_visibility-of-data">Visibilidade de dados em tabelas e visualizações de sistema</a>.</p><p>Alguns ou todos os dados nessa tabela também podem ser encontrados na exibição de monitoramento SYS <a href="./SYS_QUERY_HISTORY.html">SYS_QUERY_HISTORY</a>. Os dados na exibição de monitoramento SYS são formatados para serem mais fáceis de usar e compreender. É recomendável usar a exibição de monitoramento SYS nas consultas.</p>
            <h2 id="sub-r_STL_QUERY-table-columns">Colunas da tabela</h2>


            <div class="table-container"><div class="table-contents"><table id="w319aac49c17b9c67c13b3"><thead>
                        <tr>
                            <th>Nome da coluna </th>
                            <th>Tipo de dados </th>
                            <th>Descrição </th>
                        </tr>
                    </thead>
                        <tr>
                            <td tabindex="-1">userid</td>
                            <td tabindex="-1">inteiro</td>
                            <td tabindex="-1">O ID do usuário que gerou a entrada.</td>
                        </tr>
                        <tr>
                            <td tabindex="-1">consulta </td>
                            <td tabindex="-1">inteiro</td>
                            <td tabindex="-1">ID da consulta. A coluna de consulta pode ser usada para unir outras tabelas e exibições do sistema.</td>
                        </tr>
                        <tr>
                            <td tabindex="-1">label </td>
                            <td tabindex="-1">character(320) </td> 
                            <td tabindex="-1">O nome do arquivo usado para executar a consulta ou um rótulo definido com o comando SET QUERY_GROUP. Se a consulta não for baseada em arquivos ou o parâmetro QUERY_GROUP não estiver definido, o valor deste campo será <code class="code">default</code>. </td>
                        </tr>
                        <tr>
                            <td tabindex="-1">xid </td>
                            <td tabindex="-1">bigint </td>
                            <td tabindex="-1">ID da transação. </td>
                        </tr>
                        <tr>
                            <td tabindex="-1">pid </td>
                            <td tabindex="-1">inteiro </td>
                            <td tabindex="-1">ID do processo. Normalmente, todas as consultas de uma sessão são executadas no mesmo processo, portanto esse valor geralmente permanece constante se você executa uma série de consultas na mesma sessão. Após certos eventos internos, o Amazon Redshift pode reiniciar uma sessão ativa e atribuir um novo PID. Para obter mais informações, consulte <a href="./r_STL_RESTARTED_SESSIONS.html">STL_RESTARTED_SESSIONS</a>.</td>
                        </tr>
                        <tr>
                            <td tabindex="-1">banco de dados</td>
                            <td tabindex="-1">character(32)</td>
                            <td tabindex="-1">O nome do banco de dados ao qual o usuário estava conectado quando a consulta foi enviada.</td>
                        </tr>
                        <tr>
                            <td tabindex="-1">querytxt </td>
                            <td tabindex="-1">character(4000) </td>
                            <td tabindex="-1">O texto da consulta. </td>
                        </tr>
                        <tr>
                            <td tabindex="-1">starttime</td>
                            <td tabindex="-1">timestamp</td>
                            <td tabindex="-1">O horário (em UTC) de início da consulta. O tempo total inclui consultas e execução, com seis dígitos de precisão para segundos fracionários. Por exemplo: <code class="userinput">2009-06-12 11:29:19.131358</code>.</td>
                        </tr>
                        <tr>
                            <td tabindex="-1">endtime</td>
                            <td tabindex="-1">timestamp</td>
                            <td tabindex="-1">Horário em UTC em que a consulta foi finalizada. O tempo total inclui consultas e execução, com seis dígitos de precisão para segundos fracionários. Por exemplo: <code class="userinput">2009-06-12 11:29:19.131358</code>.</td>
                        </tr>
                        <tr>
                            <td tabindex="-1">aborted </td>
                            <td tabindex="-1">inteiro </td>
                            <td tabindex="-1">Se uma consulta for interrompida pelo sistema ou cancelada pelo usuário, essa coluna terá o valor <code class="userinput">1</code>. Se a consulta for executada até o final (inclusive retornando os resultados para o cliente), essa coluna conterá o valor <code class="userinput">0</code>. Se o cliente desconectar antes de receber os resultados, a consulta será marcada como cancelada (<code class="userinput">1</code>), mesmo que ela tenha sido concluída com êxito no backend.</td>
                        </tr>
                        <tr>
                            <td tabindex="-1">insert_pristine </td>
                            <td tabindex="-1">inteiro </td>
                            <td tabindex="-1"> Se as consultas de gravação são/puderam ser executadas enquanto a consulta atual está/estava em execução. 1 = nenhuma consulta de gravação permitida. 0 = consultas de gravação permitidas. Essa coluna deve ser usada na depuração. </td>
                        </tr>
                        <tr>
                            <td tabindex="-1">concurrency_scaling_status</td>
                            <td tabindex="-1">inteiro </td>
                            <td tabindex="-1"><p>Indica se a consulta foi executada no cluster principal ou em um cluster de escalabilidade da simultaneidade. Os valores possíveis são: </p>
                                <p>0 - Executada no cluster principal </p>
                                <p>1 — Executada em um cluster de escalabilidade da simultaneidade </p>
                                <p>Maior que 1 - Executada no cluster principal </p>
                            </td>
                        </tr>
                    </table></div></div>
         
            <h2 id="r_STL_QUERY-sample-queries">Consultas de exemplo</h2>


            <p>A consulta a seguir lista as cinco consultas mais recentes.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select query, trim(querytxt) as sqlquery
from stl_query
order by query desc limit 5;

query |                                   sqlquery
------+--------------------------------------------------
129 | select query, trim(querytxt) from stl_query order by query;
128 | select node from stv_disk_read_speeds;
127 | select system_status from stv_gui_status
126 | select * from systable_topology order by slice
125 | load global dict registry
(5 rows)</code></pre>
            <p>A consulta a seguir retorna o tempo decorrido em ordem descendente para as consultas executadas no dia 15 de fevereiro de 2013. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select query, datediff(seconds, starttime, endtime),
trim(querytxt) as sqlquery
from stl_query
where starttime &gt;= '2013-02-15 00:00' and endtime &lt; '2013-02-16 00:00'
order by date_diff desc;

 query | date_diff |  sqlquery
-------+-----------+-------------------------------------------
 55    |       119 | padb_fetch_sample: select count(*) from category
121    |         9 | select * from svl_query_summary;
181    |         6 | select * from svl_query_summary where query in(179,178);
172    |         5 | select * from svl_query_summary where query=148;
...
(189 rows)</code></pre>
            <p>A consulta a seguir mostra o tempo da fila e o tempo de execução para consultas. Consultas com <code class="code">concurrency_scaling_status = 1</code> executadas em um cluster de escalabilidade da simultaneidade. Todas as outras consultas executadas no cluster principal.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">SELECT w.service_class AS queue
     , q.concurrency_scaling_status
     , COUNT( * ) AS queries
     , SUM( q.aborted )  AS aborted
     , SUM( ROUND( total_queue_time::NUMERIC / 1000000,2 ) ) AS queue_secs
     , SUM( ROUND( total_exec_time::NUMERIC / 1000000,2 ) )  AS exec_secs
FROM stl_query q
     JOIN stl_wlm_query w
          USING (userid,query)
WHERE q.userid &gt; 1
  AND service_class &gt; 5
  AND q.starttime &gt; '2019-03-01 16:38:00'
  AND q.endtime   &lt; '2019-03-01 17:40:00'
GROUP BY 1,2
ORDER BY 1,2;</code></pre>

        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_STL_PROJECT.html">STL_PROJECT</div><div id="next" class="next-link" accesskey="n" href="./r_STL_QUERY_METRICS.html">STL_QUERY_METRICS</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_STL_QUERY.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_STL_QUERY.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>