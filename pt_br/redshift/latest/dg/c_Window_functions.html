<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Funções de janela - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="c_Window_functions" /><meta name="default_state" content="c_Window_functions" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html" /><meta name="description" content="Crie consultas analíticas de negócios com mais eficiência usando as funções da janela para SQL que o Amazon Redshift oferece suporte." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guia do desenvolvedor de banco de dados" /><meta name="abstract" content="Crie e gerencie um data warehouse com o Amazon Redshift, um serviço de data warehouse totalmente gerenciado, em escala de petabyte e de nível empresarial." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c_Window_functions.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c_Window_functions.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c_Window_functions.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c_Window_functions.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c_Window_functions.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c_Window_functions.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_Window_functions.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c_Window_functions.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c_Window_functions.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c_Window_functions.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c_Window_functions.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c_Window_functions.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/c_Window_functions.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/c_Window_functions.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c_Window_functions.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guia do desenvolvedor de banco de dados" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guia do desenvolvedor de banco de dados" /><meta id="panorama-serviceConsolePage" value="Funções de janela" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Funções de janela - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#c_Window_functions" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,desenvolvedor,dados de amostra,banco de dados,desenvolvedor do banco de dados,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do desenvolvedor de banco de dados",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Referência SQL",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Referência de funções SQL",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_SQL_functions.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Funções de janela",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_SQL_functions.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#c_Window_functions" target="_blank" rel="noopener noreferrer" title="Abrir em PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guia do desenvolvedor de banco de dados</a></div><div id="page-toc-src"><a href="#r_Window_function_synopsis">Resumo da sintaxe de funções da janela</a><a href="#r_Examples_order_by_WF">Ordenação exclusiva de dados para funções da janela</a><a href="#r_Window_function_supported">Funções compatíveis</a><a href="#r_Window_function_example">Amostra de tabela para exemplos de funções de janela </a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="c_Window_functions">Funções de janela</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Usando funções da janela, é possível criar consultas analíticas empresariais de forma mais eficiente. Funções de janela operam em uma partição ou “janela” de um conjunto de resultados e retornam um valor para cada linha naquela janela. Por outro lado, funções sem janela executam seus cálculos em relação a cada linha no conjunto de resultados. Diferente de funções de grupo que agregam linhas de resultado, as funções de janela retêm todas as linhas na expressão da tabela. </p><p> Os valores retornados são calculados usando valores dos conjuntos de linhas dessa janela. Para cada linha da tabela, a janela define um conjunto de linhas que é usado para computar atributos adicionais. Um janela é definida usando uma especificação de janela (a cláusula OVER) se baseia em três conceitos principais: </p><div class="itemizedlist">
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p> <em>Particionamento da janela,</em> que forma grupos de linhas (cláusula PARTITION) </p>
         </li><li class="listitem">
            <p> <em>Ordenação da janela</em>, que define uma ordem ou sequência de linhas dentro de cada partição (cláusula ORDER BY) </p>
         </li><li class="listitem">
            <p> <em>Quadros da janela</em>, que são definidos em relação a cada linha para restringir ainda mais o conjunto de linhas (especificação de ROWS) </p>
         </li></ul></div><p>As funções da janela são o último conjunto de operações executadas em uma consulta, exceto pela cláusula ORDER BY final. Todas as junções e todas as cláusulas WHERE, GROUP BY e HAVING são concluídas antes do processamento das funções da janela. Portanto, as funções da janela podem aparecer somente na lista de seleção ou na cláusula ORDER BY. Você pode usar várias funções da janela em uma única consulta com diferentes cláusulas de quadro. Você também pode usar funções da janela em outras expressões escalares, tal como CASE. </p>
         <h2 id="r_Window_function_synopsis">Resumo da sintaxe de funções da janela</h2>
         
         
         <p>As funções de janela seguem uma sintaxe padrão, mostrada a seguir.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><em>function</em> (<em>expression</em>) OVER (
[ PARTITION BY <em>expr_list</em> ]
[ ORDER BY <em>order_list</em> [ <em>frame_clause</em> ] ] )</code></pre>
         <p> Aqui, <em>function</em> é uma das funções descritas nesta seção.</p> 
         <p>A <em>expr_list</em> é como indicado a seguir.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><em>expression</em> | <em>column_name</em> [, <em>expr_list</em> ]</code></pre>
         <p> A <em>order_list</em> é como a seguir. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><em>expression</em> | <em>column_name</em> [ ASC | DESC ] 
[ NULLS FIRST | NULLS LAST ]
[, <em>order_list</em> ]</code></pre>
         <p> O <em>frame_clause</em> é como a seguir. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">ROWS
<span>{</span> UNBOUNDED PRECEDING | <em>unsigned_value</em> PRECEDING | CURRENT ROW } |

<span>{</span> BETWEEN
<span>{</span> UNBOUNDED PRECEDING | <em>unsigned_value</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW}
AND
<span>{</span> UNBOUNDED FOLLOWING | <em>unsigned_value</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW }}</code></pre>
          
            <h3 id="r_Window_function_synopsis-arguments">Argumentos</h3>
            
            
            <div class="variablelist">
                
                
                
                
                
                
                
                
                
            <dl>
                  <dt><span class="term"> <em>função</em> </span></dt>
                  <dd>
                     <p>A função de janela. Para obter detalhes, consulte as descrições individuais da função. </p>
                  </dd>
                
                  <dt><span class="term">OVER </span></dt>
                  <dd>
                     <p>A cláusula que define a especificação da janela. A cláusula OVER é obrigatória para funções da janela e diferencia funções da janela de outras funções SQL. </p>
                  </dd>
                
                  <dt><span class="term">PARTITION BY <em>expr_list</em> </span></dt>
                  <dd>
                     <p>(Opcional) A cláusula PARTITION BY subdivide o conjunto de resultados em partições, bem como a cláusula GROUP BY. Se uma cláusula de partição estiver presente, a função será calculada para as linhas em cada partição. Se nenhuma cláusula de partição estiver especificada, uma única partição contém a tabela inteira e a função é computada para esta tabela completa. </p>
                     <p>As funções de classificação DENSE_RANK, NTILE, RANK e ROW_NUMBER exigem uma comparação global de todas as linhas no conjunto de resultados. Quando uma cláusula PARTITION BY é utilizada, o otimizador de consulta pode executar cada agregação em paralelo, distribuindo a workload em várias fatias de acordo com as partições. Se a cláusula PARTITION BY não estiver presente, a etapa de agregação deverá ser executada em série em uma única fatia, o que poderá ter um impacto negativo considerável na performance, sobretudo para grandes clusters.</p>
                     <p>O Amazon Redshift não oferece suporte a literais de string nas cláusulas PARTITION BY.</p>
                  </dd>
                
                  <dt><span class="term">ORDER BY <em>order_list</em> </span></dt>
                  <dd>
                     <p>(Opcional) A função da janela é aplicada às linhas dentro de cada partição classificada de acordo com a especificação do pedido em ORDER BY. Esta cláusula ORDER BY é diferente e totalmente não relacionada a uma cláusula ORDER BY na <em>frame_clause</em>. A cláusula ORDER BY pode ser usada sem a cláusula PARTITION BY. </p>
                     <p>Para as funções de classificação, a cláusula ORDER BY identifica as medidas para os valores de classificação. Para funções de agregação, as linhas particionadas devem ser ordenadas antes que a função agregada seja computada para cada quadro. Para obter mais informações sobre os tipos de função da janela, consulte <a href="./c_Window_functions.html">Funções de janela</a>.</p>
                     <p>Os identificadores de coluna ou expressões que avaliam os identificadores de coluna são obrigatórios na lista de ordenação. Nem constantes ou expressões constantes podem ser usadas como substitutos para nomes de coluna. </p>
                     <p>Valores NULL são tratados como seu próprio grupo, ordenados e classificados de acordo com a opção NULLS FIRST ou NULLS LAST. Por padrão, os valores NULL são ordenados e classificados por último na ordem ASC e são ordenados e classificados primeiro na ordem DESC.</p>
                     <p>O Amazon Redshift não oferece suporte a literais de string nas cláusulas ORDER BY.</p>
                     <p> Se a cláusula ORDER BY for omitida, a ordem das linhas não será determinística. </p>
                     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Em qualquer sistema paralelo, como o Amazon Redshift, quando uma cláusula ORDER BY não produz uma ordem única e total dos dados, a ordem das linhas não é determinística. Ou seja, se a expressão ORDER BY produzir valores duplicados (uma ordenação parcial), a ordem de retorno dessas linhas pode variar de uma execução do Amazon Redshift para a próxima. Por sua vez, funções da janela podem retornar resultados inesperados ou inconsistentes. Para obter mais informações, consulte <a href="#r_Examples_order_by_WF">Ordenação exclusiva de dados para funções da janela</a>. </p></div></div>
                  </dd>
                
                  <dt><span class="term"> <em>column_name</em> </span></dt>
                  <dd>
                     <p>Nome de uma coluna a ser particionada por ou ordenada por. </p>
                  </dd>
                
                  <dt><span class="term">ASC | DESC </span></dt>
                  <dd>
                     <p>Opção que define a ordem de classificação para a expressão, da seguinte forma: </p>
                     <div class="itemizedlist">
                         
                         
                     <ul class="itemizedlist"><li class="listitem">
                           <p>ASC: ascendente (por exemplo, de valores numéricos menores para maiores e de "A" a "Z" para strings de caracteres). Se nenhuma opção é especificada, os dados são classificados na ordem ascendente por padrão.</p>
                        </li><li class="listitem">
                           <p>DESC: descendente (de valores numéricos maiores para menores; de "Z" a "A" para strings). </p>
                        </li></ul></div>
                  </dd>
                
                  <dt><span class="term">NULLS FIRST | NULLS LAST</span></dt>
                  <dd>
                     <p>Opção que especifica se NULLS devem ser ordenados primeiro, antes de valores não nulos, ou por último, após valores não nulos. Por padrão, NULLs são ordenados e classificados por último na ordem ASC e ordenados e classificados primeiro na ordem DESC.</p>
                  </dd>
                
                  <dt><span class="term"> <em>frame_clause</em> </span></dt>
                  <dd>
                     
                     <p>Para funções agregadas, a cláusula do quadro refina ainda mais o conjunto de linhas na janela de uma função ao usar ORDER BY. Ele permite que você inclua ou exclua conjuntos de linhas no resultado ordenado. A cláusula de quadro consiste na palavra-chave ROWS e nos especificadores associados.</p>
                     <p>A cláusula frame não se aplica a funções de classificação. Além disso, a cláusula frame não é necessária quando nenhuma cláusula ORDER BY é usada na cláusula OVER para uma função agregada. Se uma cláusula ORDER BY é usada para uma função agregada, uma cláusula de quadro explícita é necessária.</p>
                     <p>Quando nenhuma cláusula ORDER BY é especificada, o quadro implícito é ilimitado, equivalente a ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING. </p>
                  </dd>
                
                  <dt><span class="term">ROWS</span></dt>
                  <dd>
                     <p>Especificando um deslocamento físico da linha atual especificando um deslocamento físico da linha atual.</p>
                     <p>Essa cláusula especifica as linhas na janela ou particionamento atual ao qual o valor da linha atual dever ser combinado. Ela usa os argumentos que especificam a posição da linha, que pode ser antes ou depois da linha atual. O ponto de referência para todos os quadros de janela é a linha atual. Cada linha se torna a linha atual, por sua vez, à medida que o quadro de janela avança pela partição.</p>
                     <p>O quadro pode ser um conjunto simples de linhas até e incluindo a linha atual.</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>UNBOUNDED PRECEDING | <em>offset</em> PRECEDING | CURRENT ROW}</code></pre>
                     <p>Ou pode ser um conjunto de linhas entre dois limites.</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">BETWEEN
<span>{</span> UNBOUNDED PRECEDING | <em>offset</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW }
AND
<span>{</span> UNBOUNDED FOLLOWING | <em>offset</em> <span>{</span> PRECEDING | FOLLOWING } | CURRENT ROW }</code></pre>
                     <p>UNBOUNDED PRECEDING indica que a janela começa na primeira linha da partição; <em>deslocamento</em> PRECEDING indica que a janela começa um número de linhas equivalentes ao valor do deslocamento antes da linha atual. UNBOUNDED PRECEDING é o padrão.</p>
                     <p>CURRENT ROW indica que a janela começa ou termina na linha atual. </p>
                     <p>UNBOUNDED FOLLOWING indica que a janela termina na última linha da partição; <em>deslocamento</em> FOLLOWING indica que a janela termina um número de linhas equivalentes ao valor do deslocamento depois da linha atual.</p>
                     <p>O <em>offset</em> identifica um número físico de linhas antes ou depois da linha atual. Nesse caso, o <em>deslocamento</em> deve ser uma constante que retorna um valor numérico positivo. Por exemplo, 5 FOLLOWING termina o quadro 5 linhas após a linha atual.</p>
                     
                     <p>Onde BETWEEN não é especificado, o quadro é limitado implicitamente pela linha atual. Por exemplo, <code class="code">ROWS 5 PRECEDING</code> é igual a <code class="code">ROWS BETWEEN 5 PRECEDING AND CURRENT ROW</code>. Além disso, <code class="code">ROWS
                           UNBOUNDED FOLLOWING</code> é igual a <code class="code">ROWS BETWEEN CURRENT ROW AND
                              UNBOUNDED FOLLOWING</code>.</p>
                     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Você não pode especificar um quadro em que o limite inicial seja maior do que o limite final. Por exemplo, você não pode especificar nenhum dos quadros a seguir. </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">between 5 following and 5 preceding
between current row and 2 preceding
between 3 following and current row</code></pre></div></div>
                  </dd>
               </dl></div>
          
         
       
         <h2 id="r_Examples_order_by_WF">Ordenação exclusiva de dados para funções da janela</h2>
         
         
         <p>Se uma cláusula ORDER BY para uma função da janela não produz uma ordem única e total dos dados, a ordem das linhas não é determinística. Se a expressão ORDER BY produzir valores duplicados (uma ordenação parcial), a ordem de retorno dessas linhas pode variar em várias execuções. Nesse caso, as funções da janela também podem retornar resultados inesperados ou inconsistentes. </p>
         <p>Por exemplo, a consulta a seguir retorna resultados diferentes ao longo de várias execuções. Esses resultados diferentes ocorrem porque <code class="code">order by dateid</code> não produz uma ordenação exclusiva dos dados para a função da janela SUM. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select dateid, pricepaid,
sum(pricepaid) over(order by dateid rows unbounded preceding) as sumpaid
from sales
group by dateid, pricepaid;

dateid | pricepaid |   sumpaid
--------+-----------+-------------
1827 |   1730.00 |     1730.00
1827 |    708.00 |     2438.00
1827 |    234.00 |     2672.00
...

select dateid, pricepaid,
sum(pricepaid) over(order by dateid rows unbounded preceding) as sumpaid
from sales
group by dateid, pricepaid;

dateid | pricepaid |   sumpaid
--------+-----------+-------------
1827 |    234.00 |      234.00
1827 |    472.00 |      706.00
1827 |    347.00 |     1053.00
...</code></pre>
         <p> Nesse caso, adicionar uma segunda coluna ORDER BY à função da janela pode resolver o problema. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select dateid, pricepaid,
sum(pricepaid) over(order by dateid, pricepaid rows unbounded preceding) as sumpaid
from sales
group by dateid, pricepaid;

dateid | pricepaid | sumpaid
--------+-----------+---------
1827 |    234.00 |  234.00
1827 |    337.00 |  571.00
1827 |    347.00 |  918.00
...</code></pre>
       
         <h2 id="r_Window_function_supported">Funções compatíveis</h2>
      <p>O Amazon Redshift oferece suporte a dois tipos de funções da janela: agregação e classificação.</p>
      <p>Veja a seguir as funções agregadas compatíveis: </p>
      <div class="itemizedlist">
          
          
          
          
          
          
          
          
               
          
          
          
          
          
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><a href="./r_WF_AVG.html">Função de janela AVG</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_COUNT.html">Função de janela COUNT</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_CUME_DIST.html">Função de janela CUME_DIST</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_DENSE_RANK.html">Função de janela DENSE_RANK</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_first_value.html">Função de janela FIRST_VALUE</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_LAG.html">Função de janela LAG</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_last_value.html">Função de janela LAST_VALUE</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_LEAD.html">Função de janela LEAD</a> </p>
         </li><li class="listitem">
               <p><a href="./r_WF_LISTAGG.html">Função de janela LISTAGG</a> </p>
            </li><li class="listitem">
            <p><a href="./r_WF_MAX.html">Função de janela MAX</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_MEDIAN.html">Função de janela MEDIAN</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_MIN.html">Função de janela MIN</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_NTH.html">Função de janela NTH_VALUE</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_PERCENTILE_CONT.html">Função de janela PERCENTILE_CONT</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_PERCENTILE_DISC.html">Função de janela PERCENTILE_DISC</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_RATIO_TO_REPORT.html">Função de janela RATIO_TO_REPORT</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_STDDEV.html">Funções de janela STDDEV_SAMP e STDDEV_POP</a> (STDDEV_SAMP e STDDEV são sinônimos) </p>
         </li><li class="listitem">
            <p><a href="./r_WF_SUM.html">Função de janela SUM</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_VARIANCE.html">Funções de janela VAR_SAMP e VAR_POP</a> (VAR_SAMP e VARIANCE são sinônimos)</p>
         </li></ul></div>
      <p>Veja a seguir as funções de classificação compatíveis: </p>
      <div class="itemizedlist">
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><a href="./r_WF_DENSE_RANK.html">Função de janela DENSE_RANK</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_NTILE.html">Função de janela NTILE</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_PERCENT_RANK.html">Função de janela PERCENT_RANK</a></p>
         </li><li class="listitem">
            <p><a href="./r_WF_RANK.html">Função de janela RANK</a> </p>
         </li><li class="listitem">
            <p><a href="./r_WF_ROW_NUMBER.html">Função de janela ROW_NUMBER</a></p>
         </li></ul></div>
       
         <h2 id="r_Window_function_example">Amostra de tabela para exemplos de funções de janela</h2>
         
         <p>É possível encontrar exemplos de função de janela específicos com cada descrição de função. Alguns dos exemplos usam uma tabela chamada WINSALES, que contém 11 linhas, conforme mostrado a seguir.</p>
         <div class="table-container"><div class="table-contents"><table id="w320aac47c11c45c17b5"><thead>
                  <tr>
                     <th>SALESID </th>
                     <th>DATEID </th>
                     <th>SELLERID </th>
                     <th>BUYERID </th>
                     <th>QTY </th>
                     <th>QTY_SHIPPED </th>
                  </tr>
               </thead>
                  <tr>
                     <td tabindex="-1"> 30001 </td>
                     <td tabindex="-1"> 8/2/2003 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1">10 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 10001 </td>
                     <td tabindex="-1"> 12/24/2003 </td>
                     <td tabindex="-1"> 1 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1">10 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 10005 </td>
                     <td tabindex="-1"> 12/24/2003 </td>
                     <td tabindex="-1"> 1 </td>
                     <td tabindex="-1"> A </td>
                     <td tabindex="-1"> 30 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 40001 </td>
                     <td tabindex="-1"> 1/9/2004 </td>
                     <td tabindex="-1"> 4 </td>
                     <td tabindex="-1"> A </td>
                     <td tabindex="-1"> 40 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 10006 </td>
                     <td tabindex="-1"> 1/18/2004 </td>
                     <td tabindex="-1"> 1 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 20001 </td>
                     <td tabindex="-1"> 2/12/2004 </td>
                     <td tabindex="-1"> 2 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 20 </td>
                     <td tabindex="-1">20 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 40005 </td>
                     <td tabindex="-1"> 2/12/2004 </td>
                     <td tabindex="-1"> 4 </td>
                     <td tabindex="-1"> A </td>
                     <td tabindex="-1"> 10 </td>
                     <td tabindex="-1">10 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 20002 </td>
                     <td tabindex="-1"> 2/16/2004 </td>
                     <td tabindex="-1"> 2 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 20 </td>
                     <td tabindex="-1">20 </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 30003 </td>
                     <td tabindex="-1"> 4/18/2004 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 15 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 30004 </td>
                     <td tabindex="-1"> 4/18/2004 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> B </td>
                     <td tabindex="-1"> 20 </td>
                     <td tabindex="-1"> </td>
                  </tr>
                  <tr>
                     <td tabindex="-1"> 30007 </td>
                     <td tabindex="-1"> 9/7/2004 </td>
                     <td tabindex="-1"> 3 </td>
                     <td tabindex="-1"> C </td>
                     <td tabindex="-1"> 30 </td>
                     <td tabindex="-1"> </td>
                  </tr>
               </table></div></div>
         <p>O seguinte script cria e preenche a tabela de amostra WINSALES.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE winsales(
  salesid int,
  dateid date,
  sellerid int,
  buyerid char(10),
  qty int,
  qty_shipped int);

INSERT INTO winsales VALUES
  (30001, '8/2/2003', 3, 'b', 10, 10),
  (10001, '12/24/2003', 1, 'c', 10, 10),
  (10005, '12/24/2003', 1, 'a', 30, null),	
  (40001, '1/9/2004', 4, 'a', 40, null),	
  (10006, '1/18/2004', 1, 'c', 10, null),	
  (20001, '2/12/2004', 2, 'b', 20, 20),
  (40005, '2/12/2004', 4, 'a', 10, 10),
  (20002, '2/16/2004', 2, 'c', 20, 20),
  (30003, '4/18/2004', 3, 'b', 15, null),
  (30004, '4/18/2004', 3, 'b', 20, null),	
  (30007, '9/7/2004', 3, 'c', 30, null);	 
</code></pre>
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_TO_VARBYTE.html">TO_VARBYTE</div><div id="next" class="next-link" accesskey="n" href="./r_WF_AVG.html">AVG</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_Window_functions.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>