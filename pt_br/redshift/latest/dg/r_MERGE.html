<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>MERGE - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_MERGE" /><meta name="default_state" content="r_MERGE" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" /><meta name="description" content="Insere, atualiza e exclui valores em uma tabela com base nos valores de uma tabela de origem." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guia do desenvolvedor de banco de dados" /><meta name="abstract" content="Crie e gerencie um data warehouse com o Amazon Redshift, um serviço de data warehouse totalmente gerenciado, em escala de petabyte e de nível empresarial." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_MERGE.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_MERGE.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_MERGE.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_MERGE.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_MERGE.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_MERGE.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_MERGE.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_MERGE.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_MERGE.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_MERGE.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_MERGE.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_MERGE.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_MERGE.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guia do desenvolvedor de banco de dados" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guia do desenvolvedor de banco de dados" /><meta id="panorama-serviceConsolePage" value="MERGE" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>MERGE - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_MERGE" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,desenvolvedor,dados de amostra,banco de dados,desenvolvedor do banco de dados,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do desenvolvedor de banco de dados",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Referência SQL",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Comandos SQL",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "MERGE",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_SQL_commands.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_MERGE" target="_blank" rel="noopener noreferrer" title="Abrir em PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guia do desenvolvedor de banco de dados</a></div><div id="page-toc-src"><a href="#r_MERGE-synopsis">Sintaxe</a><a href="#r_MERGE-parameters">Parâmetros</a><a href="#r_MERGE_usage_notes">Observações de uso</a><a href="#sub-examples-merge">Exemplos</a><a href="#r_MERGE-see-also">Consulte também</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="r_MERGE">MERGE</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Mescla condicionalmente as linhas de uma tabela de origem em uma tabela de destino. Tradicionalmente, isso só pode ser feito usando várias instruções insert, update ou delete separadamente. Para obter mais informações sobre as operações que MERGE permite combinar, consulte <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_UPDATE.html">UPDATE</a>, <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_DELETE.html">DELETE</a> e <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_INSERT_30.html">INSERT</a>.</p>
         <h2 id="r_MERGE-synopsis">Sintaxe</h2>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">MERGE INTO <em>target_table</em> 
USING <em>source_table</em> [ [ AS ] <em>alias</em> ] 
ON <em>match_condition</em> 
[ WHEN MATCHED THEN <span>{</span> UPDATE SET <em>col_name</em> = <span>{</span> <em>expr</em> } [,...] | DELETE }
WHEN NOT MATCHED THEN INSERT [ ( <em>col_name</em> [,...] ) ] VALUES ( <span>{</span> <em>expr</em> } [, ...] ) |
REMOVE DUPLICATES ]</code></pre>

       
         <h2 id="r_MERGE-parameters">Parâmetros</h2>
         <div class="variablelist">
             
             
             
             
            
             
             
             

             
             
             
             
             
         <dl>
               <dt><span class="term"> <em>target_table</em></span></dt>
               <dd>
                  <p>A tabela temporária ou permanente de destino da instrução MERGE.</p>
               </dd>
             
               <dt><span class="term"> <em>source_table</em></span></dt>
               <dd>
                  <p>A tabela temporária ou permanente que fornece as linhas a serem mescladas em <em>target_table</em>. <em>source_table</em> também pode ser uma tabela do Spectrum. <em>source_table</em> não pode ser uma visualização nem uma subconsulta.</p>
               </dd>
             
               <dt><span class="term"> <em>alias</em></span></dt>
               <dd>
                  <p>O nome alternativo temporário para <em>source_table</em>.</p>
                  <p>Esse parâmetro é opcional. O <em>alias</em> precedente com AS também é opcional.</p>
               </dd>
             
               <dt><span class="term"> <em>match_condition</em></span></dt>
               <dd>
                  <p>Especifica predicados iguais entre a coluna da tabela de origem e a coluna da tabela de destino que são usados para determinar se as linhas em <em>source_table</em> podem ser combinadas com as linhas em <em>target_table</em>. Se a condição for atendida, MERGE executará <em>matched_clause</em> para essa linha. Caso contrário, MERGE executará <em>not_matched_clause</em> para essa linha.</p>
               </dd>
             
               <dt><span class="term">WHEN MATCHED</span></dt>
               <dd>
                  <p> Especifica a ação a ser executada quando a condição de correspondência entre uma linha de origem e uma linha de destino é avaliada como True. Você pode especificar uma ação UPDATE ou uma ação DELETE. </p>
               </dd>
             
               <dt><span class="term">UPDATE</span></dt>
               <dd><p> Atualiza a linha correspondente em <em>target_table</em>. Somente os valores no <em>col_name</em> que você especificar serão atualizados. </p></dd>
             
               <dt><span class="term">DELETE</span></dt>
               <dd><p> Exclui a linha correspondente em <em>target_table</em>. </p></dd>
             
               <dt><span class="term">WHEN NOT MATCHED</span></dt>
               <dd>
                  <p> Especifica a ação a ser executada quando a condição de correspondência é avaliada como False ou Unknown. Você só pode especificar a ação de inserção INSERT para essa cláusula. </p>
               </dd>
             
               <dt><span class="term">INSERT</span></dt>
               <dd><p> Insere uma linha em <em>target_table</em>. O <em>col_name</em> de destino pode ser listado em qualquer ordem. Se você não fornecer nenhum valor de <em>col_name</em>, a ordem padrão será todas as colunas da tabela na ordem declarada. </p></dd>
             
               <dt><span class="term"> <em>col_name</em></span></dt>
               <dd>
                  <p>Um ou mais nomes de coluna que você deseja modificar. Não inclui o nome da tabela ao especificar a coluna de destino.</p>
               </dd>
             
               <dt><span class="term"> <em>expr</em></span></dt>
               <dd>
                  <p>A expressão que define o novo valor para <em>col_name</em>.</p>
               </dd>
             
               <dt><span class="term"> REMOVE DUPLICATES</span></dt>
               <dd>
                  <p>Especifica que o comando MERGE é executado no modo simplificado. O modo simplificado tem os seguintes requisitos:</p>
                  <div class="itemizedlist">
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem"><p> <em>target_table</em> e <em>source_table</em> devem ter o mesmo número de colunas e tipos de coluna compatíveis. </p></li><li class="listitem"><p> A cláusula WHEN e as cláusulas UPDATE e INSERT devem ser omitidas do comando MERGE. </p></li><li class="listitem"><p> A cláusula REMOVE DUPLICATES deve ser usada no comando MERGE. </p></li></ul></div>
                  <p>No modo simplificado, o MERGE faz o seguinte:</p>
                  <div class="itemizedlist">
                      
                      
                      
                  <ul class="itemizedlist"><li class="listitem"><p> As linhas em <em>target_table</em> que têm uma correspondência em <em>source_table</em> são atualizadas para corresponder aos valores em source_table. </p></li><li class="listitem"><p> As linhas em <em>source_table</em> que não têm uma correspondência em <em>target_table</em> são inseridas em <em>target_table</em>. </p></li><li class="listitem"><p> Quando várias linhas em <em>target_table</em> correspondem à mesma linha em <em>source_table</em>, as linhas duplicadas são removidas. O Amazon Redshift mantém uma única linha e a atualiza. As linhas duplicadas que não correspondem a uma linha em <em>source_table</em> permanecem inalteradas. </p></li></ul></div>
                  <p>REMOVE DUPLICATES oferece melhor performance do que WHEN MATCHED e WHEN NOT MATCHED. Recomendamos usar REMOVE DUPLICATES se <em>target_table</em> e <em>source_table</em> forem compatíveis e você não precisar preservar linhas duplicadas em <em>target_table</em>.</p>
               </dd>
            </dl></div>
       
         <h2 id="r_MERGE_usage_notes">Observações de uso</h2>
         <div class="itemizedlist">
             
             
             
             
             
             
            
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>Para executar instruções MERGE, você deve ser o proprietário das tabelas <em>source_table</em> e <em>target_table</em> ou ter a permissão SELECT para essas tabelas. Além disso, você deve ter as permissões UPDATE, DELETE e INSERT para <em>target_table</em>, dependendo das operações incluídas em sua instrução MERGE.</p>
            </li><li class="listitem">
               <p> <em>target_table</em> não pode ser uma tabela do sistema, tabela de catálogo ou tabela externa. </p>
            </li><li class="listitem">
               <p> <em>source_table</em> e <em>target_table</em> não podem ser a mesma tabela. </p>
            </li><li class="listitem">
               <p> Não é possível usar a cláusula WITH em uma instrução MERGE. </p>
            </li><li class="listitem">
               <p> As linhas em <em>target_table</em> não podem estabelecer correspondência com várias linhas em <em>source_table</em>. </p>
               <p>Considere o seguinte exemplo:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (1, 'Bob'), (2, 'John');
INSERT INTO source VALUES (1, 'Tony'), (1, 'Alice'), (3, 'Bill');

MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN UPDATE SET id = source.id, name = source.name
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);
ERROR: Found multiple matches to update the same tuple.

MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN DELETE
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);
ERROR: Found multiple matches to update the same tuple.</code></pre>
               <p>Nas duas instruções MERGE, a operação falha porque há várias linhas na tabela <code class="code">source</code> com um valor de ID de <code class="code">1</code>.</p>
            </li><li class="listitem">
               <p> <em>match_condition</em> e <em>expr</em> não podem fazer referência parcial a colunas do tipo SUPER. Por exemplo, se seu objeto do tipo SUPER for uma matriz ou uma estrutura, você não poderá usar elementos individuais dessa coluna para <em>match_condition</em> ou <em>expr</em>, mas poderá usar a coluna inteira. </p>
               <p>Considere o seguinte exemplo:</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE IF NOT EXISTS target (key INT, value SUPER);
CREATE TABLE IF NOT EXISTS source (key INT, value SUPER);

INSERT INTO target VALUES (1, JSON_PARSE('<span>{</span>"key": 88}'));
INSERT INTO source VALUES (1, ARRAY(1, 'John')), (2, ARRAY(2, 'Bill'));

MERGE INTO target USING source ON target.key = source.key
WHEN matched THEN UPDATE SET value = source.value[0]
WHEN NOT matched THEN INSERT VALUES (source.key, source.value[0]);
ERROR: Partial reference of SUPER column is not supported in MERGE statement.</code></pre>
               <p>Para obter mais informações sobre o tipo SUPER, consulte <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SUPER_type.html">Tipo SUPER</a>.</p>
            </li><li class="listitem">
               <p>Se <em>source_table</em> for grande, definir as colunas de junção de <em>target_table</em> e <em>source_table</em> como chaves de distribuição poderá melhorar a performance.</p>
            </li><li class="listitem">
               <p>Para usar a cláusula REMOVE DUPLICATES, você precisa das permissões SELECT, INSERT e DELETE para <em>target_table</em>.</p>
            </li></ul></div>
       
         <h2 id="sub-examples-merge">Exemplos</h2>
         <p>O exemplo a seguir cria duas tabelas e executa uma operação MERGE nelas, atualizando as linhas correspondentes na tabela de destino e inserindo linhas que não correspondem. Depois, ele insere outro valor na tabela de origem e executa outra operação MERGE, desta vez excluindo as linhas correspondentes e inserindo a nova linha da tabela de origem.</p>
         <p>Primeiro, crie e preencha as tabelas de origem e de destino.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (101, 'Bob'), (102, 'John'), (103, 'Susan');
INSERT INTO source VALUES (102, 'Tony'), (103, 'Alice'), (104, 'Bill');

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 102 | John
 103 | Susan
(3 rows)

SELECT * FROM source;
 id  |    name
-----+------------
 102 | Tony
 103 | Alice
 104 | Bill
(3 rows)</code></pre>
         <p>Depois, mescle a tabela de origem com a tabela de destino, atualizando a tabela de destino com linhas correspondentes e insira linhas da tabela de origem que não tenham correspondência.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN UPDATE SET id = source.id, name = source.name
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 102 | Tony
 103 | Alice
 104 | Bill
(4 rows)</code></pre>
         <p>Observe que as linhas com valores de id 102 e 103 são atualizadas para corresponder aos valores dos nomes da tabela de destino. Além disso, uma nova linha com um valor de id 104 e o valor de nome Bill é inserida na tabela de destino.</p>
         <p>Depois, insira uma nova linha na tabela de origem.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">INSERT INTO source VALUES (105, 'David');

SELECT * FROM source;
 id  |    name
-----+------------
 102 | Tony
 103 | Alice
 104 | Bill
 105 | David
(4 rows)</code></pre>
         <p>Por fim, execute uma operação de mesclagem excluindo linhas correspondentes na tabela de destino e inserindo linhas que não correspondem.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">MERGE INTO target USING source ON target.id = source.id
WHEN MATCHED THEN DELETE
WHEN NOT MATCHED THEN INSERT VALUES (source.id, source.name);

SELECT * FROM target;
 id  |    name
-----+------------
 101 | Bob
 105 | David
(2 rows)</code></pre>
         <p>As linhas com valores de id 102, 103 e 104 são excluídas da tabela de destino, e uma nova linha com um valor de id 105 e valor de nome David é inserida na tabela de destino.</p>
         <p>O exemplo a seguir exibe um comando MERGE usando a cláusula REMOVE DUPLICATES.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (30, 'Tony'), (11, 'Alice'), (23, 'Bill');
INSERT INTO source VALUES (23, 'David'), (22, 'Clarence');

MERGE INTO target USING source ON target.id = source.id REMOVE DUPLICATES;

SELECT * FROM target;
id | name
---+------------
30 | Tony
11 | Alice
23 | David
22 | Clarence
(4 rows)</code></pre>
         <p>O exemplo a seguir mostra um comando MERGE usando a cláusula REMOVE DUPLICATES, que remove linhas duplicadas de <em>target_table</em> quando elas têm linhas correspondentes em source_table.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE TABLE target (id INT, name CHAR(10));
CREATE TABLE source (id INT, name CHAR(10));

INSERT INTO target VALUES (30, 'Tony'), (30, 'Daisy'), (11, 'Alice'), (23, 'Bill'), (23, 'Nikki');
INSERT INTO source VALUES (23, 'David'), (22, 'Clarence');

MERGE INTO target USING source ON target.id = source.id REMOVE DUPLICATES;

SELECT * FROM target;
id | name
---+------------
30 | Tony
30 | Daisy
11 | Alice
23 | David
22 | Clarence
(5 rows)</code></pre>
         <p>Depois que MERGE é executado, há apenas uma linha com um valor de ID de 23 em <em>target_table</em>. Como não havia nenhuma linha em <em>source_table</em> com o valor de ID 30, as duas linhas duplicadas com valores de ID de 30 permanecem em <em>target_table</em>.</p>
       
         <h2 id="r_MERGE-see-also">Consulte também</h2>
         <p>
            <a href="./r_INSERT_30.html">INSERT</a>, <a href="./r_UPDATE.html">UPDATE</a>,
            <a href="./r_DELETE.html">DELETE</a>
         </p>
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_LOCK.html">LOCK</div><div id="next" class="next-link" accesskey="n" href="./r_PREPARE.html">PREPARE</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_MERGE.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>