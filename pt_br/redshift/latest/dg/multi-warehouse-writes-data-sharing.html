<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Compartilhamento de dados de leitura e gravação em uma Conta da AWS ou em várias contas (visualização) - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="multi-warehouse-writes-data-sharing" /><meta name="default_state" content="multi-warehouse-writes-data-sharing" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" /><meta name="description" content="Para obter mais informações sobre como configurar a faixa de visualização, faça o seguinte." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guia do desenvolvedor de banco de dados" /><meta name="abstract" content="Crie e gerencie um data warehouse com o Amazon Redshift, um serviço de data warehouse totalmente gerenciado, em escala de petabyte e de nível empresarial." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guia do desenvolvedor de banco de dados" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guia do desenvolvedor de banco de dados" /><meta id="panorama-serviceConsolePage" value="Compartilhamento de dados de leitura e gravação em uma Conta da AWS ou em várias contas (visualização)" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Compartilhamento de dados de leitura e gravação em uma Conta da AWS ou em várias contas (visualização) - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#multi-warehouse-writes-data-sharing" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/multi-warehouse-writes-data-sharing.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,desenvolvedor,dados de amostra,banco de dados,desenvolvedor do banco de dados,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do desenvolvedor de banco de dados",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Compartilhar dados entre clusters no Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/datashare-overview.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Gerenciamento de tarefas de compartilhamento de dados",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/getting-started-datashare.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Compartilhamento de dados de leitura e gravação em uma Conta da AWS ou em várias contas (visualização)",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/getting-started-datashare.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#multi-warehouse-writes-data-sharing" target="_blank" rel="noopener noreferrer" title="Abrir em PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guia do desenvolvedor de banco de dados</a></div><div id="page-toc-src"><a href="#within-account-writes-context">Compartilhamento de dados somente leitura X compartilhamento de dados para leituras e gravações</a><a href="#within-account-writes-share-prereqs">Pré-requisitos e observações sobre uso</a><a href="#within-account-writes-share-producer">Compartilhamento de objetos de banco de dados para acesso de leitura e gravação em uma unidade de compartilhamento de dados como administrador do banco de dados produtor</a><a href="#within-account-writes-share-grants-available">Permissões que você pode conceder a unidades de compartilhamento de dados</a><a href="#within-account-writes-share-consumer-create-database">Habilitação de clusters ou grupos de trabalho de tecnologia sem servidor para consultar a unidade de compartilhamento de dados</a><a href="#within-account-writes-share-consumer-transactions">Gravação em objetos dentro de uma unidade de compartilhamento de dados</a><a href="#across-account-read-write-req">Requisitos e limitações sobre para unidade de compartilhamento de dados em visualização</a><a href="#within-account-writes-share-sql-statements">Instruções SQL compatíveis</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="multi-warehouse-writes-data-sharing">Compartilhamento de dados de leitura e gravação em uma Conta da AWS ou em várias contas (visualização)</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><div class="table-container"><div class="table-contents"><table id="w319aac35c19c13b3">
      <tr>
        <td tabindex="-1"><em><b>Esta é a documentação de pré-lançamento do recurso de gravação de vários data warehouses por meio do compartilhamento de dados para o Amazon Redshift, que está disponível em visualização pública na faixa PREVIEW_2023. A documentação e o recurso estão sujeitos a alterações. Recomendamos que você use esse recurso apenas com clusters de teste e não em ambientes de produção. Para previsualizar termos e condições, consulte <em>Participação no serviço beta</em> nos <a href="https://aws.amazon.com/service-terms/" rel="noopener noreferrer" target="_blank"><span>Termos de Serviço da AWS</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</b></em> </td>
      </tr>
    </table></div></div><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>As gravações em vários data warehouses por meio do compartilhamento de dados não estão disponíveis em clusters ra3.xlplus no momento. Para usar esse recurso, crie clusters ra3.4xl, clusters ra3.16xl, ou grupos de trabalho do Amazon Redshift Serverless com a faixa de visualização.</p></div></div><p>Para obter mais informações sobre como configurar a faixa de visualização, faça o seguinte.</p><div class="itemizedlist">
                          
                          
                      <ul class="itemizedlist"><li class="listitem"><p>Para visualização do Amazon Redshift Serverless: <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/serverless-workgroup-preview.html">criação de um grupo de trabalho de visualização</a></p></li><li class="listitem"><p>Para visualização de clusters provisionados do Amazon Redshift: <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-console.html#cluster-preview">criação de um cluster de visualização</a></p></li></ul></div><p>Você pode compartilhar objetos de banco de dados de leituras e gravações em clusters do Amazon Redshift diferentes ou grupos de trabalho do Amazon Redshift Serverless dentro da mesma Conta da AWS ou de uma Conta da AWS para outra. Você também pode gravar dados em várias regiões. Os procedimentos neste tópico mostram como configurar o compartilhamento de dados. Você pode conceder permissões como SELECT, INSERT e UPDATE para tabelas diferentes e USAGE e CREATE para esquemas diferentes. Os dados permanecem ativos e disponíveis para todos os warehouses assim que uma transação de gravação é confirmada. Ao compartilhar dados entre contas, os administradores das contas produtoras podem escolher se essas contas têm ou não acesso somente leitura aos dados. Além disso, os administradores das contas produtoras podem determinar se regiões ou namespaces específicos têm ou não acesso somente leitura, leitura e gravação ou qualquer acesso aos dados. </p><p>As seções a seguir mostram como configurar o compartilhamento de dados. Os procedimentos pressupõem que você esteja trabalhando em um banco de dados em um cluster provisionado ou um grupo de trabalho do Amazon Redshift sem servidor.</p>
               <h2 id="within-account-writes-context">Compartilhamento de dados somente leitura X compartilhamento de dados para leituras e gravações</h2>   
               <p>Anteriormente, objetos em unidades de compartilhamento de dados eram somente leitura em todas as circunstâncias. A gravação em um objeto em uma unidade de compartilhamento de dados é um novo recurso. Os objetos em unidades de compartilhamento de dados só são habilitados para gravação quando um produtor concede especificamente privilégios de gravação, como INSERT ou CREATE, em objetos na unidade de compartilhamento de dados. Os detalhes seguem nas seções subsequentes deste tópico.</p>
               <p>Se você estiver à procura da documentação existente para unidades de compartilhamento de dados somente leitura, ela estará disponível em <a href="https://docs.aws.amazon.com/redshift/latest/dg/datashare-overview.html">Compartilhamento de dados entre clusters no Amazon Redshift</a>.</p>
             
               <h2 id="within-account-writes-share-prereqs">Pré-requisitos e observações sobre uso</h2> 
               <p><em>Configurações de isolamento</em>: <b>o banco de dados deve estar configurado como isolamento de snapshot.</b> Os bancos de dados criados na faixa PREVIEW_2023 têm isolamento de snapshot por padrão. As configurações de isolamento podem ser alteradas usando-se a palavra-chave ISOLATION nas instruções <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_DATABASE.html">CREATE DATABASE</a> ou <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_ALTER_DATABASE.html">ALTER DATABASE</a>.</p>

            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>As gravações em vários data warehouses por meio do compartilhamento de dados não estão disponíveis em clusters ra3.xlplus no momento. Para usar esse recurso, crie clusters ra3.4xl, clusters ra3.16xl, ou grupos de trabalho do Amazon Redshift Serverless com a faixa de visualização.</p></div></div> 
             
               <h2 id="within-account-writes-share-producer">Compartilhamento de objetos de banco de dados para acesso de leitura e gravação em uma unidade de compartilhamento de dados como administrador do banco de dados produtor</h2> 
               <p>Para iniciar o compartilhamento de dados, o administrador no produtor cria uma unidade de compartilhamento de dados e adiciona objetos a ele:</p>
               <div class="procedure"><ol><li><p>O proprietário ou o <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_superusers.html">superusuário</a> do banco de dados produtor cria uma unidade de compartilhamento de dados. Uma unidade de compartilhamento de dados é um contêiner lógico de objetos, permissões e consumidores do banco de dados. (Os consumidores são clusters ou namespaces do Amazon Redshift sem servidor na conta e em outras contas.) Cada unidade de compartilhamento de dados é associada ao banco de dados no qual foi criada e somente objetos desse banco de dados podem ser adicionados. O seguinte comando cria uma unidade de compartilhamento de dados:</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE DATASHARE my_datashare [PUBLICACCESSIBLE = TRUE];</code></pre>
                     <p>A configuração PUBLICACCESSIBLE = TRUE permite aos consumidores consultar a unidade de compartilhamento de dados em clusters acessíveis ao público e grupos de trabalho provisionados. Deixe isso de fora ou o defina explicitamente como falso caso você não queira permitir.</p>
                     <p>O proprietário da unidade de compartilhamento de dados deve conceder USAGE nos esquemas que deseja adicionar à unidade de compartilhamento de dados. O comando GRANT é novo. Ele é usado para conceder várias ações no esquema, inclusive CREATE e USAGE. Os esquemas mantêm objetos compartilhados:</p>
                  
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE SCHEMA myshared_schema1;
CREATE SCHEMA myshared_schema2;
 
GRANT USAGE ON SCHEMA myshared_schema1 TO DATASHARE my_datashare;
GRANT CREATE, USAGE ON SCHEMA myshared_schema2 TO DATASHARE my_datashare;</code></pre> 
                     <p>Como alternativa, o administrador pode continuar executando comandos ALTER para adicionar um esquema à unidade de compartilhamento de dados. Somente permissões USAGE são concedidas quando um esquema é adicionado assim.</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">ALTER DATASHARE my_datashare ADD SCHEMA myshared_schema1;</code></pre>
                  </li><li>
                     <p>Depois de adicionar esquemas, o administrador poderá conceder permissões da unidade de compartilhamento de dados em objetos no esquema. Elas podem ser permissões de leitura e gravação: O exemplo GRANT ALL mostra como conceder todas as permissões.</p>
                     
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">GRANT SELECT, INSERT ON TABLE myshared_schema1.table1, myshared_schema1.table2, myshared_schema2.table1
TO DATASHARE my_datashare;
                     
GRANT ALL ON TABLE myshared_schema1.table4 TO DATASHARE my_datashare;</code></pre> 
                     <p>Você pode continuar executando comandos como ALTER DATASHARE para adicionar tabelas. Quando se faz isso, somente permissões SELECT são concedidas em objetos adicionados.</p>
               
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">ALTER DATASHARE my_datashare ADD TABLE myshared_schema1.table1, myshared_schema1.table2, myshared_schema2.table1;</code></pre>
            
                  </li><li><p>O administrador concede uso na unidade de compartilhamento de dados a um namespace específico na conta. Você pode encontrar o ID do namespace como parte do ARN na página de detalhes do cluster, na página de detalhes do namespace do Amazon Redshift sem servidor ou executando o comando <code class="code">SELECT current_namespace;</code>. Para obter mais informações, consulte <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_CURRENT_NAMESPACE.html">CURRENT_NAMESPACE</a>.</p>
             
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">GRANT USAGE ON DATASHARE my_datashare TO NAMESPACE '86b5169f-012a-234b-9fbb-e2e24359e9a8';</code></pre>
    
                  </li></ol></div>
                
                  <h3 id="within-account-writes-share-producer-cross">Autorização de uma unidade de compartilhamento de dados a ser compartilhada com outra conta</h3> 
                  <p>Depois de criar uma unidade de compartilhamento de dados no produtor e adicionar objetos, talvez você queira compartilhá-la com outra conta da AWS. A autorização de uma unidade de compartilhamento de dados para outra conta é um processo de segurança secundário que deve ser realizado no produtor por um administrador de segurança de dados. Ele autoriza uma unidade de compartilhamento de dados para consumo pela conta do consumidor. Você pode autorizar uma unidade de compartilhamento de dados para outra conta para fins somente leitura ou para leituras e gravações. Se autorizada para gravações, a conta tem os privilégios de gravação concedidos à unidade de compartilhamento de dados. Do contrário, somente os privilégios de leitura concedidos à unidade de compartilhamento de dados permanecerão disponíveis. Para obter mais informações sobre como fazer isso, consulte <a href="./within-account-writes-share-producer-authorize.html">Autorização de unidades de compartilhamento de dados para gravações como o administrador de segurança do produtor (visualização)</a>.</p>
                
               
                
                  <h3 id="within-account-writes-share-consumer-cross">Associação de uma unidade de compartilhamento de dados de outra conta como a consumidora</h3> 
                  <p> Se a unidade de compartilhamento de dados tiver origem em outra conta, você deverá associá-la a clusters ou namespaces específicos na conta para que ela possa ser usada com esses clusters ou namespaces. Você pode associá-la a todos os namespaces em uma conta, a todos os namespaces em regiões específicas da conta ou a namespaces específicos na conta. Você pode escolher se um namespace tem ou não permissão de acesso somente leitura ou de leitura e gravação. Se associados para gravações, os clusters associados e os namespaces de tecnologia sem servidor têm os privilégios de gravação concedidos à unidade de compartilhamento de dados. Do contrário, somente os privilégios de leitura concedidos à unidade de compartilhamento de dados permanecerão disponíveis. Para obter mais informações sobre como fazer isso, consulte <a href="within-account-writes-share-consumer-associate.html" rel="noopener noreferrer" target="_blank">Associating shared data as the consumer data security administrator (preview)</a>.</p>
                
               
             
               <h2 id="within-account-writes-share-grants-available">Permissões que você pode conceder a unidades de compartilhamento de dados</h2> 
               <p>Tipos de objeto diferentes e permissões variadas que você pode conceder a elas em um contexto de compartilhamento de dados.</p>
               <p>Esquemas:</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem"><p>USAGE</p></li><li class="listitem"><p>CREATE</p></li></ul></div>
               <p>Tabelas:</p>
               <div class="itemizedlist">
                   
                   
                   
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem"><p>SELECT</p></li><li class="listitem"><p>INSERT</p></li><li class="listitem"><p>UPDATE</p></li><li class="listitem"><p>DELETE</p></li><li class="listitem"><p>TRUNCATE</p></li><li class="listitem"><p>DROP</p></li><li class="listitem"><p>REFERENCES</p></li></ul></div>
               <p>Funções:</p>
               <div class="itemizedlist">
                   
               <ul class="itemizedlist"><li class="listitem"><p>EXECUTE</p></li></ul></div>
               
            
             
               <h2 id="within-account-writes-share-consumer-create-database">Habilitação de clusters ou grupos de trabalho de tecnologia sem servidor para consultar a unidade de compartilhamento de dados</h2> 
               <p>Esta etapa pressupõe que a unidade de compartilhamento de dados tenha origem em outro cluster ou no namespace do Amazon Redshift Serverless na conta ou esteja vindo de outra conta e tenha sido associada ao namespace que você está usando.</p>
               <div class="procedure"><ol><li><p>O administrador do banco de dados consumidor pode criar um banco de dados a partir da unidade de compartilhamento de dados.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE DATABASE my_ds_db [WITH PERMISSIONS] FROM DATASHARE my_datashare OF NAMESPACE 'abc123def';</code></pre>
                     <p>Se criar um banco de dados WITH PERMISSIONS, você poderá conceder permissões granulares em objetos da unidades de compartilhamento de dados para usuários e funções diferentes. Sem isso, todos os usuários e funções com permissão USAGE no banco de dados da unidade de compartilhamento de dados recebem todas as permissões em todos os objetos dentro do banco de dados da unidade de compartilhamento de dados.</p>
                     
                  </li><li><p>Aqui está como conceder permissões a um usuário ou função do banco de dados do Redshift. Você deve ter uma conexão com um banco de dados local para executar essas instruções: Você não poderá executar essas instruções se executar um comando USE no banco de dados da unidade de compartilhamento de dados antes de executar as instruções de concessão.</p>
                     <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">GRANT USAGE ON DATABASE my_ds_db TO ROLE data_eng;
GRANT CREATE, USAGE ON SCHEMA my_ds_db.my_shared_schema TO ROLE data_eng;
GRANT ALL ON ALL TABLES IN SCHEMA my_ds_db.my_shared_schema TO ROLE data_eng;
 
GRANT USAGE ON DATABASE my_ds_db TO bi_user;
GRANT USAGE ON SCHEMA my_ds_db.my_shared_schema TO bi_user;
GRANT SELECT ON my_ds_db.my_shared_schema.table1 TO bi_user;</code></pre>
       </li></ol></div>
     
             
                  <h2 id="within-account-writes-share-consumer-transactions">Gravação em objetos dentro de uma unidade de compartilhamento de dados</h2> 
                  <p>Existem duas maneiras de gravar em objetos dentro de uma unidade de compartilhamento de dados.</p>
                  <p><b>Com o comando USE, conectando-se ao banco de dados local</b></p>
                  <p>Com esse comando, é possível consultar objetos de uma unidade de compartilhamento de dados com notação de duas partes e realizar transações com várias declarações. Você só pode executar transações com várias instruções dentro de um único banco de dados.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">USE database_name;</code></pre>
                  <p>Você poderá voltar a usar o banco de dados com o qual mantém uma conexão executando o comando RESET USE.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">RESET USE;</code></pre>
                  
                  <p>Depois de USAR um banco de dados, você poderá COMEÇAR uma transação nesse banco de dados. Você não pode gravar em vários bancos de dados em uma única transação.</p>
                  
                  <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Importante</h6></div><div class="awsdocs-note-text"><p> Se você executar um comando USE sem primeiro confirmar ou encerrar a transação atual, o data warehouse será reiniciado. Não se esqueça de encerrar ou confirmar transações abertas antes de executar uma instrução USE.</p></div></div>
                  
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">USE database_name;    --set the context to the datashare database
 
INSERT INTO datashare_schema.table1 VALUES (1);
 
BEGIN; --start a transaction
 
INSERT INTO datashare_schema.table2 VALUES (1);
INSERT INTO datashare_schema.table3 VALUES (1);
 
COMMIT;  --end transaction; you can also use the END command.</code></pre>
                  <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Você não pode copiar dados de um parquet e arquivos ORC para uma tabela da unidade de compartilhamento de dados.</p></div></div>
                  
                  <p><b>Conectar-se diretamente ao banco de dados da unidade de compartilhamento de dados por meio de um driver Redshift JDBC, ODBC ou Python</b></p>
                  <p>Se se conectar diretamente a um banco de dados da unidade de compartilhamento de dados, você poderá consultar as tabelas usando a notação em duas partes e executar imediatamente transações com várias instruções no banco de dados da unidade de compartilhamento de dados.</p>
                  
 
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">--connect to the datashare database via JDBC, ODBC, or the Python Driver
 
INSERT INTO datashare_schema.table1 VALUES (1);
 
BEGIN; --start a transaction
 
INSERT INTO datashare_schema.table2 VALUES (1);
INSERT INTO datashare_schema.table3 VALUES (1);
 
COMMIT;  -- end transaction; can also use the END command.</code></pre>
   
                  <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Importante</h6></div><div class="awsdocs-note-text"><p>A execução de uma instrução INSERT INTO SELECT é compatível, mas, para isso, você deve ter permissões INSERT em todas as tabelas referenciadas na consulta.</p></div></div>    
                  <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>O suporte para conexão com bancos de dados da unidade de compartilhamento de dados por meio da API de dados estará disponível em breve.</p></div></div>      
                 
                
               <h2 id="across-account-read-write-req">Requisitos e limitações sobre para unidade de compartilhamento de dados em visualização</h2>
              <p></p>
               <div class="itemizedlist">
                   
                   
                   
                   
       
    
   
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem"><p>Você deve ter conexão direta com um banco de dados da unidade de compartilhamento de dados ou executar o comando USE para gravar em unidades de compartilhamento de dados. No entanto, vamos habilitar em breve a capacidade de fazer isso com a notação em três partes. </p></li><li class="listitem"><p>Você deve usar grupos de trabalho com tecnologia sem servidor, clusters ra3.4xl ou clusters ra3.16xl para usar esse recurso. O suporte para clusters ra3.xlplus está planejado.</p></li><li class="listitem"><p><em>Descoberta de metadados</em>: quando você é um consumidor conectado diretamente a um banco de dados de unidade de compartilhamento de dados por meio dos drivers Redshift JDBC, ODBC ou Python, pode exibir dados de catálogo das seguintes formas: </p>
                     <div class="itemizedlist">
                  
                         
                         
                         
                     <ul class="itemizedlist"><li class="listitem"><p>Comandos SQL <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_SHOW.html">SHOW</a>.</p></li><li class="listitem"><p>Consulta a tabelas e exibições information_schema.</p></li><li class="listitem"><p>Consulta a <a href="https://docs.aws.amazon.com/redshift/latest/dg/svv_views.html">exibições de metadados SVV</a>.</p></li></ul></div>
                  </li><li class="listitem"><p>Você não consegue se conectar a bancos de dados da unidade de compartilhamento de dados por meio da API de dados. Haverá suporte para isso em breve.</p></li><li class="listitem"><p>Os consumidores não conseguem ver as permissões concedidas às unidades de compartilhamento de dados. Vamos adicionar isso em breve.</p></li><li class="listitem"><p>Para o compartilhamento de dados entre contas, o cluster de produtores e consumidores devem ser criptografados.</p></li><li class="listitem"><p>O nível de isolamento do banco de dados deve ser o isolamento do snapshot para permitir que outros grupos de trabalho e clusters de tecnologia sem servidor gravem nele.</p></li><li class="listitem"><p>Os consumidores que gravarem em objetos de unidade de compartilhamento de dados não vão acionar uma operação de análise automática. Assim, o produtor deverá executar manualmente a análise depois da inserção dos dados na tabela para que as estatísticas da tabela sejam atualizadas. Sem isso, os planos de consulta talvez não sejam ideais. </p></li></ul></div>
             
               <h2 id="within-account-writes-share-sql-statements">Instruções SQL compatíveis</h2> 
               <p>Essas instruções são compatíveis com o lançamento de visualização pública do compartilhamento de dados com gravações:</p>
               <div class="itemizedlist">
                   
                   
                   
                   
                   
                   
                   
                   
                   
              
                   
                   
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem"><p>BEGIN | START TRANSACTION</p></li><li class="listitem"><p>END | COMMIT | ROLLBACK</p></li><li class="listitem"><p>COPY sem COMPUPDATE</p></li><li class="listitem"><p><span>{</span> CREATE | DROP } SCHEMA</p></li><li class="listitem"><p><span>{</span> CREATE | DROP | SHOW } TABLE</p></li><li class="listitem"><p>CREATE TABLE table_name AS</p></li><li class="listitem"><p>DELETE</p></li><li class="listitem"><p><span>{</span> GRANT | REVOKE } privilege_name ON OBJECT_TYPE object_name TO consumer_user </p></li><li class="listitem"><p>INSERT</p></li><li class="listitem"><p>SELECT</p></li><li class="listitem"><p>INSERT INTO SELECT</p></li><li class="listitem"><p>TRUNCATE</p></li><li class="listitem"><p>UPDATE</p></li><li class="listitem"><p>Colunas do tipo de superdados</p></li></ul></div>
               
         
               <p><em>Tipos de instrução não compatíveis</em>: estes não são compatíveis:</p>
               <div class="itemizedlist">
                   
                   
                   
                   
                   
                   
        
               <ul class="itemizedlist"><li class="listitem"><p>Consultas com várias instruções a warehouses consumidores durante a gravação em produtores.</p></li><li class="listitem"><p>Gravação de consultas em escala de simultaneidade de consumidores para produtores.</p></li><li class="listitem"><p>Gravação de trabalhos de cópia automática de consumidores para produtores.</p></li><li class="listitem"><p>Gravação de trabalhos de transmissão de consumidores para produtores.</p></li><li class="listitem"><p>Criação de tabelas de integração ETL zero por consumidores em clusters produtores. Para obter informações sobre integrações ETL zero, consulte <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/zero-etl-using.html">Working with zero-ETL integrations</a>.</p></li><li class="listitem"><p>Gravação em uma tabela com uma chave de classificação intercalada.</p></li></ul></div>
               
            <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./data-sharing-within-account-CF.html">Gerenciamento do compartilhamento de dados com o CloudFormation</div><div id="next" class="next-link" accesskey="n" href="./within-account-writes-share-producer-authorize.html">Autorização de unidades de compartilhamento de dados para gravações como o administrador de segurança do produtor (visualização)</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/multi-warehouse-writes-data-sharing.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/multi-warehouse-writes-data-sharing.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>