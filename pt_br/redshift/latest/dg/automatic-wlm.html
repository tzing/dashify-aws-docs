<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Implementar o WLM automático - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="automatic-wlm" /><meta name="default_state" content="automatic-wlm" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/automatic-wlm.html" /><meta name="description" content="Com o gerenciamento automático de workload (WLM), o Amazon Redshift gerencia a simultaneidade de consultas e a alocação de memória. Você pode criar até oito filas com os identificadores de classe de serviço 100–107. Cada fila tem uma prioridade. Para obter mais informações, consulte" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guia do desenvolvedor de banco de dados" /><meta name="abstract" content="Crie e gerencie um data warehouse com o Amazon Redshift, um serviço de data warehouse totalmente gerenciado, em escala de petabyte e de nível empresarial." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/automatic-wlm.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/automatic-wlm.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/automatic-wlm.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/automatic-wlm.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/automatic-wlm.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/automatic-wlm.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/automatic-wlm.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/automatic-wlm.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/automatic-wlm.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/automatic-wlm.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/automatic-wlm.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/automatic-wlm.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/automatic-wlm.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/automatic-wlm.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/automatic-wlm.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/automatic-wlm.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/automatic-wlm.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/automatic-wlm.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/automatic-wlm.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/automatic-wlm.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/automatic-wlm.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/automatic-wlm.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guia do desenvolvedor de banco de dados" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guia do desenvolvedor de banco de dados" /><meta id="panorama-serviceConsolePage" value="Implementar o WLM automático" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Implementar o WLM automático - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#automatic-wlm" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/automatic-wlm.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/automatic-wlm.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/automatic-wlm.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,desenvolvedor,dados de amostra,banco de dados,desenvolvedor do banco de dados,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do desenvolvedor de banco de dados",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Como implementar o gerenciamento do workload",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/cm-c-implementing-workload-management.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Implementar o WLM automático",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/cm-c-implementing-workload-management.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#automatic-wlm" target="_blank" rel="noopener noreferrer" title="Abrir em PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guia do desenvolvedor de banco de dados</a></div><div id="page-toc-src"><a href="#wlm-auto-query-priority">Prioridade</a><a href="#wlm-auto-concurrency-scaling-mode">Modo de escalabilidade da simultaneidade</a><a href="#wlm-auto-defining-query-queues-user-groups">Grupos de usuários</a><a href="#wlm-auto-defining-query-queues-query-groups">Grupos de consultas</a><a href="#wlm-auto-wildcards">Curingas</a><a href="#wlm-auto-query-monitoring-rules">Regras de monitoramento de consulta</a><a href="#wlm-monitoring-automatic-wlm">Verificação do WLM automático</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="automatic-wlm">Implementar o WLM automático</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Com o gerenciamento automático de workload (WLM), o Amazon Redshift gerencia a simultaneidade de consultas e a alocação de memória. Você pode criar até oito filas com os identificadores de classe de serviço 100–107. Cada fila tem uma prioridade. Para obter mais informações, consulte <a href="./query-priority.html">Prioridade da consulta</a>. </p><p>O WLM automático determina a quantidade de recursos que as consultas precisam e ajusta a simultaneidade com base na workload. Quando consultas que exigem grandes quantidades de recursos estiverem no sistema (por exemplo, uniões de hash entre tabelas grandes), a simultaneidade será menor. Quando consultas mais leves (como inserções, exclusões, varreduras ou agregações simples) forem enviadas, a simultaneidade será maior. </p><p>O WLM automático é separado da aceleração de consulta breve (SQA) e avalia as consultas de maneira diferente. O WLM automático e a SQA funcionam em conjunto para permitir que consultas leves e de execução breve sejam concluídas mesmo quando consultas de execução longa e com grande utilização de recursos estão ativas. Para obter mais informações sobre SQA, consulte <a href="./wlm-short-query-acceleration.html">Trabalhar com a aceleração de consulta breve</a>. </p><p>O Amazon Redshift habilita o WLM automático por meio de grupos de parâmetros:</p><div class="itemizedlist">
             
             
         <ul class="itemizedlist"><li class="listitem"><p>Se seus clusters usam o grupo de parâmetro padrão, o Amazon Redshift habilita o WLM automático para eles.</p></li><li class="listitem"><p>Se os clusters usarem grupos de parâmetros padrão, será possível configurar os clusters para habilitar o WLM automático. Recomendamos que você crie um grupo de parâmetros separado para a configuração do WLM automático. </p></li></ul></div><p>Para configurar o WLM, edite o parâmetro <code class="code">wlm_json_configuration</code> em um grupo de parâmetros que possa ser associado a um ou mais clusters. Para obter mais informações, consulte <a href="./cm-c-modifying-wlm-configuration.html">Modificar a configuração do WLM</a>.</p><p>As filas de consulta são definidas na configuração do WLM. Você pode adicionar filas de consultas adicionais à configuração do WLM padrão, até um total de oito filas de usuários. Você pode configurar o seguinte para cada fila de consultas: </p><div class="itemizedlist">
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>Prioridade </p>
         </li><li class="listitem">
            <p>Modo de escalabilidade da simultaneidade </p>
         </li><li class="listitem">
            <p>Grupos de usuários </p>
         </li><li class="listitem">
            <p>Grupos de consultas </p>
         </li><li class="listitem">
            <p>Regras de monitoramento de consulta </p>
         </li></ul></div>
         <h2 id="wlm-auto-query-priority">Prioridade</h2>
         <p>É possível definir a importância relativa de consultas em um workload definindo um valor de prioridade. A prioridade é especificada para uma fila e herdada por todas as consultas associadas à fila. Para obter mais informações, consulte <a href="./query-priority.html">Prioridade da consulta</a>.</p>
       
         <h2 id="wlm-auto-concurrency-scaling-mode">Modo de escalabilidade da simultaneidade</h2>
         <p>Quando a escalabilidade de simultaneidade está habilitada, o Amazon Redshift adiciona automaticamente capacidade de cluster quando necessário para processar um aumento nas consultas de leitura e gravação simultâneas. Seus usuários veem os dados mais atuais, sejam as consultas executadas no cluster principal ou em um cluster de escalabilidade de simultaneidade. </p>
         <p>Gerencie quais consultas são enviadas para o cluster de escalabilidade da simultaneidade configurando filas do WLM. Ao habilitar a escalabilidade de simultaneidade para uma fila, as consultas qualificadas são enviadas ao cluster de escalabilidade de simultaneidade em vez de aguardar na fila. Para obter mais informações, consulte <a href="./concurrency-scaling.html">Trabalhar com a escalabilidade de simultaneidade</a>.</p>
       
         <h2 id="wlm-auto-defining-query-queues-user-groups">Grupos de usuários</h2>
         
         
         <p>Você pode atribuir um conjunto de grupos de usuários a uma fila especificando o nome de cada grupo de usuários ou usando curingas. Quando um membro de um grupo de usuários listado executa uma consulta, esta é executada na fila correspondente. Não há limite definido quanto ao número de grupos de usuários que podem ser atribuídos a uma fila. Para obter mais informações, consulte <a href="./cm-c-executing-queries.html#cm-c-executing-queries-assigning-queries-to-queues-based-on-user-groups">Atribuir consultas a filas com base em grupos de usuários</a>. </p>
       
         <h2 id="wlm-auto-defining-query-queues-query-groups">Grupos de consultas </h2>
         
         
         <p>Você pode atribuir um conjunto de grupos de consultas a uma fila especificando o nome de cada grupo de consultas ou usando curingas. Um <em>grupo de consultas</em> é apenas um rótulo. No tempo de execução, é possível atribuir o rótulo do grupo de consultas a uma série de consultas. Todas as consultas atribuídas a um grupo de consultas listado são executadas na fila correspondente. Não há limite definido para o número de grupos de consultas que podem ser atribuídos a uma fila. Para obter mais informações, consulte <a href="./cm-c-executing-queries.html#cm-c-executing-queries-assigning-a-query-to-a-query-group">Atribuir uma consulta a um grupo de consultas</a>. </p>
       
         <h2 id="wlm-auto-wildcards">Curingas</h2>
         
         <p>Se os curingas estiverem habilitados na configuração da fila WLM, você pode atribuir grupos de usuários e grupos de consulta a uma fila individualmente ou usando curingas no estilo shell do Unix. A comparação de padrões não diferencia maiúsculas de minúsculas. </p>
         <p>Por exemplo, o caractere curinga “*” corresponde a qualquer número de caracteres. Portanto, se você adicionar <code class="code">dba_*</code> à lista de grupos de usuários para uma fila, qualquer consulta executada por usuário, que pertença a um grupo com um nome que começa com <code class="code">dba_</code>, será atribuída a essa fila. Os exemplos são <code class="code">dba_admin</code> ou <code class="code">DBA_primary</code>. O caractere curinga “?” corresponde a qualquer caractere único. Portanto, se a fila incluir o grupo de usuários <code class="code">dba?1</code>, os grupos de usuários chamados <code class="code">dba11</code> e <code class="code">dba21</code> corresponderão, mas <code class="code">dba12</code> não corresponderá. </p>
         <p>Por padrão, os curingas não estão habilitados.</p>
       
         <h2 id="wlm-auto-query-monitoring-rules">Regras de monitoramento de consulta</h2>
         
         <p>As regras de monitoramento de consultas definem limites de performance baseados em métricas para filas do WLM e especificam qual ação tomar quando uma consulta vai além desses limites. Por exemplo, para uma fila dedicada a consultas rápidas, convém criar uma regra que cancele consultas executadas por mais de 60 segundos. Para acompanhar consultas mal projetadas, convém ter outra regra que registre consultas que contenham loops aninhados. Para obter mais informações, consulte <a href="./cm-c-wlm-query-monitoring-rules.html">Regras de monitoramento de consulta do WLM</a>.</p>
       
         <h2 id="wlm-monitoring-automatic-wlm">Verificação do WLM automático</h2>
         
         <p>Para verificar se o WLM automático está habilitado, execute a seguinte consulta. Se a consulta retornar pelo menos uma linha, o WLM automático estará habilitado.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select * from stv_wlm_service_class_config 
where service_class &gt;= 100;</code></pre>
         
         <p>A consulta a seguir exibe o numero de consultas que passaram por cada fila de consulta (classe de serviço). Ele também mostra o tempo de execução médio, o número de consultas com tempo de espera no percentil 90º, e o tempo de espera médio. As consultas de WLM automático usam as classes de serviço 100 a 107.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select final_state, service_class, count(*), avg(total_exec_time), 
percentile_cont(0.9) within group (order by total_queue_time), avg(total_queue_time) 
from stl_wlm_query where userid &gt;= 100 group by 1,2 order by 2,1; </code></pre>
         
         <p>Para descobrir quais consultas foram executadas pelo WLM automático e concluídas com êxito, execute a seguinte consulta.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">select a.queue_start_time, a.total_exec_time, label, trim(querytxt) 
from stl_wlm_query a, stl_query b 
where a.query = b.query and a.service_class &gt;= 100 and a.final_state = 'Completed' 
order by b.query desc limit 5;</code></pre>
 
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./cm-c-modifying-wlm-configuration.html">Modificar a configuração do WLM</div><div id="next" class="next-link" accesskey="n" href="./query-priority.html">Prioridade da consulta</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/automatic-wlm.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/automatic-wlm.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>