<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Políticas do IAM do Amazon Redshift Spectrum - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="c-spectrum-iam-policies" /><meta name="default_state" content="c-spectrum-iam-policies" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-spectrum-iam-policies.html" /><meta name="description" content="Saiba mais sobre as políticas do IAM do Amazon Redshift Spectrum." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guia do desenvolvedor de banco de dados" /><meta name="abstract" content="Crie e gerencie um data warehouse com o Amazon Redshift, um serviço de data warehouse totalmente gerenciado, em escala de petabyte e de nível empresarial." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-spectrum-iam-policies.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/c-spectrum-iam-policies.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guia do desenvolvedor de banco de dados" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guia do desenvolvedor de banco de dados" /><meta id="panorama-serviceConsolePage" value="Políticas do IAM do Amazon Redshift Spectrum" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Políticas do IAM do Amazon Redshift Spectrum - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#c-spectrum-iam-policies" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-spectrum-iam-policies.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-spectrum-iam-policies.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-spectrum-iam-policies.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,desenvolvedor,dados de amostra,banco de dados,desenvolvedor do banco de dados,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do desenvolvedor de banco de dados",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Consultar dados externos usando o Amazon Redshift Spectrum",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-using-spectrum.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Políticas do IAM do Amazon Redshift Spectrum",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-using-spectrum.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#c-spectrum-iam-policies" target="_blank" rel="noopener noreferrer" title="Abrir em PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guia do desenvolvedor de banco de dados</a></div><div id="page-toc-src"><a href="#spectrum-iam-policies-s3">Permissões do Amazon S3</a><a href="#spectrum-iam-policies-cross-account">Permissões entre contas do Amazon S3</a><a href="#spectrum-iam-policies-spectrum-only">Conceder ou restringir acesso usando o Redshift Spectrum</a><a href="#spectrum-iam-policies-minimum-permissions">Permissões mínimas</a><a href="#c-spectrum-chaining-roles">Encadeamento de funções do IAM</a><a href="#c-spectrum-glue-acess">Acesso a dados do AWS Glue</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="c-spectrum-iam-policies">Políticas do IAM do Amazon Redshift Spectrum</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Por padrão, o Amazon Redshift Spectrum usa o AWS Glue Data Catalog em regiões da AWS compatíveis com o AWS Glue. Em outras regiões da AWS, o Redshift Spectrum usa o catálogo de dados do Athena. Seu cluster precisa de autorização para acessar o catálogo de dados externos no AWS Glue ou no Athena e os arquivos de dados no Amazon S3. Essa autorização é fornecida por meio de referência à função do AWS Identity and Access Management (IAM) que é associada ao cluster. Se você usa uma metastore do Apache Hive para gerenciar o catálogo de dados, não precisa conceder acesso ao Athena.</p><p>Você pode encadear funções para que seu cluster possa assumir outras funções não anexadas ao cluster. Para obter mais informações, consulte <a href="#c-spectrum-chaining-roles">Encadeamento de funções do IAM no Amazon Redshift Spectrum</a>.</p><p>O catálogo do AWS Glue que você acessa pode ser criptografado para aumentar a segurança. Se o catálogo do AWS Glue estiver criptografado, será necessária a chave do AWS KMS para que o AWS Glue acesse o catálogo de dados do AWS Glue. Para obter informações, consulte <a href="https://docs.aws.amazon.com/glue/latest/dg/encrypt-glue-data-catalog.html">Criptografia de seu catálogo de dados do AWS Glue</a> no <em><a href="https://docs.aws.amazon.com/glue/latest/dg/">Guia do desenvolvedor do AWS Glue</a>.</em></p><div class="highlights" id="inline-topiclist"><h6>Tópicos</h6><ul><li><a href="#spectrum-iam-policies-s3">Permissões do Amazon S3</a></li><li><a href="#spectrum-iam-policies-cross-account">Permissões entre contas do Amazon S3</a></li><li><a href="#spectrum-iam-policies-spectrum-only">Políticas para conceder ou restringir acesso ao Redshift Spectrum</a></li><li><a href="#spectrum-iam-policies-minimum-permissions">Políticas para conceder permissões mínimas</a></li><li><a href="#c-spectrum-chaining-roles">Encadeamento de funções do IAM no Amazon Redshift Spectrum</a></li><li><a href="#c-spectrum-glue-acess">Controlar o acesso ao Catálogo de dados do AWS Glue</a></li></ul></div><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Se você tiver tabelas externas do Redshift Spectrum no catálogo de dados do Athena, poderá migrar o catálogo de dados do Athena para um catálogo de dados do AWS Glue. Para usar o catálogo de dados do AWS Glue com o Redshift Spectrum, talvez seja necessário alterar as políticas do IAM. Para obter mais informações, consulte <a href="https://docs.aws.amazon.com/athena/latest/ug/glue-athena.html#glue-upgrade">Atualizar para o catálogo de dados do AWS Glue</a> no <em>Manual do usuário do Athena</em>.</p></div></div>
         <h2 id="spectrum-iam-policies-s3">Permissões do Amazon S3</h2>
         <p>No mínimo, seu cluster precisa dos acessos GET e LIST para o bucket do Amazon S3. Se o bucket não estiver na mesma conta da AWS que o cluster, o bucket também deverá conceder autorização para que o cluster acesse os dados. Para obter mais informações, consulte <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/authorizing-redshift-service.html"> Autorização para o Amazon Redshift acessar outros serviços da AWS em seu nome</a>. </p>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>O bucket do Amazon S3 não pode usar uma política de bucket que restrinja o acesso somente a partir de endpoints da VPC específicos.</p></div></div>
         <p>A política a seguir concede os acessos GET e LIST a um bucket do Amazon S3. A política permite o acesso aos buckets do Amazon S3 para o Redshift Spectrum, bem como às operações COPY.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
	"Version": "2012-10-17",
	"Statement": [<span>{</span>
		"Effect": "Allow",
		"Action": ["s3:Get*", "s3:List*"],
		"Resource": "*"
	}]
}</code></pre>

         <p>A política a seguir concede os acessos GET e LIST ao bucket do Amazon S3 denominado <code class="code">myBucket</code>.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
	"Version": "2012-10-17",
	"Statement": [<span>{</span>
		"Effect": "Allow",
		"Action": ["s3:Get*", "s3:List*"],
		"Resource": "arn:aws:s3:::myBucket/*"
	}]
}</code></pre>
       
         <h2 id="spectrum-iam-policies-cross-account">Permissões entre contas do Amazon S3</h2>
         <p>Para conceder ao Redshift Spectrum permissão para acessar dados em um bucket do Amazon S3 que pertence a outra conta da AWS, adicione a política a seguir ao bucket do Amazon S3. Para obter mais informações, consulte <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/example-walkthroughs-managing-access-example2.html">Conceder permissões de bucket entre contas</a>.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "Example permissions",
            "Effect": "Allow",
            "Principal": <span>{</span>
                "AWS": "arn:aws:iam::<code class="replaceable">redshift-account</code>:role/<code class="replaceable">spectrumrole</code>"
            },
            "Action": [
                "s3:GetBucketLocation",
                "s3:GetObject",
                "s3:ListMultipartUploadParts",
                "s3:ListBucket",
                "s3:ListBucketMultipartUploads"
            ],
            "Resource": [
                "arn:aws:s3:::<code class="replaceable">bucketname</code>",
                "arn:aws:s3:::<code class="replaceable">bucketname</code>/*"
            ]
        }
    ]
}</code></pre>
       
         <h2 id="spectrum-iam-policies-spectrum-only">Políticas para conceder ou restringir acesso ao Redshift Spectrum</h2>
         <p>Para conceder acesso somente a um bucket do Amazon S3 usando o Redshift Spectrum, inclua uma condição que permita o acesso ao agente de usuário <code class="code">AWS Redshift/Spectrum</code>. A política a seguir permite o acesso somente aos buckets do Amazon S3 para o Redshift Spectrum. Ela exclui outros acessos, como às operações COPY.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [<span>{</span>
        "Effect": "Allow",
        "Action": ["s3:Get*", "s3:List*"],
        "Resource": "arn:aws:s3:::myBucket/*",
                "Condition": <span>{</span>"StringEquals": <span>{</span>"aws:UserAgent": "AWS Redshift/Spectrum"}}
    }]
}</code></pre>
         <p>Da mesma forma, pode ser necessário criar uma função do IAM que permite o acesso às operações COPY, mas exclui o acesso do Redshift Spectrum. Para fazer isso, inclua uma condição que negue o acesso ao agente de usuário <code class="userinput">AWS Redshift/Spectrum</code>. A política a seguir permite o acesso a um bucket do Amazon S3 excluindo o acesso do Redshift Spectrum.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [<span>{</span>
        "Effect": "Allow",
        "Action": ["s3:Get*", "s3:List*"],
        "Resource": "arn:aws:s3:::myBucket/*",
                "Condition": <span>{</span>"StringNotEquals": <span>{</span>"aws:UserAgent": "AWS Redshift/Spectrum"}}
    }]
}</code></pre>
       
         <h2 id="spectrum-iam-policies-minimum-permissions">Políticas para conceder permissões mínimas</h2>
         <p>A política a seguir concede as permissões mínimas necessárias para usar o Redshift Spectrum com o Amazon S3, o AWS Glue e o Athena. </p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "s3:GetBucketLocation",
                "s3:GetObject",
                "s3:ListMultipartUploadParts",
                "s3:ListBucket",
                "s3:ListBucketMultipartUploads"
            ],
            "Resource": [
                "arn:aws:s3:::<code class="replaceable">bucketname</code>",
                "arn:aws:s3:::<code class="replaceable">bucketname</code>/<code class="replaceable">folder1</code>/<code class="replaceable">folder2</code>/*"
            ]
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "glue:CreateDatabase",
                "glue:DeleteDatabase",
                "glue:GetDatabase",
                "glue:GetDatabases",
                "glue:UpdateDatabase",
                "glue:CreateTable",
                "glue:DeleteTable",
                "glue:BatchDeleteTable",
                "glue:UpdateTable",
                "glue:GetTable",
                "glue:GetTables",
                "glue:BatchCreatePartition",
                "glue:CreatePartition",
                "glue:DeletePartition",
                "glue:BatchDeletePartition",
                "glue:UpdatePartition",
                "glue:GetPartition",
                "glue:GetPartitions",
                "glue:BatchGetPartition"
            ],
            "Resource": [
                "*"
            ]
        }
    ]
}</code></pre>
         <p>Se você utilizar o Athena para o catálogo de dados em vez do AWS Glue, a política exigirá acesso total ao Athena. A política a seguir concede acesso aos recursos do Athena. Se seu banco de dados externo for uma metastore do Hive, você não precisará de acesso ao Athena.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
	"Version": "2012-10-17",
	"Statement": [<span>{</span>
		"Effect": "Allow",
		"Action": ["athena:*"],
		"Resource": ["*"]
	}]
}</code></pre>
       
         <h2 id="c-spectrum-chaining-roles">Encadeamento de funções do IAM no Amazon Redshift Spectrum</h2>

         <p>Ao anexar uma função ao cluster, seu cluster poderá assumir essa função para acessar o Amazon S3, o Athena e o AWS Glue em seu nome. Se uma função anexada ao cluster não tiver acesso aos recursos necessários, você poderá encadear outra função, possivelmente pertencente a outra conta. O cluster assumirá a função encadeada temporariamente para acessar os dados. Você também pode conceder acesso entre contas com o encadeamento de funções. Você pode encadear um máximo de 10 funções. Cada função em cadeia assume a próxima função na cadeia, até que o cluster assuma a função no final da cadeia. </p>
         <p>Para encadear funções, você estabelece uma relação de confiança entre as funções. Uma função que assume uma outra função deve ter uma política de permissões que permita que ela assuma a função especificada. Por sua vez, a função que passa permissões deve ter uma política de confiança que permita que ela passe suas permissões para outra função. Para obter mais informações, consulte <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/authorizing-redshift-service.html#authorizing-redshift-service-chaining-roles">Encadeamento de funções do IAM no Amazon Redshift</a>. </p>

         <p>Quando você executa o comando do CREATE EXTERNAL SCHEMA, pode encadear funções incluindo uma lista separada por vírgulas de ARNs de funções. </p>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>A lista de funções encadeadas não deve incluir espaços.</p></div></div>
         <p>No exemplo a seguir, <code class="code">MyRedshiftRole</code> está anexada ao cluster. <code class="code">MyRedshiftRole</code> assume a função <code class="code">AcmeData</code>, que pertence à conta <code class="code">111122223333</code>.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">create external schema acme from data catalog 
database 'acmedb' region 'us-west-2' 
iam_role 'arn:aws:iam::123456789012:role/MyRedshiftRole,arn:aws:iam::111122223333:role/AcmeData';</code></pre>
       

         <h2 id="c-spectrum-glue-acess">Controlar o acesso ao Catálogo de dados do AWS Glue</h2>
         <p>Se usar o AWS Glue em seu catálogo de dados, você poderá aplicar um controle de acesso refinado ao catálogo de dados do AWS Glue com sua política do IAM. Por exemplo, você pode querer expor apenas alguns bancos de dados e tabelas para uma função específica do IAM.</p>
         <p>As seções a seguir descrevem as políticas do IAM para vários níveis de acesso aos dados armazenados no AWS Glue Data Catalog.</p>

         <div class="highlights" id="inline-topiclist"><h6>Tópicos</h6><ul><li><a href="#c-spectrum-glue-acess-database">Política para operações de banco de dados</a></li><li><a href="#c-spectrum-glue-acess-tables">Política para operações de tabela</a></li><li><a href="#c-spectrum-glue-acess-partitions">Política para operações de partição</a></li></ul></div>
          
            <h3 id="c-spectrum-glue-acess-database">Política para operações de banco de dados</h3>

            <p>Se quiser conceder aos usuários permissões para exibir e criar um banco de dados, eles precisarão de direitos de acesso ao banco de dados e ao AWS Glue Data Catalog.</p>
            <p>A consulta de exemplo a seguir cria um banco de dados.</p>

            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
CREATE EXTERNAL SCHEMA example_db
FROM DATA CATALOG DATABASE 'example_db' region 'us-west-2' 
IAM_ROLE 'arn:aws:iam::redshift-account:role/spectrumrole'
CREATE EXTERNAL DATABASE IF NOT EXISTS              
            </code></pre>
            <p>A seguinte política do IAM fornece as permissões mínimas necessárias para criar um banco de dados.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
<span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "glue:GetDatabase",
                "glue:CreateDatabase"
            ],
            "Resource": [
                "arn:aws:glue:us-west-2:redshift-account:database/example_db",
                "arn:aws:glue:us-west-2:redshift-account:catalog"
            ]
        }
    ]
}             
            </code></pre>
            <p>A consulta de exemplo a seguir lista os bancos de dados atuais.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
SELECT * FROM SVV_EXTERNAL_DATABASES WHERE
databasename = 'example_db1' or databasename = 'example_db2';
            </code></pre>
            <p>A seguinte política do IAM fornece as permissões mínimas necessárias para listar os bancos de dados atuais.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
<span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "glue:GetDatabases"
            ],
            "Resource": [
                "arn:aws:glue:us-west-2:redshift-account:database/example_db1",
                "arn:aws:glue:us-west-2:redshift-account:database/example_db2",
                "arn:aws:glue:us-west-2:redshift-account:catalog"

            ]
        }
    ]
}                    
            </code></pre>
          
          
            <h3 id="c-spectrum-glue-acess-tables">Política para operações de tabela</h3>
            <p>Para conceder aos usuários permissões para exibir, criar, descartar, alterar ou executar outras ações em tabelas, eles precisarão de vários tipos de acesso. Eles precisam de acesso às próprias tabelas, aos bancos de dados ao qual elas pertencem e ao catálogo.</p>
            <p>A consulta de exemplo a seguir cria uma tabela externa.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
CREATE EXTERNAL TABLE example_db.example_tbl0(
    col0 INT,
    col1 VARCHAR(255)
) PARTITIONED BY (part INT) STORED AS TEXTFILE
LOCATION 's3://test/s3/location/';              
            </code></pre>
            <p>A seguinte política do IAM fornece as permissões mínimas necessárias para criar uma tabela externa.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
<span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "glue:CreateTable"
            ],
            "Resource": [
                "arn:aws:glue:us-west-2:redshift-account:catalog",
                "arn:aws:glue:us-west-2:redshift-account:database/example_db",
                "arn:aws:glue:us-west-2:redshift-account:table/example_db/example_tbl0"
            ]
        }
    ]
}               
            </code></pre>
            <p>O exemplo a seguir consulta cada lista das tabelas externas atuais.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
SELECT * FROM svv_external_tables
WHERE tablename = 'example_tbl0' OR
tablename = 'example_tbl1';               
            </code></pre>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
SELECT * FROM svv_external_columns
WHERE tablename = 'example_tbl0' OR
tablename = 'example_tbl1';               
            </code></pre>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
SELECT parameters FROM svv_external_tables
WHERE tablename = 'example_tbl0' OR
tablename = 'example_tbl1';               
            </code></pre>
            <p>A seguinte política do IAM fornece as permissões mínimas necessárias para listar as tabelas externas atuais.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
<span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "glue:GetTables"
            ],
            "Resource": [
                "arn:aws:glue:us-west-2:redshift-account:catalog",
                "arn:aws:glue:us-west-2:redshift-account:database/example_db",
                "arn:aws:glue:us-west-2:redshift-account:table/example_db/example_tbl0",
                "arn:aws:glue:us-west-2:redshift-account:table/example_db/example_tbl1"

            ]
        }
    ]
}    
            
            </code></pre>
            <p>A consulta de exemplo a seguir altera uma tabela existente.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
ALTER TABLE example_db.example_tbl0
SET TABLE PROPERTIES ('numRows' = '100');               
            </code></pre>
            <p>A seguinte política do IAM fornece as permissões mínimas necessárias para alterar uma tabela existente.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
<span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "glue:GetTable",
                "glue:UpdateTable"
            ],
            "Resource": [
                "arn:aws:glue:us-west-2:redshift-account:catalog",
                "arn:aws:glue:us-west-2:redshift-account:database/example_db",
                "arn:aws:glue:us-west-2:redshift-account:table/example_db/example_tbl0"

            ]
        }
    ]
}       
</code></pre>
            <p>A consulta de exemplo a seguir descarta uma tabela existente.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
DROP TABLE example_db.example_tbl0;                       
            </code></pre>
            <p>A seguinte política do IAM fornece as permissões mínimas necessárias para descartar uma tabela existente.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
<span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "glue:DeleteTable"
            ],
            "Resource": [
                "arn:aws:glue:us-west-2:redshift-account:catalog",
                "arn:aws:glue:us-west-2:redshift-account:database/example_db",
                "arn:aws:glue:us-west-2:redshift-account:table/example_db/example_tbl0"
            ]
        }
    ]
}           
            </code></pre>


          

          
            <h3 id="c-spectrum-glue-acess-partitions">Política para operações de partição</h3>
            <p>Se quiser conceder aos usuários permissões para executar operações no nível da partição (exibir, criar, soltar, alterar e assim por diante), eles precisarão de permissões para as tabelas às quais as partições pertencem. Eles também precisarão de permissões para os bancos de dados relacionados e o catálogo de dados do AWS Glue.</p>
            <p>A consulta de exemplo a seguir cria uma partição.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
ALTER TABLE example_db.example_tbl0
ADD PARTITION (part=0) LOCATION 's3://test/s3/location/part=0/';
ALTER TABLE example_db.example_t
ADD PARTITION (part=1) LOCATION 's3://test/s3/location/part=1/';               
            </code></pre>
            <p>A seguinte política do IAM fornece as permissões mínimas necessárias para criar uma partição.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
 <span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "glue:GetTable",
                "glue:BatchCreatePartition"
            ],
            "Resource": [
                "arn:aws:glue:us-west-2:redshift-account:catalog",
                "arn:aws:glue:us-west-2:redshift-account:database/example_db",
                "arn:aws:glue:us-west-2:redshift-account:table/example_db/example_tbl0"
            ]
        }
    ]
}              
            </code></pre>

            <p>A consulta de exemplo a seguir lista as partições atuais.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">

SELECT * FROM svv_external_partitions
WHERE schemname = 'example_db' AND
tablename = 'example_tbl0'               
            </code></pre>

            <p>A seguinte política do IAM fornece as permissões mínimas necessárias para listar as partições atuais.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">

<span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "glue:GetPartitions",
                "glue:GetTables",
                "glue:GetTable"
            ],
            "Resource": [
                "arn:aws:glue:us-west-2:redshift-account:catalog",
                "arn:aws:glue:us-west-2:redshift-account:database/example_db",
                "arn:aws:glue:us-west-2:redshift-account:table/example_db/example_tbl0"
            ]
        }
    ]
}               
            </code></pre>

            <p>A consulta de exemplo a seguir altera uma partição existente.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
ALTER TABLE example_db.example_tbl0 PARTITION(part='0')
SET LOCATION 's3://test/s3/new/location/part=0/';               
            </code></pre>
            <p>A seguinte política do IAM fornece as permissões mínimas necessárias para alterar uma partição existente.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">

<span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "glue:GetPartition",
                "glue:UpdatePartition"
            ],
            "Resource": [
                "arn:aws:glue:us-west-2:redshift-account:catalog",
                "arn:aws:glue:us-west-2:redshift-account:database/example_db",
                "arn:aws:glue:us-west-2:redshift-account:table/example_db/example_tbl0"
            ]
        }
    ]
}               
            </code></pre>

            <p>A consulta de exemplo a seguir descarta uma partição existente.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">
ALTER TABLE example_db.example_tbl0 DROP PARTITION(part='0');               
            </code></pre>
            <p>A seguinte política do IAM fornece as permissões mínimas necessárias para destacar uma partição existente.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">

<span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "glue:DeletePartition"
            ],
            "Resource": [
                "arn:aws:glue:us-west-2:redshift-account:catalog",
                "arn:aws:glue:us-west-2:redshift-account:database/example_db",
                "arn:aws:glue:us-west-2:redshift-account:table/example_db/example_tbl0"
            ]
        }
    ]
}               
            </code></pre>
          

      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./c-getting-started-using-spectrum-query-s3-data-cfn.html">Iniciar a pilha do CloudFormation e consultar seus dados</div><div id="next" class="next-link" accesskey="n" href="./spectrum-lake-formation.html">Usar Redshift Spectrum com Lake Formation</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-spectrum-iam-policies.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c-spectrum-iam-policies.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>