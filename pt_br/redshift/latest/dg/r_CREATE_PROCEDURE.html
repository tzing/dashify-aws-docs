<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CREATE PROCEDURE - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_CREATE_PROCEDURE" /><meta name="default_state" content="r_CREATE_PROCEDURE" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><meta name="description" content="Cria um novo procedimento armazenado ou substitui um procedimento existente para o banco de dados atual." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guia do desenvolvedor de banco de dados" /><meta name="abstract" content="Crie e gerencie um data warehouse com o Amazon Redshift, um serviço de data warehouse totalmente gerenciado, em escala de petabyte e de nível empresarial." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_PROCEDURE.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guia do desenvolvedor de banco de dados" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guia do desenvolvedor de banco de dados" /><meta id="panorama-serviceConsolePage" value="CREATE PROCEDURE" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>CREATE PROCEDURE - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_CREATE_PROCEDURE" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_PROCEDURE.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,desenvolvedor,dados de amostra,banco de dados,desenvolvedor do banco de dados,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do desenvolvedor de banco de dados",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Referência SQL",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Comandos SQL",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "CREATE PROCEDURE",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_SQL_commands.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_CREATE_PROCEDURE" target="_blank" rel="noopener noreferrer" title="Abrir em PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guia do desenvolvedor de banco de dados</a></div><div id="page-toc-src"><a href="#r_CREATE_PROCEDURE-privileges">Privilégios obrigatórios</a><a href="#r_CREATE_PROCEDURE-synopsis">Sintaxe</a><a href="#r_CREATE_PROCEDURE-parameters">Parâmetros</a><a href="#r_CREATE_PROCEDURE-usage">Observações de uso</a><a href="#r_CREATE_PROCEDURE-examples">Exemplos</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="r_CREATE_PROCEDURE">CREATE PROCEDURE</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Cria um novo procedimento armazenado ou substitui um procedimento existente para o banco de dados atual.</p><p>Para ter mais informações e exemplos, consulte <a href="./stored-procedure-overview.html">Criar procedimentos armazenados no Amazon Redshift</a>.</p>
         <h2 id="r_CREATE_PROCEDURE-privileges">Privilégios obrigatórios</h2>
         <p>A seguir estão os privilégios obrigatórios para CREATE PROCEDURE:</p>
         <div class="itemizedlist">
             
             
         <ul class="itemizedlist"><li class="listitem">
               <p>Para CREATE PROCEDURE:</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p>Superusuário</p>
                  </li><li class="listitem">
                     <p>Usuários com o privilégio CREATE [ OR REPLACE ] PROCEDURE</p>
                  </li></ul></div>
            </li><li class="listitem">
               <p>Para REPLACE PROCEDURE:</p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p>Superusuário</p>
                  </li><li class="listitem">
                     <p>Usuários com o privilégio CREATE [ OR REPLACE ] PROCEDURE</p>
                  </li><li class="listitem">
                     <p>Proprietário do procedimento</p>
                  </li></ul></div>
            </li></ul></div>
       
         <h2 id="r_CREATE_PROCEDURE-synopsis">Sintaxe</h2>

         
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">CREATE [ OR REPLACE ] PROCEDURE sp_procedure_name  
  ( [ [ argname ] [ argmode ] argtype [, ...] ] )
[ NONATOMIC ]
AS $$
  procedure_body
$$ LANGUAGE plpgsql
[ <span>{</span> SECURITY INVOKER | SECURITY DEFINER } ]
[ SET configuration_parameter <span>{</span> TO value | = value } ]
</code></pre>
       
         <h2 id="r_CREATE_PROCEDURE-parameters">Parâmetros</h2>
         <div class="variablelist">
             
             
             
             
             
             
             
             
             
         <dl>
               <dt><span class="term"> OR REPLACE </span></dt>
               <dd>
                  <p>Uma cláusula que especifica que, se um procedimento com o mesmo nome e tipos de dados do argumento de entrada, ou assinatura, como esse já existir, o procedimento existente será substituído. Só é possível substituir um procedimento por um novo procedimento que defina um conjunto idêntico de tipos de dados. É necessário ser um usuário avançado ou o proprietário para substituir um procedimento.</p>
                  <p>Se você definir um procedimento com o mesmo nome de um procedimento existente, mas com uma assinatura diferente, um novo procedimento será criado. Em outras palavras, o nome do procedimento é sobrecarregado. Para obter mais informações, consulte <a href="./stored-procedure-naming.html#stored-procedure-overloading-name">Sobrecarga de nomes de procedimento</a>. </p>
               </dd>
             
               <dt><span class="term"> <em>sp_procedure_name</em> </span></dt>
               <dd>
                  <p>O nome do procedimento. Se você especificar um nome de esquema (como <code class="userinput">myschema.myprocedure</code>), o procedimento será criado no esquema especificado. Caso contrário, o procedimento será criado no esquema atual. Para obter mais informações sobre nomes válidos, consulte <a href="./r_names.html">Nomes e identificadores</a>. </p>
                  <p>Recomendamos que você prefixe os nomes de todos os UDF com <code class="code">sp_</code>. O Amazon Redshift reserva o prefixo <code class="code">sp_</code> para nomes de procedimentos armazenados. Ao usar o prefixo <code class="code">sp_</code>, você garante que o seu nome de procedimento armazenado não entra em conflito com qualquer procedimento armazenado integrado ao Amazon Redshift existente ou futuro ou nomes de função. Para obter mais informações, consulte <a href="./stored-procedure-naming.html">Nomeação de procedimentos armazenados</a>.</p>
                  <p>É possível definir mais de um procedimento com o mesmo nome se os tipos de dados dos argumentos de entrada, ou assinaturas, forem diferentes. Em outras palavras, nesse caso, o nome do procedimento é sobrecarregado. Para obter mais informações, consulte <a href="./stored-procedure-naming.html#stored-procedure-overloading-name">Sobrecarga de nomes de procedimento</a></p>
               </dd>
             
               <dt><span class="term"><em>[argname] [ argmode] argtype</em> </span></dt>
               <dd>
                  <p>Uma lista de nomes de argumentos, modos de argumentos e tipos de dados. Somente o tipo de dados é obrigatório. O nome e o modo são opcionais e suas posições podem ser alternadas.</p>
                  <p>O modo do argumento pode ser IN, OUT ou INOUT. O padrão é IN.</p>
                  <p>Use argumentos OUT e INOUT para retornar um ou mais valores de uma chamada de procedimento. Quando houver argumentos OUT ou INOUT, a chamada de procedimento retorna uma linha de resultados que contém <em>n</em> colunas, onde <em>n</em> é o número total de argumentos OUT ou INOUT.</p>
                  <p>Argumentos INOUT são argumentos de entrada e saída ao mesmo tempo. <em>Argumentos de entrada</em> incluem argumentos IN e INOUT, e <em>argumentos de saída</em> incluem argumentos OUT e INOUT.</p>
                  
                  <p>Argumentos OUT não são especificados como parte da instrução CALL. Especifique argumentos INOUT na instrução CALL do procedimento armazenado. Argumentos INOUT podem ser úteis ao enviar e retornar valores de uma chamada aninhada, bem como ao retornar um <code class="code">refcursor</code>. Para obter mais informações sobre os tipos <code class="code">refcursor</code>, consulte <a href="./c_PLpgSQL-statements.html#r_PLpgSQL-cursors">Cursores</a>.</p>
                  <p>Os tipos de dados de argumento podem ser qualquer tipo de dados padrão do Amazon Redshift. Além disso, um tipo de dados de argumento pode ser <code class="code">refcursor</code>.</p>
                  <p>Você pode especificar no máximo 32 argumentos de entrada e 32 argumentos de saída. </p>
               </dd>
             
               <dt><span class="term">AS $$ <em>procedure_body</em> $$ </span></dt>
               <dd>
                  <p>Uma construção que delimita o procedimento a ser executado. As palavras-chave literais AS $$ e $$ são obrigatórias.</p>
                  <p>O Amazon Redshift exige que você inclua a instrução em seu procedimento usando um formato chamado cotação de dólar. Qualquer item incluído na instrução é aprovado exatamente como está. Não é preciso inserir caracteres de escape antes dos caracteres especiais, pois o conteúdo da string é gravado literalmente.</p>
                  <p>Com a <em>cotação de dólar</em>, um par de símbolos de cifrão ($$) deve ser usado no início e no final da instrução para que ela seja executada, conforme exibido no exemplo a seguir.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">$$ my statement $$</code></pre>
                  <p>Como opção, entre cada par de símbolos de cifrão, você pode especificar uma string para ajudar a identificar a instrução. A string que você usa deve ser a mesma no início e no final dos pares de sinais. A sequência diferencia maiúsculas de minúsculas e segue as mesmas restrições de um identificador sem aspas, com a exceção de que não pode conter cifrões. O exemplo a seguir usa a string test.</p>
                  <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">$test$ my statement $test$</code></pre>
                  <p>Essa sintaxe também é útil para cotação de dólar aninhada. Para obter mais informações sobre o uso de símbolos de cifrão, consulte “Constantes de string entre símbolos de cifrão” em <a href="https://www.postgresql.org/docs/9.0/sql-syntax-lexical.html" rel="noopener noreferrer" target="_blank"><span>Estrutura lexical</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> na documentação do PostgreSQL.</p>
               </dd>
             
               <dt><span class="term"> <em>procedure_body</em> </span></dt>
               <dd>
                  <p>Um conjunto de instruções válidas da PL/pgSQL. As instruções da PL/pgSQL aumentam comandos SQL com construções processuais, incluindo loops e expressões condicionais, a fim de controlar o fluxo lógico. A maioria dos comandos SQL podem ser usados no corpo do procedimento, incluindo linguagem de modificação de dados (DML), como COPY, UNLOAD e INSERT, e linguagem de definição de dados (DDL), como CREATE TABLE. Para obter mais informações, consulte <a href="./c_pl_pgSQL_reference.html">Referência da linguagem PL/pgSQL</a>. </p>
               </dd>
             
               <dt><span class="term">LANGUAGE <em>plpgsql</em></span></dt>
               <dd>
                  <p>Um valor de linguagem. Especifique <code class="code">plpgsql</code>. É necessário ter permissão de uso na linguagem para usar <code class="code">plpgsql</code>. Para obter mais informações, consulte <a href="./r_GRANT.html">GRANT</a>. </p>
               </dd>
             
                            
               <dt><span class="term">NONATOMIC</span></dt>
               <dd>
                  
                  <p>Cria o procedimento armazenado em um modo de transação não atômico. O modo NONATOMIC confirma automaticamente as instruções dentro do procedimento. Além disso, quando ocorre um erro dentro do procedimento NONATOMIC, o erro não será relançado se for tratado por um bloco de exceções. Para obter mais informações, consulte <a href="./stored-procedure-transaction-management.html">Gerenciamento de transações</a> e <a href="./c_PLpgSQL-statements.html#r_PLpgSQL-messages-errors">RAISE</a>.</p>
                  <p>Ao definir um procedimento armazenado como <code class="code">NONATOMIC</code>, considere o seguinte:</p>
                  <div class="itemizedlist">
                      
                      
                     
                      
                     
                  <ul class="itemizedlist"><li class="listitem"><p>Quando você aninha chamadas de procedimentos armazenados, todos os procedimentos devem ser criados no mesmo modo de transação.</p></li><li class="listitem"><p>A opção <code class="code">SECURITY DEFINER</code> e a opção <code class="code">SET configuration_parameter</code> não são compatíveis ao criar um procedimento no modo NONATOMIC.</p></li><li class="listitem"><p>Qualquer cursor aberto (explícita ou implicitamente) será fechado automaticamente quando uma confirmação implícita for processada. Portanto, você deve abrir uma transação explícita antes de iniciar um loop de cursor para garantir que nenhuma instrução SQL dentro da iteração do loop seja confirmada implicitamente.</p></li></ul></div>
               </dd>
               
             
               <dt><span class="term">SECURITY INVOKER | SECURITY DEFINER</span></dt>
               <dd>
                  <p>A opção <code class="code">SECURITY DEFINER</code> não é compatível quando <code class="code">NONATOMIC</code> é especificado.</p>
                  <p>O modo de segurança para o procedimento determina os privilégios de acesso do procedimento em tempo de execução. O procedimento deve ter permissão para acessar os objetos de banco de dados subjacentes. </p>
                  <p>Para o modo SECURITY INVOKER, o procedimento usa os privilégios do usuário que chama o procedimento. O usuário deve ter permissões explícitas para os objetos de banco de dados subjacentes. O padrão é SECURITY INVOKER.</p>
                  <p>Para o modo SECURITY DEFINER, o procedimento usa os privilégios do proprietário do procedimento. O proprietário do procedimento é definido como o usuário que possui o procedimento no tempo de execução, não necessariamente o usuário que definiu o procedimento inicialmente. O usuário que chama o procedimento precisa ter privilégio de execução no procedimento, mas não precisa de qualquer privilégio nos objetos subjacentes. </p>
               </dd>
             
               <dt><span class="term">SET configuration_parameter <span>{</span> TO value | = value }</span></dt>
               <dd>
                  <p>Essas opções não são compatíveis quando <code class="code">NONATOMIC</code> é especificado.</p>
                  <p>A cláusula SET faz com que o <code class="code">configuration_parameter</code> especificado seja definido como o valor especificado quando o procedimento for inserido. Depois, essa cláusula restaurará <code class="code">configuration_parameter</code> para seu valor anterior quando o procedimento sair. </p>
               </dd>
            </dl></div>
       
         <h2 id="r_CREATE_PROCEDURE-usage">Observações de uso</h2>
         <p>Se um procedimento armazenado tiver sido criado usando a opção SECURITY DEFINER, ao invocar a função CURRENT_USER de dentro do procedimento armazenado, o Amazon Redshift retornará o nome de usuário do proprietário do procedimento armazenado.</p>
       
         <h2 id="r_CREATE_PROCEDURE-examples">Exemplos</h2>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Se você encontrar um erro na execução desses exemplos parecido com:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">ERROR: 42601: [Amazon](500310) unterminated dollar-quoted string at or near "$$</code></pre><p>Consulte <a href="./stored-procedure-create.html">Visão geral dos procedimentos armazenados no Amazon Redshift</a>. </p></div></div>
         <p>O exemplo a seguir cria um procedimento com dois parâmetros de entrada.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE OR REPLACE PROCEDURE test_sp1(f1 int, f2 varchar(20))
AS $$
DECLARE
  min_val int;
BEGIN
  DROP TABLE IF EXISTS tmp_tbl;
  CREATE TEMP TABLE tmp_tbl(id int);
  INSERT INTO tmp_tbl values (f1),(10001),(10002);
  SELECT INTO min_val MIN(id) FROM tmp_tbl;
  RAISE INFO 'min_val = %, f2 = %', min_val, f2;
END;
$$ LANGUAGE plpgsql;
</code></pre>
         
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p> Quando você escreve procedimentos armazenados, recomendamos a prática de proteger valores confidenciais: </p><p> Não codifique nenhuma informação confidencial na lógica do procedimento armazenado. Por exemplo, não atribua uma senha de usuário em uma instrução CREATE USER no corpo de um procedimento armazenado. Isso representa um risco de segurança, pois valores codificados podem ser registrados como metadados de esquema nas tabelas do catálogo. Em vez disso, transmita valores confidenciais, como senhas, como argumentos ao procedimento armazenado por meio de parâmetros. </p><p>Para obter mais informações sobre os procedimentos armazenados, consulte <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_PROCEDURE.html">CREATE PROCEDURE</a> e <a href="https://docs.aws.amazon.com/redshift/latest/dg/stored-procedure-overview.html">“Criar procedimentos armazenados no Amazon Redshift”</a>. Para obter mais informações sobre tabelas de catálogo, consulte <a href="https://docs.aws.amazon.com/redshift/latest/dg/c_intro_catalog_views.html">“Tabelas de catálogo do sistema”</a>.</p></div></div>

         <p>O exemplo a seguir cria um procedimento com um parâmetro IN, um parâmetro OUT e um parâmetro INOUT.</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="">CREATE OR REPLACE PROCEDURE test_sp2(f1 IN int, f2 INOUT varchar(256), out_var OUT varchar(256))
AS $$
DECLARE
  loop_var int;
BEGIN
  IF f1 is null OR f2 is null THEN
    RAISE EXCEPTION 'input cannot be null';
  END IF;
  DROP TABLE if exists my_etl;
  CREATE TEMP TABLE my_etl(a int, b varchar);
    FOR loop_var IN 1..f1 LOOP
        insert into my_etl values (loop_var, f2);
        f2 := f2 || '+' || f2;
    END LOOP;
  SELECT INTO out_var count(*) from my_etl;
END;
$$ LANGUAGE plpgsql;
</code></pre>
         
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_create_model_use_cases.html">Casos de uso</div><div id="next" class="next-link" accesskey="n" href="./r_CREATE_RLS_POLICY.html">CREATE RLS POLICY</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_PROCEDURE.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_CREATE_PROCEDURE.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>