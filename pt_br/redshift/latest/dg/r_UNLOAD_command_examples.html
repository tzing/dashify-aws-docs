<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Exemplos de UNLOAD - Amazon Redshift</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="r_UNLOAD_command_examples" /><meta name="default_state" content="r_UNLOAD_command_examples" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_UNLOAD_command_examples.html" /><meta name="description" content="Fornece exemplos de como usar o comando UNLOAD." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Redshift" /><meta name="guide" content="Guia do desenvolvedor de banco de dados" /><meta name="abstract" content="Crie e gerencie um data warehouse com o Amazon Redshift, um serviço de data warehouse totalmente gerenciado, em escala de petabyte e de nível empresarial." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_UNLOAD_command_examples.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/redshift/latest/dg/r_UNLOAD_command_examples.html" hreflang="x-default" /><meta name="feedback-item" content="Redshift" /><meta name="this_doc_product" content="Amazon Redshift" /><meta name="this_doc_guide" content="Guia do desenvolvedor de banco de dados" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'redshift'}"></script><meta id="panorama-serviceSubSection" value="Guia do desenvolvedor de banco de dados" /><meta id="panorama-serviceConsolePage" value="Exemplos de UNLOAD" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Exemplos de UNLOAD - Amazon Redshift</title><meta name="pdf" content="redshift-dg.pdf#r_UNLOAD_command_examples" /><meta name="rss" content="Dochistory.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=155" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_UNLOAD_command_examples.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_UNLOAD_command_examples.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_UNLOAD_command_examples.html" /><meta name="keywords" content="Amazon Redshift,AWS Redshift,Redshift,Redshift Spectrum,cluster,data warehouse,desenvolvedor,dados de amostra,banco de dados,desenvolvedor do banco de dados,HLL" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Redshift",
        "item" : "https://docs.aws.amazon.com/redshift/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do desenvolvedor de banco de dados",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Referência SQL",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/cm_chap_SQLCommandRef.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Comandos SQL",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/c_SQL_commands.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "UNLOAD",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_UNLOAD.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Exemplos de UNLOAD",
        "item" : "https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_UNLOAD.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="redshift-dg.pdf#r_UNLOAD_command_examples" target="_blank" rel="noopener noreferrer" title="Abrir em PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/redshift/index.html">Amazon Redshift</a><a href="welcome.html">Guia do desenvolvedor de banco de dados</a></div><div id="page-toc-src"><a href="#unload-examples-venue">Descarregar VENUE para um arquivo delimitado por barras (delimitador padrão)</a><a href="#unload-examples-partitioned-parquet">Descarregar tabela LINEITEM para arquivos Parquet particionados</a><a href="#unload-examples-json">Descarregue a tabela VENUE para um arquivo JSON</a><a href="#unload-examples-csv">Descarregar VENUE para um arquivo CSV</a><a href="#unload-examples-csv-delimiter">Descarregar VENUE para um arquivo CSV usando um delimitador</a><a href="#unload-examples-manifest">Descarregar VENUE com um arquivo manifesto</a><a href="#unload-examples-manifest-verbose">Descarregar VENUE com MANIFEST VERBOSE</a><a href="#unload-examples-header">Descarregar VENUE com um cabeçalho</a><a href="#unload-examples-maxfilesize">Descarregar VENUE em arquivos menores</a><a href="#unload-examples-serial">Descarregar VENUE em série</a><a href="#unload-examples-load">Carregar VENUE dos arquivos de descarregamento</a><a href="#unload-examples-unload-encrypted">Descarregar VENUE em arquivos criptografados</a><a href="#unload-examples-load-encrypted">Carregar VENUE dos arquivos criptografados</a><a href="#unload-examples-venue-tab">Descarregar dados de VENUE para um arquivo delimitado por tabulação</a><a href="#unload-venue-fixed-width">Descarregar VENUE para um arquivo de dados de largura fixa</a><a href="#unload-examples-venue-gzip">Descarregar VENUE para um conjunto de arquivos GZIP compactados delimitados por tabulação</a><a href="#unload-examples-venue-extension-gzip">Descarregue VENUE em um arquivo de texto compactado com GZIP</a><a href="#unload-examples-delimiter">Descarregar dados que contêm um delimitador</a><a href="#unload-examples-join">Descarregar os resultados de uma consulta de junção</a><a href="#unload-examples-null-as">Descarregar usando NULL AS</a><a href="#unload-examples-allowoverwrite">Descarregar usando o parâmetro ALLOWOVERWRITE</a><a href="#unload-examples-manifest-parallel">Descarregue a tabela EVENT usando os parâmetros PARALLEL e MANIFEST</a><a href="#unload-examples-manifest-serial">Descarregue a tabela EVENT usando os parâmetros PARALLEL OFF e MANIFEST</a><a href="#unload-examples-manifest-partition">Descarregue a tabela EVENT usando os parâmetros PARTITION BY e MANIFEST</a><a href="#unload-examples-manifest-maxsize">Descarregue a tabela EVENT usando os parâmetros MAXFILESIZE, ROWGROUPSIZE e MANIFEST</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="r_UNLOAD_command_examples">Exemplos de UNLOAD</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Esses exemplos demonstram vários parâmetros do comando UNLOAD. Os dados de amostra de TICKIT são usados em muitos dos exemplos. Para obter mais informações, consulte <a href="./c_sampledb.html">Banco de dados de exemplo</a>.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Estes exemplos contêm quebras de linha para garantir legibilidade. Não inclua quebras de linha nem espaços na string <em>credentials-args</em>.</p></div></div>
            <h2 id="unload-examples-venue">Descarregar VENUE para um arquivo delimitado por barras (delimitador padrão)</h2>

            <p>O exemplo a seguir descarrega a tabela VENUE e grava os dados em <code class="code">s3://mybucket/unload/</code>: </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/unload/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole';</code></pre>
            <p>Por padrão, UNLOAD grava um ou mais arquivos por fatia. Pressupondo um cluster de dois nós com duas fatias por nó, o exemplo anterior cria estes arquivos em <code class="code">mybucket</code>:</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">unload/0000_part_00
unload/0001_part_00
unload/0002_part_00
unload/0003_part_00</code></pre>
            
            <p>Para melhor diferenciar os arquivos de saída, você pode incluir um prefixo no local. O exemplo a seguir descarrega a tabela VENUE e grava os dados em <code class="code">s3://mybucket/unload/venue_pipe_</code>: </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/unload/venue_pipe_'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole';</code></pre>
            <p>Como resultado, temos os quatro arquivos na pasta <code class="code">unload</code>, mais uma vez pressupondo quatro fatias.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">venue_pipe_0000_part_00
venue_pipe_0001_part_00
venue_pipe_0002_part_00
venue_pipe_0003_part_00</code></pre>
          
            <h2 id="unload-examples-partitioned-parquet">Descarregar tabela LINEITEM para arquivos Parquet particionados</h2>
            <p>O exemplo a seguir descarrega a tabela LINEITEM no formato Parquet, particionada pela coluna <code class="code">l_shipdate</code>. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from lineitem')
to 's3://mybucket/lineitem/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
PARQUET
PARTITION BY (l_shipdate);
</code></pre>
            <p>Assumindo que há quatro fatias, os arquivos Parquet resultantes são particionados dinamicamente em várias pastas. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">
s3://mybucket/lineitem/l_shipdate=1992-01-02/0000_part_00.parquet
                                             0001_part_00.parquet
                                             0002_part_00.parquet
                                             0003_part_00.parquet
s3://mybucket/lineitem/l_shipdate=1992-01-03/0000_part_00.parquet
                                             0001_part_00.parquet
                                             0002_part_00.parquet
                                             0003_part_00.parquet
s3://mybucket/lineitem/l_shipdate=1992-01-04/0000_part_00.parquet
                                             0001_part_00.parquet
                                             0002_part_00.parquet
                                             0003_part_00.parquet
...
</code></pre>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Em alguns casos, o comando UNLOAD usou a opção INCLUDE, conforme mostrado na instrução SQL a seguir. </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from lineitem')
to 's3://mybucket/lineitem/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
PARQUET
PARTITION BY (l_shipdate) INCLUDE;
</code></pre><p>Nesses casos, a coluna <code class="code">l_shipdate</code> também está nos dados nos arquivos Parquet. Caso contrário, os dados da coluna <code class="code">l_shipdate</code> não estão nos arquivos Parquet.</p></div></div>
          
            <h2 id="unload-examples-json">Descarregue a tabela VENUE para um arquivo JSON</h2>
            <p>O exemplo a seguir descarrega a tabela VENUE e grava os dados no formato JSON em <code class="code">s3://mybucket/unload/</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="SQL ">unload ('select * from venue')
to 's3://mybucket/unload/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
JSON;</code></pre>
            <p>As linhas de exemplo são exemplos da tabela VENUE.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">venueid | venuename                  | venuecity       | venuestate | venueseats
--------+----------------------------+-----------------+------------+-----------
      1 | Pinewood Racetrack         | Akron           | OH         | 0
      2 | Columbus "Crew" Stadium    | Columbus        | OH         | 0
      4 | Community, Ballpark, Arena | Kansas City     | KS         | 0</code></pre>
            <p>Após o descarregamento para JSON, o formato do arquivo é semelhante ao seguinte.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>"venueid":1,"venuename":"Pinewood Racetrack","venuecity":"Akron","venuestate":"OH","venueseats":0}
<span>{</span>"venueid":2,"venuename":"Columbus \"Crew\" Stadium ","venuecity":"Columbus","venuestate":"OH","venueseats":0}
<span>{</span>"venueid":4,"venuename":"Community, Ballpark, Arena","venuecity":"Kansas City","venuestate":"KS","venueseats":0}</code></pre>
          
            <h2 id="unload-examples-csv">Descarregar VENUE para um arquivo CSV</h2>
            <p>O exemplo a seguir descarrega a tabela VENUE e grava os dados no formato CSV em <code class="code">s3://mybucket/unload/</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/unload/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
CSV;</code></pre>
            <p>Suponha que a tabela VENUE contenha as linhas a seguir.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">
venueid | venuename                  | venuecity       | venuestate | venueseats
--------+----------------------------+-----------------+------------+-----------
      1 | Pinewood Racetrack         | Akron           | OH         | 0
      2 | Columbus "Crew" Stadium    | Columbus        | OH         | 0
      4 | Community, Ballpark, Arena | Kansas City     | KS         | 0
            </code></pre>
            <p>O arquivo de descarregamento é semelhante ao seguinte.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">1,Pinewood Racetrack,Akron,OH,0
2,"Columbus ""Crew"" Stadium",Columbus,OH,0
4,"Community, Ballpark, Arena",Kansas City,KS,0</code></pre>
          
            <h2 id="unload-examples-csv-delimiter">Descarregar VENUE para um arquivo CSV usando um delimitador</h2>
            <p>O exemplo a seguir descarrega a tabela VENUE e grava os dados no formato CSV usando o caractere de barra vertical (|) como delimitador. O arquivo descarregado é gravado em <code class="code">s3://mybucket/unload/</code>. Neste exemplo, a tabela VENUE contém o caractere de barra vertical no valor da primeira linha (<code class="code">Pinewood Race|track</code>). Isso é feito para mostrar que o valor no resultado está entre aspas duplas. Aspas duplas são recuadas por aspas duplas e todo o campo é colocado entre aspas duplas. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/unload/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
CSV DELIMITER AS '|';</code></pre>
            <p>Suponha que a tabela VENUE contenha as linhas a seguir.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">
venueid | venuename                  | venuecity       | venuestate | venueseats
--------+----------------------------+-----------------+------------+-------------
      1 | Pinewood Race|track        | Akron           | OH         | 0
      2 | Columbus "Crew" Stadium    | Columbus        | OH         | 0
      4 | Community, Ballpark, Arena | Kansas City     | KS         | 0
</code></pre>
            <p>O arquivo de descarregamento é semelhante ao seguinte.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">1|"Pinewood Race|track"|Akron|OH|0
2|"Columbus ""Crew"" Stadium"|Columbus|OH|0
4|Community, Ballpark, Arena|Kansas City|KS|0
</code></pre>
          
            <h2 id="unload-examples-manifest">Descarregar VENUE com um arquivo manifesto</h2>
            <p>Para criar um arquivo manifesto, inclua a opção MANIFEST. O exemplo a seguir descarrega a tabela VENUE e grava um arquivo manifesto com arquivos de dados em s3: : //mybucket/venue_pipe_: </p>
            <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Importante</h6></div><div class="awsdocs-note-text"><p>Ao descarregar arquivos com a opção MANIFEST, você deve usar a opção MANIFEST com o comando COPY para carregar os arquivos. Se você usar o mesmo prefixo para carregar os arquivos e não especificar a opção MANIFEST, ocorrerá uma falha na opção COPY porque ela pressupõe que o arquivo de manifesto é um arquivo de dados.</p></div></div>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/venue_pipe_' iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
manifest;</code></pre>
            <p>O resultado são estes cinco arquivos:</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">s3://mybucket/venue_pipe_0000_part_00
s3://mybucket/venue_pipe_0001_part_00
s3://mybucket/venue_pipe_0002_part_00
s3://mybucket/venue_pipe_0003_part_00
s3://mybucket/venue_pipe_manifest</code></pre>
            <p>A seguir, você verá o conteúdo do arquivo manifesto. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "entries": [
    <span>{</span>"url":"s3://mybucket/tickit/venue_0000_part_00"},
    <span>{</span>"url":"s3://mybucket/tickit/venue_0001_part_00"},
    <span>{</span>"url":"s3://mybucket/tickit/venue_0002_part_00"},
    <span>{</span>"url":"s3://mybucket/tickit/venue_0003_part_00"}
  ]
}</code></pre>
          
            <h2 id="unload-examples-manifest-verbose">Descarregar VENUE com MANIFEST VERBOSE</h2>
            <p>Quando você especifica a opção MANIFEST VERBOSE, o arquivo manifesto inclui as seguintes seções: </p>
            <div class="itemizedlist">
                
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>A seção <code class="code">entries</code> lista o caminho, o tamanho e a contagem de linhas do Amazon S3 para cada arquivo. </p>
               </li><li class="listitem">
                  <p>A seção <code class="code">schema</code> lista os nomes das colunas, os tipos de dados e a dimensão de cada coluna. </p>
               </li><li class="listitem">
                  <p>A seção <code class="code">meta</code> mostra o tamanho total do arquivo e a contagem de linhas para todos os arquivos. </p>
               </li></ul></div>
            <p>O exemplo a seguir descarrega a tabela VENUE usando a opção MANIFEST VERBOSE. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/unload_venue_folder/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
manifest verbose;</code></pre>
            <p>A seguir, você verá o conteúdo do arquivo manifesto.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "entries": [
    <span>{</span>"url":"s3://mybucket/venue_pipe_0000_part_00", "meta": <span>{</span> "content_length": 32295, "record_count": 10 }},
    <span>{</span>"url":"s3://mybucket/venue_pipe_0001_part_00", "meta": <span>{</span> "content_length": 32771, "record_count": 20 }},
    <span>{</span>"url":"s3://mybucket/venue_pipe_0002_part_00", "meta": <span>{</span> "content_length": 32302, "record_count": 10 }},
    <span>{</span>"url":"s3://mybucket/venue_pipe_0003_part_00", "meta": <span>{</span> "content_length": 31810, "record_count": 15 }}
  ],
  "schema": <span>{</span>
    "elements": [
      <span>{</span>"name": "venueid", "type": <span>{</span> "base": "integer" }},
      <span>{</span>"name": "venuename", "type": <span>{</span> "base": "character varying", 25 }},
      <span>{</span>"name": "venuecity", "type": <span>{</span> "base": "character varying", 25 }},
      <span>{</span>"name": "venuestate", "type": <span>{</span> "base": "character varying", 25 }},
      <span>{</span>"name": "venueseats", "type": <span>{</span> "base": "character varying", 25 }}
    ]
  },
  "meta": <span>{</span>
    "content_length": 129178,
    "record_count": 55
  },
  "author": <span>{</span>
    "name": "Amazon Redshift",
    "version": "1.0.0"
  }
}</code></pre>
          
            <h2 id="unload-examples-header">Descarregar VENUE com um cabeçalho</h2>
            <p>O exemplo a seguir descarrega VENUE com uma linha de cabeçalho.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue where venueseats &gt; 75000')
to 's3://mybucket/unload/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
header
parallel off;</code></pre>
            <p>O seguinte mostra o conteúdo do arquivo de saída com uma linha de cabeçalho.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">venueid|venuename|venuecity|venuestate|venueseats
6|New York Giants Stadium|East Rutherford|NJ|80242
78|INVESCO Field|Denver|CO|76125
83|FedExField|Landover|MD|91704
79|Arrowhead Stadium|Kansas City|MO|79451</code></pre>
          
            <h2 id="unload-examples-maxfilesize">Descarregar VENUE em arquivos menores</h2>
            <p>Por padrão, o tamanho máximo de arquivo é 6,2 GB. Se os dados do descarregamento forem maiores de 6,2 GB, UNLOAD criará um novo arquivo para cada segmento de dados de 6,2 GB. Para criar arquivos menores, inclua o parâmetro MAXFILESIZE. Pressupondo que o tamanho dos dados no exemplo anterior foi 20 GB, o seguinte comando UNLOAD cria 20 arquivos, cada um com 1 GB.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/unload/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
maxfilesize 1 gb;
</code></pre>
          
            <h2 id="unload-examples-serial">Descarregar VENUE em série</h2>
            <p>Para descarregar em série, especifique PARALLEL OFF. UNLOAD gravará um arquivo por vez, com no máximo 6,2 GB por arquivo. </p>
            <p>O exemplo a seguir descarrega a tabela VENUE e grava os dados em série em <code class="code">s3://mybucket/unload/</code>. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/unload/venue_serial_'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
parallel off;</code></pre>
            <p>O resultado é um arquivo chamado venue_serial_000. </p>
            <p>Se os dados do descarregamento forem maiores de 6,2 GB, UNLOAD criará um novo arquivo para cada segmento de dados de 6,2 GB. O exemplo a seguir descarrega a tabela LINEORDER e grava os dados em série em <code class="code">s3://mybucket/unload/</code>. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from lineorder')
to 's3://mybucket/unload/lineorder_serial_'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
parallel off gzip;</code></pre>
            <p>O resultado é a seguinte série de arquivos.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">lineorder_serial_0000.gz
lineorder_serial_0001.gz
lineorder_serial_0002.gz
lineorder_serial_0003.gz</code></pre>
            <p>Para melhor diferenciar os arquivos de saída, você pode incluir um prefixo no local. O exemplo a seguir descarrega a tabela VENUE e grava os dados em <code class="code">s3://mybucket/venue_pipe_</code>: </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/unload/venue_pipe_'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole';</code></pre>
            <p>Como resultado, temos os quatro arquivos na pasta <code class="code">unload</code>, mais uma vez pressupondo quatro fatias.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">venue_pipe_0000_part_00
venue_pipe_0001_part_00
venue_pipe_0002_part_00
venue_pipe_0003_part_00</code></pre>
          
            <h2 id="unload-examples-load">Carregar VENUE dos arquivos de descarregamento</h2>
            <p>Para carregar uma tabela de um conjunto de arquivos de descarga, simplesmente inverta o processo usando um comando COPY. O exemplo a seguir cria uma nova tabela, LOADVENUE, e carrega a tabela dos arquivos de dados criados no exemplo anterior.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">create table loadvenue (like venue);

copy loadvenue from 's3://mybucket/venue_pipe_' iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole';</code></pre>
            <p>Se tiver usado a opção MANIFEST para criar um arquivo manifesto com seus arquivos de descarga, você poderá carregar os dados usando o mesmo arquivo manifesto. Você faz isso com um comando COPY com a opção MANIFEST. O exemplo a seguir carrega dados usando um arquivo manifesto.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">copy loadvenue
from 's3://mybucket/venue_pipe_manifest' iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
manifest;
</code></pre>
          
            <h2 id="unload-examples-unload-encrypted">Descarregar VENUE em arquivos criptografados</h2>
            <p>O exemplo a seguir descarrega a tabela VENUE para um conjunto de arquivos criptografados usando uma chave do AWS KMS. Se você especificar um arquivo manifesto com a opção ENCRYPTED, o arquivo manifesto também será criptografado. Para obter mais informações, consulte <a href="./t_unloading_encrypted_files.html">Descarregamento de arquivos de dados criptografados</a>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/venue_encrypt_kms'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
kms_key_id '1234abcd-12ab-34cd-56ef-1234567890ab'
manifest
encrypted;</code></pre>
            <p>O exemplo a seguir descarrega a tabela VENUE para um conjunto de arquivos criptografados usando uma chave simétrica raiz. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/venue_encrypt_cmk'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
master_symmetric_key 'EXAMPLEMASTERKEYtkbjk/OpCwtYSx/M4/t7DMCDIK722'
encrypted;</code></pre>
          
            <h2 id="unload-examples-load-encrypted">Carregar VENUE dos arquivos criptografados</h2>
            <p>Para carregar tabelas de um conjunto de arquivos que foram criados usando UNLOAD com a opção ENCRYPT, inverta o processo usando um comando COPY. Com esse comando, use a opção ENCRYPTED e especifique a mesma chave simétrica raiz que foi usada no comando UNLOAD. O exemplo a seguir carrega a tabela LOADVENUE a partir dos arquivos de dados criptografados criados no exemplo anterior.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">create table loadvenue (like venue);

copy loadvenue
from 's3://mybucket/venue_encrypt_manifest'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
master_symmetric_key 'EXAMPLEMASTERKEYtkbjk/OpCwtYSx/M4/t7DMCDIK722'
manifest
encrypted;</code></pre>
          
            <h2 id="unload-examples-venue-tab">Descarregar dados de VENUE para um arquivo delimitado por tabulação</h2>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select venueid, venuename, venueseats from venue')
to 's3://mybucket/venue_tab_'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
delimiter as '\t';</code></pre>
            <p>Os arquivos de dados de saída são semelhantes a: </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">1	Toyota Park	Bridgeview	IL	0
2	Columbus Crew Stadium	Columbus	OH	0
3	RFK Stadium	Washington	DC	0
4	CommunityAmerica Ballpark	Kansas City	KS	0
5	Gillette Stadium	Foxborough	MA	68756
...</code></pre>
          
            <h2 id="unload-venue-fixed-width">Descarregar VENUE para um arquivo de dados de largura fixa</h2>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/venue_fw_'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
fixedwidth as 'venueid:3,venuename:39,venuecity:16,venuestate:2,venueseats:6';</code></pre>
            <p>Os arquivos de dados de saída serão semelhantes a: </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">1  Toyota Park              Bridgeview  IL0
2  Columbus Crew Stadium    Columbus    OH0
3  RFK Stadium              Washington  DC0
4  CommunityAmerica BallparkKansas City KS0
5  Gillette Stadium         Foxborough  MA68756
...</code></pre>
          
            <h2 id="unload-examples-venue-gzip">Descarregar VENUE para um conjunto de arquivos GZIP compactados delimitados por tabulação</h2>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/venue_tab_'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
delimiter as '\t'
gzip;</code></pre>
          
            <h2 id="unload-examples-venue-extension-gzip">Descarregue VENUE em um arquivo de texto compactado com GZIP</h2>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/venue_tab_'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
extension 'txt.gz'
gzip;
</code></pre>
          
            <h2 id="unload-examples-delimiter">Descarregar dados que contêm um delimitador</h2>
            <p>Este exemplo usa a opção ADDQUOTES para descarregar dados delimitados por vírgula onde alguns dos campos de dados reais contêm uma vírgula.</p>
            <p>Primeiramente, crie uma tabela que contenha aspas.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">create table location (id int, location char(64));

insert into location values (1,'Phoenix, AZ'),(2,'San Diego, CA'),(3,'Chicago, IL');</code></pre>
            <p>Em seguida, descarregue os dados usando a opção ADDQUOTES.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select id, location from location')
to 's3://mybucket/location_'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
delimiter ',' addquotes;</code></pre>
            <p>Os arquivos de dados descarregados são semelhantes a: </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">1,"Phoenix, AZ"
2,"San Diego, CA"
3,"Chicago, IL"
...</code></pre>
          
            <h2 id="unload-examples-join">Descarregar os resultados de uma consulta de junção</h2>
            <p>O exemplo a seguir descarrega os resultados de uma consulta de junção que contém uma função de janela. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select venuecity, venuestate, caldate, pricepaid,
sum(pricepaid) over(partition by venuecity, venuestate
order by caldate rows between 3 preceding and 3 following) as winsum
from sales join date on sales.dateid=date.dateid
join event on event.eventid=sales.eventid
join venue on event.venueid=venue.venueid
order by 1,2')
to 's3://mybucket/tickit/winsum'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole';</code></pre>
            <p>Os arquivos de saída são semelhantes a: </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">Atlanta|GA|2008-01-04|363.00|1362.00
Atlanta|GA|2008-01-05|233.00|2030.00
Atlanta|GA|2008-01-06|310.00|3135.00
Atlanta|GA|2008-01-08|166.00|8338.00
Atlanta|GA|2008-01-11|268.00|7630.00
...</code></pre>
          
            <h2 id="unload-examples-null-as">Descarregar usando NULL AS</h2>
            <p>UNLOAD apresenta valores nulos de saída como strings vazias por padrão. Os exemplos a seguir mostram como usar NULL AS para substituir valores nulos por uma string de texto.</p>
            <p>Para esses exemplos, vamos adicionar alguns valores nulos à tabela VENUE.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">update venue set venuestate = NULL
where venuecity = 'Cleveland';</code></pre>
            <p>Selecione de VENUE onde VENUESTATE for nulo para confirmar que as colunas contêm valores NULL.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql "><code class="userinput">select * from venue where venuestate is null;</code>
<code class="computeroutput" copy="false">
 venueid |        venuename         | venuecity | venuestate | venueseats
---------+--------------------------+-----------+------------+------------
      22 | Quicken Loans Arena      | Cleveland |            |          0
     101 | Progressive Field        | Cleveland |            |      43345
      72 | Cleveland Browns Stadium | Cleveland |            |      73200
</code></code></pre>
            <p>Agora, use UNLOAD para descarregar a tabela VENUE usando a opção NULL AS para substituir valores nulos pela string de caractere '<code class="code">fred</code>'. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/nulls/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
null as 'fred';</code></pre>
            <p>O exemplo a seguir do arquivo de descarregamento mostra que os valores nulos foram substituídos por <code class="code">fred</code>. Na realidade, os valores para VENUESEATS também eram nulos e foram substituídos por <code class="code">fred</code>. Apesar de o tipo de dados para VENUESEATS ser 'inteiro', a opção UNLOAD converte os valores em texto nos arquivos do descarregamento, e a opção COPY os converte de volta em inteiro. Se você está descarregando para um arquivo de largura fixa, a string NULL AS não deve ser superior à largura do campo.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">248|Charles Playhouse|Boston|MA|0
251|Paris Hotel|Las Vegas|NV|fred
258|Tropicana Hotel|Las Vegas|NV|fred
300|Kennedy Center Opera House|Washington|DC|0
306|Lyric Opera House|Baltimore|MD|0
308|Metropolitan Opera|New York City|NY|0
  5|Gillette Stadium|Foxborough|MA|5
 22|Quicken Loans Arena|Cleveland|fred|0
101|Progressive Field|Cleveland|fred|43345
...</code></pre>
            <p>Para carregar uma tabela de arquivos de descarregamento, use um comando COPY com a mesma opção NULL AS. </p>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Se você tentar carregar nulos em uma coluna definida como NOT NULL, o comando COPY falhará.</p></div></div>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">create table loadvenuenulls (like venue);

copy loadvenuenulls from 's3://mybucket/nulls/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
null as 'fred';</code></pre>
            <p>Para confirmar que as colunas contêm nulos, e não apenas strings vazias, selecione a opção LOADVENUENULLS e filtre por nulos.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql "><code class="userinput">select * from loadvenuenulls where venuestate is null or venueseats is null;</code>
<code class="computeroutput" copy="false">
 venueid |        venuename         | venuecity | venuestate | venueseats
---------+--------------------------+-----------+------------+------------
      72 | Cleveland Browns Stadium | Cleveland |            |      73200
     253 | Mirage Hotel             | Las Vegas | NV         |
     255 | Venetian Hotel           | Las Vegas | NV         |
      22 | Quicken Loans Arena      | Cleveland |            |          0
     101 | Progressive Field        | Cleveland |            |      43345
     251 | Paris Hotel              | Las Vegas | NV         |

...</code></code></pre>
            <p>Você pode usar a opção UNLOAD em uma tabela que contenha nulos usando o comportamento padrão NULL AS e depois COPY para copiar os dados de volta para uma tabela usando o comportamento NULL AS. No entanto, todos os campos não numéricos na tabela de destino contêm strings vazias, não nulas. Por padrão, UNLOAD converte nulos em strings vazias (espaços em branco ou de tamanho zero). Uma opção COPY converte strings vazias em NULL para colunas numéricas, mas insere strings vazias em colunas não numéricas. O exemplo a seguir mostra como executar a opção UNLOAD seguida por uma opção COPY usando o comportamento padrão NULL AS. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/nulls/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole' allowoverwrite;

truncate loadvenuenulls;
copy loadvenuenulls from 's3://mybucket/nulls/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole';</code></pre>
            <p>Nesse caso, quando você filtra por nulos, somente as linhas em que VENUESEATS continha nulos. Nas linhas em que VENUESTATE continha nulos na tabela (VENUE), VENUESTATE contém strings vazias na tabela de destino (LOADVENUENULLS).</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql "><code class="userinput">select * from loadvenuenulls where venuestate is null or venueseats is null;</code>
<code class="computeroutput" copy="false">
 venueid |        venuename         | venuecity | venuestate | venueseats
---------+--------------------------+-----------+------------+------------
     253 | Mirage Hotel             | Las Vegas | NV         |
     255 | Venetian Hotel           | Las Vegas | NV         |
     251 | Paris Hotel              | Las Vegas | NV         |
...</code></code></pre>
            <p>Para carregar strings vazias em colunas não numéricas como NULL, inclua a opção EMPTYASNULL ou BLANKSASNULL. É possível usar ambas.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/nulls/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole' allowoverwrite;

truncate loadvenuenulls;
copy loadvenuenulls from 's3://mybucket/nulls/'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole' EMPTYASNULL;</code></pre>
            <p>Para confirmar que as colunas contêm NULL, e não apenas os espaços em branco ou vazios, selecione a opção LOADVENUENULLS e filtre por nulos.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql "><code class="userinput">select * from loadvenuenulls where venuestate is null or venueseats is null;</code>
<code class="computeroutput" copy="false">
 venueid |        venuename         | venuecity | venuestate | venueseats
---------+--------------------------+-----------+------------+------------
      72 | Cleveland Browns Stadium | Cleveland |            |      73200
     253 | Mirage Hotel             | Las Vegas | NV         |
     255 | Venetian Hotel           | Las Vegas | NV         |
      22 | Quicken Loans Arena      | Cleveland |            |          0
     101 | Progressive Field        | Cleveland |            |      43345
     251 | Paris Hotel              | Las Vegas | NV         |
     ...</code></code></pre>
          
            <h2 id="unload-examples-allowoverwrite">Descarregar usando o parâmetro ALLOWOVERWRITE</h2>
            <p>Por padrão, UNLOAD não substitui arquivos existentes no bucket de destino. Por exemplo, se você executar a mesma instrução UNLOAD duas vezes sem modificar os arquivos no bucket de destino, a segunda ocorrência de UNLOAD falha. Para substituir arquivos existentes, incluindo o arquivo manifesto, especifique a opção ALLOWOVERWRITE.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from venue')
to 's3://mybucket/venue_pipe_'
iam_role 'arn:aws:iam::0123456789012:role/MyRedshiftRole'
manifest allowoverwrite;</code></pre>
          
            
            <h2 id="unload-examples-manifest-parallel">Descarregue a tabela EVENT usando os parâmetros PARALLEL e MANIFEST</h2>
            <p>Você pode usar o parâmetro UNLOAD em uma tabela em paralelo e gerar um arquivo de manifesto. Os arquivos de dados do Amazon S3 são todos criados no mesmo nível e os nomes têm como sufixo o padrão <code class="code">0000_part_00</code>. O arquivo de manifesto está no mesmo nível de pasta dos arquivos de dados e tem como sufixo o texto <code class="code">manifest</code>. O SQL a seguir descarrega a tabela EVENT e cria arquivos com o nome base <code class="code">parallel</code></p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from mytickit1.event')
to 's3://my-s3-bucket-name/parallel'
iam_role 'arn:aws:iam::123456789012:role/MyRedshiftRole'
parallel on
manifest;</code></pre>
            <p>A lista de arquivos do Amazon S3 é semelhante à seguinte:</p>
            <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
 Name                       Last modified                        Size                  
 parallel0000_part_00	-   August 2, 2023, 14:54:39 (UTC-07:00) 52.1 KB  
 parallel0001_part_00	-   August 2, 2023, 14:54:39 (UTC-07:00) 53.4 KB
 parallel0002_part_00	-   August 2, 2023, 14:54:39 (UTC-07:00) 52.1 KB
 parallel0003_part_00	-   August 2, 2023, 14:54:39 (UTC-07:00) 51.1 KB
 parallel0004_part_00	-   August 2, 2023, 14:54:39 (UTC-07:00) 54.6 KB
 parallel0005_part_00	-   August 2, 2023, 14:54:39 (UTC-07:00) 53.4 KB
 parallel0006_part_00	-   August 2, 2023, 14:54:39 (UTC-07:00) 54.1 KB
 parallel0007_part_00	-   August 2, 2023, 14:54:39 (UTC-07:00) 55.9 KB
 parallelmanifest       -   August 2, 2023, 14:54:39 (UTC-07:00) 886.0 B                           
</code></pre>
            <p>O conteúdo do arquivo <code class="code">parallelmanifest</code> é semelhante ao seguinte:</p>
            <pre class="programlisting"><div class="code-btn-container"></div><code class="JSON ">
<span>{</span>
  "entries": [
    <span>{</span>"url":"s3://my-s3-bucket-name/parallel0000_part_00", "meta": <span>{</span> "content_length": 53316 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/parallel0001_part_00", "meta": <span>{</span> "content_length": 54704 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/parallel0002_part_00", "meta": <span>{</span> "content_length": 53326 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/parallel0003_part_00", "meta": <span>{</span> "content_length": 52356 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/parallel0004_part_00", "meta": <span>{</span> "content_length": 55933 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/parallel0005_part_00", "meta": <span>{</span> "content_length": 54648 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/parallel0006_part_00", "meta": <span>{</span> "content_length": 55436 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/parallel0007_part_00", "meta": <span>{</span> "content_length": 57272 }}
  ]
}                         
</code></pre>
          
            
            <h2 id="unload-examples-manifest-serial">Descarregue a tabela EVENT usando os parâmetros PARALLEL OFF e MANIFEST</h2>
            <p>Você pode usar o parâmetro UNLOAD em uma tabela em série (PARALLEL OFF) e gerar um arquivo de manifesto. Os arquivos de dados do Amazon S3 são todos criados no mesmo nível e os nomes têm como sufixo o padrão <code class="code">0000</code>. O arquivo de manifesto está no mesmo nível de pasta dos arquivos de dados e tem como sufixo o texto <code class="code">manifest</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from mytickit1.event')
to 's3://my-s3-bucket-name/serial'
iam_role 'arn:aws:iam::123456789012:role/MyRedshiftRole'
parallel off
manifest;</code></pre>
            <p>A lista de arquivos do Amazon S3 é semelhante à seguinte:</p>
            <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
 Name                       Last modified                        Size                  
 serial0000             -   August 2, 2023, 15:54:39 (UTC-07:00) 426.7 KB  
 serialmanifest         -   August 2, 2023, 15:54:39 (UTC-07:00) 120.0 B                           
</code></pre>
            <p>O conteúdo do arquivo <code class="code">serialmanifest</code> é semelhante ao seguinte:</p>
            <pre class="programlisting"><div class="code-btn-container"></div><code class="JSON ">
<span>{</span>
  "entries": [
    <span>{</span>"url":"s3://my-s3-bucket-name/serial000", "meta": <span>{</span> "content_length": 436991 }}
  ]
}                         
</code></pre>
          
            
            <h2 id="unload-examples-manifest-partition">Descarregue a tabela EVENT usando os parâmetros PARTITION BY e MANIFEST</h2>
            <p>Você pode usar o parâmetro UNLOAD em uma tabela por partição e gerar um arquivo de manifesto. Uma nova pasta é criada no Amazon S3 com pastas de partição secundárias e os arquivos de dados nas pastas secundárias com um padrão de nome semelhante a <code class="code">0000_par_00</code>. O arquivo de manifesto está no mesmo nível de pasta que as pastas secundárias com o nome <code class="code">manifest</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from mytickit1.event')
to 's3://my-s3-bucket-name/partition'
iam_role 'arn:aws:iam::123456789012:role/MyRedshiftRole'
partition by (eventname)
manifest;</code></pre>
            <p>A lista de arquivos do Amazon S3 é semelhante à seguinte:</p>
            <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
 Name                   Type     Last modified                        Size                  
 partition           	Folder	                     
</code></pre>
            <p>Na pasta <code class="code">partition</code> encontram-se pastas secundárias com o nome da partição e o arquivo de manifesto. Veja a seguir a parte inferior da lista de pastas na pasta <code class="code">partition</code>, semelhante à seguinte:</p>
            <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
 Name                   Type      Last modified                        Size                  
 ...
 eventname=Zucchero/    Folder 
 eventname=Zumanity/    Folder 
 eventname=ZZ Top/      Folder  
 manifest          	    -	    August 2, 2023, 15:54:39 (UTC-07:00) 467.6 KB                           
</code></pre>
            <p>Na pasta <code class="code">eventname=Zucchero/</code> estão os arquivos de dados semelhantes aos seguintes:</p>
            <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
 Name               Last modified                        Size                  
 0000_part_00	-   August 2, 2023, 15:59:19 (UTC-07:00) 70.0 B
 0001_part_00	-   August 2, 2023, 15:59:16 (UTC-07:00) 106.0 B
 0002_part_00	-   August 2, 2023, 15:59:15 (UTC-07:00) 70.0 B
 0004_part_00	-   August 2, 2023, 15:59:17 (UTC-07:00) 141.0 B
 0006_part_00	-   August 2, 2023, 15:59:16 (UTC-07:00) 35.0 B
 0007_part_00	-   August 2, 2023, 15:59:19 (UTC-07:00) 108.0 B                       
</code></pre>
            <p>A parte inferior do conteúdo do arquivo <code class="code">manifest</code> é semelhante ao seguinte:</p>
            <pre class="programlisting"><div class="code-btn-container"></div><code class="JSON ">
<span>{</span>
  "entries": [
    ...
    <span>{</span>"url":"s3://my-s3-bucket-name/partition/eventname=Zucchero/0007_part_00", "meta": <span>{</span> "content_length": 108 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/partition/eventname=Zumanity/0007_part_00", "meta": <span>{</span> "content_length": 72 }}
  ]
}                         
</code></pre>
          
            
            <h2 id="unload-examples-manifest-maxsize">Descarregue a tabela EVENT usando os parâmetros MAXFILESIZE, ROWGROUPSIZE e MANIFEST</h2>
            <p>Você pode usar o parâmetro UNLOAD em uma tabela em paralelo e gerar um arquivo de manifesto. Os arquivos de dados do Amazon S3 são todos criados no mesmo nível e os nomes têm como sufixo o padrão <code class="code">0000_part_00</code>. Os arquivos de dados do Parquet gerados são limitados a 256 MB e o tamanho do grupo de linhas a 128 MB. O arquivo de manifesto está no mesmo nível de pasta dos arquivos de dados e tem como sufixo <code class="code">manifest</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sql ">unload ('select * from mytickit1.event')
to 's3://my-s3-bucket-name/eventsize'
iam_role 'arn:aws:iam::123456789012:role/MyRedshiftRole'
maxfilesize 256 MB
rowgroupsize 128 MB
parallel on
parquet
manifest;</code></pre>
            <p>A lista de arquivos do Amazon S3 é semelhante à seguinte:</p>
            <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">
 Name                            Type      Last modified                        Size 
 eventsize0000_part_00.parquet	parquet	August 2, 2023, 17:35:21 (UTC-07:00) 24.5 KB
 eventsize0001_part_00.parquet	parquet	August 2, 2023, 17:35:21 (UTC-07:00) 24.8 KB
 eventsize0002_part_00.parquet	parquet	August 2, 2023, 17:35:21 (UTC-07:00) 24.4 KB
 eventsize0003_part_00.parquet	parquet	August 2, 2023, 17:35:21 (UTC-07:00) 24.0 KB
 eventsize0004_part_00.parquet	parquet	August 2, 2023, 17:35:21 (UTC-07:00) 25.3 KB
 eventsize0005_part_00.parquet	parquet	August 2, 2023, 17:35:21 (UTC-07:00) 24.8 KB
 eventsize0006_part_00.parquet	parquet	August 2, 2023, 17:35:21 (UTC-07:00) 25.0 KB
 eventsize0007_part_00.parquet	parquet	August 2, 2023, 17:35:21 (UTC-07:00) 25.6 KB
 eventsizemanifest                 -       August 2, 2023, 17:35:21 (UTC-07:00) 958.0 B                        
</code></pre>
            <p>O conteúdo do arquivo <code class="code">eventsizemanifest</code> é semelhante ao seguinte:</p>
            <pre class="programlisting"><div class="code-btn-container"></div><code class="JSON ">
<span>{</span>
  "entries": [
    <span>{</span>"url":"s3://my-s3-bucket-name/eventsize0000_part_00.parquet", "meta": <span>{</span> "content_length": 25130 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/eventsize0001_part_00.parquet", "meta": <span>{</span> "content_length": 25428 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/eventsize0002_part_00.parquet", "meta": <span>{</span> "content_length": 25025 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/eventsize0003_part_00.parquet", "meta": <span>{</span> "content_length": 24554 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/eventsize0004_part_00.parquet", "meta": <span>{</span> "content_length": 25918 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/eventsize0005_part_00.parquet", "meta": <span>{</span> "content_length": 25362 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/eventsize0006_part_00.parquet", "meta": <span>{</span> "content_length": 25647 }},
    <span>{</span>"url":"s3://my-s3-bucket-name/eventsize0007_part_00.parquet", "meta": <span>{</span> "content_length": 26256 }}
  ]
}                       
</code></pre>
         <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./r_UNLOAD.html">UNLOAD</div><div id="next" class="next-link" accesskey="n" href="./r_UPDATE.html">UPDATE</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_UNLOAD_command_examples.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Redshift&amp;topic_url=https://docs.aws.amazon.com/pt_br/redshift/latest/dg/r_UNLOAD_command_examples.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>