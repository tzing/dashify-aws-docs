<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Melhores práticas do AWS CloudFormation - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="best-practices" /><meta name="default_state" content="best-practices" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/best-practices.html" /><meta name="description" content="Use as melhores práticas para usar o AWS CloudFormation de forma mais eficaz e segura." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Guia do usuário" /><meta name="abstract" content="Crie e gerencie implantações da infraestrutura da AWS de maneira previsível e que pode ser repetida usando o AWS CloudFormation com este Guia do usuário." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/best-practices.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/best-practices.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Guia do usuário" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Guia do usuário" /><meta id="panorama-serviceConsolePage" value="Melhores práticas do AWS CloudFormation" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Melhores práticas do AWS CloudFormation - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/best-practices.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/best-practices.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/best-practices.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,provisionamento de recursos,configuração de recursos,gerenciamento da infraestrutura,CloudFormer,Pilha do CloudFormation,Stackset do CloudFormation,Modelo do CloudFormation,conjunto de alterações" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do usuário",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Melhores práticas do AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/best-practices.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Guia do usuário</a></div><div id="page-toc-src"><a href="#shortenfeedbackloop">Encurtar o ciclo de feedback para melhorar a velocidade de entrega</a><a href="#organizingstacks">Organizar pilhas por ciclo de vida e propriedade</a><a href="#cross-stack">Usar referências entre pilhas para exportar recursos compartilhados</a><a href="#limits">Verificar cotas para todos os tipos de recursos</a><a href="#reuse">Reutilizar modelos para replicar pilhas em vários ambientes</a><a href="#modules-reuse">Usar módulos para reutilizar configurações de recursos</a><a href="#parmtypes">Usar tipos de parâmetros específicos da AWS</a><a href="#parmconstraints">Usar restrições de parâmetros</a><a href="#pseudoparameters">Use pseudoparâmetros para promover a portabilidade</a><a href="#cfninit">Usar AWS::CloudFormation::Init para implantar aplicações de software em instâncias do Amazon EC2</a><a href="#helper-scripts">Usar os scripts auxiliares mais recentes</a><a href="#validate">Validar modelos antes de usá-los</a><a href="#donttouch">Gerenciar todos os recursos de pilha por meio do AWS CloudFormation</a><a href="#cfn-best-practices-changesets">Criar conjuntos de alteração antes de atualizar as pilhas</a><a href="#stackpolicy">Usar políticas de pilha</a><a href="#code">Usar revisões de código e controles de revisão para gerenciar seus modelos</a><a href="#update-ec2-linux">Atualizar suas instâncias do Amazon EC2 regularmente</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="best-practices">Melhores práticas do AWS CloudFormation</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>As melhores práticas são recomendações que podem ajudar você a usar o AWS CloudFormation de forma mais eficaz e segura em todo o fluxo de trabalho dele. Saiba como planejar e organizar suas pilhas, criar modelos que descrevem os recursos e os aplicativos de software que são executados neles, e gerenciar as pilhas e seus respectivos recursos. As práticas recomendadas a seguir são baseadas em experiência real de clientes atuais do CloudFormation.</p><div class="variablelist">
     
     
     
  <dl>
      <dt><b><span class="term">Planejamento e organização</span></b></dt>
      <dd>
        <div class="itemizedlist">
           
           
           
           
           
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p><a href="#shortenfeedbackloop">Encurtar o ciclo de feedback para melhorar a velocidade de entrega</a></p>
          </li><li class="listitem">
            <p><a href="#organizingstacks">Organizar pilhas por ciclo de vida e propriedade</a></p>
          </li><li class="listitem">
            <p><a href="#cross-stack">Usar referências entre pilhas para exportar recursos compartilhados</a></p>
          </li><li class="listitem">
            <p><a href="./security-best-practices.html#use-iam-to-control-access">Usar o IAM para controlar o acesso</a></p>
          </li><li class="listitem">
            <p><a href="#reuse">Reutilizar modelos para replicar pilhas em vários ambientes</a></p>
          </li><li class="listitem">
            <p><a href="#limits">Verificar cotas para todos os tipos de recursos</a>
            </p>
          </li><li class="listitem">
            <p><a href="#modules-reuse">Usar módulos para reutilizar configurações de recursos</a></p>
          </li></ul></div>
      </dd>
    
      <dt><b><span class="term">Criação de modelos</span></b></dt>
      <dd>
        <div class="itemizedlist">
           
           
           
           
           
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p><a href="./security-best-practices.html#creds">Não incorporar credenciais em seus modelos</a></p>
          </li><li class="listitem">
            <p><a href="#parmtypes">Usar tipos de parâmetros específicos da AWS</a></p>
          </li><li class="listitem">
            <p><a href="#parmconstraints">Usar restrições de parâmetros</a></p>
          </li><li class="listitem">
            <p><a href="#pseudoparameters">Use pseudoparâmetros para promover a portabilidade</a></p>
          </li><li class="listitem">
            <p><a href="#cfninit">Usar AWS::CloudFormation::Init para implantar aplicações de software em instâncias do Amazon EC2</a></p>
          </li><li class="listitem">
            <p><a href="#helper-scripts">Usar os scripts auxiliares mais recentes</a></p>
          </li><li class="listitem">
            <p><a href="#validate">Validar modelos antes de usá-los</a></p>
          </li></ul></div>
      </dd>
    
      <dt><b><span class="term">Gerenciamento de pilhas</span></b></dt>
      <dd>
        <div class="itemizedlist">
           
           
           
           
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p><a href="#donttouch">Gerenciar todos os recursos de pilha por meio do AWS CloudFormation</a></p>
          </li><li class="listitem">
            <p><a href="#cfn-best-practices-changesets">Criar conjuntos de alteração antes de atualizar as pilhas</a></p>
          </li><li class="listitem">
            <p><a href="#stackpolicy">Usar políticas de pilha</a></p>
          </li><li class="listitem">
            <p><a href="./security-best-practices.html#cloudtrail">Usar o AWS CloudTrail para registrar chamadas do AWS CloudFormation</a></p>
          </li><li class="listitem">
            <p><a href="#code">Usar revisões de código e controles de revisão para gerenciar seus modelos</a></p>
          </li><li class="listitem">
            <p><a href="#update-ec2-linux">Atualizar suas instâncias do Amazon EC2 regularmente</a></p>
          </li></ul></div>
      </dd>
    </dl></div>
    <h2 id="shortenfeedbackloop">Encurtar o ciclo de feedback para melhorar a velocidade de entrega</h2>

    <p>Adote práticas e ferramentas que ajudam a reduzir o ciclo de feedback da infraestrutura que você descreve com os modelos do CloudFormation. Isso inclui fazer mais cedo o linting e os testes de modelos em sua estação de trabalho. Com isso, você descobre possíveis problemas de sintaxe e configuração antes mesmo de enviar suas contribuições para um repositório de código-fonte. A descoberta precoce desses problemas ajuda a evitar que eles atinjam os ambientes formais do ciclo de vida, como desenvolvimento, garantia de qualidade e produção. Essa estratégia de testar cedo e antecipar-se à falha tem a vantagem de reduzir o tempo de espera de retrabalho, diminuir as possíveis áreas de impacto e aumentar seu nível de confiança no sucesso das operações de provisionamento.</p>
    <p>As opções de ferramentas que ajudam você a adotar a prática de antecipar-se à falha incluem as ferramentas de linha de comando <a href="https://github.com/aws-cloudformation/cfn-lint" rel="noopener noreferrer" target="_blank"><span>AWS CloudFormationLinter</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> (cfn-lint) e <a href="https://github.com/aws-ia/taskcat" rel="noopener noreferrer" target="_blank"><span>TaskCat</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. A ferramenta cfn-lint permite validar os modelos do CloudFormation em relação à <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-resource-specification.html">especificação de recursos do AWS CloudFormation</a>. Isso inclui verificar se foram usados valores válidos nas propriedades dos recursos, bem como as práticas recomendadas. Os plug-ins para o cfn-lint estão <a href="https://github.com/aws-cloudformation/cfn-lint#editor-plugins" rel="noopener noreferrer" target="_blank"><span>disponíveis para vários editores de código</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, o que permite que você visualize os problemas no editor e obtenha feedback direto da ferramenta de linting. Você também pode optar por integrar o cfn-lint à configuração do repositório de código-fonte, para poder validar os modelos quando confirmar suas contribuições. Para obter mais informações, consulte <a href="https://aws.amazon.com/blogs/mt/git-pre-commit-validation-of-aws-cloudformation-templates-with-cfn-lint/" rel="noopener noreferrer" target="_blank"><span>Validação pré-confirmação do Git de modelos do AWS CloudFormation com o cfn-lint</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. Depois de realizar o linting inicial e corrigir quaisquer problemas que o cfn-lint possa ter apontado, você poderá usar o TaskCat para testar seus modelos criando programaticamente pilhas nas regiões da AWS de sua escolha. O TaskCat também gera um relatório com os resultados de aprovação/reprovação para cada região escolhida.</p>
    <p>Para obter uma demonstração prática passo a passo de como usar as duas ferramentas para encurtar o ciclo de feedback, siga o <a href="https://catalog.workshops.aws/cfn101/en-US/basics/templates/linting-and-testing" rel="noopener noreferrer" target="_blank"><span>Laboratório de linting e testes</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> do <a href="https://catalog.workshops.aws/cfn101/en-US" rel="noopener noreferrer" target="_blank"><span>Workshop do AWS CloudFormation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
   
    <h2 id="organizingstacks">Organizar pilhas por ciclo de vida e propriedade</h2>

    <p>Use o ciclo de vida e a propriedade dos recursos da AWS para ajudar você a decidir quais deles devem estar contidos em cada pilha. Inicialmente, é possível colocar todos os recursos em uma pilha, porém, à medida que ela cresce em escala e aumenta em escopo, o gerenciamento de uma única pilha pode ser trabalhoso e demorado. Ao agrupar recursos com ciclos de vida e propriedade comuns, os proprietários podem fazer alterações no conjunto de recursos deles usando um processo e uma programação próprios sem afetar outros recursos.</p>
    <p>Por exemplo, imagine uma equipe de desenvolvedores e engenheiros que possuem um site hospedado em instâncias de Auto Scaling atrás de um load balancer. Como o site tem seu próprio ciclo de vida e é mantido pela equipe do site, é possível criar uma pilha para o site e seus respectivos recursos. Agora, imagine que o site também usa bancos de dados de back-end, em que os bancos de dados estão em uma pilha separada que cujas propriedade e manutenção são dos administradores de bancos de dados. Sempre que a equipe do site ou a equipe do banco de dados precisa atualizar seus recursos, eles podem fazê-lo sem afetar a pilha uns dos outros. Se todos os recursos estavam em uma única pilha, a coordenação e a comunicação de atualizações pode ser difícil.</p>
    <p>Para obter mais orientações sobre como organizar suas pilhas, você pode usar duas estruturas comuns: uma arquitetura em várias camadas e a arquitetura orientada a serviços (SOA).</p>
    <p>A arquitetura em camadas organiza pilhas em várias camadas horizontais que se sobrepõem, em que cada camada tem uma dependência na camada diretamente abaixo dela. Você pode ter uma ou mais pilhas em cada camada, mas dentro de cada camada, suas pilhas devem ter recursos da AWS com ciclos de vida e propriedade semelhantes.</p>
    <p>Com uma arquitetura orientada a serviços, é possível organizar grandes problemas de negócios em partes gerenciáveis. Cada uma dessas partes é um serviço que tem uma finalidade claramente definida e representa uma unidade independente de funcionalidade. Você pode mapear esses serviços para uma pilha, em que cada pilha tenha seu próprio ciclo de vida e proprietários. Esses serviços (pilhas) podem ser conectados para que possam interagir uns com os outros.</p>
   
    <h2 id="cross-stack">Usar referências entre pilhas para exportar recursos compartilhados</h2>

    <p>Ao organizar os recursos da AWS com base no ciclo de vida e na propriedade, talvez você queira criar uma pilha que use recursos existentes em outra pilha. Você pode codificar valores ou usar parâmetros de entrada para transmitir os nomes e os IDs dos recursos. No entanto, esses métodos podem dificultar a reutilização dos modelos ou aumentar a sobrecarga para colocar uma pilha em execução. Em vez disso, use referências entre pilhas para exportar os recursos de uma pilha para que as outras pilhas possam usá-los. As pilhas podem usar os recursos exportados chamando-os com a função <code class="code">Fn::ImportValue</code>.</p>
    <p>Por exemplo, você pode ter uma pilha de rede que inclui uma VPC, um security group e uma sub-rede. Você deseja que todas aplicações web públicas usem esses recursos. Ao exportar os recursos, você permite que todas as pilhas com aplicações web públicas usem tais recursos. Para ter mais informações, consulte <a href="./walkthrough-crossstackref.html">Demonstração: Consultar saídas de recurso em outra pilha do AWS CloudFormation</a>.</p>
   
    <h2 id="limits">Verificar cotas para todos os tipos de recursos</h2>

    <p>Antes de executar uma pilha, certifique-se de que pode criar todos os recursos que desejados sem atingir os limites de sua conta da AWS. Se você atingir um limite, o CloudFormation não criará a pilha com êxito até que você aumente sua cota ou exclua recursos adicionais. Cada serviço pode ter vários limites que você deve levar em conta antes de executar uma pilha. Por exemplo, por padrão, você pode executar somente 2000 pilhas do CloudFormation por região na sua Conta da AWS. Para mais informações sobre limites e como aumentar os limites padrão, consulte <a href="https://docs.aws.amazon.com/general/latest/gr/aws_service_limits.html">Cotas de serviços da AWS</a>, no <em>Referência geral da AWS</em>.</p>
   
    <h2 id="reuse">Reutilizar modelos para replicar pilhas em vários ambientes</h2>

    <p>Depois de configurar suas pilhas e recursos, você pode reutilizar os modelos para replicar sua infraestrutura em vários ambientes. Por exemplo, você pode criar ambientes para desenvolvimento, teste e produção para testar as alterações antes de implementá-las na produção. Para tornar os modelos reutilizáveis, use as seções de parâmetros, mapeamentos e condições para personalizar suas pilhas ao criá-las. Por exemplo, para ambientes de desenvolvimento, é possível especificar um tipo de instância de custo mais baixo em comparação com o ambiente de produção, mas todas as outras configurações e definições são as mesmas. Para obter mais informações sobre parâmetros, mapeamentos e condições, consulte <a href="./template-anatomy.html">Anatomia do modelo</a>.</p>
   
    <h2 id="modules-reuse">Usar módulos para reutilizar configurações de recursos</h2>

    <p>À medida que sua infraestrutura cresce, podem surgir padrões comuns em que é possível declarar os mesmos componentes em cada um dos modelos. Os <em>módulo</em>s são uma maneira de empacotar configurações de recursos para inclusão entre modelos de pilha, de modo transparente, gerenciável e repetível. Os módulos podem encapsular configurações comuns de serviço e práticas recomendadas como blocos de construção modulares e personalizáveis para você incluir em seus modelos de pilha.</p>
    <p>Esses blocos de construção podem ser para um único recurso, como práticas recomendadas para definir uma instância do Amazon Elastic Compute Cloud (Amazon EC2), ou podem ser para vários recursos, para definir padrões comuns de arquitetura de aplicações. Esses blocos fundamentais podem ser aninhados a outros módulos, para que você possa empilhar suas práticas recomendadas em blocos fundamentais de nível superior. Módulos do CloudFormation estão disponíveis no <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/registry.html">Registro do CloudFormation</a>, para que você possa utilizá-los como um recurso nativo. Quando você usa um módulo do CloudFormation, o modelo de módulo é expandido para o modelo de consumo, o que possibilita acessar os recursos dentro do módulo usando uma função <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html">Ref</a> ou <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-getatt.html">Fn::GetAtt</a>. Para obter mais informações, consulte <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/modules.html">Módulos</a>.</p>
   
    <h2 id="parmtypes">Usar tipos de parâmetros específicos da AWS</h2>

    <p>Se o modelo exige entradas de valores existentes específicos da AWS, como IDs existentes do Amazon Virtual Private Cloud ou um nome de par de chaves do Amazon EC2, use os tipos de parâmetros específicos da AWS. Por exemplo, é possível especificar um parâmetro como o tipo <code class="code">AWS::EC2::KeyPair::KeyName</code>, que usa um nome de par de chaves existente que está em sua conta da AWS e na região em que você está criando a pilha. O AWS CloudFormation pode validar rapidamente valores de tipos de parâmetros específicos da AWS antes de criar a pilha. Além disso, se você usar o console do CloudFormation, o CloudFormation mostrará uma lista suspensa de valores válidos, de modo que você não precisará examinar ou memorizar os IDs da VPC corretos ou os nomes de pares de chaves. Para ter mais informações, consulte <a href="./parameters-section-structure.html">Parâmetros</a>.</p>
   
    <h2 id="parmconstraints">Usar restrições de parâmetros</h2>

    <p>Com restrições, é possível descrever valores de entrada permitidos para que o CloudFormation detecte todos os valores inválidos antes de criar uma pilha. É possível definir restrições como um tamanho mínimo ou máximo e padrões permitidos. Por exemplo, você pode definir as restrições em um valor de nome de usuário do banco de dados para que ele tenha no mínimo oito caracteres e contenha apenas caracteres alfanuméricos. Para ter mais informações, consulte <a href="./parameters-section-structure.html">Parâmetros</a>.</p>
   
    <h2 id="pseudoparameters">Use pseudoparâmetros para promover a portabilidade</h2>

    <p>Você pode usar <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/pseudo-parameter-reference.html">pseudoparâmetros</a> em seus modelos como argumentos para <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference.html">funções intrínsecas</a>, como <code class="code">Ref</code> e <code class="code">Fn::Sub</code>. Os pseudoparâmetros são parâmetros que são predefinidos pelo CloudFormation. Você não os declará-las em seu modelo. O uso de pseudoparâmetros em funções intrínsecas aumenta a portabilidade de seus modelos de pilha entre regiões e contas.</p>
    <p>Por exemplo, imagine que você deseja criar um modelo em que, para uma determinada propriedade de recurso, seja necessário especificar o <a href="https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html">nome do recurso da Amazon</a> (ARN) de outro recurso existente. Nesse caso, o recurso existente é um recurso do <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html">AWS Systems Manager Parameter Store</a> com o seguinte ARN: <code class="code">arn:aws:ssm:us-east-1:111122223333:parameter/MySampleParameter</code>. Você precisará adaptar o <a href="https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html#arns-syntax">formato do ARN</a> à partição, região e ID da conta da AWS de destino. Em vez de realizar a codificação rígida desses valores, você pode usar os pseudoparâmetros <code class="code">AWS::Partition</code>, <code class="code">AWS::Region</code> e <code class="code">AWS::AccountId</code> para tornar seu modelo mais portátil. Nesse caso, o exemplo a seguir mostra como encadear elementos em um ARN com o CloudFormation: <code class="code">!Sub
        'arn:$<span>{</span>AWS::Partition}:ssm:$<span>{</span>AWS::Region}:$<span>{</span>AWS::AccountId}:parameter/MySampleParameter</code>.</p>
    <p>Para outro exemplo, suponha que você deseje usar <a href="./walkthrough-crossstackref.html">Demonstração: Consultar saídas de recurso em outra pilha do AWS CloudFormation</a> para se referir a saídas de recursos em outra pilha do CloudFormation. Neste exemplo, suponha que você tenha criado uma <a href="https://docs.aws.amazon.com/vpc/latest/userguide/configure-subnets.html">sub-rede</a> para sua VPC e, em seguida, <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/outputs-section-structure.html">exportado</a> seu ID para uso com outras pilhas na mesma conta e região. Em outra pilha, você faz referência ao valor exportado do ID da sub-rede ao descrever uma instância do Amazon EC2.</p>
    <p>As exportações de pilha devem ser exclusivas por conta e região. Portanto, nesse caso, você pode usar o pseudoparâmetro <code class="code">AWS::StackName</code> para criar um prefixo para sua exportação. Como os nomes de pilha também devem ser exclusivos por conta e região, o uso desse pseudoparâmetro como prefixo aumenta a possibilidade de ter um nome de exportação exclusivo e, ao mesmo tempo, promove uma abordagem reutilizável entre as pilhas das quais você exporta valores. Alternativamente, você pode usar um prefixo de sua escolha.</p>
    <p>Para obter um exemplo detalhado sobre o uso do campo de saída <code class="code">Export</code> e da função intrínseca <code class="code">Fn::ImportValue</code>, consulte <a href="./walkthrough-crossstackref.html">Demonstração: Consultar saídas de recurso em outra pilha do AWS CloudFormation</a>.</p>
   
    <h2 id="cfninit">Usar <code class="code">AWS::CloudFormation::Init</code> para implantar aplicações de software em instâncias do Amazon EC2</h2>

    <p>Ao executar pilhas, você pode instalar e configurar aplicativos de software em instâncias do Amazon EC2 usando o script auxiliar cfn-init e o recurso <code class="code">AWS::CloudFormation::Init</code>. Ao usar <code class="code">AWS::CloudFormation::Init</code>, você pode descrever as configurações que deseja em vez criar o script de etapas procedimentais. Também é possível atualizar as configurações sem recriar instâncias. E se algo errado der errado com a configuração, o CloudFormation gerará logs que podem ser usados para investigar problemas.</p>
    <p>Em seu modelo, especifique estados de instalação e configuração no recurso <code class="code">AWS::CloudFormation::Init</code>. Para obter uma explicação detalhada que mostra como usar o cfn-init e <code class="code">AWS::CloudFormation::Init</code>, consulte <a href="./deploying.applications.html">Implantar aplicações no Amazon EC2 com o AWS CloudFormation</a>.</p>
   
    <h2 id="helper-scripts">Usar os scripts auxiliares mais recentes</h2>

    <p>Os <a href="./cfn-helper-scripts-reference.html">scripts auxiliares</a> são atualizados periodicamente. Certifique-se de incluir o seguinte comando na propriedade <code class="code">UserData</code> do seu modelo antes de chamar os scripts auxiliares para garantir que suas instâncias executadas obtenham os scripts auxiliares mais recentes:</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="userinput">yum install -y aws-cfn-bootstrap</code></code></pre>
    <p>Para obter mais informações sobre como receber os scripts auxiliares mais recentes, consulte a <a href="./cfn-helper-scripts-reference.html">CloudFormation referência de scripts auxiliares</a>.</p>
   
    <h2 id="validate">Validar modelos antes de usá-los</h2>

    <p>Antes de usar um modelo para criar ou atualizar uma pilha, você pode usar o CloudFormation para validá-lo. A validação de um modelo pode ajudá-lo a perceber alguns erros de sintaxe e semântica, como dependências circulares, antes que o CloudFormation crie algum recurso. Se você usar o console do CloudFormation, ele validará automaticamente o modelo depois que você especificar os parâmetros de entrada. Para a AWS CLI ou a API do CloudFormation, use o comando <a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/validate-template.html"><code class="code">aws cloudformation validate-template</code></a> ou a operação da API <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_ValidateTemplate.html"><code class="code">ValidateTemplate</code></a>.</p>
    <p>Durante a validação, o CloudFormation primeiro verifica se o modelo é JSON válido. Caso não seja, o CloudFormation verifica se o modelo é YAML válido. Se as duas verificações falharem, o CloudFormation retornará um erro de validação de modelo.</p>
     
      <h3 id="validate-compliance">Validar modelos para a conformidade com a política da organização</h3>
      <p>Você também pode validar a conformidade do seu modelo com as diretrizes da política da organização. O AWS CloudFormation Guard (<code class="code">cfn-guard</code>) é uma ferramenta de interface de linha de comando (CLI) de código aberto que fornece uma linguagem de política como código para definir regras que podem verificar as configurações de recursos obrigatórios e proibidos. Ele permite que você valide seus modelos em relação a essas regras. Por exemplo, os administradores podem criar regras para garantir que os usuários sempre criem buckets do Amazon S3 criptografados.</p>
      <p>É possível usar o <code class="code">cfn-guard</code> localmente, durante a edição de modelos, ou automaticamente, como parte de um pipeline de CI/CD para interromper a implantação de recursos não compatíveis.</p>
      <p>Além disso, o <code class="code">cfn-guard</code> inclui um recurso, <code class="code">rulegen</code>, que permite extrair regras de modelos existentes compatíveis do CloudFormation.</p>
      <p>Para obter mais informações, consulte o repositório <a href="https://github.com/aws-cloudformation/cloudformation-guard" rel="noopener noreferrer" target="_blank"><span>cfn-guard</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> no GitHub.</p>
     
   
    <h2 id="donttouch">Gerenciar todos os recursos de pilha por meio do AWS CloudFormation</h2>

    <p>Depois de iniciar uma pilha, use o <a href="https://console.aws.amazon.com/cloudformation/home" rel="noopener noreferrer" target="_blank"><span>console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> do CloudFormation, a <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/">API</a> ou a <a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/index.html">AWS CLI</a> para atualizar recursos na sua pilha. Não faça alterações nos recursos da pilha fora do CloudFormation. Isso pode criar uma incompatibilidade entre seu modelo de pilha e o estado atual dos recursos da pilha, o que pode causar erros se você atualizar ou excluir a pilha. Para ter mais informações, consulte <a href="./updating.stacks.walkthrough.html">Demonstração: Atualizar uma pilha</a>.</p>
   
    <h2 id="cfn-best-practices-changesets">Criar conjuntos de alteração antes de atualizar as pilhas</h2>

    <p>Conjuntos de alterações permitem que você veja como as alterações propostas para uma pilha podem afetar os recursos em execução antes de implementá-las.  O CloudFormation não fará alterações na pilha até que você execute o conjunto de alterações, permitindo que você decida se deseja continuar com as alterações propostas ou criar outro conjunto de alterações.</p>
    <p>Use conjuntos de alterações para verificar como as alterações podem afetar os recursos em execução, especialmente em relação a recursos críticos. Por exemplo, se você alterar o nome de uma instância de banco de dados do Amazon RDS, o CloudFormation criará um novo banco de dados e excluirá o antigo. Você perderá os dados do banco de dados antigo, a menos que já tenha feito o backup dele. Se você gerar um conjunto de alterações, verá que sua alteração substituirá seu banco de dados. Isso pode ajudar no planejamento antes de atualizar a pilha. Para ter mais informações, consulte <a href="./using-cfn-updating-stacks-changesets.html">Atualizar pilhas usando conjuntos de alterações</a>.</p>
   
    <h2 id="stackpolicy">Usar políticas de pilha</h2>

    <p>As políticas de pilha ajudam a proteger recursos de pilha críticos contra atualizações não intencionais capazes de fazer com que os recursos sejam interrompidos ou até mesmo substituídos. Uma política de pilha é um documento JSON que descreve quais ações de atualização podem ser executadas nos recursos designados. Especifique uma política de pilha sempre que criar uma pilha com recursos críticos.</p>
    <p>Durante uma atualização de pilha, é necessário especificar explicitamente os recursos protegidos que deseja atualizar, caso contrário, nenhuma alteração será feita nos recursos protegidos. Para ter mais informações, consulte <a href="./protect-stack-resources.html">Impedir atualizações nos recursos de pilha</a>.</p>
   
    <h2 id="code">Usar revisões de código e controles de revisão para gerenciar seus modelos</h2>

    <p>Os modelos de pilha descrevem a configuração de seus recursos da AWS, como seus respectivos valores de propriedades. Para analisar as alterações e manter um histórico exato de seus recursos, use revisões de código e controles de revisão. Esses métodos podem ajudá-lo a rastrear as alterações entre versões diferentes de seus modelos, o que pode ajudar você a rastrear alterações nos recursos de sua pilha. Além disso, com a manutenção de um histórico, sempre é possível reverter a pilha para uma determinada versão do modelo.</p>
   
    <h2 id="update-ec2-linux">Atualizar suas instâncias do Amazon EC2 regularmente</h2>

    <p>Em todas as instâncias Windows do Amazon EC2 e instâncias Linux do Amazon EC2 criadas com o CloudFormation, execute regularmente o comando <code class="code">yum update</code> para atualizar o pacote RPM. Isso garante que você obtenha as mais recentes correções e atualizações de segurança.</p>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./vpc-interface-endpoints.html">Endpoint da VPC (AWS PrivateLink)</div><div id="next" class="next-link" accesskey="n" href="./continuous-delivery-codepipeline.html">Entrega contínua</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/best-practices.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/best-practices.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>