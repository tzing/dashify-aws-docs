<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Monitorar e reverter operações de pilha - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="using-cfn-rollback-triggers" /><meta name="default_state" content="using-cfn-rollback-triggers" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" /><meta name="description" content="Os triggers de reversão permitem que você utilize o AWS CloudFormation para monitorar o estado do seu aplicativo durante a criação e a atualização da pilha e reverter a operação, se necessário." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Guia do usuário" /><meta name="abstract" content="Crie e gerencie implantações da infraestrutura da AWS de maneira previsível e que pode ser repetida usando o AWS CloudFormation com este Guia do usuário." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Guia do usuário" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Guia do usuário" /><meta id="panorama-serviceConsolePage" value="Monitorar e reverter operações de pilha" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Monitorar e reverter operações de pilha - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,provisionamento de recursos,configuração de recursos,gerenciamento da infraestrutura,CloudFormer,Pilha do CloudFormation,Stackset do CloudFormation,Modelo do CloudFormation,conjunto de alterações" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do usuário",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Como trabalhar com pilhas",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacks.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Usar o console do AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/cfn-using-console.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Monitorar e reverter operações de pilha",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/cfn-using-console.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Guia do usuário</a></div><div id="page-toc-src"><a href="#using-cfn-rollback-triggers-create">Para adicionar triggers de reversão durante a criação ou atualização da pilha</a><a href="#using-cfn-rollback-triggers-change-set">Para adicionar triggers de reversão a um conjunto de alterações</a><a href="#using-cfn-rollback-triggers-view">Para visualizar os triggers de reversão para uma pilha</a><a href="#using-cfn-rollback-triggers-view-change-set">Para visualizar gatilhos de reversão de um conjunto de alterações</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="using-cfn-rollback-triggers">Monitorar e reverter operações de pilha</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Triggers de reversão permitem que você utilize o AWS CloudFormation para monitorar o estado da sua aplicação durante a criação e atualização de pilhas, e que você reverta essa operação se a aplicação violar os limites dos alarmes especificados. Para cada trigger de reversão criado, você especifica o alarme do CloudWatch que o CloudFormation deve monitorar. O CloudFormation monitora os alarmes especificados durante a operação de criação ou atualização da pilha, e pelo tempo especificado depois que todos os recursos foram implantados. Se qualquer um dos alarmes entrar no estado <code class="code">ALARM</code> durante a operação de pilha ou o período de monitoramento, o CloudFormation reverterá toda a operação de pilha.</p><p>Você pode definir um tempo de monitoramento de 0 (padrão) até 180 minutos. Durante esse tempo, o CloudFormation monitora todos os triggers de reversão depois da implantação de todos os recursos necessários pela operação de criação ou atualização da pilha. Se qualquer um dos alarmes entrar no estado <code class="code">ALARM</code> durante a operação de pilha ou esse período de monitoramento, o CloudFormation reverterá toda a operação de pilha. Em seguida, para as operações de atualização, se o período de monitoramento expirar sem que qualquer alarme entre no estado <code class="code">ALARM</code>, o CloudFormation continuará a descartar recursos antigos normalmente. Se você definir um tempo de monitoramento, mas não especificar um trigger de reversão, o CloudFormation ainda aguardará o tempo especificado antes de limpar os recursos antigos para atualizar as operações. Você pode usar este período de monitoramento para executar qualquer validação manual desejada na pilha, e cancelar ou atualizar a criação da pilha manualmente conforme necessário. Se você definir um tempo de monitoramento de 0 minutos, o CloudFormation ainda fará o monitoramento dos triggers de reversão durante as operações de criação e atualização da pilha e reverterá a operação se um alarme entrar no estado <code class="code">ALARM</code>. Em seguida, para as operações de atualização sem alarmes de violação, ele começará a eliminar os recursos antigos imediatamente assim que a operação for concluída.</p><p>Por padrão, o CloudFormation somente reverte as operações da pilha se um alarme entrar no estado <code class="code">ALARM</code>, não no estado <code class="code">INSUFFICIENT_DATA</code>. Para que o CloudFormation também reverta a operação de pilha caso um alarme entre no estado <code class="code">INSUFFICIENT_DATA</code>, edite o alerta do CloudWatch para tratar a ausência de dados como <code class="code">breaching</code>. Para obter mais informações, consulte <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/AlarmThatSendsEmail.html#alarms-and-missing-data">Configurar como alarmes do CloudWatch tratam a ausência de dados</a> no Guia do usuário do Amazon CloudWatch.</p><p>O CloudFormation não monitora os triggers de reversão quando ele reverte uma pilha durante uma operação de atualização.</p><p>Você pode adicionar um máximo de cinco triggers de reversão. Para adicionar um trigger de reversão, especifique o nome do recurso da Amazon (ARN) do alarme do CloudWatch. No momento, <code class="code">AWS::CloudWatch::Alarm</code> e <code class="code">AWS::CloudWatch::CompositeAlarm</code> podem ser utilizados como gatilhos de reversão. Para obter mais informações sobre alarmes do CloudWatch, consulte <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/AlarmThatSendsEmail.html">Usar alarmes do CloudWatch</a>, no Guia do usuário do Amazon CloudWatch.</p><p>Se um determinado alarme do CloudWatch estiver ausente, toda a operação de pilha falhará e será revertida.</p><p>Lembre-se de que o acesso ao Amazon CloudWatch requer credenciais. Essas credenciais devem ter permissões para acessar os recursos da AWS, como recuperar dados de métricas do CloudWatch sobre seus recursos. Para obter mais informações, consulte <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/auth-and-access-control-cw.html">Autenticação e controle de acesso para o Amazon CloudWatch</a> no Guia do usuário do Amazon CloudWatch.</p>
        <h2 id="using-cfn-rollback-triggers-create">Para adicionar triggers de reversão durante a criação ou atualização da pilha</h2>
        <p>Para adicionar gatilhos de reversão a uma criação ou atualização de pilha, especifique os alarmes do Amazon CloudWatch na seção <b>Rollback configuration</b> (Configuração de reversão).</p>
        <div class="procedure"><ol><li>
                <p>Durante a <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-console-create-stack.html">criação</a> ou a <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks.html">atualização</a> de uma pilha, na página <b>Configure stack options</b> (Configurar opções da pilha), em <b>Advanced options</b> (Opções avançadas), expanda a seção <b>Rollback configuration</b> (Configuração de reversão).</p>
            </li><li>
                <p>Insira um tempo de monitoramento entre <code class="code">0</code> e <code class="code">180</code> minutos. O valor padrão é <code class="code">0</code>.</p>
            </li><li>
                <p>Especifique o ARN do alarme do CloudWatch ou do alarme composto que você deseja usar como um gatilho de reversão e selecione <b>Add CloudWatch alarm ARN</b> (Adicionar ARN de alarme do CloudWatch).</p>
                <p>Por exemplo, o seguinte é um ARN para um alarme do CloudWatch ou um alarme composto, <code class="code">arn:aws:cloudwatch:<code class="replaceable">us-east-1</code>:123456789012:alarm:<code class="replaceable">MyAlarmName</code></code>.</p>
            </li><li>
                <p>Selecione <b>Next</b> (Próximo) e analise os detalhes da sua pilha.</p>
            </li><li>
                <p>Após verificar as configurações de criação da pilha e o custo estimado dela, escolha <b>Criar pilha</b> para iniciá-la.</p>
            </li></ol></div>
        <p><em>Resultados</em>: você adicionou alarmes do Amazon CloudWatch com êxito à sua pilha.</p>
     
        <h2 id="using-cfn-rollback-triggers-change-set">Para adicionar triggers de reversão a um conjunto de alterações</h2>
        <p>Para adicionar gatilhos de reversão a um conjunto de alterações, selecione seu modelo de pilha e especifique os alarmes do Amazon CloudWatch na seção <b>Rollback configuration</b> (Configuração de reversão).</p>
        <div class="procedure"><ol><li>
                <p>Durante a <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-changesets-create.html">criação</a> ou a atualização de um conjunto de alterações, na página <b>Configure stack options</b> (Configurar opções da pilha), em <b>Advanced options</b> (Opções avançadas), expanda a seção <b>Rollback configuration</b> (Configuração de reversão).</p>
            </li><li>
                <p>Insira um tempo de monitoramento entre <code class="code">0</code> e <code class="code">180</code> minutos. O valor padrão é <code class="code">0</code>.</p>
            </li><li>
                <p>Especifique o ARN do alarme do CloudWatch ou do alarme composto que você deseja usar como um gatilho de reversão e selecione <b>Add CloudWatch alarm ARN</b> (Adicionar ARN de alarme do CloudWatch).</p>
                <p>Por exemplo, o seguinte é um ARN para um alarme do CloudWatch ou um alarme composto, <code class="code">arn:aws:cloudwatch:<code class="replaceable">us-east-1</code>:123456789012:alarm:<code class="replaceable">MyAlarmName</code></code>.</p>

            </li><li>
                <p>Selecione <b>Next</b> (Próximo) e analise os detalhes da sua pilha.</p>
            </li><li>
                <p>Após verificar as configurações de criação da pilha e o custo estimado dela, escolha <b>Create change set</b> (Criar conjunto de alterações).</p>
            </li><li>
                <p>Analise o módulo <b>Create change set</b> (Criar conjunto de alterações) e selecione <b>Create change set</b> (Criar conjunto de alterações).</p>
            </li><li>
                <p>(Opcional) Para concluir a criação de uma nova pilha com base no conjunto de alterações, escolha <b>Execute</b> (Executar), especifique sua configuração de reversão e depois escolha <b>Execute change set</b> (Executar conjunto de alterações).</p>
            </li></ol></div>
        <p><em>Resultados</em>: você adicionou alarmes do Amazon CloudWatch com êxito ao seu conjunto de alterações.</p>
     
        <h2 id="using-cfn-rollback-triggers-view">Para visualizar os triggers de reversão para uma pilha</h2>
        <p>Para visualizar gatilhos de reversão para uma pilha, consulte a seção <b>Rollback configuration</b> (Configuração de reversão).</p>
        <div class="procedure"><ol><li>
                <p>Na página <b>Stacks</b> (Pilhas), selecione a pilha que você deseja visualizar na lista à esquerda.</p>
            </li><li>
                <p>Na guia <b>Stack info</b> (Informações da pilha), expanda a seção <b>Rollback configuration</b> (Configuração de reversão).</p>

            </li></ol></div>
        <p><em>Resultados</em>: gatilhos de reversão são exibidos na seção <b>Rollback configuration</b> (Configuração de reversão) se tiverem sido especificados.</p>
     
        <h2 id="using-cfn-rollback-triggers-view-change-set">Para visualizar gatilhos de reversão de um conjunto de alterações</h2>
        <p>Para visualizar gatilhos de reversão para um conjunto de alterações, consulte a seção <b>Rollback configuration</b> (Configuração de reversão).</p>
        <div class="procedure"><ol><li>
                <p>Na página <b>Stacks</b> (Pilhas), selecione a pilha que você deseja visualizar na lista à esquerda.</p>
            </li><li>
                <p>Selecione a guia <b>Change sets</b> (Conjuntos de alterações) e selecione o conjunto de alterações que você deseja visualizar.</p>

            </li><li>
                <p>Selecione a guia <b>Input</b> (Entrada) e visualize a seção <b>Rollback configuration</b> (Configuração de reversão).</p>
            </li></ol></div>
        <p><em>Resultados</em>: gatilhos de reversão são exibidos na seção <b>Rollback configuration</b> (Configuração de reversão) se tiverem sido especificados.</p>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./cfn-console-view-stack-data-resources.html">Visualizar dados e recursos da pilha</div><div id="next" class="next-link" accesskey="n" href="./cfn-console-create-stacks-quick-create-links.html">Criar links de quick-create para pilhas</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-rollback-triggers.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>