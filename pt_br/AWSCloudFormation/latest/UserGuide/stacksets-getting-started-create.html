<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Criar um conjunto de pilhas - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="stacksets-getting-started-create" /><meta name="default_state" content="stacksets-getting-started-create" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" /><meta name="description" content="Você pode criar um conjunto de pilhas usando o AWS Management Console ou usando comandos do AWS CloudFormation na AWS CLI. Você pode criar um conjunto de pilhas com as permissões service-managed ou self-managed ." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Guia do usuário" /><meta name="abstract" content="Crie e gerencie implantações da infraestrutura da AWS de maneira previsível e que pode ser repetida usando o AWS CloudFormation com este Guia do usuário." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Guia do usuário" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Guia do usuário" /><meta id="panorama-serviceConsolePage" value="Criar um conjunto de pilhas" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Criar um conjunto de pilhas - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,provisionamento de recursos,configuração de recursos,gerenciamento da infraestrutura,CloudFormer,Pilha do CloudFormation,Stackset do CloudFormation,Modelo do CloudFormation,conjunto de alterações" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do usuário",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Trabalhar com o AWS CloudFormation StackSets",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/what-is-cfnstacksets.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Conceitos básicos do AWS CloudFormation StackSets",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-getting-started.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Criar um conjunto de pilhas",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-getting-started.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Guia do usuário</a></div><div id="page-toc-src"><a href="#stacksets-getting-started-create-self-managed">Criar um conjunto de pilhas com permissões autogerenciadas</a><a href="#stacksets-orgs-associate-stackset-with-org">Criar um conjunto de pilhas com permissões gerenciadas pelo serviço</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="stacksets-getting-started-create">Criar um conjunto de pilhas</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Você pode criar um conjunto de pilhas usando o AWS Management Console ou usando comandos do AWS CloudFormation na AWS CLI. Você pode criar um conjunto de pilhas com as permissões <code class="code">service-managed</code> ou <code class="code">self-managed</code>.</p><p>Com permissões <code class="code">self-managed</code>, você pode implantar instâncias de pilha em Contas da AWS específicas de regiões específicas. Para fazer isso, você deve primeiro criar as funções do IAM necessárias para estabelecer uma relação de confiança entre a conta na qual você está administrando o conjunto de pilhas e a conta na qual você está implantando as instâncias de pilha.</p><p>Com as permissões <code class="code">service-managed</code>, você pode implantar instâncias de pilhas em contas gerenciadas pelo AWS Organizations em regiões específicas. Com esse modelo, você não precisa criar os perfis do IAM necessários. O StackSets cria esses perfis do IAM em seu nome. Você também pode habilitar implantações automáticas em contas adicionadas a uma organização de destino ou unidade organizacional (OU) no futuro. Com implantações automáticas habilitadas, o StackSets excluirá automaticamente instâncias de pilha de uma conta se ela for removida de uma organização de destino ou OU.</p><div class="highlights" id="inline-topiclist"><h6>Tópicos</h6><ul><li><a href="#stacksets-getting-started-create-self-managed">Criar um conjunto de pilhas com permissões autogerenciadas</a></li><li><a href="#stacksets-orgs-associate-stackset-with-org">Criar um conjunto de pilhas com permissões gerenciadas pelo serviço</a></li></ul></div>
            <h2 id="stacksets-getting-started-create-self-managed">Criar um conjunto de pilhas com permissões autogerenciadas</h2>

            <div class="highlights" id="inline-topiclist"><h6>Tópicos</h6><ul><li><a href="#stacksets-getting-started-create-self-managed-console">Criar um conjunto de pilhas com permissões autogerenciadas usando a AWS Management Console</a></li><li><a href="#stacksets-getting-started-self-managed-cli">Criar um conjunto de pilhas com permissões autogerenciadas usando a AWS CLI</a></li></ul></div>

             
                <h3 id="stacksets-getting-started-create-self-managed-console">Criar um conjunto de pilhas com permissões autogerenciadas usando a AWS Management Console</h3>

                <div class="procedure"><ol><li><p>Abra o console do AWS CloudFormation em <a href="https://console.aws.amazon.com/cloudformation/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/cloudformation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
                        <p>No painel de navegação, escolha <b>StackSets</b>.</p>
                    </li><li>
                        <p>No topo da página <b>StackSets</b>, escolha <b>Create StackSet (Criar StackSet)</b>.</p>
                    </li><li>
                        <p>Em <b>Prerequisite - Prepare template (Pré-requisito - preparar modelo)</b>, escolha <b>Use a sample template (Usar um modelo de exemplo)</b>.</p>
                    </li><li>
                        <p>Em <b>Selecionar um exemplo de modelo</b>, no menu suspenso, escolha o modelo <b>Habilitar configuração da AWS</b>. Selecione <b>Próximo</b>.</p>
                        <div class="mediaobject">
                             
                                <img src="images/console-create-stackset-choose-template.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                                Modelo para Habilitar AWS Config do exemplo do StackSets&#xA;                            " style="max-width:100%" />
                             
                             
                        </div>
                    </li><li>
                        <p>Na página <b>Specify StackSet details (Especificar detalhes do StackSet)</b>, forneça as seguintes informações.</p>
                        <ol><li>
                                <p>Forneça um nome para o conjunto de pilhas. Os nomes dos conjuntos de pilhas precisam começar com um caractere alfabético e conter apenas letras, números e hifens. Neste passo a passo, usamos o nome <code class="userinput">my-awsconfig-stackset</code>.</p>
                            </li><li>
                                <p>Você precisará especificar os valores para os parâmetros usados pelo AWS Config. Para obter mais informações sobre esses parâmetros, consulte <a href="https://docs.aws.amazon.com/config/latest/developerguide/gs-console.html">Configurar o AWS Config com o console</a> no <em>Guia do desenvolvedor do AWS Config</em>. Neste passo-a-passo, manteremos as configurações padrão para todos parâmetros do AWS Config.</p>
                            </li><li>
                                <p>Você pode configurar atualizações do Amazon Simple Notification Service (SNS) por e-mail, com base no conteúdo do log, usando os parâmetros <b>TopicARN</b> e <b>NotificationEmail</b>. Para a finalidade deste passo-a-passo, não configuraremos as atualizações do Amazon SNS.</p>
                            </li><li>
                                <p>É possível configurar o canal de entrega para atualizações e notificações usando os parâmetros <b>DeliveryChannelName</b> e <b>Frequency</b>. Para obter mais informações sobre o canal de entrega no AWS Config, consulte <a href="https://docs.aws.amazon.com/config/latest/developerguide/manage-delivery-channel.html">Gerenciar o canal de entrega</a> no <em>Guia de desenvolvedor do AWS Config</em>. Para a finalidade deste passo-a-passo, manteremos as configurações padrão nesta área.</p>
                            </li></ol>
                    </li><li>
                        <p>Depois de especificar os parâmetros para o AWS Config, escolha <b>Next (Próximo)</b>.</p>
                    </li><li>
                        <p>Na página <b>Configure StackSet options (Configurar opções de StackSet)</b>, adicione uma tag ao especificar um par de chave e valor. Neste passo-a-passo, criaremos uma tag chamada <b>Fase</b> com um valor <b>Teste</b>. As tags que você aplica aos conjuntos de pilhas são aplicadas a todos os recursos criados pelas suas pilhas. Para obter mais informações sobre como as tags são usadas na AWS, consulte <a href="https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/cost-alloc-tags.html">Usar tags de alocação de custos</a>, no <em>Guia do usuário do AWS Billing and Cost Management</em>.</p>
                        <p>Deixe <b>Permissions</b> (Permissões) não especificado.</p>
                    </li><li>
                        <p>Para <b>Execution configuration</b> (Configuração de execução), escolha <b>Active</b> (Ativo) para que o StackSets execute operações não conflitantes simultaneamente e enfileire operações conflitantes. Depois do término das operações conflitantes, o StackSets inicia as operações em fila na ordem de solicitação.</p>
                        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Se já houver operações em execução ou em fila, o StackSets enfileirará todas as operações de entrada, mesmo que não sejam conflitantes.</p><p>Não será possível modificar a configuração de execução do conjunto de pilhas enquanto houver operações em execução ou em fila para esse conjunto de pilhas.</p></div></div>
                    </li><li>
                        <p>Escolha <b>Next</b> (Próximo).</p>
                    </li><li>
                        <p>Na página <b>Set deployment options (Definir opções de implantação)</b>, informe em quais contas e regiões você deseja que as pilhas do seu conjunto de pilhas sejam implantadas.</p>
                        <p>O AWS CloudFormation implementará pilhas nas contas especificadas na primeira região, depois passará para a próxima e assim por diante, desde que as falhas de implantação de uma região não excedam uma tolerância a falhas especificada.</p>
                        <ol><li>
                                <p>Em <b>Accounts (Contas)</b>, escolha <b>Deploy stacks in accounts (Implantar pilhas em contas)</b>. Cole os números da sua conta de destino na caixa de texto, separando-os com vírgulas.</p>
                            </li><li>
                                <p>Em <b>Specify regions (Especificar regiões)</b>, escolha Leste dos EUA (Norte da Virgínia)  Região. Repita para a Região Oeste dos EUA (Oregon). Clique na seta para cima ao lado de Região Oeste dos EUA (Oregon) a fim de movê-la para ser a primeira entrada na lista. A ordem das regiões em <b>Specify regions (Especificar regiões)</b> determina a ordem de implantação.</p>
                            </li><li>
                                <p>Em <b>Deployment options (Opções de implantação)</b>:</p>
                                <div class="itemizedlist">
                                     
                                     
                                <ul class="itemizedlist"><li class="listitem">
                                        <p>Em <b>Maximum concurrent accounts</b> (Máximo de contas concorrentes), mantenha os valores padrão de <b>Number</b> (Número) e <b>1</b>.</p>
                                        <p>Isso significa que o AWS CloudFormation implantará sua pilha em apenas uma conta de cada vez.</p>
                                    </li><li class="listitem">
                                        <p>Em <b>Failure tolerance (Tolerância a falhas)</b>, mantenha os padrões de <b>Number (Número)</b> e <b>0</b>.</p>
                                        <p>Isso significa que, no máximo, uma implantação de pilha poderá falhar em uma das suas regiões especificadas para que o AWS CloudFormation interrompa a implantação na região atual e cancele a implantação nas regiões restantes.</p>
                                    </li></ul></div>
                            </li><li>
                                <div class="itemizedlist">
                                    <p>Em <b>Region concurrency</b> (Simultaneidade de região):</p>
                                     
                                <ul class="itemizedlist"><li class="listitem">
                                        <p>Selecione <b>Sequential</b> (Sequencial) ou<b> Parallel</b> (Paralelo) para determinar a ordem de implantação do StackSets para regiões especificadas. Por padrão, a opção <b>Sequential</b> (Sequencial) é selecionada.</p>

                                    </li></ul></div>
                                <p>Selecione <b>Próximo</b>.</p>
                            </li></ol>
                        <div class="mediaobject">
                             
                                <img src="images/console-create-stackset-set-deploy-options.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                                Página Definir opções de implantação&#xA;                            " style="max-width:100%" />
                             
                             
                        </div>
                    </li><li>
                        <p>Na página <b>Revisão</b>, revise suas escolhas e as propriedades do seu conjunto de pilhas. Para fazer as alterações, escolha <b>Editar</b> na área em que você deseja alterar as propriedades. Antes de criar o conjunto de pilhas, é necessário preencher a caixa de seleção na área <b>Capabilities (Recursos)</b> para confirmar que alguns dos recursos que você está criando com o conjunto de pilhas podem exigir novos recursos e permissões do IAM. Para obter mais informações sobre as permissões que poderão ser necessárias, consulte <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-iam-template.html#using-iam-capabilities">Reconhecer recursos do IAM em modelos do AWS CloudFormation</a>, neste guia. Quando estiver pronto para criar seu conjunto de pilhas, escolha <b>Submit</b> (Enviar).</p>
                        <div class="mediaobject">
                             
                                <img src="images/console-create-stackset-review-capabilities.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                                Reconhecer recursos necessários&#xA;                            " style="max-width:100%" />
                             
                             
                        </div>
                    </li><li>
                        <p>O AWS CloudFormation começa a criar seu conjunto de pilhas. Visualize o progresso e o status da criação das pilhas em seu conjunto de pilhas na página de detalhes do conjunto de pilhas que é aberta ao escolher <b>Submit (Enviar)</b>.</p>
                        <div class="mediaobject">
                             
                                <img src="images/console-stackset-detail-operations.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                                Guia de operações da página de detalhes de StackSets&#xA;                            " style="max-width:100%" />
                             
                             
                        </div>
                    </li></ol></div>
             
             
                <h3 id="stacksets-getting-started-self-managed-cli">Criar um conjunto de pilhas com permissões autogerenciadas usando a AWS CLI</h3>
                <div class="procedure"><p>Ao criar conjuntos de pilhas usando os comandos da AWS CLI, você executa dois comandos separados: <code class="code">create-stack-set</code> para carregar seu modelo e criar o contêiner do conjunto de pilhas e <code class="code">create-stack-instances</code> para criar as pilhas dentro do seu conjunto de pilhas. Comece executando um comando da AWS CLI, <code class="code">create-stack-set</code>, para carregar o modelo de amostra do AWS CloudFormation que habilita o AWS Config e, em seguida, inicie a criação do conjunto de pilhas.</p><ol><li>
                        <p>Abra a AWS CLI.</p>
                    </li><li>
                        <p>Execute o comando a seguir.</p>
                        <p>Para o parâmetro <code class="code">--template-url</code>, forneça o URL do bucket do Amazon S3 no qual você está armazenando seu modelo. Neste passo-a-passo, usaremos <code class="code">my-awsconfig-stackset</code> como o valor do parâmetro <code class="code">--stack-set-name</code>. Também ativamos <code class="code">--managed-execution</code> para que o StackSets execute operações não conflitantes simultaneamente e enfileire operações conflitantes. Depois do término das operações conflitantes, o StackSets inicia as operações em fila na ordem de solicitação.</p>
                        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Se já houver operações em execução ou em fila, o StackSets enfileirará todas as operações de entrada, mesmo que não sejam conflitantes.</p><p>Não será possível modificar a configuração de execução do conjunto de pilhas enquanto houver operações em execução ou em fila para esse conjunto de pilhas.</p></div></div>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation create-stack-set \
  --stack-set-name my-awsconfig-stackset \
  --template-url https://s3.amazonaws.com/cloudformation-stackset-sample-templates-us-east-1/EnableAWSConfig.yml</code></pre>
                    </li><li>
                        <p>Quando o comando <code class="code">create-stack-set</code> estiver concluído, execute o comando <code class="code">list-stack-sets</code> para ver qual conjunto de pilhas foi criado. Sua nova pilha configurada deve ser visualizada nos resultados.</p>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation list-stack-sets</code></pre>
                    </li><li>
                        <p>Execute o comando <code class="code">create-stack-instances</code> da AWS CLI para adicionar instâncias de pilha ao seu conjunto de pilhas. Neste passo-a-passo, usaremos <code class="code">us-west-2</code> e <code class="code">us-east-1</code> como os valores do parâmetro <code class="code">--regions</code>.</p>
                        <p>Configure a tolerância a falhas e o máximo de contas concorrentes definindo <code class="code">FailureToleranceCount</code> como <code class="code">0</code> e <code class="code">MaxConcurrentCount</code> como <code class="code">1</code> no parâmetro <code class="code">--operation-preferences</code>, como mostrado no exemplo a seguir. Para aplicar porcentagens, use <code class="code">FailureTolerancePercentage</code> ou <code class="code">MaxConcurrentPercentage</code>. Para a finalidade deste passo-a-passo, usaremos conta, e não porcentagem.</p>
                        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>O valor de <code class="code">MaxConcurrentCount</code> depende do valor de <code class="code">FailureToleranceCount</code>. <code class="code">MaxConcurrentCount</code> é, no máximo, um a mais do que <code class="code">MaxConcurrentCount</code>.</p></div></div>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation create-stack-instances \
  --stack-set-name my-awsconfig-stackset \
  --accounts '["<code class="replaceable">account_ID_1</code>","<code class="replaceable">account_ID_2</code>"]' \
  --regions '["<code class="replaceable">region_1</code>","<code class="replaceable">region_2</code>"]' \
  --operation-preferences FailureToleranceCount=0,MaxConcurrentCount=1</code></pre>
                        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>A simultaneidade das implantações de instâncias do StackSet na operação depende do valor de <code class="code">FailureToleranceCount-MaxConcurrentCount</code> e é, no máximo, um a mais do que o <code class="code">FailureToleranceCount</code>.</p></div></div>
                        <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Importante</h6></div><div class="awsdocs-note-text"><p>Aguarde até que uma operação seja concluída antes de iniciar outra. Você só pode executar uma operação por vez.</p></div></div>
                    </li><li>
                        <p>Verifique se as instâncias da pilha foram criadas com sucesso. Execute <code class="code"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_DescribeStackSetOperation.html">DescribeStackSetOperation</a></code> com <code class="code">operation-id</code>, que é retornado como parte da saída da etapa 4.</p>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation describe-stack-set-operation \
  --stack-set-name my-awsconfig-stackset \
  --operation-id <code class="replaceable">operation_ID</code></code></pre>
                    </li></ol></div>
             
         
            <h2 id="stacksets-orgs-associate-stackset-with-org">Criar um conjunto de pilhas com permissões gerenciadas pelo serviço</h2>

            <div class="highlights" id="inline-topiclist"><h6>Tópicos</h6><ul><li><a href="#stacksets-orgs-considerations">Considerações ao criar um conjunto de pilhas com permissões gerenciadas pelo serviço</a></li><li><a href="#stacksets-orgs-associate-stackset-with-org-console">Criar um conjunto de pilhas com permissões gerenciadas pelo serviço usando o console do AWS CloudFormation</a></li><li><a href="#stacksets-orgs-associate-stackset-with-org-cli">Criar um conjunto de pilhas com permissões gerenciadas pelo serviço usando a AWS CLI</a></li></ul></div>

             
                <h3 id="stacksets-orgs-considerations">Considerações ao criar um conjunto de pilhas com permissões gerenciadas pelo serviço</h3>

                <p>Antes de criar um conjunto de pilha com permissões gerenciadas por serviço, considere o seguinte:</p>

                <div class="itemizedlist">
                     
                     
                     
                     
                     
                     
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Os conjuntos de pilha com permissões gerenciadas por serviço são criados na conta de gerenciamento, incluindo conjuntos de pilha criados por administradores delegados.</p>
                    </li><li class="listitem">
                        <p>O conjunto de pilhas pode ter como destino toda a sua organização ou unidades organizacionais (OUs) especificadas. Se o conjunto de pilhas tiver como destino a sua organização, ele também terá como destino todas as contas em todas as OUs da organização. Se o conjunto de pilhas tiver como destino OUs especificadas, ela também terá todas as contas nessas OUs como destino.</p>
                    </li><li class="listitem">
                        <p>Se o conjunto de pilhas tiver uma OU pai como destino, o conjunto de pilhas também terá qualquer OU filha como destino.</p>
                    </li><li class="listitem">
                        <p>Vários conjuntos de pilhas podem ter como destino a mesma organização ou OU.</p>
                    </li><li class="listitem">
                        <p>O conjunto de pilhas não pode ter contas fora da organização como destino.</p>
                    </li><li class="listitem">
                        <p>Seu conjunto de pilhas não pode implantar pilhas aninhadas.</p>
                    </li><li class="listitem">
                        <p>O StackSets não implanta instâncias de pilha na conta de gerenciamento da organização, mesmo que a conta de gerenciamento esteja em sua organização ou em uma OU na sua organização.</p>
                    </li><li class="listitem">
                        <p>A implantação automática é definida no nível do conjunto de pilhas. Não é possível ajustar implantações automáticas seletivamente para OUs, contas ou regiões.</p>
                    </li><li class="listitem">
                        <p>As permissões da entidade principal do IAM (usuário, função ou grupo) que você usa para fazer login na conta de gerenciamento determinam se você está autorizado a implantar com o StackSets. Para obter um exemplo de política do IAM que concede permissões para implantar em uma organização, consulte <a href="./using-iam-template.html#resource-level-permissions-service-managed-stack-set">Exemplo de política que concede permissões de conjunto de pilhas gerenciadas pelo serviço</a>.</p>
                    </li><li class="listitem">
                        <p>Os administradores delegados têm permissões completas para implantar em contas em sua organização. A conta de gerenciamento não pode limitar as permissões de administrador delegado para implantar em OUs específicas ou para executar operações específicas de conjunto de pilhas.</p>
                    </li></ul></div>
             

             
                <h3 id="stacksets-orgs-associate-stackset-with-org-console">Criar um conjunto de pilhas com permissões gerenciadas pelo serviço usando o console do AWS CloudFormation</h3>

                <div class="procedure"><ol><li>
                        <p>Abra o console do AWS CloudFormation em <a href="https://console.aws.amazon.com/cloudformation" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/cloudformation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
                    </li><li>
                        <p>No painel de navegação, escolha <b>StackSets</b>.</p>
                    </li><li>
                        <p>No topo da página <b>StackSets</b>, escolha <b>Create StackSet (Criar StackSet)</b>.</p>
                    </li><li>
                        <p>Em <b>Prepare template (Preparar modelo)</b>, escolha <b>Template is ready (O modelo está pronto)</b>.</p>
                    </li><li>
                        <p>Em <b>Specify template (Especificar modelo)</b>, escolha especificar o URL para o bucket do S3 que contém o modelo de pilha ou fazer upload de um arquivo de modelo de pilha. Escolha <b>Next</b> (Próximo).</p>
                    </li><li>
                        <p>Na página <b>Specify StackSet details (Especificar detalhes do StackSet)</b> forneça um nome para o conjunto de pilhas, especifique quaisquer parâmetros e escolha <b>Next (Próximo)</b>.</p>
                    </li><li>
                        <p>Na página <b>Configure StackSet options (Configurar opções do StackSet)</b> em <b>Tags</b>, especifique todas as tags a serem aplicadas aos recursos em sua pilha.</p>
                    </li><li>
                        <p>Em <b>Permissions (Permissões)</b>, escolha <b>Service-managed permissions (Permissões gerenciadas pelo serviço)</b>.</p>
                        <p>Se o acesso confiável com o AWS Organizations estiver desabilitado, será exibido um banner. É necessário o acesso confiável para criar ou atualizar um conjunto de pilhas com permissões gerenciadas pelo serviço. Somente o administrador na conta de gerenciamento da organização tem permissões para <a href="./stacksets-orgs-activate-trusted-access.html">Ativar o acesso confiável com AWS Organizations</a>.</p>
                        <div class="mediaobject">
                             
                                <img src="images/console-stackset-service-managed-permissions.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                                Ativa o banner de acesso confiável.&#xA;                            " style="max-width:100%" />
                             
                             
                        </div>
                    </li><li>
                        <p>Para <b>Execution configuration</b> (Configuração de execução), escolha <b>Active</b> (Ativo) para que o StackSets execute operações não conflitantes simultaneamente e enfileire operações conflitantes. Depois do término das operações conflitantes, o StackSets inicia as operações em fila na ordem de solicitação.</p>
                        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Se já houver operações em execução ou em fila, o StackSets enfileirará todas as operações de entrada, mesmo que não sejam conflitantes.</p><p>Não será possível modificar a configuração de execução do conjunto de pilhas enquanto houver operações em execução ou em fila para esse conjunto de pilhas.</p></div></div>
                    </li><li>
                        <p>Escolha <b>Próximo</b> para continuar e habilitar o acesso confiável caso ainda não esteja habilitado.</p>

                    </li><li>
                        <p>Na página <b>Set deployment options (Definir opções de implantação)</b> em <b>Deployment targets (Destinos da implantação)</b>, escolha as contas em sua organização nas quais implantar.</p>
                        <div class="itemizedlist">
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p>Escolha <b>Deploy to organization (Implantar na organização)</b> para implantar em todas as contas em sua organização.</p>
                                <div class="mediaobject">
                                     
                                        <img src="images/console-stackset-deploy-to-org.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                                        Implantar instâncias de pilha em todas as contas em sua organização.&#xA;                                    " style="max-width:100%" />
                                     
                                     
                                </div>
                            </li><li class="listitem">
                                <p>Escolha <b>Deploy to organizational units (OUs) (Implantar em unidades organizacionais (OUs))</b> para implantar em todas as contas em OUs específicas. Escolha <b>Add an OU (Adicionar uma OU)</b> e cole o ID de destino na caixa de texto. Repita para cada nova OU de destino.</p>
                                <div class="mediaobject">
                                     
                                        <img src="images/console-stackset-deploy-to-organizational-units.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                                        Implantar instâncias de pilha em todas as contas em OUs selecionadas dentro de sua organização.&#xA;                                    " style="max-width:100%" />
                                     
                                     
                                </div>
                            </li></ul></div>
                    </li><li>
                        <p>Em <b>Automatic deployment (Implantação automática)</b>, escolha se os StackSets serão implantados automaticamente em contas que serão adicionadas à organização de destino ou OUs no futuro.</p>
                        <div class="mediaobject">
                             
                                <img src="images/console-stackset-auto-deploy.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                                Configurações de implantação automática para conjuntos de pilhas com permissões gerenciadas pelo serviço.&#xA;                            " style="max-width:100%" />
                             
                             
                        </div>
                    </li><li>
                        <p>Se você habilitou a implantação automática, em <b>Account removal behavior (Comportamento de remoção de conta)</b>, escolha se os recursos de pilha serão retidos ou excluídos quando uma conta for removida de uma organização ou OU de destino.</p>
                        <div class="mediaobject">
                             
                                <img src="images/console-stackset-account-removal-retain.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                                Configurações de comportamento de remoção de conta para conjuntos de pilhas com permissões gerenciadas pelo serviço.&#xA;                            " style="max-width:100%" />
                             
                             
                        </div>
                        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Com a opção <b>Retain stacks (Reter pilhas)</b> selecionada, as instâncias de pilha são removidas do conjunto de pilhas, mas as pilhas e os recursos associados são retidos. Os recursos permanecem em seu estado atual, mas não farão mais parte do conjunto de pilhas.</p></div></div>
                    </li><li>
                        <p>Em <b>Deployment regions (Regiões de implantação)</b>, escolha as regiões nas quais você deseja implantar instâncias de pilha. Escolha <b>Next</b> (Próximo).</p>
                    </li><li>
                        <p>Na página <b>Review</b> (Revisar), verifique se o StackSets será implantado nas contas corretas nas regiões corretas e escolha <b>Create StackSet</b> (Criar StackSet).</p>
                    </li></ol></div>

                <p>A página <b>StackSet details (Detalhes do StackSet)</b> é aberta. Você pode visualizar o andamento e o status da criação das pilhas em seu conjunto de pilhas.</p>

             
             
                <h3 id="stacksets-orgs-associate-stackset-with-org-cli">Criar um conjunto de pilhas com permissões gerenciadas pelo serviço usando a AWS CLI</h3>

                <p>Quando cria conjuntos de pilhas usando a AWS CLI, você executa dois comandos separados. Durante o <code class="code">create-stack-set</code>, você carrega seu modelo, cria o contêiner do conjunto de pilhas e gerencia implantações automáticas. Durante <code class="code">create-stack-instances</code>, você cria instâncias de pilha em contas de destino específicas.</p>

                <p>Ao atuar como administrador delegado, você deve definir o parâmetro <code class="code">--call-as</code> como <code class="code">DELEGATED_ADMIN</code> todas as vezes que executar um comando StackSets.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="text ">--call-as <code class="replaceable">DELEGATED_ADMIN</code></code></pre>
                <p>Os conjuntos de pilha criados por um administrador delegado são criados na conta de gerenciamento da organização.</p>

                <div class="procedure"><ol><li>
                        <p>Abra a AWS CLI.</p>
                    </li><li>
                        <p>Execute o comando <code class="code">create-stack-set</code>.</p>
                        <p>No exemplo a seguir, habilitamos implantações automáticas para permitir que o StackSets implante automaticamente em contas adicionadas à organização de destino ou em OUs no futuro. Retemos recursos de pilha quando uma conta é removida de uma organização ou OU de destino. Também ativamos <code class="code">--managed-execution</code> para que o StackSets execute operações não conflitantes simultaneamente e enfileire operações conflitantes. Depois do término das operações conflitantes, o StackSets inicia as operações em fila na ordem de solicitação.</p>
                        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Se já houver operações em execução ou em fila, o StackSets enfileirará todas as operações de entrada, mesmo que não sejam conflitantes.</p><p>Não será possível modificar a configuração de execução do conjunto de pilhas enquanto houver operações em execução ou em fila para esse conjunto de pilhas.</p></div></div>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation create-stack-set \
  --stack-set-name <code class="replaceable">StackSet_myApp</code> \
  --template-url <code class="replaceable">https://s3.us-west-2.amazonaws.com/cloudformation-templates-us-west-2/MyApp.template</code> \
  <b>--permission-model <code class="replaceable">SERVICE_MANAGED</code> \
  --auto-deployment Enabled=<code class="replaceable">true</code>,RetainStacksOnAccountRemoval=<code class="replaceable">true</code></b></code></pre>
                    </li><li>
                        <p>Quando o comando <code class="code">create-stack-set</code> for concluído, execute o comando <code class="code">list-stack-sets</code> para ver qual conjunto de pilhas foi criado. O novo conjunto de pilhas é listado nos resultados.</p>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation list-stack-sets</code></pre>
                        <div class="itemizedlist">
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p>Se você definir o parâmetro <code class="code">--call-as</code> como <code class="code">DELEGATED_ADMIN</code> enquanto estiver conectado à sua conta de membro, <code class="code">list-stack-sets</code> retornará todos os conjuntos de pilha com permissões gerenciadas por serviço na conta de gerenciamento da organização.</p>
                            </li><li class="listitem">
                                <p>Se você definir o parâmetro <code class="code">--call-as</code> <code class="code">SELF</code> enquanto estiver conectado à sua conta da AWS, <code class="code">list-stack-sets</code> retornará todos os conjuntos de pilhas autogerenciados em sua conta da AWS.</p>
                            </li><li class="listitem">
                                <p>Se você definir o parâmetro <code class="code">--call-as</code> como <code class="code">SELF</code> enquanto estiver conectado à conta de gerenciamento da organização, <code class="code">list-stack-sets</code> retornará todos os conjuntos de pilha na organização conta de gerenciamento.</p>
                            </li></ul></div>
                    </li><li>
                        <p>Execute o comando <code class="code">create-stack-instances</code> para adicionar instâncias de pilha ao conjunto de pilhas. Para o parâmetro <code class="code">--deployment-targets</code>, especifique o ID raiz da organização a ser implantado em todas as contas da organização ou especifique IDs de OUs para implantar em todas as contas nessas OUs. Neste exemplo, especificamos OUs com os IDs <code class="code">ou-rcuk-slr5lh0a</code> e <code class="code">ou-rcuk-1x5j1lwo</code>.</p>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh ">aws cloudformation create-stack-instances --stack-set-name <code class="replaceable">StackSet_myApp</code> <b>--deployment-targets OrganizationalUnitIds='["<code class="replaceable">ou-rcuk-1x5j1lwo</code>", "<code class="replaceable">ou-rcuk-slr5lh0a</code>"]'</b> --regions '["<code class="replaceable">eu-west-1</code>"]'</code></pre>
                        <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Importante</h6></div><div class="awsdocs-note-text"><p>Aguarde até que uma operação seja concluída antes de iniciar outra. Você só pode executar uma operação por vez.</p></div></div>
                    </li><li>
                        <p>Usando o <code class="code">operation-id</code> que foi retornado como parte da saída <code class="code">create-stack-instances</code> na etapa 4, execute <code class="code">describe-stack-set-operation</code> para verificar se suas instâncias de pilha foram criadas com êxito.</p>
                    </li></ol></div>

             
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./stacksets-getting-started.html">Conceitos básicos</div><div id="next" class="next-link" accesskey="n" href="./stacksets-update.html">Atualizar o conjunto de pilhas</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/stacksets-getting-started-create.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>