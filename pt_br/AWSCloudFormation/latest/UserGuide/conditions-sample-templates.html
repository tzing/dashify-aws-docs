<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Exemplos de modelo do - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="conditions-sample-templates" /><meta name="default_state" content="conditions-sample-templates" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" /><meta name="description" content="Use esses modelos de exemplo como um ponto de partida para criar modelos semelhantes que atendam às suas necessidades." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Guia do usuário" /><meta name="abstract" content="Crie e gerencie implantações da infraestrutura da AWS de maneira previsível e que pode ser repetida usando o AWS CloudFormation com este Guia do usuário." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Guia do usuário" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Guia do usuário" /><meta id="panorama-serviceConsolePage" value="Exemplos de modelo do" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Exemplos de modelo do - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,provisionamento de recursos,configuração de recursos,gerenciamento da infraestrutura,CloudFormer,Pilha do CloudFormation,Stackset do CloudFormation,Modelo do CloudFormation,conjunto de alterações" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do usuário",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Referência do modelo",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/template-reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Referência à função intrínseca",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Funções de condição",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-conditions.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Exemplos de modelo do",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-conditions.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Guia do usuário</a></div><div id="page-toc-src"><a href="#w9aac34c28c21c31b3">Crie condicionalmente recursos para uma produção, desenvolvimento ou teste de pilha</a><a href="#w9aac34c28c21c31b5">Atribuição condicional de uma propriedade de recurso</a><a href="#w9aac34c28c21c31b7">Uso condicional de um recurso existente</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="conditions-sample-templates">Exemplos de modelo do </h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div>
      <h2 id="w9aac34c28c21c31b3">Crie condicionalmente recursos para uma produção, desenvolvimento ou teste de pilha</h2>

      <p>Em alguns casos, você pode criar pilhas que são semelhantes, mas com pequenos ajustes. Por exemplo, você pode ter um modelo que você usa para aplicativos de produção. Você deseja criar a mesma pilha de produção, para que você possa usá-la para desenvolvimento ou teste. No entanto, para desenvolvimento e teste, você pode não exigir toda a capacidade extra incluída em uma pilha de nível de produção. Em vez disso, você pode usar um parâmetro de entrada no tipo de ambiente para criar condicionalmente os recursos de pilha que são específicos para produção, desenvolvimento ou testes, como mostrado no seguinte exemplo:</p>
      <div class="example"><h6>exemplo JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "AWSTemplateFormatVersion" : "2010-09-09",

  "Mappings" : <span>{</span>
    "RegionMap" : <span>{</span>
      "us-east-1"      : <span>{</span> "AMI" : "ami-0ff8a91507f77f867"},
      "us-west-1"      : <span>{</span> "AMI" : "ami-0bdb828fd58c52235"},
      "us-west-2"      : <span>{</span> "AMI" : "ami-a0cfeed8"},
      "eu-west-1"      : <span>{</span> "AMI" : "ami-047bb4163c506cd98"},
      "sa-east-1"      : <span>{</span> "AMI" : "ami-07b14488da8ea02a0"},
      "ap-southeast-1" : <span>{</span> "AMI" : "ami-08569b978cc4dfa10"},
      "ap-southeast-2" : <span>{</span> "AMI" : "ami-09b42976632b27e9b"},
      "ap-northeast-1" : <span>{</span> "AMI" : "ami-06cd52961ce9f0d85"}
    }
  },
  
  "Parameters" : <span>{</span>
    "EnvType" : <span>{</span>
      "Description" : "Environment type.",
      "Default" : "test",
      "Type" : "String",
      "AllowedValues" : ["prod", "dev", "test"],
      "ConstraintDescription" : "must specify prod, dev, or test."
    }
  },
  
  "Conditions" : <span>{</span>
    "CreateProdResources" : <span>{</span>"Fn::Equals" : [<span>{</span>"Ref" : "EnvType"}, "prod"]},
    "CreateDevResources" : <span>{</span>"Fn::Equals" : [<span>{</span>"Ref" : "EnvType"}, "dev"]}
  },
  
  "Resources" : <span>{</span>
    "EC2Instance" : <span>{</span>
      "Type" : "AWS::EC2::Instance",
      "Properties" : <span>{</span>
        "ImageId" : <span>{</span> "Fn::FindInMap" : [ "RegionMap", <span>{</span> "Ref" : "AWS::Region" }, "AMI" ]},
        "InstanceType" : <span>{</span> "Fn::If" : [
          "CreateProdResources",
          "c1.xlarge",
          <span>{</span>"Fn::If" : [
            "CreateDevResources",
            "m1.large",
            "m1.small"
          ]}
        ]}
      }
    },
    
    "MountPoint" : <span>{</span>
      "Type" : "AWS::EC2::VolumeAttachment",
      "Condition" : "CreateProdResources",
      "Properties" : <span>{</span>
        "InstanceId" : <span>{</span> "Ref" : "EC2Instance" },
        "VolumeId"  : <span>{</span> "Ref" : "NewVolume" },
        "Device" : "/dev/sdh"
      }
    },

    "NewVolume" : <span>{</span>
      "Type" : "AWS::EC2::Volume",
      "Condition" : "CreateProdResources",
      "Properties" : <span>{</span>
        "Size" : "100",
        "AvailabilityZone" : <span>{</span> "Fn::GetAtt" : [ "EC2Instance", "AvailabilityZone" ]}
      }
    }
  }
}</code></pre></div></div>
      <div class="example"><h6>exemplo YAML</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWSTemplateFormatVersion: "2010-09-09"

Mappings:
  RegionMap:
    us-east-1:
      AMI: "ami-0ff8a91507f77f867"
    us-west-1:
      AMI: "ami-0bdb828fd58c52235"
    us-west-2:
      AMI: "ami-a0cfeed8"
    eu-west-1:
      AMI: "ami-047bb4163c506cd98"
    sa-east-1:
      AMI: "ami-07b14488da8ea02a0"
    ap-southeast-1:
      AMI: "ami-08569b978cc4dfa10"
    ap-southeast-2:
      AMI: "ami-09b42976632b27e9b"
    ap-northeast-1:
      AMI: "ami-06cd52961ce9f0d85"

Parameters:
  EnvType:
    Description: Environment type.
    Default: test
    Type: String
    AllowedValues: [prod, dev, test]
    ConstraintDescription: must specify prod, dev, or test.
  
Conditions:
  CreateProdResources: !Equals [!Ref EnvType, prod]
  CreateDevResources: !Equals [!Ref EnvType, "dev"]

Resources:
  EC2Instance:
    Type: "AWS::EC2::Instance"
    Properties:
      ImageId: !FindInMap [RegionMap, !Ref "AWS::Region", AMI]
      InstanceType: !If [CreateProdResources, c1.xlarge, !If [CreateDevResources, m1.large, m1.small]]    
  MountPoint:
    Type: "AWS::EC2::VolumeAttachment"
    Condition: CreateProdResources
    Properties:
      InstanceId: !Ref EC2Instance
      VolumeId: !Ref NewVolume
      Device: /dev/sdh
  NewVolume:
    Type: "AWS::EC2::Volume"
    Condition: CreateProdResources
    Properties:
      Size: 100
      AvailabilityZone: !GetAtt EC2Instance.AvailabilityZone</code></pre></div></div>
      <p>Você pode especificar <code class="code">prod</code>, <code class="code">dev</code> ou <code class="code">test</code> para o parâmetro <code class="code">EnvType</code>. Para cada tipo de ambiente, o modelo especifica um tipo de instância diferente. Os tipos de instância podem variar desde um tipo de instância grande, otimizada por computação, até um tipo de instância pequeno, de uso geral. Para especificar condicionalmente o tipo de instância, o modelo define duas condições na seção Condições do modelo: <code class="code">CreateProdResources</code>, que avalia como verdadeiro se o valor do parâmetro <code class="code">EnvType</code> é igual a <code class="code">prod</code> e <code class="code">CreateDevResources</code>, que avalia como verdadeiro se o valor do parâmetro é igual a <code class="code">dev</code>.</p>
      <p>Na propriedade <code class="code">InstanceType</code>, o modelo aninha duas funções intrínsecas <code class="code">Fn::If</code> para determinar qual tipo de instância deverá ser usada. Se a condição <code class="code">CreateProdResources</code> for verdadeira, o tipo de instância será <code class="code">c1.xlarge</code>. Se a condição for falsa, a condição <code class="code">CreateDevResources</code> será avaliada. Se a condição <code class="code">CreateDevResources</code> for verdadeira, o tipo de instância será <code class="code">m1.large</code>; caso contrário, o tipo de instância será <code class="code">m1.small</code>.</p>
      <p>Além do tipo de instância, o ambiente de produção cria e anexa um volume do Amazon EC2 à instância. Os recurso <code class="code">MountPoint</code> e <code class="code">NewVolume</code> estão associados à condição <code class="code">CreateProdResources</code> para que os recursos sejam criados somente se a condição for verdadeira.</p>
     
      <h2 id="w9aac34c28c21c31b5">Atribuição condicional de uma propriedade de recurso</h2>

      <p>Neste exemplo, você pode criar uma instância de banco de dados do Amazon RDS a partir de um snapshot. Se você especificar o parâmetro <code class="code">DBSnapshotName</code>, o CloudFormation usará o valor do parâmetro como o nome do snapshot ao criar a instância de banco de dados. Se você mantiver o valor padrão (string vazia), o CloudFormation removerá a propriedade <code class="code">DBSnapshotIdentifier</code> e criará uma instância de banco de dados do zero.</p>
      <p>O exemplo define os parâmetros <code class="code">DBUser</code> e <code class="code">DBPassword</code> com a propriedade <code class="code">NoEcho</code> definida como <code class="code">true</code>. Se você definir o atributo <code class="code">NoEcho</code> como <code class="code">true</code>, o CloudFormation retornará o valor do parâmetro mascarado como asteriscos (*****) para qualquer chamada que descreva a pilha ou os eventos de pilha, exceto informações armazenadas nos locais especificados abaixo.</p>
      <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Importante</h6></div><div class="awsdocs-note-text"><p>O uso do atributo <code class="code">NoEcho</code> não mascara informações armazenadas no seguinte:</p><div class="itemizedlist">
           
           
           
         <ul class="itemizedlist"><li class="listitem">
           <p>A seção de modelo de <code class="code">Metadata</code>. O CloudFormation não transforma, modifica nem edita nenhuma informação incluída na seção <code class="code">Metadata</code>. Para ter mais informações, consulte <a href="./metadata-section-structure.html">Metadados</a>.</p>
          </li><li class="listitem">
           <p>A seção de modelo de <code class="code">Outputs</code>. Para ter mais informações, consulte <a href="./outputs-section-structure.html">Outputs</a>.</p>
          </li><li class="listitem">
           <p>O atributo <code class="code">Metadata</code> de uma definição de recurso. Para ter mais informações, consulte <a href="./aws-attribute-metadata.html">Atributo Metadata</a>.</p>
          </li></ul></div><p>É altamente recomendável não usar esses mecanismos para incluir informações confidenciais, como senhas ou segredos.</p></div></div> <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Importante</h6></div><div class="awsdocs-note-text"><p>Em vez de incorporar informações confidenciais diretamente em modelos do CloudFormation, recomendamos usar os parâmetros dinâmicos no modelo da pilha para fazer referência a informações confidenciais que são armazenadas e gerenciadas de forma externa ao CloudFormation, como no AWS Systems Manager Parameter Store ou no AWS Secrets Manager.</p><p>Para obter mais informações, consulte as práticas recomendadas do <a href="./security-best-practices.html#creds">Não incorporar credenciais em seus modelos</a>.</p></div></div> <div class="example"><h6>exemplo JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "AWSTemplateFormatVersion" : "2010-09-09",

  "Parameters": <span>{</span>
    "DBUser": <span>{</span>
      "NoEcho": "true",
      "Description" : "The database admin account username",
      "Type": "String",
      "MinLength": "1",
      "MaxLength": "16",
      "AllowedPattern" : "[a-zA-Z][a-zA-Z0-9]*",
      "ConstraintDescription" : "must begin with a letter and contain only alphanumeric characters."
    },
    "DBPassword": <span>{</span>
      "NoEcho": "true",
      "Description" : "The database admin account password",
      "Type": "String",
      "MinLength": "1",
      "MaxLength": "41",
      "AllowedPattern" : "[a-zA-Z0-9]*",
      "ConstraintDescription" : "must contain only alphanumeric characters."
    },
    "DBSnapshotName": <span>{</span>
      "Description": "The name of a DB snapshot (optional)",
      "Default": "",
      "Type": "String"      
    }
  },
  
  "Conditions": <span>{</span>
    "UseDBSnapshot": <span>{</span>"Fn::Not": [<span>{</span>"Fn::Equals" : [<span>{</span>"Ref" : "DBSnapshotName"}, ""]}]}
  },

  "Resources" : <span>{</span>
    "MyDB" : <span>{</span>
      "Type" : "AWS::RDS::DBInstance",
      "Properties" : <span>{</span>
        "AllocatedStorage" : "5",
        "DBInstanceClass" : "db.t2.small",
        "Engine" : "MySQL",
        "EngineVersion" : "5.5",
        "MasterUsername" : <span>{</span> "Ref" : "DBUser" },
        "MasterUserPassword" : <span>{</span> "Ref" : "DBPassword" },
        "DBParameterGroupName" : <span>{</span> "Ref" : "MyRDSParamGroup" },
        "DBSnapshotIdentifier" : <span>{</span>
          "Fn::If" : [
            "UseDBSnapshot",
            <span>{</span>"Ref" : "DBSnapshotName"},
            <span>{</span>"Ref" : "AWS::NoValue"}
          ]
        }
      }
    },

    "MyRDSParamGroup" : <span>{</span>
      "Type": "AWS::RDS::DBParameterGroup",
      "Properties" : <span>{</span>
        "Family" : "MySQL5.5",
        "Description" : "CloudFormation Sample Database Parameter Group",
          "Parameters" : <span>{</span>
            "autocommit" : "1" ,
            "general_log" : "1",
            "old_passwords" : "0"
        }
      }
    }
  }
}</code></pre></div></div>
      <div class="example"><h6>exemplo YAML</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">AWSTemplateFormatVersion: "2010-09-09"
Parameters: 
  DBUser: 
    NoEcho: true
    Description: The database admin account username
    Type: String
    MinLength: 1
    MaxLength: 16
    AllowedPattern: "[a-zA-Z][a-zA-Z0-9]*"
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword: 
    NoEcho: true
    Description: The database admin account password
    Type: String
    MinLength: 1
    MaxLength: 41
    AllowedPattern: "[a-zA-Z0-9]*"
    ConstraintDescription: must contain only alphanumeric characters.
  DBSnapshotName: 
    Description: The name of a DB snapshot (optional)
    Default: ""
    Type: String
Conditions: 
  UseDBSnapshot: !Not [!Equals [!Ref DBSnapshotName, ""]]
Resources: 
  MyDB: 
    Type: "AWS::RDS::DBInstance"
    Properties: 
      AllocatedStorage: 5
      DBInstanceClass: db.t2.small
      Engine: MySQL
      EngineVersion: 5.5
      MasterUsername: !Ref DBUser
      MasterUserPassword: !Ref DBPassword
      DBParameterGroupName: !Ref MyRDSParamGroup
      DBSnapshotIdentifier: !If [UseDBSnapshot, !Ref DBSnapshotName, !Ref "AWS::NoValue"]
  MyRDSParamGroup: 
    Type: "AWS::RDS::DBParameterGroup"
    Properties: 
      Family: MySQL5.5
      Description: CloudFormation Sample Database Parameter Group
      Parameters: 
        autocommit: 1
        general_log: 1
        old_passwords: 0</code></pre></div></div>
      <p>A condição <code class="code">UseDBSnapshot</code> será avaliada como verdadeira somente se <code class="code">DBSnapshotName</code> não for uma string vazia. Se a condição <code class="code">UseDBSnapshot</code> for avaliada como verdadeira, o CloudFormation usará o valor do parâmetro <code class="code">DBSnapshotName</code> para a propriedade <code class="code">DBSnapshotIdentifier</code>. Se a condição for avaliada como falsa, o CloudFormation removerá a propriedade <code class="code">DBSnapshotIdentifier</code>. O pseudoparâmetro <code class="code">AWS::NoValue</code> remove a propriedade de recurso correspondente quando é usada como um valor de retorno.</p>
     
      <h2 id="w9aac34c28c21c31b7">Uso condicional de um recurso existente</h2>

      <p>Neste exemplo, você pode usar um security group do Amazon EC2 que já tenha sido criado ou você pode criar um novo security group, que está especificado no modelo. Para o parâmetro <code class="code">ExistingSecurityGroup</code>, você pode especificar o nome do security group <code class="code">default</code> ou <code class="code">NONE</code>. Se você especificar <code class="code">default</code>, o CloudFormation usará um grupo de segurança que já foi criado e é chamado de <code class="code">default</code>. Se você especificar <code class="code">NONE</code>, o CloudFormation criará o grupo de segurança que está definido no modelo.</p>
      <div class="example"><h6>exemplo JSON</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Parameters" : <span>{</span>
    "ExistingSecurityGroup" : <span>{</span>
      "Description" : "An existing security group ID (optional).",
      "Default" : "NONE",
      "Type" : "String",
      "AllowedValues" : ["default", "NONE"]
    }
  },
 
  "Conditions" : <span>{</span>
    "CreateNewSecurityGroup" : <span>{</span>"Fn::Equals" : [<span>{</span>"Ref" : "ExistingSecurityGroup"}, "NONE"] }
  },

  "Resources" : <span>{</span>
    "MyInstance" : <span>{</span>
      "Type" : "AWS::EC2::Instance",
        "Properties" : <span>{</span>
          "ImageId" : "ami-0ff8a91507f77f867",
          "SecurityGroups" : [<span>{</span>
            "Fn::If" : [
              "CreateNewSecurityGroup",
              <span>{</span>"Ref" : "NewSecurityGroup"},
              <span>{</span>"Ref" : "ExistingSecurityGroup"}
            ]
          }]
        }
    },

    "NewSecurityGroup" : <span>{</span>
      "Type" : "AWS::EC2::SecurityGroup",
      "Condition" : "CreateNewSecurityGroup",
      "Properties" : <span>{</span>
        "GroupDescription" : "Enable HTTP access via port 80",
        "SecurityGroupIngress" : [ <span>{</span>
          "IpProtocol" : "tcp",
          "FromPort" : 80,
          "ToPort" : 80,
          "CidrIp" : "0.0.0.0/0"
        } ]
      }
    }
  },

  "Outputs" : <span>{</span>
    "SecurityGroupId" : <span>{</span>
      "Description" : "Group ID of the security group used.",
      "Value" : <span>{</span>
        "Fn::If" : [
          "CreateNewSecurityGroup",
          <span>{</span>"Ref" : "NewSecurityGroup"},
          <span>{</span>"Ref" : "ExistingSecurityGroup"}
        ]
      }
    }
  }
}</code></pre></div></div>
      <div class="example"><h6>exemplo YAML</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Parameters: 
  ExistingSecurityGroup: 
    Description: An existing security group ID (optional).
    Default: NONE
    Type: String
    AllowedValues: 
      - default
      - NONE
Conditions: 
  CreateNewSecurityGroup: !Equals [!Ref ExistingSecurityGroup, NONE]
Resources: 
  MyInstance: 
    Type: "AWS::EC2::Instance"
    Properties: 
      ImageId: "ami-0ff8a91507f77f867"
      SecurityGroups: !If [CreateNewSecurityGroup, !Ref NewSecurityGroup, !Ref ExistingSecurityGroup]
  NewSecurityGroup: 
    Type: "AWS::EC2::SecurityGroup"
    Condition: CreateNewSecurityGroup
    Properties: 
      GroupDescription: Enable HTTP access via port 80
      SecurityGroupIngress: 
        - 
          IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0
Outputs: 
  SecurityGroupId:
    Description: Group ID of the security group used.
    Value: !If [CreateNewSecurityGroup, !Ref NewSecurityGroup, !Ref ExistingSecurityGroup]</code></pre></div></div>
      <p>Para determinar se deseja criar o recurso <code class="code">NewSecurityGroup</code>, o recurso está associada à condição <code class="code">CreateNewSecurityGroup</code>. O recurso é criado somente quando a condição é verdadeira (quando o parâmetro <code class="code">ExistingSecurityGroup</code> é igual a <code class="code">NONE</code>).</p>
      <p>Na propriedade <code class="code">SecurityGroups</code>, o modelo usa a função intrínseca <code class="code">Fn::If</code> para determinar qual tipo de security group deverá ser usado. Se a condição <code class="code">CreateNewSecurityGroup</code> avaliar como verdadeira, a propriedade de security group fará referência ao recurso <code class="code">NewSecurityGroup</code>. Se a condição <code class="code">CreateNewSecurityGroup</code> avaliar como falsa, a propriedade de security group fará referência ao parâmetro <code class="code">ExistingSecurityGroup</code> (o security group <code class="code">default</code>).</p>
      <p>Por fim, o modelo condicionalmente emite o ID do security group. Se a condição <code class="code">CreateNewSecurityGroup</code> for avaliada como verdadeira, o CloudFormation emitirá o ID do grupo de segurança do recurso <code class="code">NewSecurityGroup</code>. Se a condição for falsa, o CloudFormation emitirá o ID do grupo de segurança do recurso <code class="code">ExistingSecurityGroup</code>.</p>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./intrinsic-function-reference-conditions.html">Funções de condição</div><div id="next" class="next-link" accesskey="n" href="./intrinsic-function-reference-condition.html">Condição</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/conditions-sample-templates.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>