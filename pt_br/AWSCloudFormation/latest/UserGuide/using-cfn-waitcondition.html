<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Criar condições de espera em um modelo - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="using-cfn-waitcondition" /><meta name="default_state" content="using-cfn-waitcondition" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><meta name="description" content="Crie uma condição de espera em um modelo para coordenar a criação de recursos de pilha ou acompanhar o progresso de um processo de configuração." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="Guia do usuário" /><meta name="abstract" content="Crie e gerencie implantações da infraestrutura da AWS de maneira previsível e que pode ser repetida usando o AWS CloudFormation com este Guia do usuário." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" hreflang="x-default" /><meta name="feedback-item" content="CloudFormation" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="Guia do usuário" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="Guia do usuário" /><meta id="panorama-serviceConsolePage" value="Criar condições de espera em um modelo" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Criar condições de espera em um modelo - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,provisionamento de recursos,configuração de recursos,gerenciamento da infraestrutura,CloudFormer,Pilha do CloudFormation,Stackset do CloudFormation,Modelo do CloudFormation,conjunto de alterações" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do usuário",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Trabalhar com modelos do AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/template-guide.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Demonstrações",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/CHAP_Using.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Criar condições de espera em um modelo",
        "item" : "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/CHAP_Using.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="Welcome.html">Guia do usuário</a></div><div id="page-toc-src"><a href="#using-cfn-waitconditionhandle">Usar um identificador de condição de espera</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="using-cfn-waitcondition">Criar condições de espera em um modelo</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Importante</h6></div><div class="awsdocs-note-text"><p>Para recursos do Amazon EC2 e do Auto Scaling, recomendamos usar um atributo CreationPolicy, em vez de condições de espera. Adicione um atributo CreationPolicy a esses recursos e use o script auxiliar cfn-signal para sinalizar quando um processo de criação de instância foi concluído com êxito.</p><p>Para obter mais informações, consulte <a href="./aws-attribute-creationpolicy.html">Atributo CreationPolicy</a> ou <a href="./deploying.applications.html">Implantar aplicações no Amazon EC2 com o AWS CloudFormation</a>.</p></div></div><p>Usando o recurso <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-waitconditionhandle.html"><code class="code">AWS::CloudFormation::WaitConditionHandle</code></a> e o atributo <a href="./aws-attribute-creationpolicy.html">Atributo CreationPolicy</a>, você pode fazer o seguinte:</p><div class="itemizedlist">
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>Coordenar a criação de recursos de pilha com outras ações de configuração que são externas à criação da pilha</p>
         </li><li class="listitem">
            <p>Acompanhar o status de um processo de configuração</p>
         </li></ul></div><p>Por exemplo, você pode iniciar a criação de outro recurso depois que a configuração de um aplicativo é parcialmente concluída, ou você pode enviar sinais durante um processo de instalação e configuração para acompanhar seu progresso.</p><h2 id="using-cfn-waitconditionhandle">Usar um identificador de condição de espera</h2>
            
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>Se você usar o recurso do <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-endpoints.html">endpoint de VPC</a>, os recursos na VPC que respondem à condição de espera devem ter acesso a buckets do Amazon Simple Storage Service (Amazon S3) específicos do AWS CloudFormation CloudFormation. Recursos devem enviar respostas à condição de espera para um URL pré-assinado do Amazon S3. Se eles não conseguirem enviar respostas ao Amazon S3, o AWS CloudFormation não receberá uma resposta, e haverá falha na operação de pilha. Para obter mais informações, consulte <a href="./cfn-vpce-bucketnames.html">Configurar VPC endpoints VPC para o AWS CloudFormation</a> e <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies-vpc-endpoint.html">Exemplos de políticas de buckets para VPC endpoints do Amazon S3</a>.</p></div></div>
            <p>Você pode usar a condição de espera e o identificador de condição de espera para fazer com que o AWS CloudFormation pause a criação de uma pilha e espere por um sinal antes de continuar a criação da pilha. Por exemplo, talvez seja necessário fazer download dos aplicativos em uma instância do Amazon EC2 e configurá-los antes de considerar a conclusão da criação da instância do Amazon EC2.</p>
            <p>A lista a seguir fornece um resumo de como funciona uma condição de espera com um identificador de condição de espera:</p>
            <div class="itemizedlist">
                 
                 
                 
                 
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>O AWS CloudFormation cria uma condição de espera como qualquer outro recurso. Quando o AWS CloudFormation cria uma condição de espera, ele informa o status da condição de espera como CREATE_IN_PROGRESS e aguarda até receber o número de requisito dos sinais de sucesso ou o período de tempo limite da condição de espera expirou. Se o AWS CloudFormation receber o número de requisito de sinais de êxito antes que o período de tempo limite expire, ele continuará criando a pilha; caso contrário, ele definirá o status da condição de espera para <code class="code">CREATE_FAILED</code> e reverterá a pilha.</p>
                </li><li class="listitem">
                    <p>A propriedade <code class="code">Timeout</code> determina por quanto tempo o AWS CloudFormation aguardará o número de requisito de sinais de sucesso. <code class="code">Timeout</code> é uma propriedade de limite mínimo, o que significa que o tempo limite não ocorre antes do tempo especificado, mas pode ocorrer um pouco depois. O tempo máximo que você pode especificar é 43200 segundos (12 horas).</p>
                </li><li class="listitem">
                    <p>Normalmente, você deseja que uma condição de espera comece imediatamente após a criação de um recurso específico, como uma instância do Amazon EC2, uma instância de banco de dados do RDS ou um grupo de Auto Scaling. Para isso, adicione o <a href="./aws-attribute-dependson.html">atributo DependsOn</a> a uma condição de espera. Ao adicionar um atributo <code class="code">DependsOn</code> a uma condição de espera, você especifica que essa condição de espera será criada apenas após a criação de um recurso específico ter sido concluída. Quando a condição de espera é criada, o AWS CloudFormation inicia o período de tempo limite e aguarda os sinais de sucesso.</p>
                </li><li class="listitem">
                    <p>Você também pode usar o atributo <code class="code">DependsOn</code> em outros recursos. Por exemplo, você talvez queira que uma instância de banco de dados do Amazon RDS seja criada e que um banco de dados seja configurado nessa instância primeiro antes de criar instâncias do EC2 que usem esse banco de dados. Nesse caso, você cria uma condição de espera que tenha um atributo <code class="code">DependsOn</code> que especifique a instância de banco de dados e cria recursos de instância do EC2 que tenham atributos <code class="code">DependsOn</code> que especifiquem a condição de espera. Isso garante que as instâncias EC2 serão criadas diretamente depois que a instância de banco de dados e a condição de espera forem concluídas.</p>
                </li><li class="listitem">
                    <p>O AWS CloudFormation deve receber um número especificado de sinais de êxito para uma condição de espera antes de definir o status dessa condição de espera para <code class="code">CREATE_COMPLETE</code> e continuar criando a pilha. A propriedade <code class="code">Count</code> da condição de espera especifica o número de sinais de êxito. Se não for definido nenhum, o padrão será 1.</p>
                </li><li class="listitem">
                    <p>Uma condição de espera requer um identificador de condição de espera para configurar um pre-signed URL que é usado como mecanismo de sinalização. O URL pré-assinado permite que você envie um sinal sem precisar fornecer as credenciais da AWS. Você usa o pre-signed URL para sinalizar sucesso ou falha, que é encapsulado em uma instrução JSON. Para saber o formato dessa instrução JSON, consulte o <a href="#using-cfn-waitcondition-signaljson">Formato JSON do sinal da condição de espera</a>.</p>
                </li><li class="listitem">
                    <p>Se uma condição de espera receber o número de requisito de sinais de êxito (conforme definido na propriedade Count) antes que o tempo de espera expire, o AWS CloudFormation marcará a condição de espera como <code class="code">CREATE_COMPLETE</code> e continuará criando a pilha. Caso contrário, o AWS CloudFormation fará com que a condição de espera falhe e reverterá a pilha (por exemplo, se o período de tempo limite expirar sem sinais de êxito de requisito ou se um sinal de falha for recebido).</p>
                </li></ul></div>
            <div class="procedure"><h6>Para usar uma condição de espera em uma pilha:</h6><ol><li>
                    <p>Declare um recurso <code class="code">AWS::CloudFormation::WaitConditionHandle</code> no modelo da pilha. Um identificador de condição de espera não tem propriedades. No entanto, uma referência a um recurso <code class="code">WaitConditionHandle</code> retorna um URL pré-assinado que você pode usar para sinalizar o êxito ou a falha à <code class="code">WaitCondition</code>. Por exemplo:</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"myWaitHandle" : <span>{</span>
     "Type" : "AWS::CloudFormation::WaitConditionHandle",
     "Properties" : <span>{</span>
     }
}</code></pre>
                </li><li>
                    <p>Declare um recurso <code class="code">AWS::CloudFormation::WaitCondition</code> no modelo da pilha. Um recurso <code class="code">WaitCondition</code> tem duas propriedades necessárias: <code class="code">Handle</code> é uma referência a um <code class="code">WaitConditionHandle</code> declarado no modelo, e <code class="code">Timeout</code> é o número de segundos que o AWS CloudFormation aguardará. Opcionalmente, você pode definir a propriedade <code class="code">Count</code>, que determina o número de sinais de êxito que a condição de espera deve receber para que o AWS CloudFormation possa retomar a criação da pilha.</p>
                    <p>Para determinar quando a condição de espera será acionada, defina um atributo <code class="code">DependsOn</code> na condição de espera. Uma cláusula <code class="code">DependsOn</code> associa um recurso à condição de espera. Depois que o AWS CloudFormation cria o recurso <code class="code">DependsOn</code>, ele bloqueia a criação de recursos de pilha até que um dos seguintes eventos ocorra: a) o período de tempo limite expire; b) o número de requisito de sinais de êxito seja recebido; c) um sinal de falha seja recebido.</p>
                    <p>Este é um exemplo de uma condição de espera que começa após a criação com êxito do recurso <code class="code">Ec2Instance</code>, usa o recurso <code class="code">myWaitHandle</code> como o <code class="code">WaitConditionHandle</code>, tem um tempo limite de 4.500 segundos e tem a <code class="code">Count</code> padrão de 1 (desde que nenhuma propriedade <code class="code">Count</code> seja especificada):</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"myWaitCondition" : <span>{</span>
    "Type" : "AWS::CloudFormation::WaitCondition",
    "DependsOn" : "Ec2Instance",
    "Properties" : <span>{</span>
        "Handle" : <span>{</span> "Ref" : "myWaitHandle" },
        "Timeout" : "4500"
    }
}</code></pre>
                </li><li>
                    <p>Obtenha o pre-signed URL a ser usada para sinalização.</p>
                    <p>No modelo, o URL pré-assinado pode ser recuperado ao transmitir o nome lógico do recurso <code class="code">AWS::CloudFormation::WaitConditionHandle</code> para a função intrínseca Ref. Por exemplo, você pode usar a propriedade <code class="code">UserData</code> nos recursos <code class="code">AWS::EC2::Instance</code> para transmitir o URL pré-assinado para as instâncias do Amazon EC2, a fim de que os scripts ou as aplicações em execução nessas instâncias possam sinalizar o êxito ou a falha para o AWS CloudFormation:</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"UserData" : <span>{</span>
   "Fn::Base64" : <span>{</span>
       "Fn::Join" : [ "", ["SignalURL=", <span>{</span> "Ref" : "myWaitHandle" } ] ]
   }
}</code></pre>
                    <p>Observação: no AWS Management Console ou nas ferramentas de linha de comando do AWS CloudFormation, o URL pré-assinado é exibido como ID físico do recurso de identificador de condição de espera.</p>
                </li><li>
                    <p>Selecione um método para detectar quando a pilha informará a condição de espera.</p>
                    <p>Se você criar a pilha com notificações habilitadas, o AWS CloudFormation publicará uma notificação para cada evento de pilha no tópico especificado. Se você ou seu aplicativo se inscrever nesse tópico, você poderá monitorar as notificações do evento de criação do identificador de condição de espera e recuperará o pre-signed URL na mensagem de notificação.</p>
                    <p>Você também poderá monitorar os eventos da pilha usando o AWS Management Console, as ferramentas de linha de comando do AWS CloudFormation ou a API do AWS CloudFormation.</p>
                </li><li>
                    <p>Use o pre-signed URL para sinalizar sucesso ou falha.</p>
                    <p>Para enviar um sinal, envie uma mensagem de solicitação HTTP usando o pre-signed URL. O método de solicitação deve ser <code class="code">PUT</code>, e o cabeçalho <code class="code">Content-Type</code> deve ser omitido ou uma string vazia. A mensagem de solicitação deve ser uma estrutura JSON do formulário especificado em <a href="#using-cfn-waitcondition-signaljson">Formato JSON do sinal da condição de espera</a>.</p>
                    <p>Você precisa enviar o número de sinais de êxito especificados pela propriedade <code class="code">Count</code> para que o AWS CloudFormation continue com a criação da pilha. Se a propriedade <code class="code">Count</code> for maior do que 1, o valor do <code class="code">UniqueId</code> de cada sinal deverá ser exclusivo em todos os sinais enviados a uma condição de espera específica. O <code class="code">UniqueId</code> é uma string alfanumérica arbitrária.</p>
                    <p>Um comando <code class="code">curl</code> é uma forma de enviar um sinal. O exemplo a seguir mostra uma linha do comando <code class="code">curl</code> que sinaliza o êxito para uma condição de espera.</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">curl -T /tmp/a \
  "https://cloudformation-waitcondition-test.s3.amazonaws.com/arn%3Aaws%3Acloudformation%3A<span>us-east-2</span>%3A034017226601%3Astack%2Fstack-gosar-20110427004224-test-stack-with-WaitCondition--VEYW%2Fe498ce60-70a1-11e0-81a7-5081d0136786%2FmyWaitConditionHandle?Expires=1303976584&amp;AWSAccessKeyId=AKIAIOSFODNN7EXAMPLE&amp;Signature=ik1twT6hpS4cgNAw7wyOoRejVoo%3D"</code></code></pre>
                    <p>em que o arquivo/tmp/a contém a seguinte estrutura JSON:</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">
<span>{</span>
   "Status" : "SUCCESS",
   "Reason" : "Configuration Complete",
   "UniqueId" : "ID1234",
   "Data" : "Application has completed configuration."
}</code></pre>
                    <p>Este exemplo mostra uma linha do comando <code class="code">curl</code> que envia o mesmo sinal de êxito, exceto que ele envia a estrutura JSON como um parâmetro na linha de comando.</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="sh "><code class="prompt" copy="false">$ </code><code class="userinput">curl -X PUT \
  -H 'Content-Type:' --data-binary '<span>{</span>"Status" : "SUCCESS","Reason" : "Configuration Complete","UniqueId" : "ID1234","Data" : "Application has completed configuration."}' \
  "https://cloudformation-waitcondition-test.s3.amazonaws.com/arn%3Aaws%3Acloudformation%3A<span>us-east-2</span>%3A034017226601%3Astack%2Fstack-gosar-20110427004224-test-stack-with-WaitCondition--VEYW%2Fe498ce60-70a1-11e0-81a7-5081d0136786%2FmyWaitConditionHandle?Expires=1303976584&amp;AWSAccessKeyId=AKIAIOSFODNN7EXAMPLE&amp;Signature=ik1twT6hpS4cgNAw7wyOoRejVoo%3D"</code></code></pre>
                </li></ol></div>
            <h3 id="using-cfn-waitcondition-signaljson">Formato JSON do sinal da condição de espera</h3>
                
                <p>Quando você sinaliza uma condição de espera, deve usar o seguinte formato JSON:</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Status" : "StatusValue",
  "UniqueId" : "Some UniqueId",
  "Data" : "Some Data",
  "Reason" : "Some Reason"
}</code></pre>
                <p>Em que:</p>
                <p><em>StatusValue</em> deve ser um dos seguintes valores:</p>
                <div class="itemizedlist">
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p><em>SUCCESS</em> indica um sinal de sucesso.</p>
                    </li><li class="listitem">
                        <p><em>FAILURE</em> indica um sinal de falha e aciona uma condição de espera com falha e uma reversão de pilha.</p>
                    </li></ul></div>
                <p>O <em><code class="code">UniqueId</code></em> identifica o sinal para o AWS CloudFormation. Se a propriedade <code class="code">Count</code> da condição de espera for maior que 1, o valor do <code class="code">UniqueId</code> deverá ser exclusivo em todos os sinais enviados de uma condição de espera; caso contrário, o AWS CloudFormation considerará o sinal uma retransmissão dos sinais enviados anteriormente com o mesmo <code class="code">UniqueId</code> e ignorará o sinal.</p>
                <p><em><code class="code">Data</code></em> é qualquer informação que você deseje enviar novamente com o sinal. O valor de <code class="code">Data</code> pode ser acessado chamando a <a href="./intrinsic-function-reference-getatt.html">função Fn::GetAtt</a> no modelo. Por exemplo, se você criar o seguinte valor de saída para a condição de espera <code class="code">mywaitcondition</code>, poderá usar o comando <code class="code">aws cloudformation describe-stacks</code>, a operação da API <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/API_DescribeStacks.html"><code class="code">DescribeStacks</code></a> ou a guia <b>Saídas</b> do console do AWS CloudFormation para visualizar os <code class="code">Data</code> enviados pelos sinais válidos enviados para o AWS CloudFormation: </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">
"WaitConditionData" : <span>{</span>
  "Value" : <span>{</span> "Fn::GetAtt" : [ "mywaitcondition", "Data" ]},
  "Description" : "The data passed back as part of signalling the WaitCondition"
},
            </code></pre>
                <p>A <a href="./intrinsic-function-reference-getatt.html">função Fn::GetAtt</a> retorna o <code class="code">UniqueId</code> e os <code class="code">Data</code> como um par de nome/valor em uma estrutura JSON. O exemplo abaixo é de um atributo <code class="code">Data</code> retornado pelo valor de saída <code class="code">WaitConditionData</code> definido acima:</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>"Signal1":"Application has completed configuration."}</code></pre>
                <p><em>Reason</em> é uma string sem outras restrições em seu conteúdo, além da conformidade com JSON.</p>
             
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./deploying.applications.html">Implantar aplicativos </div><div id="next" class="next-link" accesskey="n" href="./CHAP_TemplateQuickRef.html">Trechos de modelo</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudFormation&amp;topic_url=https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>