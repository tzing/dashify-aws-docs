<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS::Config::ConfigRule - AWS CloudFormation</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="aws-resource-config-configrule" /><meta name="default_state" content="aws-resource-config-configrule" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" /><meta name="description" content="Use the AWS CloudFormation AWS::Config::ConfigRule resource for Config." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudFormation" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Create and manage AWS infrastructure deployments predictably and repeatedly using AWS CloudFormation with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json;toc-AWS_Config.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" hreflang="x-default" /><meta name="feedback-item" content="AWS Config" /><meta name="this_doc_product" content="AWS CloudFormation" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudformation'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="AWS::Config::ConfigRule" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS::Config::ConfigRule - AWS CloudFormation</title><meta name="rss" content="aws-cloudformation-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=92" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS%20Config&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html" /><meta name="keywords" content="CloudFormation,AWSCloudFormation,resource provisioning,resource configuration,infrastructure management,CloudFormer,CloudFormation stack,CloudFormation stackset,CloudFormation template,change set" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudFormation",
        "item" : "https://docs.aws.amazon.com/cloudformation/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "AWS Config resource type reference",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Config.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "AWS::Config::ConfigRule",
        "item" : "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Config.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudformation/index.html">AWS CloudFormation</a><a href="AWS_Config.html">User Guide</a></div><div id="page-toc-src"><a href="#aws-resource-config-configrule-syntax">Syntax</a><a href="#aws-resource-config-configrule-properties">Properties</a><a href="#aws-resource-config-configrule-return-values">Return values</a><a href="#aws-resource-config-configrule--examples">Examples</a></div><div id="page-filters" style="display:none"><filter label="All" id="All"></filter><filter label="JSON" id="JSON"></filter><filter label="YAML" id="YAML"></filter></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="aws-resource-config-configrule">AWS::Config::ConfigRule</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You must first create and start the AWS Config configuration recorder in order to create AWS Config managed
           rules with AWS CloudFormation. For more information, see <a href="https://docs.aws.amazon.com/config/latest/developerguide/stop-start-recorder.html">Managing the Configuration Recorder</a>.</p></div></div><p>Adds or updates an AWS Config rule to evaluate if your
           AWS resources comply with your desired configurations. For information on how many AWS Config rules you can have per account, 
           see <a href="https://docs.aws.amazon.com/config/latest/developerguide/configlimits.html"><b>Service Limits</b></a> in the <em>AWS Config Developer Guide</em>.</p><p>There are two types of rules: <em>AWS Config Managed Rules</em> and <em>AWS Config Custom Rules</em>.
           You can use the <code class="code">ConfigRule</code> resource to create both AWS Config Managed Rules and  AWS Config Custom Rules.</p><p>AWS Config Managed Rules are predefined,
           customizable rules created by AWS Config. For a list of managed rules, see
           <a href="https://docs.aws.amazon.com/config/latest/developerguide/managed-rules-by-aws-config.html">List of AWS Config
               Managed Rules</a>. If you are adding an AWS Config managed rule, you must specify the
           rule's identifier for the <code class="code">SourceIdentifier</code> key.</p><p>AWS Config Custom Rules are rules that you create from scratch. There are two ways to create AWS Config custom rules: with Lambda functions
           (<a href="https://docs.aws.amazon.com/config/latest/developerguide/gettingstarted-concepts.html#gettingstarted-concepts-function">AWS Lambda Developer Guide</a>) and with Guard (<a href="https://github.com/aws-cloudformation/cloudformation-guard" rel="noopener noreferrer" target="_blank"><span>Guard GitHub
                   Repository</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>), a policy-as-code language.
           
           AWS Config custom rules created with AWS Lambda
           are called <em>AWS Config Custom Lambda Rules</em> and AWS Config custom rules created with
           Guard are called <em>AWS Config Custom Policy Rules</em>.</p><p>If you are adding a new AWS Config Custom Lambda rule,
           you first need to create an AWS Lambda function that the rule invokes to evaluate
           your resources. When you use the <code class="code">ConfigRule</code> resource to add a Custom Lambda rule to AWS Config, you must specify the Amazon Resource
           Name (ARN) that AWS Lambda assigns to the function. You specify the ARN
           in the <code class="code">SourceIdentifier</code> key. This key is part of the
           <code class="code">Source</code> object, which is part of the
           <code class="code">ConfigRule</code> object. </p><p>For any new AWS Config rule that you add, specify the
           <code class="code">ConfigRuleName</code> in the <code class="code">ConfigRule</code>
           object. Do not specify the <code class="code">ConfigRuleArn</code> or the
           <code class="code">ConfigRuleId</code>. These values are generated by AWS Config for new rules.</p><p>If you are updating a rule that you added previously, you can
           specify the rule by <code class="code">ConfigRuleName</code>,
           <code class="code">ConfigRuleId</code>, or <code class="code">ConfigRuleArn</code> in the
           <code class="code">ConfigRule</code> data type that you use in this
           request.</p><p>For more information about developing and using AWS Config
           rules, see <a href="https://docs.aws.amazon.com/config/latest/developerguide/evaluate-config.html">Evaluating Resources with AWS Config Rules</a>
           in the <em>AWS Config Developer Guide</em>.</p><h2 id="aws-resource-config-configrule-syntax">Syntax</h2><p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p><div id="JSON" name="JSON" class="section langfilter"><h3 id="aws-resource-config-configrule-syntax.json">JSON</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Type" : "AWS::Config::ConfigRule",
  "Properties" : <span>{</span>
      "<a href="#cfn-config-configrule-compliance">Compliance</a>" : <code class="replaceable"><a href="./aws-properties-config-configrule-compliance.html">Compliance</a></code>,
      "<a href="#cfn-config-configrule-configrulename">ConfigRuleName</a>" : <code class="replaceable">String</code>,
      "<a href="#cfn-config-configrule-description">Description</a>" : <code class="replaceable">String</code>,
      "<a href="#cfn-config-configrule-evaluationmodes">EvaluationModes</a>" : <code class="replaceable">[ <a href="./aws-properties-config-configrule-evaluationmodeconfiguration.html">EvaluationModeConfiguration</a>, ... ]</code>,
      "<a href="#cfn-config-configrule-inputparameters">InputParameters</a>" : <code class="replaceable">Json</code>,
      "<a href="#cfn-config-configrule-maximumexecutionfrequency">MaximumExecutionFrequency</a>" : <code class="replaceable">String</code>,
      "<a href="#cfn-config-configrule-scope">Scope</a>" : <code class="replaceable"><a href="./aws-properties-config-configrule-scope.html">Scope</a></code>,
      "<a href="#cfn-config-configrule-source">Source</a>" : <code class="replaceable"><a href="./aws-properties-config-configrule-source.html">Source</a></code>
    }
}
</code></pre></div><div id="YAML" name="YAML" class="section langfilter"><h3 id="aws-resource-config-configrule-syntax.yaml">YAML</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">Type: AWS::Config::ConfigRule
Properties:
  <a href="#cfn-config-configrule-compliance">Compliance</a>: <code class="replaceable">
    <a href="./aws-properties-config-configrule-compliance.html">Compliance</a></code>
  <a href="#cfn-config-configrule-configrulename">ConfigRuleName</a>: <code class="replaceable">String</code>
  <a href="#cfn-config-configrule-description">Description</a>: <code class="replaceable">String</code>
  <a href="#cfn-config-configrule-evaluationmodes">EvaluationModes</a>: <code class="replaceable">
    - <a href="./aws-properties-config-configrule-evaluationmodeconfiguration.html">EvaluationModeConfiguration</a></code>
  <a href="#cfn-config-configrule-inputparameters">InputParameters</a>: <code class="replaceable">Json</code>
  <a href="#cfn-config-configrule-maximumexecutionfrequency">MaximumExecutionFrequency</a>: <code class="replaceable">String</code>
  <a href="#cfn-config-configrule-scope">Scope</a>: <code class="replaceable">
    <a href="./aws-properties-config-configrule-scope.html">Scope</a></code>
  <a href="#cfn-config-configrule-source">Source</a>: <code class="replaceable">
    <a href="./aws-properties-config-configrule-source.html">Source</a></code>
</code></pre></div><h2 id="aws-resource-config-configrule-properties">Properties</h2><div class="variablelist"><dl><dt id="cfn-config-configrule-compliance"><span class="term"><code class="code">Compliance</code></span></dt><dd>
         <p>Indicates whether an AWS resource or AWS Config rule is
			compliant and provides the number of contributors that affect the
			compliance.</p>
      <p><em>Required</em>: No</p><p><em>Type</em>: <a href="./aws-properties-config-configrule-compliance.html">Compliance</a></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-config-configrule-configrulename"><span class="term"><code class="code">ConfigRuleName</code></span></dt><dd>
       <p>A name for the AWS Config rule. If you don't specify a name, AWS CloudFormation generates a unique physical ID and uses that ID for the rule name. 
           For more information, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-name.html">Name Type</a>. </p>
	     <p><em>Required</em>: No</p><p><em>Type</em>: String</p><p><em>Pattern</em>: <code class="code">.*\S.*</code></p><p><em>Minimum</em>: <code class="code">1</code></p><p><em>Maximum</em>: <code class="code">128</code></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p></dd><dt id="cfn-config-configrule-description"><span class="term"><code class="code">Description</code></span></dt><dd>
         <p>The description that you provide for the AWS Config
			rule.</p>
      <p><em>Required</em>: No</p><p><em>Type</em>: String</p><p><em>Minimum</em>: <code class="code">0</code></p><p><em>Maximum</em>: <code class="code">256</code></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-config-configrule-evaluationmodes"><span class="term"><code class="code">EvaluationModes</code></span></dt><dd>
         <p>The modes the AWS Config rule can be evaluated in. The valid values are distinct objects. By default, the value is Detective evaluation mode only.</p>
      <p><em>Required</em>: No</p><p><em>Type</em>: Array of <a href="./aws-properties-config-configrule-evaluationmodeconfiguration.html">EvaluationModeConfiguration</a></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-config-configrule-inputparameters"><span class="term"><code class="code">InputParameters</code></span></dt><dd>
         <p>A string, in JSON format, that is passed to the AWS Config rule
			Lambda function.</p>
      <p><em>Required</em>: No</p><p><em>Type</em>: Json</p><p><em>Minimum</em>: <code class="code">1</code></p><p><em>Maximum</em>: <code class="code">1024</code></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-config-configrule-maximumexecutionfrequency"><span class="term"><code class="code">MaximumExecutionFrequency</code></span></dt><dd>


		

		       <p>The maximum frequency with which AWS Config runs evaluations
			for a rule. You can specify a value for
				<code class="code">MaximumExecutionFrequency</code> when:</p>
		       <div class="itemizedlist">
			          
			          
		       <ul class="itemizedlist"><li class="listitem">
				           <p>You are using an AWS managed rule that is triggered at
					a periodic frequency.</p>
			         </li><li class="listitem">
				           <p>Your custom rule is triggered when AWS Config delivers
				               the configuration snapshot. For more information, see <a href="https://docs.aws.amazon.com/config/latest/APIReference/API_ConfigSnapshotDeliveryProperties.html">ConfigSnapshotDeliveryProperties</a>.</p>
			         </li></ul></div>



		       <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>By default, rules with a periodic trigger are evaluated
				every 24 hours. To change the frequency, specify a valid value
				for the <code class="code">MaximumExecutionFrequency</code>
				parameter.</p></div></div>

		

	     <p><em>Required</em>: No</p><p><em>Type</em>: String</p><p><em>Allowed values</em>: <code class="code">One_Hour | Three_Hours | Six_Hours | Twelve_Hours | TwentyFour_Hours</code></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-config-configrule-scope"><span class="term"><code class="code">Scope</code></span></dt><dd>
         <p>Defines which resources can trigger an evaluation for the rule.
			The scope can include one or more resource types, a combination of
			one resource type and one resource ID, or a combination of a tag key
			and value. Specify a scope to constrain the resources that can
			trigger an evaluation for the rule. If you do not specify a scope,
			evaluations are triggered when any resource in the recording group
			changes.</p>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The scope can be empty. </p></div></div>
      <p><em>Required</em>: No</p><p><em>Type</em>: <a href="./aws-properties-config-configrule-scope.html">Scope</a></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd><dt id="cfn-config-configrule-source"><span class="term"><code class="code">Source</code></span></dt><dd>
         <p>Provides the rule owner (<code class="code">
               AWS
            </code> for managed rules, <code class="code">CUSTOM_POLICY</code> for Custom Policy rules, and <code class="code">CUSTOM_LAMBDA</code> for Custom Lambda rules), the rule identifier,
			and the notifications that cause the function to evaluate your AWS
			resources.</p>
      <p><em>Required</em>: Yes</p><p><em>Type</em>: <a href="./aws-properties-config-configrule-source.html">Source</a></p><p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p></dd></dl></div><h2 id="aws-resource-config-configrule-return-values">Return values</h2><h3 id="aws-resource-config-configrule-return-values-ref">Ref</h3><p>
   	      When you pass the logical ID of this resource to the intrinsic <code class="code">Ref</code> function, <code class="code">Ref</code> returns the rule name, such as <code class="code">mystack-MyConfigRule-12ABCFPXHV4OV</code>.</p><p>For more information about using the <code class="code">Ref</code> function, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html"><code class="code">Ref</code></a>.</p><h3 id="aws-resource-config-configrule-return-values-fn--getatt">Fn::GetAtt</h3><p>The <code class="code">Fn::GetAtt</code> intrinsic function returns a value for a specified attribute of this type. The following are the available attributes and sample return values.</p>
<p>For more information about using the <code class="code">Fn::GetAtt</code> intrinsic function, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-getatt.html"><code class="code">Fn::GetAtt</code></a>.</p><h4 id="aws-resource-config-configrule-return-values-fn--getatt-fn--getatt"></h4><div class="variablelist"><dl><dt id="Arn-fn::getatt"><span class="term"><code class="code">Arn</code></span></dt><dd>
       <p>The Amazon Resource Name (ARN) of the AWS Config rule, such as <code class="code">arn:aws:config:us-east-1:123456789012:config-rule/config-rule-a1bzhi</code>.</p>
   </dd><dt id="Compliance.Type-fn::getatt"><span class="term"><code class="code">Compliance.Type</code></span></dt><dd><p>Property description not available.</p></dd><dt id="ConfigRuleId-fn::getatt"><span class="term"><code class="code">ConfigRuleId</code></span></dt><dd>
       <p>The ID of the AWS Config rule, such as <code class="code">config-rule-a1bzhi</code>.</p>
   </dd></dl></div><h2 id="aws-resource-config-configrule--examples">Examples</h2><p></p><div class="highlights" id="inline-topiclist"><h6> </h6><ul><li><a href="#aws-resource-config-configrule--examples--Config_Rule">Config Rule</a></li><li><a href="#aws-resource-config-configrule--examples--Create_Rule_Using_Lambda_Function">Create Rule Using Lambda Function</a></li><li><a href="#aws-resource-config-configrule--examples--Update_Rule_Using_Lambda_Function_with_SourceArn_based_permission">Update Rule Using Lambda Function with SourceArn based permission</a></li></ul></div><h3 id="aws-resource-config-configrule--examples--Config_Rule">Config Rule</h3><p>The following example uses an AWS managed rule that checks whether EC2 volumes resource types have a CostCenter tag. </p><div id="JSON" name="JSON" class="section langfilter"><h4 id="aws-resource-config-configrule--examples--Config_Rule--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"ConfigRuleForVolumeTags": <span>{</span>
  "Type": "AWS::Config::ConfigRule",
  "Properties": <span>{</span>
    "InputParameters": <span>{</span>"tag1Key": "CostCenter"},
    "Scope": <span>{</span>
      "ComplianceResourceTypes": ["AWS::EC2::Volume"]
    },
    "Source": <span>{</span>
      "Owner": "AWS",
      "SourceIdentifier": "REQUIRED_TAGS"
    }
  }
}</code></pre></div><div id="YAML" name="YAML" class="section langfilter"><h4 id="aws-resource-config-configrule--examples--Config_Rule--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">ConfigRuleForVolumeTags: 
  Type: AWS::Config::ConfigRule
  Properties: 
    InputParameters: |
        <span>{</span>"tag1Key": "CostCenter"}
    Scope: 
      ComplianceResourceTypes: 
        - "AWS::EC2::Volume"
    Source: 
      Owner: AWS
      SourceIdentifier: "REQUIRED_TAGS"</code></pre></div><h3 id="aws-resource-config-configrule--examples--Create_Rule_Using_Lambda_Function">Create Rule Using Lambda Function</h3><p>The following example creates a custom configuration rule that uses a Lambda function. The function checks whether an EC2 volume has the AutoEnableIO property set to true. 
               Note that the configuration rule has a dependency on the Lambda policy so that the rule calls the function only after it's permitted to do so.</p><p>After you create a rule using Lambda it is recommended you update the permissions based on the <em>Update Rule Using Lambda Function with SourceArn based permission</em> example which restricts only a specific rule ARN to invoke the Lambda function.
               This helps make sure AWS Lambda is accessing your resources on behalf of expected users and scenarios only.</p><div id="JSON" name="JSON" class="section langfilter"><h4 id="aws-resource-config-configrule--examples--Create_Rule_Using_Lambda_Function--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"ConfigPermissionToCallLambda": <span>{</span>
    "Type": "AWS::Lambda::Permission",
    "Properties": <span>{</span>
        "FunctionName": <span>{</span>"Fn::GetAtt": ["VolumeAutoEnableIOComplianceCheck", "Arn"]},
        "Action": "lambda:InvokeFunction",
        "Principal": "config.amazonaws.com",
        "SourceAccount": <span>{</span>"Ref": "AWS::AccountId" }
    }
},
"VolumeAutoEnableIOComplianceCheck": <span>{</span>
  "Type": "AWS::Lambda::Function",
  "Properties": <span>{</span>
    "Code": <span>{</span>
      "ZipFile":  <span>{</span>"Fn::Join": ["\n", [
        "var aws  = require('aws-sdk');",
        "var config = new aws.ConfigService();",
        "var ec2 = new aws.EC2();",

        "exports.handler = function(event, context) <span>{</span>",
        "    compliance = evaluateCompliance(event, function(compliance, event) <span>{</span>",
        "        var configurationItem = JSON.parse(event.invokingEvent).configurationItem;",

        "        var putEvaluationsRequest = <span>{</span>",
        "            Evaluations: [<span>{</span>",
        "                ComplianceResourceType: configurationItem.resourceType,",
        "                ComplianceResourceId: configurationItem.resourceId,",
        "                ComplianceType: compliance,",
        "                OrderingTimestamp: configurationItem.configurationItemCaptureTime",
        "            }],",
        "            ResultToken: event.resultToken",
        "        };",

        "        config.putEvaluations(putEvaluationsRequest, function(err, data) <span>{</span>",
        "            if (err) context.fail(err);",
        "            else context.succeed(data);",
        "        });",
        "    });",
        "};",

        "function evaluateCompliance(event, doReturn) <span>{</span>",
        "    var configurationItem = JSON.parse(event.invokingEvent).configurationItem;",
        "    var status = configurationItem.configurationItemStatus;",
        "    if (configurationItem.resourceType !== 'AWS::EC2::Volume' || event.eventLeftScope || (status !== 'OK' &amp;&amp; status !== 'ResourceDiscovered'))",
        "        doReturn('NOT_APPLICABLE', event);",
        "    else ec2.describeVolumeAttribute(<span>{</span>VolumeId: configurationItem.resourceId, Attribute: 'autoEnableIO'}, function(err, data) <span>{</span>",
        "        if (err) context.fail(err);",
        "        else if (data.AutoEnableIO.Value) doReturn('COMPLIANT', event);",
        "        else doReturn('NON_COMPLIANT', event);",
        "    });",
        "}"
      ]]}
    },
    "Handler": "index.handler",
    "Runtime": "nodejs12.x",
    "Timeout": "30",
    "Role": <span>{</span>"Fn::GetAtt": ["LambdaExecutionRole", "Arn"]}
  }
},
"ConfigRuleForVolumeAutoEnableIO": <span>{</span>
  "Type": "AWS::Config::ConfigRule",
  "Properties": <span>{</span>
    "ConfigRuleName": "ConfigRuleForVolumeAutoEnableIO",
    "Scope": <span>{</span>
      "ComplianceResourceId": <span>{</span>"Ref": "Ec2Volume"},
      "ComplianceResourceTypes": ["AWS::EC2::Volume"]
    },
    "Source": <span>{</span>
      "Owner": "CUSTOM_LAMBDA",
      "SourceDetails": [<span>{</span>
          "EventSource": "aws.config",
          "MessageType": "ConfigurationItemChangeNotification"
      }],
      "SourceIdentifier": <span>{</span>"Fn::GetAtt": ["VolumeAutoEnableIOComplianceCheck", "Arn"]}
    }
  },
  "DependsOn": "ConfigPermissionToCallLambda"
}</code></pre></div><div id="YAML" name="YAML" class="section langfilter"><h4 id="aws-resource-config-configrule--examples--Create_Rule_Using_Lambda_Function--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">ConfigPermissionToCallLambda: 
  Type: AWS::Lambda::Permission
  Properties: 
    FunctionName: 
       Fn::GetAtt: 
        - VolumeAutoEnableIOComplianceCheck
        - Arn
    Action: "lambda:InvokeFunction"
    Principal: "config.amazonaws.com"
    SourceAccount: !Ref 'AWS::AccountId'
VolumeAutoEnableIOComplianceCheck: 
  Type: AWS::Lambda::Function
  Properties: 
    Code: 
      ZipFile: 
        !Sub |
          var aws  = require('aws-sdk');
          var config = new aws.ConfigService();
          var ec2 = new aws.EC2();
          exports.handler = function(event, context) <span>{</span>
              compliance = evaluateCompliance(event, function(compliance, event) <span>{</span>
                    var configurationItem = JSON.parse(event.invokingEvent).configurationItem;
                    var putEvaluationsRequest = <span>{</span>
                        Evaluations: [<span>{</span>
                            ComplianceResourceType: configurationItem.resourceType,
                            ComplianceResourceId: configurationItem.resourceId,
                            ComplianceType: compliance,
                            OrderingTimestamp: configurationItem.configurationItemCaptureTime
                        }],
                        ResultToken: event.resultToken
                    };
                    config.putEvaluations(putEvaluationsRequest, function(err, data) <span>{</span>
                        if (err) context.fail(err);
                        else context.succeed(data);
                    });
                });
            };
            function evaluateCompliance(event, doReturn) <span>{</span>
                var configurationItem = JSON.parse(event.invokingEvent).configurationItem;
                var status = configurationItem.configurationItemStatus;
                if (configurationItem.resourceType !== 'AWS::EC2::Volume' || event.eventLeftScope || (status !== 'OK' &amp;&amp; status !== 'ResourceDiscovered'))
                    doReturn('NOT_APPLICABLE', event);
                else ec2.describeVolumeAttribute(<span>{</span>VolumeId: configurationItem.resourceId, Attribute: 'autoEnableIO'}, function(err, data) <span>{</span>
                    if (err) context.fail(err);
                    else if (data.AutoEnableIO.Value) doReturn('COMPLIANT', event);
                    else doReturn('NON_COMPLIANT', event);
                });
            }
    Handler: "index.handler"
    Runtime: nodejs12.x
    Timeout: 30
    Role: 
      Fn::GetAtt: 
        - LambdaExecutionRole
        - Arn
ConfigRuleForVolumeAutoEnableIO: 
  Type: AWS::Config::ConfigRule
  Properties: 
    ConfigRuleName: ConfigRuleForVolumeAutoEnableIO
    Scope: 
      ComplianceResourceId: 
        Ref: Ec2Volume
      ComplianceResourceTypes: 
        - "AWS::EC2::Volume"
    Source: 
      Owner: "CUSTOM_LAMBDA"
      SourceDetails: 
        - 
          EventSource: "aws.config"
          MessageType: "ConfigurationItemChangeNotification"
      SourceIdentifier: 
        Fn::GetAtt: 
          - VolumeAutoEnableIOComplianceCheck
          - Arn
  DependsOn: ConfigPermissionToCallLambda</code></pre></div><h3 id="aws-resource-config-configrule--examples--Update_Rule_Using_Lambda_Function_with_SourceArn_based_permission">Update Rule Using Lambda Function with SourceArn based permission</h3><p>After an AWS Config rule has been created, there is a <code class="code">sourceARN</code> which is the ARN of the AWS Config rule that is invoking the Lambda function.
                   The following example includes <code class="code">sourceARN</code> based permission to restrict only a specific rule ARN to invoke the Lambda function.
                   It is recommended after you create a rule that you update with these more restrictive permissions to help make sure AWS Lambda is accessing your resources on behalf of expected users and scenarios only.</p><div id="JSON" name="JSON" class="section langfilter"><h4 id="aws-resource-config-configrule--examples--Update_Rule_Using_Lambda_Function_with_SourceArn_based_permission--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"ConfigPermissionToCallLambda": <span>{</span>
    "Type": "AWS::Lambda::Permission",
    "Properties": <span>{</span>
        "FunctionName": <span>{</span>"Fn::GetAtt": ["VolumeAutoEnableIOComplianceCheck", "Arn"]},
        "Action": "lambda:InvokeFunction",
        "Principal": "config.amazonaws.com",
        "SourceAccount": <span>{</span>"Ref": "AWS::AccountId" },
        "SourceArn": <span>{</span>"Fn::GetAtt": [ "ConfigRuleForVolumeAutoEnableIO", "Arn" ] }
    }
},
"VolumeAutoEnableIOComplianceCheck": <span>{</span>
    "Type": "AWS::Lambda::Function",
    "Properties": <span>{</span>
        "Code": <span>{</span>
            "ZipFile":  <span>{</span>"Fn::Join": ["\n", [
               "var aws  = require('aws-sdk');",
               "var config = new aws.ConfigService();",
               "var ec2 = new aws.EC2();",
               
               "exports.handler = function(event, context) <span>{</span>",
               "    compliance = evaluateCompliance(event, function(compliance, event) <span>{</span>",
               "        var configurationItem = JSON.parse(event.invokingEvent).configurationItem;",
               
               "        var putEvaluationsRequest = <span>{</span>",
               "            Evaluations: [<span>{</span>",
               "                ComplianceResourceType: configurationItem.resourceType,",
               "                ComplianceResourceId: configurationItem.resourceId,",
               "                ComplianceType: compliance,",
               "                OrderingTimestamp: configurationItem.configurationItemCaptureTime",
               "            }],",
               "            ResultToken: event.resultToken",
               "        };",
               
               "        config.putEvaluations(putEvaluationsRequest, function(err, data) <span>{</span>",
               "            if (err) context.fail(err);",
               "            else context.succeed(data);",
               "        });",
               "    });",
               "};",
               
               "function evaluateCompliance(event, doReturn) <span>{</span>",
               "    var configurationItem = JSON.parse(event.invokingEvent).configurationItem;",
               "    var status = configurationItem.configurationItemStatus;",
               "    if (configurationItem.resourceType !== 'AWS::EC2::Volume' || event.eventLeftScope || (status !== 'OK' &amp;&amp; status !== 'ResourceDiscovered'))",
               "        doReturn('NOT_APPLICABLE', event);",
               "    else ec2.describeVolumeAttribute(<span>{</span>VolumeId: configurationItem.resourceId, Attribute: 'autoEnableIO'}, function(err, data) <span>{</span>",
               "        if (err) context.fail(err);",
               "        else if (data.AutoEnableIO.Value) doReturn('COMPLIANT', event);",
               "        else doReturn('NON_COMPLIANT', event);",
               "    });",
               "}"
               ]]}
               },
            "Handler": "index.handler",
            "Runtime": "nodejs12.x",
            "Timeout": "30",
            "Role": <span>{</span>"Fn::GetAtt": ["LambdaExecutionRole", "Arn"]}
    }
},
"ConfigRuleForVolumeAutoEnableIO": <span>{</span>
    "Type": "AWS::Config::ConfigRule",
    "Properties": <span>{</span>
        "ConfigRuleName": "ConfigRuleForVolumeAutoEnableIO",
        "Scope": <span>{</span>
            "ComplianceResourceId": <span>{</span>"Ref": "Ec2Volume"},
            "ComplianceResourceTypes": ["AWS::EC2::Volume"]
         },
         "Source": <span>{</span>
            "Owner": "CUSTOM_LAMBDA",
             "SourceDetails": [<span>{</span>
               "EventSource": "aws.config",
               "MessageType": "ConfigurationItemChangeNotification"
            }],
            "SourceIdentifier": <span>{</span>"Fn::GetAtt": ["VolumeAutoEnableIOComplianceCheck", "Arn"]}
          }
     },
     "DependsOn": "ConfigPermissionToCallLambda"
}</code></pre></div><div id="YAML" name="YAML" class="section langfilter"><h4 id="aws-resource-config-configrule--examples--Update_Rule_Using_Lambda_Function_with_SourceArn_based_permission--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="yaml ">ConfigPermissionToCallLambda: 
    Type: AWS::Lambda::Permission
    Properties: 
      FunctionName: 
        Fn::GetAtt: 
           - VolumeAutoEnableIOComplianceCheck
           - Arn
      Action: "lambda:InvokeFunction"
      Principal: "config.amazonaws.com"
      SourceAccount: !Ref 'AWS::AccountId'
      SourceArn:
        Fn::GetAtt: 
           - VolumeAutoEnableIOComplianceCheck
           - Arn
VolumeAutoEnableIOComplianceCheck: 
    Type: AWS::Lambda::Function
    Properties: 
      Code: 
        ZipFile: 
           !Sub |
             var aws  = require('aws-sdk');
             var config = new aws.ConfigService();
             var ec2 = new aws.EC2();
             exports.handler = function(event, context) <span>{</span>
                compliance = evaluateCompliance(event, function(compliance, event) <span>{</span>
                    var configurationItem = JSON.parse(event.invokingEvent).configurationItem;
                    var putEvaluationsRequest = <span>{</span>
                        Evaluations: [<span>{</span>
                            ComplianceResourceType: configurationItem.resourceType,
                            ComplianceResourceId: configurationItem.resourceId,
                            ComplianceType: compliance,
                            OrderingTimestamp: configurationItem.configurationItemCaptureTime
                         }],
                         ResultToken: event.resultToken
                    };
                    config.putEvaluations(putEvaluationsRequest, function(err, data) <span>{</span>
                        if (err) context.fail(err);
                        else context.succeed(data);
                    });
                 });
               };
               function evaluateCompliance(event, doReturn) <span>{</span>
                  var configurationItem = JSON.parse(event.invokingEvent).configurationItem;
                  var status = configurationItem.configurationItemStatus;
               if (configurationItem.resourceType !== 'AWS::EC2::Volume' || event.eventLeftScope || (status !== 'OK' &amp;&amp; status !== 'ResourceDiscovered'))
                    doReturn('NOT_APPLICABLE', event);
               else ec2.describeVolumeAttribute(<span>{</span>VolumeId: configurationItem.resourceId, Attribute: 'autoEnableIO'}, function(err, data) <span>{</span>
                    if (err) context.fail(err);
                    else if (data.AutoEnableIO.Value) doReturn('COMPLIANT', event);
                    else doReturn('NON_COMPLIANT', event);
                  });
               }
      Handler: "index.handler"
      Runtime: nodejs12.x
      Timeout: 30
      Role: 
        Fn::GetAtt: 
           - LambdaExecutionRole
           - Arn
ConfigRuleForVolumeAutoEnableIO: 
    Type: AWS::Config::ConfigRule
    Properties: 
      ConfigRuleName: ConfigRuleForVolumeAutoEnableIO
      Scope: 
         ComplianceResourceId: 
           Ref: Ec2Volume
          ComplianceResourceTypes: 
           - "AWS::EC2::Volume"
      Source: 
         Owner: "CUSTOM_LAMBDA"
         SourceDetails: 
           - 
              EventSource: "aws.config"
              MessageType: "ConfigurationItemChangeNotification"
         SourceIdentifier: 
           Fn::GetAtt: 
               - VolumeAutoEnableIOComplianceCheck
               - Arn
     DependsOn: ConfigPermissionToCallLambda</code></pre></div><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./aws-properties-config-aggregationauthorization-tag.html">Tag</div><div id="next" class="next-link" accesskey="n" href="./aws-properties-config-configrule-compliance.html">Compliance</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS Config&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS Config&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>